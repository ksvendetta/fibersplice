var gU=Object.defineProperty;var A1=e=>{throw TypeError(e)};var yU=(e,t,r)=>t in e?gU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var fe=(e,t,r)=>yU(e,typeof t!="symbol"?t+"":t,r),ny=(e,t,r)=>t.has(e)||A1("Cannot "+r);var J=(e,t,r)=>(ny(e,t,"read from private field"),r?r.call(e):t.get(e)),yt=(e,t,r)=>t.has(e)?A1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),it=(e,t,r,n)=>(ny(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Dt=(e,t,r)=>(ny(e,t,"access private method"),r);var Lp=(e,t,r,n)=>({set _(i){it(e,t,i,r)},get _(){return J(e,t,n)}});function vU(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var R1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function OX(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var FN={exports:{}},sg={},LN={exports:{}},Bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tp=Symbol.for("react.element"),wU=Symbol.for("react.portal"),bU=Symbol.for("react.fragment"),xU=Symbol.for("react.strict_mode"),_U=Symbol.for("react.profiler"),$U=Symbol.for("react.provider"),SU=Symbol.for("react.context"),CU=Symbol.for("react.forward_ref"),kU=Symbol.for("react.suspense"),EU=Symbol.for("react.memo"),TU=Symbol.for("react.lazy"),O1=Symbol.iterator;function IU(e){return e===null||typeof e!="object"?null:(e=O1&&e[O1]||e["@@iterator"],typeof e=="function"?e:null)}var BN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},UN=Object.assign,VN={};function Ec(e,t,r){this.props=e,this.context=t,this.refs=VN,this.updater=r||BN}Ec.prototype.isReactComponent={};Ec.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ec.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qN(){}qN.prototype=Ec.prototype;function Gw(e,t,r){this.props=e,this.context=t,this.refs=VN,this.updater=r||BN}var Qw=Gw.prototype=new qN;Qw.constructor=Gw;UN(Qw,Ec.prototype);Qw.isPureReactComponent=!0;var D1=Array.isArray,WN=Object.prototype.hasOwnProperty,Zw={current:null},KN={key:!0,ref:!0,__self:!0,__source:!0};function HN(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)WN.call(t,n)&&!KN.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:tp,type:e,key:s,ref:a,props:i,_owner:Zw.current}}function NU(e,t){return{$$typeof:tp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Yw(e){return typeof e=="object"&&e!==null&&e.$$typeof===tp}function PU(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var j1=/\/+/g;function iy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?PU(""+e.key):t.toString(36)}function Ih(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case tp:case wU:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+iy(a,0):n,D1(i)?(r="",e!=null&&(r=e.replace(j1,"$&/")+"/"),Ih(i,t,r,"",function(u){return u})):i!=null&&(Yw(i)&&(i=NU(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(j1,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",D1(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+iy(s,o);a+=Ih(s,t,r,l,i)}else if(l=IU(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+iy(s,o++),a+=Ih(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Bp(e,t,r){if(e==null)return e;var n=[],i=0;return Ih(e,n,"","",function(s){return t.call(r,s,i++)}),n}function AU(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Fn={current:null},Nh={transition:null},RU={ReactCurrentDispatcher:Fn,ReactCurrentBatchConfig:Nh,ReactCurrentOwner:Zw};function GN(){throw Error("act(...) is not supported in production builds of React.")}Bt.Children={map:Bp,forEach:function(e,t,r){Bp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Bp(e,function(){t++}),t},toArray:function(e){return Bp(e,function(t){return t})||[]},only:function(e){if(!Yw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Bt.Component=Ec;Bt.Fragment=bU;Bt.Profiler=_U;Bt.PureComponent=Gw;Bt.StrictMode=xU;Bt.Suspense=kU;Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RU;Bt.act=GN;Bt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=UN({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Zw.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)WN.call(t,l)&&!KN.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:tp,type:e.type,key:i,ref:s,props:n,_owner:a}};Bt.createContext=function(e){return e={$$typeof:SU,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$U,_context:e},e.Consumer=e};Bt.createElement=HN;Bt.createFactory=function(e){var t=HN.bind(null,e);return t.type=e,t};Bt.createRef=function(){return{current:null}};Bt.forwardRef=function(e){return{$$typeof:CU,render:e}};Bt.isValidElement=Yw;Bt.lazy=function(e){return{$$typeof:TU,_payload:{_status:-1,_result:e},_init:AU}};Bt.memo=function(e,t){return{$$typeof:EU,type:e,compare:t===void 0?null:t}};Bt.startTransition=function(e){var t=Nh.transition;Nh.transition={};try{e()}finally{Nh.transition=t}};Bt.unstable_act=GN;Bt.useCallback=function(e,t){return Fn.current.useCallback(e,t)};Bt.useContext=function(e){return Fn.current.useContext(e)};Bt.useDebugValue=function(){};Bt.useDeferredValue=function(e){return Fn.current.useDeferredValue(e)};Bt.useEffect=function(e,t){return Fn.current.useEffect(e,t)};Bt.useId=function(){return Fn.current.useId()};Bt.useImperativeHandle=function(e,t,r){return Fn.current.useImperativeHandle(e,t,r)};Bt.useInsertionEffect=function(e,t){return Fn.current.useInsertionEffect(e,t)};Bt.useLayoutEffect=function(e,t){return Fn.current.useLayoutEffect(e,t)};Bt.useMemo=function(e,t){return Fn.current.useMemo(e,t)};Bt.useReducer=function(e,t,r){return Fn.current.useReducer(e,t,r)};Bt.useRef=function(e){return Fn.current.useRef(e)};Bt.useState=function(e){return Fn.current.useState(e)};Bt.useSyncExternalStore=function(e,t,r){return Fn.current.useSyncExternalStore(e,t,r)};Bt.useTransition=function(){return Fn.current.useTransition()};Bt.version="18.3.1";LN.exports=Bt;var P=LN.exports;const Nt=Hw(P),QN=vU({__proto__:null,default:Nt},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OU=P,DU=Symbol.for("react.element"),jU=Symbol.for("react.fragment"),MU=Object.prototype.hasOwnProperty,zU=OU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FU={key:!0,ref:!0,__self:!0,__source:!0};function ZN(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)MU.call(t,n)&&!FU.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:DU,type:e,key:s,ref:a,props:i,_owner:zU.current}}sg.Fragment=jU;sg.jsx=ZN;sg.jsxs=ZN;FN.exports=sg;var y=FN.exports,YN={exports:{}},yi={},XN={exports:{}},JN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,F){var H=W.length;W.push(F);e:for(;0<H;){var B=H-1>>>1,ee=W[B];if(0<i(ee,F))W[B]=F,W[H]=ee,H=B;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var F=W[0],H=W.pop();if(H!==F){W[0]=H;e:for(var B=0,ee=W.length,me=ee>>>1;B<me;){var K=2*(B+1)-1,Ae=W[K],Ze=K+1,be=W[Ze];if(0>i(Ae,H))Ze<ee&&0>i(be,Ae)?(W[B]=be,W[Ze]=H,B=Ze):(W[B]=Ae,W[K]=H,B=K);else if(Ze<ee&&0>i(be,H))W[B]=be,W[Ze]=H,B=Ze;else break e}}return F}function i(W,F){var H=W.sortIndex-F.sortIndex;return H!==0?H:W.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,f=null,p=3,w=!1,x=!1,v=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=W)n(u),F.sortIndex=F.expirationTime,t(l,F);else break;F=r(u)}}function E(W){if(v=!1,S(W),!x)if(r(l)!==null)x=!0,ne(A);else{var F=r(u);F!==null&&ce(E,F.startTime-W)}}function A(W,F){x=!1,v&&(v=!1,b(I),I=-1),w=!0;var H=p;try{for(S(F),f=r(l);f!==null&&(!(f.expirationTime>F)||W&&!ue());){var B=f.callback;if(typeof B=="function"){f.callback=null,p=f.priorityLevel;var ee=B(f.expirationTime<=F);F=e.unstable_now(),typeof ee=="function"?f.callback=ee:f===r(l)&&n(l),S(F)}else n(l);f=r(l)}if(f!==null)var me=!0;else{var K=r(u);K!==null&&ce(E,K.startTime-F),me=!1}return me}finally{f=null,p=H,w=!1}}var M=!1,D=null,I=-1,U=5,Z=-1;function ue(){return!(e.unstable_now()-Z<U)}function X(){if(D!==null){var W=e.unstable_now();Z=W;var F=!0;try{F=D(!0,W)}finally{F?ie():(M=!1,D=null)}}else M=!1}var ie;if(typeof g=="function")ie=function(){g(X)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,le=j.port2;j.port1.onmessage=X,ie=function(){le.postMessage(null)}}else ie=function(){C(X,0)};function ne(W){D=W,M||(M=!0,ie())}function ce(W,F){I=C(function(){W(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,ne(A))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(W){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var H=p;p=F;try{return W()}finally{p=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,F){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var H=p;p=W;try{return F()}finally{p=H}},e.unstable_scheduleCallback=function(W,F,H){var B=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?B+H:B):H=B,W){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=H+ee,W={id:c++,callback:F,priorityLevel:W,startTime:H,expirationTime:ee,sortIndex:-1},H>B?(W.sortIndex=H,t(u,W),r(l)===null&&W===r(u)&&(v?(b(I),I=-1):v=!0,ce(E,H-B))):(W.sortIndex=ee,t(l,W),x||w||(x=!0,ne(A))),W},e.unstable_shouldYield=ue,e.unstable_wrapCallback=function(W){var F=p;return function(){var H=p;p=F;try{return W.apply(this,arguments)}finally{p=H}}}})(JN);XN.exports=JN;var LU=XN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BU=P,gi=LU;function ze(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var e3=new Set,hf={};function Ml(e,t){uc(e,t),uc(e+"Capture",t)}function uc(e,t){for(hf[e]=t,e=0;e<t.length;e++)e3.add(t[e])}var ba=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zv=Object.prototype.hasOwnProperty,UU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,M1={},z1={};function VU(e){return Zv.call(z1,e)?!0:Zv.call(M1,e)?!1:UU.test(e)?z1[e]=!0:(M1[e]=!0,!1)}function qU(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function WU(e,t,r,n){if(t===null||typeof t>"u"||qU(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ln(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yn[e]=new Ln(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yn[t]=new Ln(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yn[e]=new Ln(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yn[e]=new Ln(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yn[e]=new Ln(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yn[e]=new Ln(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yn[e]=new Ln(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yn[e]=new Ln(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yn[e]=new Ln(e,5,!1,e.toLowerCase(),null,!1,!1)});var Xw=/[\-:]([a-z])/g;function Jw(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Xw,Jw);yn[t]=new Ln(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Xw,Jw);yn[t]=new Ln(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Xw,Jw);yn[t]=new Ln(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yn[e]=new Ln(e,1,!1,e.toLowerCase(),null,!1,!1)});yn.xlinkHref=new Ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yn[e]=new Ln(e,1,!1,e.toLowerCase(),null,!0,!0)});function eb(e,t,r,n){var i=yn.hasOwnProperty(t)?yn[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(WU(t,r,i,n)&&(r=null),n||i===null?VU(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ea=BU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Up=Symbol.for("react.element"),wu=Symbol.for("react.portal"),bu=Symbol.for("react.fragment"),tb=Symbol.for("react.strict_mode"),Yv=Symbol.for("react.profiler"),t3=Symbol.for("react.provider"),r3=Symbol.for("react.context"),rb=Symbol.for("react.forward_ref"),Xv=Symbol.for("react.suspense"),Jv=Symbol.for("react.suspense_list"),nb=Symbol.for("react.memo"),Va=Symbol.for("react.lazy"),n3=Symbol.for("react.offscreen"),F1=Symbol.iterator;function ud(e){return e===null||typeof e!="object"?null:(e=F1&&e[F1]||e["@@iterator"],typeof e=="function"?e:null)}var Ar=Object.assign,sy;function Ad(e){if(sy===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sy=t&&t[1]||""}return`
`+sy+e}var ay=!1;function oy(e,t){if(!e||ay)return"";ay=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{ay=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ad(e):""}function KU(e){switch(e.tag){case 5:return Ad(e.type);case 16:return Ad("Lazy");case 13:return Ad("Suspense");case 19:return Ad("SuspenseList");case 0:case 2:case 15:return e=oy(e.type,!1),e;case 11:return e=oy(e.type.render,!1),e;case 1:return e=oy(e.type,!0),e;default:return""}}function e0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bu:return"Fragment";case wu:return"Portal";case Yv:return"Profiler";case tb:return"StrictMode";case Xv:return"Suspense";case Jv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case r3:return(e.displayName||"Context")+".Consumer";case t3:return(e._context.displayName||"Context")+".Provider";case rb:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case nb:return t=e.displayName||null,t!==null?t:e0(e.type)||"Memo";case Va:t=e._payload,e=e._init;try{return e0(e(t))}catch{}}return null}function HU(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return e0(t);case 8:return t===tb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function go(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function i3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function GU(e){var t=i3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vp(e){e._valueTracker||(e._valueTracker=GU(e))}function s3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=i3(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Xh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function t0(e,t){var r=t.checked;return Ar({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function L1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=go(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function a3(e,t){t=t.checked,t!=null&&eb(e,"checked",t,!1)}function r0(e,t){a3(e,t);var r=go(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?n0(e,t.type,r):t.hasOwnProperty("defaultValue")&&n0(e,t.type,go(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function B1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function n0(e,t,r){(t!=="number"||Xh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Rd=Array.isArray;function ju(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+go(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function i0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ze(91));return Ar({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function U1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ze(92));if(Rd(r)){if(1<r.length)throw Error(ze(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:go(r)}}function o3(e,t){var r=go(t.value),n=go(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function V1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function l3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function s0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?l3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qp,u3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qp=qp||document.createElement("div"),qp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function mf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Zd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QU=["Webkit","ms","Moz","O"];Object.keys(Zd).forEach(function(e){QU.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zd[t]=Zd[e]})});function c3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Zd.hasOwnProperty(e)&&Zd[e]?(""+t).trim():t+"px"}function d3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=c3(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var ZU=Ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a0(e,t){if(t){if(ZU[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ze(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ze(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ze(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ze(62))}}function o0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var l0=null;function ib(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var u0=null,Mu=null,zu=null;function q1(e){if(e=ip(e)){if(typeof u0!="function")throw Error(ze(280));var t=e.stateNode;t&&(t=cg(t),u0(e.stateNode,e.type,t))}}function f3(e){Mu?zu?zu.push(e):zu=[e]:Mu=e}function p3(){if(Mu){var e=Mu,t=zu;if(zu=Mu=null,q1(e),t)for(e=0;e<t.length;e++)q1(t[e])}}function h3(e,t){return e(t)}function m3(){}var ly=!1;function g3(e,t,r){if(ly)return e(t,r);ly=!0;try{return h3(e,t,r)}finally{ly=!1,(Mu!==null||zu!==null)&&(m3(),p3())}}function gf(e,t){var r=e.stateNode;if(r===null)return null;var n=cg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ze(231,t,typeof r));return r}var c0=!1;if(ba)try{var cd={};Object.defineProperty(cd,"passive",{get:function(){c0=!0}}),window.addEventListener("test",cd,cd),window.removeEventListener("test",cd,cd)}catch{c0=!1}function YU(e,t,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(c){this.onError(c)}}var Yd=!1,Jh=null,em=!1,d0=null,XU={onError:function(e){Yd=!0,Jh=e}};function JU(e,t,r,n,i,s,a,o,l){Yd=!1,Jh=null,YU.apply(XU,arguments)}function eV(e,t,r,n,i,s,a,o,l){if(JU.apply(this,arguments),Yd){if(Yd){var u=Jh;Yd=!1,Jh=null}else throw Error(ze(198));em||(em=!0,d0=u)}}function zl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function y3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function W1(e){if(zl(e)!==e)throw Error(ze(188))}function tV(e){var t=e.alternate;if(!t){if(t=zl(e),t===null)throw Error(ze(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return W1(i),e;if(s===n)return W1(i),t;s=s.sibling}throw Error(ze(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ze(189))}}if(r.alternate!==n)throw Error(ze(190))}if(r.tag!==3)throw Error(ze(188));return r.stateNode.current===r?e:t}function v3(e){return e=tV(e),e!==null?w3(e):null}function w3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=w3(e);if(t!==null)return t;e=e.sibling}return null}var b3=gi.unstable_scheduleCallback,K1=gi.unstable_cancelCallback,rV=gi.unstable_shouldYield,nV=gi.unstable_requestPaint,Lr=gi.unstable_now,iV=gi.unstable_getCurrentPriorityLevel,sb=gi.unstable_ImmediatePriority,x3=gi.unstable_UserBlockingPriority,tm=gi.unstable_NormalPriority,sV=gi.unstable_LowPriority,_3=gi.unstable_IdlePriority,ag=null,js=null;function aV(e){if(js&&typeof js.onCommitFiberRoot=="function")try{js.onCommitFiberRoot(ag,e,void 0,(e.current.flags&128)===128)}catch{}}var ls=Math.clz32?Math.clz32:uV,oV=Math.log,lV=Math.LN2;function uV(e){return e>>>=0,e===0?32:31-(oV(e)/lV|0)|0}var Wp=64,Kp=4194304;function Od(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function rm(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Od(o):(s&=a,s!==0&&(n=Od(s)))}else a=r&~i,a!==0?n=Od(a):s!==0&&(n=Od(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ls(t),i=1<<r,n|=e[r],t&=~i;return n}function cV(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dV(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-ls(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=cV(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function f0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $3(){var e=Wp;return Wp<<=1,!(Wp&4194240)&&(Wp=64),e}function uy(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function rp(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ls(t),e[t]=r}function fV(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-ls(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function ab(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ls(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var pr=0;function S3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var C3,ob,k3,E3,T3,p0=!1,Hp=[],so=null,ao=null,oo=null,yf=new Map,vf=new Map,Wa=[],pV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function H1(e,t){switch(e){case"focusin":case"focusout":so=null;break;case"dragenter":case"dragleave":ao=null;break;case"mouseover":case"mouseout":oo=null;break;case"pointerover":case"pointerout":yf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vf.delete(t.pointerId)}}function dd(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=ip(t),t!==null&&ob(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function hV(e,t,r,n,i){switch(t){case"focusin":return so=dd(so,e,t,r,n,i),!0;case"dragenter":return ao=dd(ao,e,t,r,n,i),!0;case"mouseover":return oo=dd(oo,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return yf.set(s,dd(yf.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,vf.set(s,dd(vf.get(s)||null,e,t,r,n,i)),!0}return!1}function I3(e){var t=nl(e.target);if(t!==null){var r=zl(t);if(r!==null){if(t=r.tag,t===13){if(t=y3(r),t!==null){e.blockedOn=t,T3(e.priority,function(){k3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ph(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=h0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);l0=n,r.target.dispatchEvent(n),l0=null}else return t=ip(r),t!==null&&ob(t),e.blockedOn=r,!1;t.shift()}return!0}function G1(e,t,r){Ph(e)&&r.delete(t)}function mV(){p0=!1,so!==null&&Ph(so)&&(so=null),ao!==null&&Ph(ao)&&(ao=null),oo!==null&&Ph(oo)&&(oo=null),yf.forEach(G1),vf.forEach(G1)}function fd(e,t){e.blockedOn===t&&(e.blockedOn=null,p0||(p0=!0,gi.unstable_scheduleCallback(gi.unstable_NormalPriority,mV)))}function wf(e){function t(i){return fd(i,e)}if(0<Hp.length){fd(Hp[0],e);for(var r=1;r<Hp.length;r++){var n=Hp[r];n.blockedOn===e&&(n.blockedOn=null)}}for(so!==null&&fd(so,e),ao!==null&&fd(ao,e),oo!==null&&fd(oo,e),yf.forEach(t),vf.forEach(t),r=0;r<Wa.length;r++)n=Wa[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Wa.length&&(r=Wa[0],r.blockedOn===null);)I3(r),r.blockedOn===null&&Wa.shift()}var Fu=Ea.ReactCurrentBatchConfig,nm=!0;function gV(e,t,r,n){var i=pr,s=Fu.transition;Fu.transition=null;try{pr=1,lb(e,t,r,n)}finally{pr=i,Fu.transition=s}}function yV(e,t,r,n){var i=pr,s=Fu.transition;Fu.transition=null;try{pr=4,lb(e,t,r,n)}finally{pr=i,Fu.transition=s}}function lb(e,t,r,n){if(nm){var i=h0(e,t,r,n);if(i===null)wy(e,t,n,im,r),H1(e,n);else if(hV(i,e,t,r,n))n.stopPropagation();else if(H1(e,n),t&4&&-1<pV.indexOf(e)){for(;i!==null;){var s=ip(i);if(s!==null&&C3(s),s=h0(e,t,r,n),s===null&&wy(e,t,n,im,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else wy(e,t,n,null,r)}}var im=null;function h0(e,t,r,n){if(im=null,e=ib(n),e=nl(e),e!==null)if(t=zl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=y3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return im=e,null}function N3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iV()){case sb:return 1;case x3:return 4;case tm:case sV:return 16;case _3:return 536870912;default:return 16}default:return 16}}var no=null,ub=null,Ah=null;function P3(){if(Ah)return Ah;var e,t=ub,r=t.length,n,i="value"in no?no.value:no.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Ah=i.slice(e,1<n?1-n:void 0)}function Rh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Gp(){return!0}function Q1(){return!1}function vi(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Gp:Q1,this.isPropagationStopped=Q1,this}return Ar(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Gp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Gp)},persist:function(){},isPersistent:Gp}),t}var Tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cb=vi(Tc),np=Ar({},Tc,{view:0,detail:0}),vV=vi(np),cy,dy,pd,og=Ar({},np,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:db,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pd&&(pd&&e.type==="mousemove"?(cy=e.screenX-pd.screenX,dy=e.screenY-pd.screenY):dy=cy=0,pd=e),cy)},movementY:function(e){return"movementY"in e?e.movementY:dy}}),Z1=vi(og),wV=Ar({},og,{dataTransfer:0}),bV=vi(wV),xV=Ar({},np,{relatedTarget:0}),fy=vi(xV),_V=Ar({},Tc,{animationName:0,elapsedTime:0,pseudoElement:0}),$V=vi(_V),SV=Ar({},Tc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),CV=vi(SV),kV=Ar({},Tc,{data:0}),Y1=vi(kV),EV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NV(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=IV[e])?!!t[e]:!1}function db(){return NV}var PV=Ar({},np,{key:function(e){if(e.key){var t=EV[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Rh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TV[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:db,charCode:function(e){return e.type==="keypress"?Rh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Rh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AV=vi(PV),RV=Ar({},og,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X1=vi(RV),OV=Ar({},np,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:db}),DV=vi(OV),jV=Ar({},Tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),MV=vi(jV),zV=Ar({},og,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),FV=vi(zV),LV=[9,13,27,32],fb=ba&&"CompositionEvent"in window,Xd=null;ba&&"documentMode"in document&&(Xd=document.documentMode);var BV=ba&&"TextEvent"in window&&!Xd,A3=ba&&(!fb||Xd&&8<Xd&&11>=Xd),J1=" ",e_=!1;function R3(e,t){switch(e){case"keyup":return LV.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xu=!1;function UV(e,t){switch(e){case"compositionend":return O3(t);case"keypress":return t.which!==32?null:(e_=!0,J1);case"textInput":return e=t.data,e===J1&&e_?null:e;default:return null}}function VV(e,t){if(xu)return e==="compositionend"||!fb&&R3(e,t)?(e=P3(),Ah=ub=no=null,xu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return A3&&t.locale!=="ko"?null:t.data;default:return null}}var qV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function t_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qV[e.type]:t==="textarea"}function D3(e,t,r,n){f3(n),t=sm(t,"onChange"),0<t.length&&(r=new cb("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Jd=null,bf=null;function WV(e){K3(e,0)}function lg(e){var t=Su(e);if(s3(t))return e}function KV(e,t){if(e==="change")return t}var j3=!1;if(ba){var py;if(ba){var hy="oninput"in document;if(!hy){var r_=document.createElement("div");r_.setAttribute("oninput","return;"),hy=typeof r_.oninput=="function"}py=hy}else py=!1;j3=py&&(!document.documentMode||9<document.documentMode)}function n_(){Jd&&(Jd.detachEvent("onpropertychange",M3),bf=Jd=null)}function M3(e){if(e.propertyName==="value"&&lg(bf)){var t=[];D3(t,bf,e,ib(e)),g3(WV,t)}}function HV(e,t,r){e==="focusin"?(n_(),Jd=t,bf=r,Jd.attachEvent("onpropertychange",M3)):e==="focusout"&&n_()}function GV(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lg(bf)}function QV(e,t){if(e==="click")return lg(t)}function ZV(e,t){if(e==="input"||e==="change")return lg(t)}function YV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fs=typeof Object.is=="function"?Object.is:YV;function xf(e,t){if(fs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Zv.call(t,i)||!fs(e[i],t[i]))return!1}return!0}function i_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function s_(e,t){var r=i_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=i_(r)}}function z3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?z3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function F3(){for(var e=window,t=Xh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Xh(e.document)}return t}function pb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function XV(e){var t=F3(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&z3(r.ownerDocument.documentElement,r)){if(n!==null&&pb(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=s_(r,s);var a=s_(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var JV=ba&&"documentMode"in document&&11>=document.documentMode,_u=null,m0=null,ef=null,g0=!1;function a_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;g0||_u==null||_u!==Xh(n)||(n=_u,"selectionStart"in n&&pb(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ef&&xf(ef,n)||(ef=n,n=sm(m0,"onSelect"),0<n.length&&(t=new cb("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=_u)))}function Qp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var $u={animationend:Qp("Animation","AnimationEnd"),animationiteration:Qp("Animation","AnimationIteration"),animationstart:Qp("Animation","AnimationStart"),transitionend:Qp("Transition","TransitionEnd")},my={},L3={};ba&&(L3=document.createElement("div").style,"AnimationEvent"in window||(delete $u.animationend.animation,delete $u.animationiteration.animation,delete $u.animationstart.animation),"TransitionEvent"in window||delete $u.transitionend.transition);function ug(e){if(my[e])return my[e];if(!$u[e])return e;var t=$u[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in L3)return my[e]=t[r];return e}var B3=ug("animationend"),U3=ug("animationiteration"),V3=ug("animationstart"),q3=ug("transitionend"),W3=new Map,o_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Eo(e,t){W3.set(e,t),Ml(t,[e])}for(var gy=0;gy<o_.length;gy++){var yy=o_[gy],e6=yy.toLowerCase(),t6=yy[0].toUpperCase()+yy.slice(1);Eo(e6,"on"+t6)}Eo(B3,"onAnimationEnd");Eo(U3,"onAnimationIteration");Eo(V3,"onAnimationStart");Eo("dblclick","onDoubleClick");Eo("focusin","onFocus");Eo("focusout","onBlur");Eo(q3,"onTransitionEnd");uc("onMouseEnter",["mouseout","mouseover"]);uc("onMouseLeave",["mouseout","mouseover"]);uc("onPointerEnter",["pointerout","pointerover"]);uc("onPointerLeave",["pointerout","pointerover"]);Ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),r6=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dd));function l_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,eV(n,t,void 0,e),e.currentTarget=null}function K3(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;l_(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;l_(i,o,u),s=l}}}if(em)throw e=d0,em=!1,d0=null,e}function xr(e,t){var r=t[x0];r===void 0&&(r=t[x0]=new Set);var n=e+"__bubble";r.has(n)||(H3(t,e,2,!1),r.add(n))}function vy(e,t,r){var n=0;t&&(n|=4),H3(r,e,n,t)}var Zp="_reactListening"+Math.random().toString(36).slice(2);function _f(e){if(!e[Zp]){e[Zp]=!0,e3.forEach(function(r){r!=="selectionchange"&&(r6.has(r)||vy(r,!1,e),vy(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zp]||(t[Zp]=!0,vy("selectionchange",!1,t))}}function H3(e,t,r,n){switch(N3(t)){case 1:var i=gV;break;case 4:i=yV;break;default:i=lb}r=i.bind(null,t,r,e),i=void 0,!c0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function wy(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=nl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}g3(function(){var u=s,c=ib(r),f=[];e:{var p=W3.get(e);if(p!==void 0){var w=cb,x=e;switch(e){case"keypress":if(Rh(r)===0)break e;case"keydown":case"keyup":w=AV;break;case"focusin":x="focus",w=fy;break;case"focusout":x="blur",w=fy;break;case"beforeblur":case"afterblur":w=fy;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Z1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=bV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=DV;break;case B3:case U3:case V3:w=$V;break;case q3:w=MV;break;case"scroll":w=vV;break;case"wheel":w=FV;break;case"copy":case"cut":case"paste":w=CV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=X1}var v=(t&4)!==0,C=!v&&e==="scroll",b=v?p!==null?p+"Capture":null:p;v=[];for(var g=u,S;g!==null;){S=g;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,b!==null&&(E=gf(g,b),E!=null&&v.push($f(g,E,S)))),C)break;g=g.return}0<v.length&&(p=new w(p,x,null,r,c),f.push({event:p,listeners:v}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",p&&r!==l0&&(x=r.relatedTarget||r.fromElement)&&(nl(x)||x[xa]))break e;if((w||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,w?(x=r.relatedTarget||r.toElement,w=u,x=x?nl(x):null,x!==null&&(C=zl(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=u),w!==x)){if(v=Z1,E="onMouseLeave",b="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(v=X1,E="onPointerLeave",b="onPointerEnter",g="pointer"),C=w==null?p:Su(w),S=x==null?p:Su(x),p=new v(E,g+"leave",w,r,c),p.target=C,p.relatedTarget=S,E=null,nl(c)===u&&(v=new v(b,g+"enter",x,r,c),v.target=S,v.relatedTarget=C,E=v),C=E,w&&x)t:{for(v=w,b=x,g=0,S=v;S;S=fu(S))g++;for(S=0,E=b;E;E=fu(E))S++;for(;0<g-S;)v=fu(v),g--;for(;0<S-g;)b=fu(b),S--;for(;g--;){if(v===b||b!==null&&v===b.alternate)break t;v=fu(v),b=fu(b)}v=null}else v=null;w!==null&&u_(f,p,w,v,!1),x!==null&&C!==null&&u_(f,C,x,v,!0)}}e:{if(p=u?Su(u):window,w=p.nodeName&&p.nodeName.toLowerCase(),w==="select"||w==="input"&&p.type==="file")var A=KV;else if(t_(p))if(j3)A=ZV;else{A=GV;var M=HV}else(w=p.nodeName)&&w.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(A=QV);if(A&&(A=A(e,u))){D3(f,A,r,c);break e}M&&M(e,p,u),e==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&n0(p,"number",p.value)}switch(M=u?Su(u):window,e){case"focusin":(t_(M)||M.contentEditable==="true")&&(_u=M,m0=u,ef=null);break;case"focusout":ef=m0=_u=null;break;case"mousedown":g0=!0;break;case"contextmenu":case"mouseup":case"dragend":g0=!1,a_(f,r,c);break;case"selectionchange":if(JV)break;case"keydown":case"keyup":a_(f,r,c)}var D;if(fb)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else xu?R3(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(A3&&r.locale!=="ko"&&(xu||I!=="onCompositionStart"?I==="onCompositionEnd"&&xu&&(D=P3()):(no=c,ub="value"in no?no.value:no.textContent,xu=!0)),M=sm(u,I),0<M.length&&(I=new Y1(I,e,null,r,c),f.push({event:I,listeners:M}),D?I.data=D:(D=O3(r),D!==null&&(I.data=D)))),(D=BV?UV(e,r):VV(e,r))&&(u=sm(u,"onBeforeInput"),0<u.length&&(c=new Y1("onBeforeInput","beforeinput",null,r,c),f.push({event:c,listeners:u}),c.data=D))}K3(f,t)})}function $f(e,t,r){return{instance:e,listener:t,currentTarget:r}}function sm(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=gf(e,r),s!=null&&n.unshift($f(e,s,i)),s=gf(e,t),s!=null&&n.push($f(e,s,i))),e=e.return}return n}function fu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function u_(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=gf(r,s),l!=null&&a.unshift($f(r,l,o))):i||(l=gf(r,s),l!=null&&a.push($f(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var n6=/\r\n?/g,i6=/\u0000|\uFFFD/g;function c_(e){return(typeof e=="string"?e:""+e).replace(n6,`
`).replace(i6,"")}function Yp(e,t,r){if(t=c_(t),c_(e)!==t&&r)throw Error(ze(425))}function am(){}var y0=null,v0=null;function w0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var b0=typeof setTimeout=="function"?setTimeout:void 0,s6=typeof clearTimeout=="function"?clearTimeout:void 0,d_=typeof Promise=="function"?Promise:void 0,a6=typeof queueMicrotask=="function"?queueMicrotask:typeof d_<"u"?function(e){return d_.resolve(null).then(e).catch(o6)}:b0;function o6(e){setTimeout(function(){throw e})}function by(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),wf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);wf(t)}function lo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function f_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ic=Math.random().toString(36).slice(2),Ps="__reactFiber$"+Ic,Sf="__reactProps$"+Ic,xa="__reactContainer$"+Ic,x0="__reactEvents$"+Ic,l6="__reactListeners$"+Ic,u6="__reactHandles$"+Ic;function nl(e){var t=e[Ps];if(t)return t;for(var r=e.parentNode;r;){if(t=r[xa]||r[Ps]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=f_(e);e!==null;){if(r=e[Ps])return r;e=f_(e)}return t}e=r,r=e.parentNode}return null}function ip(e){return e=e[Ps]||e[xa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Su(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ze(33))}function cg(e){return e[Sf]||null}var _0=[],Cu=-1;function To(e){return{current:e}}function _r(e){0>Cu||(e.current=_0[Cu],_0[Cu]=null,Cu--)}function wr(e,t){Cu++,_0[Cu]=e.current,e.current=t}var yo={},kn=To(yo),Qn=To(!1),xl=yo;function cc(e,t){var r=e.type.contextTypes;if(!r)return yo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Zn(e){return e=e.childContextTypes,e!=null}function om(){_r(Qn),_r(kn)}function p_(e,t,r){if(kn.current!==yo)throw Error(ze(168));wr(kn,t),wr(Qn,r)}function G3(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ze(108,HU(e)||"Unknown",i));return Ar({},r,n)}function lm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yo,xl=kn.current,wr(kn,e),wr(Qn,Qn.current),!0}function h_(e,t,r){var n=e.stateNode;if(!n)throw Error(ze(169));r?(e=G3(e,t,xl),n.__reactInternalMemoizedMergedChildContext=e,_r(Qn),_r(kn),wr(kn,e)):_r(Qn),wr(Qn,r)}var ca=null,dg=!1,xy=!1;function Q3(e){ca===null?ca=[e]:ca.push(e)}function c6(e){dg=!0,Q3(e)}function Io(){if(!xy&&ca!==null){xy=!0;var e=0,t=pr;try{var r=ca;for(pr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ca=null,dg=!1}catch(i){throw ca!==null&&(ca=ca.slice(e+1)),b3(sb,Io),i}finally{pr=t,xy=!1}}return null}var ku=[],Eu=0,um=null,cm=0,Ei=[],Ti=0,_l=null,ga=1,ya="";function Yo(e,t){ku[Eu++]=cm,ku[Eu++]=um,um=e,cm=t}function Z3(e,t,r){Ei[Ti++]=ga,Ei[Ti++]=ya,Ei[Ti++]=_l,_l=e;var n=ga;e=ya;var i=32-ls(n)-1;n&=~(1<<i),r+=1;var s=32-ls(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ga=1<<32-ls(t)+i|r<<i|n,ya=s+e}else ga=1<<s|r<<i|n,ya=e}function hb(e){e.return!==null&&(Yo(e,1),Z3(e,1,0))}function mb(e){for(;e===um;)um=ku[--Eu],ku[Eu]=null,cm=ku[--Eu],ku[Eu]=null;for(;e===_l;)_l=Ei[--Ti],Ei[Ti]=null,ya=Ei[--Ti],Ei[Ti]=null,ga=Ei[--Ti],Ei[Ti]=null}var fi=null,di=null,Cr=!1,rs=null;function Y3(e,t){var r=Ni(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function m_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,fi=e,di=lo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,fi=e,di=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_l!==null?{id:ga,overflow:ya}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ni(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,fi=e,di=null,!0):!1;default:return!1}}function $0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function S0(e){if(Cr){var t=di;if(t){var r=t;if(!m_(e,t)){if($0(e))throw Error(ze(418));t=lo(r.nextSibling);var n=fi;t&&m_(e,t)?Y3(n,r):(e.flags=e.flags&-4097|2,Cr=!1,fi=e)}}else{if($0(e))throw Error(ze(418));e.flags=e.flags&-4097|2,Cr=!1,fi=e}}}function g_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;fi=e}function Xp(e){if(e!==fi)return!1;if(!Cr)return g_(e),Cr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!w0(e.type,e.memoizedProps)),t&&(t=di)){if($0(e))throw X3(),Error(ze(418));for(;t;)Y3(e,t),t=lo(t.nextSibling)}if(g_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ze(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){di=lo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}di=null}}else di=fi?lo(e.stateNode.nextSibling):null;return!0}function X3(){for(var e=di;e;)e=lo(e.nextSibling)}function dc(){di=fi=null,Cr=!1}function gb(e){rs===null?rs=[e]:rs.push(e)}var d6=Ea.ReactCurrentBatchConfig;function hd(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ze(309));var n=r.stateNode}if(!n)throw Error(ze(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(ze(284));if(!r._owner)throw Error(ze(290,e))}return e}function Jp(e,t){throw e=Object.prototype.toString.call(t),Error(ze(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function y_(e){var t=e._init;return t(e._payload)}function J3(e){function t(b,g){if(e){var S=b.deletions;S===null?(b.deletions=[g],b.flags|=16):S.push(g)}}function r(b,g){if(!e)return null;for(;g!==null;)t(b,g),g=g.sibling;return null}function n(b,g){for(b=new Map;g!==null;)g.key!==null?b.set(g.key,g):b.set(g.index,g),g=g.sibling;return b}function i(b,g){return b=po(b,g),b.index=0,b.sibling=null,b}function s(b,g,S){return b.index=S,e?(S=b.alternate,S!==null?(S=S.index,S<g?(b.flags|=2,g):S):(b.flags|=2,g)):(b.flags|=1048576,g)}function a(b){return e&&b.alternate===null&&(b.flags|=2),b}function o(b,g,S,E){return g===null||g.tag!==6?(g=Ty(S,b.mode,E),g.return=b,g):(g=i(g,S),g.return=b,g)}function l(b,g,S,E){var A=S.type;return A===bu?c(b,g,S.props.children,E,S.key):g!==null&&(g.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Va&&y_(A)===g.type)?(E=i(g,S.props),E.ref=hd(b,g,S),E.return=b,E):(E=Lh(S.type,S.key,S.props,null,b.mode,E),E.ref=hd(b,g,S),E.return=b,E)}function u(b,g,S,E){return g===null||g.tag!==4||g.stateNode.containerInfo!==S.containerInfo||g.stateNode.implementation!==S.implementation?(g=Iy(S,b.mode,E),g.return=b,g):(g=i(g,S.children||[]),g.return=b,g)}function c(b,g,S,E,A){return g===null||g.tag!==7?(g=yl(S,b.mode,E,A),g.return=b,g):(g=i(g,S),g.return=b,g)}function f(b,g,S){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Ty(""+g,b.mode,S),g.return=b,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Up:return S=Lh(g.type,g.key,g.props,null,b.mode,S),S.ref=hd(b,null,g),S.return=b,S;case wu:return g=Iy(g,b.mode,S),g.return=b,g;case Va:var E=g._init;return f(b,E(g._payload),S)}if(Rd(g)||ud(g))return g=yl(g,b.mode,S,null),g.return=b,g;Jp(b,g)}return null}function p(b,g,S,E){var A=g!==null?g.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return A!==null?null:o(b,g,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Up:return S.key===A?l(b,g,S,E):null;case wu:return S.key===A?u(b,g,S,E):null;case Va:return A=S._init,p(b,g,A(S._payload),E)}if(Rd(S)||ud(S))return A!==null?null:c(b,g,S,E,null);Jp(b,S)}return null}function w(b,g,S,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return b=b.get(S)||null,o(g,b,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Up:return b=b.get(E.key===null?S:E.key)||null,l(g,b,E,A);case wu:return b=b.get(E.key===null?S:E.key)||null,u(g,b,E,A);case Va:var M=E._init;return w(b,g,S,M(E._payload),A)}if(Rd(E)||ud(E))return b=b.get(S)||null,c(g,b,E,A,null);Jp(g,E)}return null}function x(b,g,S,E){for(var A=null,M=null,D=g,I=g=0,U=null;D!==null&&I<S.length;I++){D.index>I?(U=D,D=null):U=D.sibling;var Z=p(b,D,S[I],E);if(Z===null){D===null&&(D=U);break}e&&D&&Z.alternate===null&&t(b,D),g=s(Z,g,I),M===null?A=Z:M.sibling=Z,M=Z,D=U}if(I===S.length)return r(b,D),Cr&&Yo(b,I),A;if(D===null){for(;I<S.length;I++)D=f(b,S[I],E),D!==null&&(g=s(D,g,I),M===null?A=D:M.sibling=D,M=D);return Cr&&Yo(b,I),A}for(D=n(b,D);I<S.length;I++)U=w(D,b,I,S[I],E),U!==null&&(e&&U.alternate!==null&&D.delete(U.key===null?I:U.key),g=s(U,g,I),M===null?A=U:M.sibling=U,M=U);return e&&D.forEach(function(ue){return t(b,ue)}),Cr&&Yo(b,I),A}function v(b,g,S,E){var A=ud(S);if(typeof A!="function")throw Error(ze(150));if(S=A.call(S),S==null)throw Error(ze(151));for(var M=A=null,D=g,I=g=0,U=null,Z=S.next();D!==null&&!Z.done;I++,Z=S.next()){D.index>I?(U=D,D=null):U=D.sibling;var ue=p(b,D,Z.value,E);if(ue===null){D===null&&(D=U);break}e&&D&&ue.alternate===null&&t(b,D),g=s(ue,g,I),M===null?A=ue:M.sibling=ue,M=ue,D=U}if(Z.done)return r(b,D),Cr&&Yo(b,I),A;if(D===null){for(;!Z.done;I++,Z=S.next())Z=f(b,Z.value,E),Z!==null&&(g=s(Z,g,I),M===null?A=Z:M.sibling=Z,M=Z);return Cr&&Yo(b,I),A}for(D=n(b,D);!Z.done;I++,Z=S.next())Z=w(D,b,I,Z.value,E),Z!==null&&(e&&Z.alternate!==null&&D.delete(Z.key===null?I:Z.key),g=s(Z,g,I),M===null?A=Z:M.sibling=Z,M=Z);return e&&D.forEach(function(X){return t(b,X)}),Cr&&Yo(b,I),A}function C(b,g,S,E){if(typeof S=="object"&&S!==null&&S.type===bu&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Up:e:{for(var A=S.key,M=g;M!==null;){if(M.key===A){if(A=S.type,A===bu){if(M.tag===7){r(b,M.sibling),g=i(M,S.props.children),g.return=b,b=g;break e}}else if(M.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Va&&y_(A)===M.type){r(b,M.sibling),g=i(M,S.props),g.ref=hd(b,M,S),g.return=b,b=g;break e}r(b,M);break}else t(b,M);M=M.sibling}S.type===bu?(g=yl(S.props.children,b.mode,E,S.key),g.return=b,b=g):(E=Lh(S.type,S.key,S.props,null,b.mode,E),E.ref=hd(b,g,S),E.return=b,b=E)}return a(b);case wu:e:{for(M=S.key;g!==null;){if(g.key===M)if(g.tag===4&&g.stateNode.containerInfo===S.containerInfo&&g.stateNode.implementation===S.implementation){r(b,g.sibling),g=i(g,S.children||[]),g.return=b,b=g;break e}else{r(b,g);break}else t(b,g);g=g.sibling}g=Iy(S,b.mode,E),g.return=b,b=g}return a(b);case Va:return M=S._init,C(b,g,M(S._payload),E)}if(Rd(S))return x(b,g,S,E);if(ud(S))return v(b,g,S,E);Jp(b,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,g!==null&&g.tag===6?(r(b,g.sibling),g=i(g,S),g.return=b,b=g):(r(b,g),g=Ty(S,b.mode,E),g.return=b,b=g),a(b)):r(b,g)}return C}var fc=J3(!0),eP=J3(!1),dm=To(null),fm=null,Tu=null,yb=null;function vb(){yb=Tu=fm=null}function wb(e){var t=dm.current;_r(dm),e._currentValue=t}function C0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Lu(e,t){fm=e,yb=Tu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gn=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(yb!==e)if(e={context:e,memoizedValue:t,next:null},Tu===null){if(fm===null)throw Error(ze(308));Tu=e,fm.dependencies={lanes:0,firstContext:e}}else Tu=Tu.next=e;return t}var il=null;function bb(e){il===null?il=[e]:il.push(e)}function tP(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,bb(t)):(r.next=i.next,i.next=r),t.interleaved=r,_a(e,n)}function _a(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var qa=!1;function xb(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function va(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function uo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Xt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,_a(e,r)}return i=n.interleaved,i===null?(t.next=t,bb(n)):(t.next=i.next,i.next=t),n.interleaved=t,_a(e,r)}function Oh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ab(e,r)}}function v_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function pm(e,t,r,n){var i=e.updateQueue;qa=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,c=u=l=null,o=s;do{var p=o.lane,w=o.eventTime;if((n&p)===p){c!==null&&(c=c.next={eventTime:w,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,v=o;switch(p=t,w=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){f=x.call(w,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,p=typeof x=="function"?x.call(w,f,p):x,p==null)break e;f=Ar({},f,p);break e;case 2:qa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else w={eventTime:w,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=w,l=f):c=c.next=w,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Sl|=a,e.lanes=a,e.memoizedState=f}}function w_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ze(191,i));i.call(n)}}}var sp={},Ms=To(sp),Cf=To(sp),kf=To(sp);function sl(e){if(e===sp)throw Error(ze(174));return e}function _b(e,t){switch(wr(kf,t),wr(Cf,e),wr(Ms,sp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:s0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=s0(t,e)}_r(Ms),wr(Ms,t)}function pc(){_r(Ms),_r(Cf),_r(kf)}function nP(e){sl(kf.current);var t=sl(Ms.current),r=s0(t,e.type);t!==r&&(wr(Cf,e),wr(Ms,r))}function $b(e){Cf.current===e&&(_r(Ms),_r(Cf))}var Nr=To(0);function hm(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _y=[];function Sb(){for(var e=0;e<_y.length;e++)_y[e]._workInProgressVersionPrimary=null;_y.length=0}var Dh=Ea.ReactCurrentDispatcher,$y=Ea.ReactCurrentBatchConfig,$l=0,Pr=null,Zr=null,on=null,mm=!1,tf=!1,Ef=0,f6=0;function xn(){throw Error(ze(321))}function Cb(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!fs(e[r],t[r]))return!1;return!0}function kb(e,t,r,n,i,s){if($l=s,Pr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Dh.current=e===null||e.memoizedState===null?g6:y6,e=r(n,i),tf){s=0;do{if(tf=!1,Ef=0,25<=s)throw Error(ze(301));s+=1,on=Zr=null,t.updateQueue=null,Dh.current=v6,e=r(n,i)}while(tf)}if(Dh.current=gm,t=Zr!==null&&Zr.next!==null,$l=0,on=Zr=Pr=null,mm=!1,t)throw Error(ze(300));return e}function Eb(){var e=Ef!==0;return Ef=0,e}function ks(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?Pr.memoizedState=on=e:on=on.next=e,on}function Ri(){if(Zr===null){var e=Pr.alternate;e=e!==null?e.memoizedState:null}else e=Zr.next;var t=on===null?Pr.memoizedState:on.next;if(t!==null)on=t,Zr=e;else{if(e===null)throw Error(ze(310));Zr=e,e={memoizedState:Zr.memoizedState,baseState:Zr.baseState,baseQueue:Zr.baseQueue,queue:Zr.queue,next:null},on===null?Pr.memoizedState=on=e:on=on.next=e}return on}function Tf(e,t){return typeof t=="function"?t(e):t}function Sy(e){var t=Ri(),r=t.queue;if(r===null)throw Error(ze(311));r.lastRenderedReducer=e;var n=Zr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if(($l&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,Pr.lanes|=c,Sl|=c}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,fs(n,t.memoizedState)||(Gn=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Pr.lanes|=s,Sl|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Cy(e){var t=Ri(),r=t.queue;if(r===null)throw Error(ze(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);fs(s,t.memoizedState)||(Gn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function iP(){}function sP(e,t){var r=Pr,n=Ri(),i=t(),s=!fs(n.memoizedState,i);if(s&&(n.memoizedState=i,Gn=!0),n=n.queue,Tb(lP.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||on!==null&&on.memoizedState.tag&1){if(r.flags|=2048,If(9,oP.bind(null,r,n,i,t),void 0,null),ln===null)throw Error(ze(349));$l&30||aP(r,t,i)}return i}function aP(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Pr.updateQueue,t===null?(t={lastEffect:null,stores:null},Pr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function oP(e,t,r,n){t.value=r,t.getSnapshot=n,uP(t)&&cP(e)}function lP(e,t,r){return r(function(){uP(t)&&cP(e)})}function uP(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!fs(e,r)}catch{return!0}}function cP(e){var t=_a(e,1);t!==null&&us(t,e,1,-1)}function b_(e){var t=ks();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tf,lastRenderedState:e},t.queue=e,e=e.dispatch=m6.bind(null,Pr,e),[t.memoizedState,e]}function If(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Pr.updateQueue,t===null?(t={lastEffect:null,stores:null},Pr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function dP(){return Ri().memoizedState}function jh(e,t,r,n){var i=ks();Pr.flags|=e,i.memoizedState=If(1|t,r,void 0,n===void 0?null:n)}function fg(e,t,r,n){var i=Ri();n=n===void 0?null:n;var s=void 0;if(Zr!==null){var a=Zr.memoizedState;if(s=a.destroy,n!==null&&Cb(n,a.deps)){i.memoizedState=If(t,r,s,n);return}}Pr.flags|=e,i.memoizedState=If(1|t,r,s,n)}function x_(e,t){return jh(8390656,8,e,t)}function Tb(e,t){return fg(2048,8,e,t)}function fP(e,t){return fg(4,2,e,t)}function pP(e,t){return fg(4,4,e,t)}function hP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mP(e,t,r){return r=r!=null?r.concat([e]):null,fg(4,4,hP.bind(null,t,e),r)}function Ib(){}function gP(e,t){var r=Ri();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Cb(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function yP(e,t){var r=Ri();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Cb(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function vP(e,t,r){return $l&21?(fs(r,t)||(r=$3(),Pr.lanes|=r,Sl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gn=!0),e.memoizedState=r)}function p6(e,t){var r=pr;pr=r!==0&&4>r?r:4,e(!0);var n=$y.transition;$y.transition={};try{e(!1),t()}finally{pr=r,$y.transition=n}}function wP(){return Ri().memoizedState}function h6(e,t,r){var n=fo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},bP(e))xP(t,r);else if(r=tP(e,t,r,n),r!==null){var i=Mn();us(r,e,n,i),_P(r,t,n)}}function m6(e,t,r){var n=fo(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(bP(e))xP(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,fs(o,a)){var l=t.interleaved;l===null?(i.next=i,bb(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=tP(e,t,i,n),r!==null&&(i=Mn(),us(r,e,n,i),_P(r,t,n))}}function bP(e){var t=e.alternate;return e===Pr||t!==null&&t===Pr}function xP(e,t){tf=mm=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _P(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ab(e,r)}}var gm={readContext:Ai,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useInsertionEffect:xn,useLayoutEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useMutableSource:xn,useSyncExternalStore:xn,useId:xn,unstable_isNewReconciler:!1},g6={readContext:Ai,useCallback:function(e,t){return ks().memoizedState=[e,t===void 0?null:t],e},useContext:Ai,useEffect:x_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,jh(4194308,4,hP.bind(null,t,e),r)},useLayoutEffect:function(e,t){return jh(4194308,4,e,t)},useInsertionEffect:function(e,t){return jh(4,2,e,t)},useMemo:function(e,t){var r=ks();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ks();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=h6.bind(null,Pr,e),[n.memoizedState,e]},useRef:function(e){var t=ks();return e={current:e},t.memoizedState=e},useState:b_,useDebugValue:Ib,useDeferredValue:function(e){return ks().memoizedState=e},useTransition:function(){var e=b_(!1),t=e[0];return e=p6.bind(null,e[1]),ks().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Pr,i=ks();if(Cr){if(r===void 0)throw Error(ze(407));r=r()}else{if(r=t(),ln===null)throw Error(ze(349));$l&30||aP(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,x_(lP.bind(null,n,s,e),[e]),n.flags|=2048,If(9,oP.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ks(),t=ln.identifierPrefix;if(Cr){var r=ya,n=ga;r=(n&~(1<<32-ls(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ef++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=f6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},y6={readContext:Ai,useCallback:gP,useContext:Ai,useEffect:Tb,useImperativeHandle:mP,useInsertionEffect:fP,useLayoutEffect:pP,useMemo:yP,useReducer:Sy,useRef:dP,useState:function(){return Sy(Tf)},useDebugValue:Ib,useDeferredValue:function(e){var t=Ri();return vP(t,Zr.memoizedState,e)},useTransition:function(){var e=Sy(Tf)[0],t=Ri().memoizedState;return[e,t]},useMutableSource:iP,useSyncExternalStore:sP,useId:wP,unstable_isNewReconciler:!1},v6={readContext:Ai,useCallback:gP,useContext:Ai,useEffect:Tb,useImperativeHandle:mP,useInsertionEffect:fP,useLayoutEffect:pP,useMemo:yP,useReducer:Cy,useRef:dP,useState:function(){return Cy(Tf)},useDebugValue:Ib,useDeferredValue:function(e){var t=Ri();return Zr===null?t.memoizedState=e:vP(t,Zr.memoizedState,e)},useTransition:function(){var e=Cy(Tf)[0],t=Ri().memoizedState;return[e,t]},useMutableSource:iP,useSyncExternalStore:sP,useId:wP,unstable_isNewReconciler:!1};function Ji(e,t){if(e&&e.defaultProps){t=Ar({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function k0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ar({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var pg={isMounted:function(e){return(e=e._reactInternals)?zl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Mn(),i=fo(e),s=va(n,i);s.payload=t,r!=null&&(s.callback=r),t=uo(e,s,i),t!==null&&(us(t,e,i,n),Oh(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Mn(),i=fo(e),s=va(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=uo(e,s,i),t!==null&&(us(t,e,i,n),Oh(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Mn(),n=fo(e),i=va(r,n);i.tag=2,t!=null&&(i.callback=t),t=uo(e,i,n),t!==null&&(us(t,e,n,r),Oh(t,e,n))}};function __(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!xf(r,n)||!xf(i,s):!0}function $P(e,t,r){var n=!1,i=yo,s=t.contextType;return typeof s=="object"&&s!==null?s=Ai(s):(i=Zn(t)?xl:kn.current,n=t.contextTypes,s=(n=n!=null)?cc(e,i):yo),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pg,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function $_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&pg.enqueueReplaceState(t,t.state,null)}function E0(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},xb(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Ai(s):(s=Zn(t)?xl:kn.current,i.context=cc(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(k0(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&pg.enqueueReplaceState(i,i.state,null),pm(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function hc(e,t){try{var r="",n=t;do r+=KU(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function ky(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function T0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var w6=typeof WeakMap=="function"?WeakMap:Map;function SP(e,t,r){r=va(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){vm||(vm=!0,z0=n),T0(e,t)},r}function CP(e,t,r){r=va(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){T0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){T0(e,t),typeof n!="function"&&(co===null?co=new Set([this]):co.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function S_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new w6;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=R6.bind(null,e,t,r),t.then(e,e))}function C_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function k_(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=va(-1,1),t.tag=2,uo(r,t,1))),r.lanes|=1),e)}var b6=Ea.ReactCurrentOwner,Gn=!1;function Dn(e,t,r,n){t.child=e===null?eP(t,null,r,n):fc(t,e.child,r,n)}function E_(e,t,r,n,i){r=r.render;var s=t.ref;return Lu(t,i),n=kb(e,t,r,n,s,i),r=Eb(),e!==null&&!Gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$a(e,t,i)):(Cr&&r&&hb(t),t.flags|=1,Dn(e,t,n,i),t.child)}function T_(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Mb(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,kP(e,t,s,n,i)):(e=Lh(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:xf,r(a,n)&&e.ref===t.ref)return $a(e,t,i)}return t.flags|=1,e=po(s,n),e.ref=t.ref,e.return=t,t.child=e}function kP(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(xf(s,n)&&e.ref===t.ref)if(Gn=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Gn=!0);else return t.lanes=e.lanes,$a(e,t,i)}return I0(e,t,r,n,i)}function EP(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wr(Nu,ai),ai|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wr(Nu,ai),ai|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,wr(Nu,ai),ai|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,wr(Nu,ai),ai|=n;return Dn(e,t,i,r),t.child}function TP(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function I0(e,t,r,n,i){var s=Zn(r)?xl:kn.current;return s=cc(t,s),Lu(t,i),r=kb(e,t,r,n,s,i),n=Eb(),e!==null&&!Gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$a(e,t,i)):(Cr&&n&&hb(t),t.flags|=1,Dn(e,t,r,i),t.child)}function I_(e,t,r,n,i){if(Zn(r)){var s=!0;lm(t)}else s=!1;if(Lu(t,i),t.stateNode===null)Mh(e,t),$P(t,r,n),E0(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ai(u):(u=Zn(r)?xl:kn.current,u=cc(t,u));var c=r.getDerivedStateFromProps,f=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&$_(t,a,n,u),qa=!1;var p=t.memoizedState;a.state=p,pm(t,n,a,i),l=t.memoizedState,o!==n||p!==l||Qn.current||qa?(typeof c=="function"&&(k0(t,r,c,n),l=t.memoizedState),(o=qa||__(t,r,o,n,p,l,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,rP(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ji(t.type,o),a.props=u,f=t.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ai(l):(l=Zn(r)?xl:kn.current,l=cc(t,l));var w=r.getDerivedStateFromProps;(c=typeof w=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==l)&&$_(t,a,n,l),qa=!1,p=t.memoizedState,a.state=p,pm(t,n,a,i);var x=t.memoizedState;o!==f||p!==x||Qn.current||qa?(typeof w=="function"&&(k0(t,r,w,n),x=t.memoizedState),(u=qa||__(t,r,u,n,p,x,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),a.props=n,a.state=x,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return N0(e,t,r,n,s,i)}function N0(e,t,r,n,i,s){TP(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&h_(t,r,!1),$a(e,t,s);n=t.stateNode,b6.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=fc(t,e.child,null,s),t.child=fc(t,null,o,s)):Dn(e,t,o,s),t.memoizedState=n.state,i&&h_(t,r,!0),t.child}function IP(e){var t=e.stateNode;t.pendingContext?p_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&p_(e,t.context,!1),_b(e,t.containerInfo)}function N_(e,t,r,n,i){return dc(),gb(i),t.flags|=256,Dn(e,t,r,n),t.child}var P0={dehydrated:null,treeContext:null,retryLane:0};function A0(e){return{baseLanes:e,cachePool:null,transitions:null}}function NP(e,t,r){var n=t.pendingProps,i=Nr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),wr(Nr,i&1),e===null)return S0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=gg(a,n,0,null),e=yl(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=A0(r),t.memoizedState=P0,e):Nb(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return x6(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=po(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=po(o,s):(s=yl(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?A0(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=P0,n}return s=e.child,e=s.sibling,n=po(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Nb(e,t){return t=gg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function eh(e,t,r,n){return n!==null&&gb(n),fc(t,e.child,null,r),e=Nb(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function x6(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=ky(Error(ze(422))),eh(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=gg({mode:"visible",children:n.children},i,0,null),s=yl(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&fc(t,e.child,null,a),t.child.memoizedState=A0(a),t.memoizedState=P0,s);if(!(t.mode&1))return eh(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ze(419)),n=ky(s,n,void 0),eh(e,t,a,n)}if(o=(a&e.childLanes)!==0,Gn||o){if(n=ln,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,_a(e,i),us(n,e,i,-1))}return jb(),n=ky(Error(ze(421))),eh(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=O6.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,di=lo(i.nextSibling),fi=t,Cr=!0,rs=null,e!==null&&(Ei[Ti++]=ga,Ei[Ti++]=ya,Ei[Ti++]=_l,ga=e.id,ya=e.overflow,_l=t),t=Nb(t,n.children),t.flags|=4096,t)}function P_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),C0(e.return,t,r)}function Ey(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function PP(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Dn(e,t,n.children,r),n=Nr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&P_(e,r,t);else if(e.tag===19)P_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(wr(Nr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&hm(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ey(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&hm(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ey(t,!0,r,null,s);break;case"together":Ey(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Mh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $a(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ze(153));if(t.child!==null){for(e=t.child,r=po(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=po(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function _6(e,t,r){switch(t.tag){case 3:IP(t),dc();break;case 5:nP(t);break;case 1:Zn(t.type)&&lm(t);break;case 4:_b(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;wr(dm,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(wr(Nr,Nr.current&1),t.flags|=128,null):r&t.child.childLanes?NP(e,t,r):(wr(Nr,Nr.current&1),e=$a(e,t,r),e!==null?e.sibling:null);wr(Nr,Nr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return PP(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wr(Nr,Nr.current),n)break;return null;case 22:case 23:return t.lanes=0,EP(e,t,r)}return $a(e,t,r)}var AP,R0,RP,OP;AP=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};R0=function(){};RP=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,sl(Ms.current);var s=null;switch(r){case"input":i=t0(e,i),n=t0(e,n),s=[];break;case"select":i=Ar({},i,{value:void 0}),n=Ar({},n,{value:void 0}),s=[];break;case"textarea":i=i0(e,i),n=i0(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=am)}a0(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hf.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&xr("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};OP=function(e,t,r,n){r!==n&&(t.flags|=4)};function md(e,t){if(!Cr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function _n(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $6(e,t,r){var n=t.pendingProps;switch(mb(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(t),null;case 1:return Zn(t.type)&&om(),_n(t),null;case 3:return n=t.stateNode,pc(),_r(Qn),_r(kn),Sb(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Xp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,rs!==null&&(B0(rs),rs=null))),R0(e,t),_n(t),null;case 5:$b(t);var i=sl(kf.current);if(r=t.type,e!==null&&t.stateNode!=null)RP(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ze(166));return _n(t),null}if(e=sl(Ms.current),Xp(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ps]=t,n[Sf]=s,e=(t.mode&1)!==0,r){case"dialog":xr("cancel",n),xr("close",n);break;case"iframe":case"object":case"embed":xr("load",n);break;case"video":case"audio":for(i=0;i<Dd.length;i++)xr(Dd[i],n);break;case"source":xr("error",n);break;case"img":case"image":case"link":xr("error",n),xr("load",n);break;case"details":xr("toggle",n);break;case"input":L1(n,s),xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},xr("invalid",n);break;case"textarea":U1(n,s),xr("invalid",n)}a0(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Yp(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Yp(n.textContent,o,e),i=["children",""+o]):hf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&xr("scroll",n)}switch(r){case"input":Vp(n),B1(n,s,!0);break;case"textarea":Vp(n),V1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=am)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=l3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Ps]=t,e[Sf]=n,AP(e,t,!1,!1),t.stateNode=e;e:{switch(a=o0(r,n),r){case"dialog":xr("cancel",e),xr("close",e),i=n;break;case"iframe":case"object":case"embed":xr("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dd.length;i++)xr(Dd[i],e);i=n;break;case"source":xr("error",e),i=n;break;case"img":case"image":case"link":xr("error",e),xr("load",e),i=n;break;case"details":xr("toggle",e),i=n;break;case"input":L1(e,n),i=t0(e,n),xr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ar({},n,{value:void 0}),xr("invalid",e);break;case"textarea":U1(e,n),i=i0(e,n),xr("invalid",e);break;default:i=n}a0(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?d3(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&u3(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&mf(e,l):typeof l=="number"&&mf(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(hf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&xr("scroll",e):l!=null&&eb(e,s,l,a))}switch(r){case"input":Vp(e),B1(e,n,!1);break;case"textarea":Vp(e),V1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+go(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ju(e,!!n.multiple,s,!1):n.defaultValue!=null&&ju(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=am)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _n(t),null;case 6:if(e&&t.stateNode!=null)OP(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ze(166));if(r=sl(kf.current),sl(Ms.current),Xp(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ps]=t,(s=n.nodeValue!==r)&&(e=fi,e!==null))switch(e.tag){case 3:Yp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Yp(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ps]=t,t.stateNode=n}return _n(t),null;case 13:if(_r(Nr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Cr&&di!==null&&t.mode&1&&!(t.flags&128))X3(),dc(),t.flags|=98560,s=!1;else if(s=Xp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ze(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ze(317));s[Ps]=t}else dc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_n(t),s=!1}else rs!==null&&(B0(rs),rs=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Nr.current&1?Xr===0&&(Xr=3):jb())),t.updateQueue!==null&&(t.flags|=4),_n(t),null);case 4:return pc(),R0(e,t),e===null&&_f(t.stateNode.containerInfo),_n(t),null;case 10:return wb(t.type._context),_n(t),null;case 17:return Zn(t.type)&&om(),_n(t),null;case 19:if(_r(Nr),s=t.memoizedState,s===null)return _n(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)md(s,!1);else{if(Xr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=hm(e),a!==null){for(t.flags|=128,md(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return wr(Nr,Nr.current&1|2),t.child}e=e.sibling}s.tail!==null&&Lr()>mc&&(t.flags|=128,n=!0,md(s,!1),t.lanes=4194304)}else{if(!n)if(e=hm(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),md(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Cr)return _n(t),null}else 2*Lr()-s.renderingStartTime>mc&&r!==1073741824&&(t.flags|=128,n=!0,md(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Lr(),t.sibling=null,r=Nr.current,wr(Nr,n?r&1|2:r&1),t):(_n(t),null);case 22:case 23:return Db(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ai&1073741824&&(_n(t),t.subtreeFlags&6&&(t.flags|=8192)):_n(t),null;case 24:return null;case 25:return null}throw Error(ze(156,t.tag))}function S6(e,t){switch(mb(t),t.tag){case 1:return Zn(t.type)&&om(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pc(),_r(Qn),_r(kn),Sb(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $b(t),null;case 13:if(_r(Nr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ze(340));dc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return _r(Nr),null;case 4:return pc(),null;case 10:return wb(t.type._context),null;case 22:case 23:return Db(),null;case 24:return null;default:return null}}var th=!1,Cn=!1,C6=typeof WeakSet=="function"?WeakSet:Set,lt=null;function Iu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Dr(e,t,n)}else r.current=null}function O0(e,t,r){try{r()}catch(n){Dr(e,t,n)}}var A_=!1;function k6(e,t){if(y0=nm,e=F3(),pb(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,c=0,f=e,p=null;t:for(;;){for(var w;f!==r||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(w=f.firstChild)!==null;)p=f,f=w;for(;;){if(f===e)break t;if(p===r&&++u===i&&(o=a),p===s&&++c===n&&(l=a),(w=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=w}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(v0={focusedElem:e,selectionRange:r},nm=!1,lt=t;lt!==null;)if(t=lt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,lt=e;else for(;lt!==null;){t=lt;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,C=x.memoizedState,b=t.stateNode,g=b.getSnapshotBeforeUpdate(t.elementType===t.type?v:Ji(t.type,v),C);b.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var S=t.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ze(163))}}catch(E){Dr(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,lt=e;break}lt=t.return}return x=A_,A_=!1,x}function rf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&O0(t,r,s)}i=i.next}while(i!==n)}}function hg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function D0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function DP(e){var t=e.alternate;t!==null&&(e.alternate=null,DP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ps],delete t[Sf],delete t[x0],delete t[l6],delete t[u6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jP(e){return e.tag===5||e.tag===3||e.tag===4}function R_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function j0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=am));else if(n!==4&&(e=e.child,e!==null))for(j0(e,t,r),e=e.sibling;e!==null;)j0(e,t,r),e=e.sibling}function M0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(M0(e,t,r),e=e.sibling;e!==null;)M0(e,t,r),e=e.sibling}var pn=null,ts=!1;function Da(e,t,r){for(r=r.child;r!==null;)MP(e,t,r),r=r.sibling}function MP(e,t,r){if(js&&typeof js.onCommitFiberUnmount=="function")try{js.onCommitFiberUnmount(ag,r)}catch{}switch(r.tag){case 5:Cn||Iu(r,t);case 6:var n=pn,i=ts;pn=null,Da(e,t,r),pn=n,ts=i,pn!==null&&(ts?(e=pn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):pn.removeChild(r.stateNode));break;case 18:pn!==null&&(ts?(e=pn,r=r.stateNode,e.nodeType===8?by(e.parentNode,r):e.nodeType===1&&by(e,r),wf(e)):by(pn,r.stateNode));break;case 4:n=pn,i=ts,pn=r.stateNode.containerInfo,ts=!0,Da(e,t,r),pn=n,ts=i;break;case 0:case 11:case 14:case 15:if(!Cn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&O0(r,t,a),i=i.next}while(i!==n)}Da(e,t,r);break;case 1:if(!Cn&&(Iu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Dr(r,t,o)}Da(e,t,r);break;case 21:Da(e,t,r);break;case 22:r.mode&1?(Cn=(n=Cn)||r.memoizedState!==null,Da(e,t,r),Cn=n):Da(e,t,r);break;default:Da(e,t,r)}}function O_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new C6),t.forEach(function(n){var i=D6.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ki(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:pn=o.stateNode,ts=!1;break e;case 3:pn=o.stateNode.containerInfo,ts=!0;break e;case 4:pn=o.stateNode.containerInfo,ts=!0;break e}o=o.return}if(pn===null)throw Error(ze(160));MP(s,a,i),pn=null,ts=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Dr(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zP(t,e),t=t.sibling}function zP(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ki(t,e),$s(e),n&4){try{rf(3,e,e.return),hg(3,e)}catch(v){Dr(e,e.return,v)}try{rf(5,e,e.return)}catch(v){Dr(e,e.return,v)}}break;case 1:Ki(t,e),$s(e),n&512&&r!==null&&Iu(r,r.return);break;case 5:if(Ki(t,e),$s(e),n&512&&r!==null&&Iu(r,r.return),e.flags&32){var i=e.stateNode;try{mf(i,"")}catch(v){Dr(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&a3(i,s),o0(o,a);var u=o0(o,s);for(a=0;a<l.length;a+=2){var c=l[a],f=l[a+1];c==="style"?d3(i,f):c==="dangerouslySetInnerHTML"?u3(i,f):c==="children"?mf(i,f):eb(i,c,f,u)}switch(o){case"input":r0(i,s);break;case"textarea":o3(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?ju(i,!!s.multiple,w,!1):p!==!!s.multiple&&(s.defaultValue!=null?ju(i,!!s.multiple,s.defaultValue,!0):ju(i,!!s.multiple,s.multiple?[]:"",!1))}i[Sf]=s}catch(v){Dr(e,e.return,v)}}break;case 6:if(Ki(t,e),$s(e),n&4){if(e.stateNode===null)throw Error(ze(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){Dr(e,e.return,v)}}break;case 3:if(Ki(t,e),$s(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{wf(t.containerInfo)}catch(v){Dr(e,e.return,v)}break;case 4:Ki(t,e),$s(e);break;case 13:Ki(t,e),$s(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Rb=Lr())),n&4&&O_(e);break;case 22:if(c=r!==null&&r.memoizedState!==null,e.mode&1?(Cn=(u=Cn)||c,Ki(t,e),Cn=u):Ki(t,e),$s(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(lt=e,c=e.child;c!==null;){for(f=lt=c;lt!==null;){switch(p=lt,w=p.child,p.tag){case 0:case 11:case 14:case 15:rf(4,p,p.return);break;case 1:Iu(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(v){Dr(n,r,v)}}break;case 5:Iu(p,p.return);break;case 22:if(p.memoizedState!==null){j_(f);continue}}w!==null?(w.return=p,lt=w):j_(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=c3("display",a))}catch(v){Dr(e,e.return,v)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){Dr(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ki(t,e),$s(e),n&4&&O_(e);break;case 21:break;default:Ki(t,e),$s(e)}}function $s(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(jP(r)){var n=r;break e}r=r.return}throw Error(ze(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(mf(i,""),n.flags&=-33);var s=R_(e);M0(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=R_(e);j0(e,o,a);break;default:throw Error(ze(161))}}catch(l){Dr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function E6(e,t,r){lt=e,FP(e)}function FP(e,t,r){for(var n=(e.mode&1)!==0;lt!==null;){var i=lt,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||th;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Cn;o=th;var u=Cn;if(th=a,(Cn=l)&&!u)for(lt=i;lt!==null;)a=lt,l=a.child,a.tag===22&&a.memoizedState!==null?M_(i):l!==null?(l.return=a,lt=l):M_(i);for(;s!==null;)lt=s,FP(s),s=s.sibling;lt=i,th=o,Cn=u}D_(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,lt=s):D_(e)}}function D_(e){for(;lt!==null;){var t=lt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Cn||hg(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Cn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ji(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&w_(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}w_(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&wf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ze(163))}Cn||t.flags&512&&D0(t)}catch(p){Dr(t,t.return,p)}}if(t===e){lt=null;break}if(r=t.sibling,r!==null){r.return=t.return,lt=r;break}lt=t.return}}function j_(e){for(;lt!==null;){var t=lt;if(t===e){lt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,lt=r;break}lt=t.return}}function M_(e){for(;lt!==null;){var t=lt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{hg(4,t)}catch(l){Dr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Dr(t,i,l)}}var s=t.return;try{D0(t)}catch(l){Dr(t,s,l)}break;case 5:var a=t.return;try{D0(t)}catch(l){Dr(t,a,l)}}}catch(l){Dr(t,t.return,l)}if(t===e){lt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,lt=o;break}lt=t.return}}var T6=Math.ceil,ym=Ea.ReactCurrentDispatcher,Pb=Ea.ReactCurrentOwner,Pi=Ea.ReactCurrentBatchConfig,Xt=0,ln=null,qr=null,gn=0,ai=0,Nu=To(0),Xr=0,Nf=null,Sl=0,mg=0,Ab=0,nf=null,Hn=null,Rb=0,mc=1/0,ua=null,vm=!1,z0=null,co=null,rh=!1,io=null,wm=0,sf=0,F0=null,zh=-1,Fh=0;function Mn(){return Xt&6?Lr():zh!==-1?zh:zh=Lr()}function fo(e){return e.mode&1?Xt&2&&gn!==0?gn&-gn:d6.transition!==null?(Fh===0&&(Fh=$3()),Fh):(e=pr,e!==0||(e=window.event,e=e===void 0?16:N3(e.type)),e):1}function us(e,t,r,n){if(50<sf)throw sf=0,F0=null,Error(ze(185));rp(e,r,n),(!(Xt&2)||e!==ln)&&(e===ln&&(!(Xt&2)&&(mg|=r),Xr===4&&Ka(e,gn)),Yn(e,n),r===1&&Xt===0&&!(t.mode&1)&&(mc=Lr()+500,dg&&Io()))}function Yn(e,t){var r=e.callbackNode;dV(e,t);var n=rm(e,e===ln?gn:0);if(n===0)r!==null&&K1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&K1(r),t===1)e.tag===0?c6(z_.bind(null,e)):Q3(z_.bind(null,e)),a6(function(){!(Xt&6)&&Io()}),r=null;else{switch(S3(n)){case 1:r=sb;break;case 4:r=x3;break;case 16:r=tm;break;case 536870912:r=_3;break;default:r=tm}r=HP(r,LP.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function LP(e,t){if(zh=-1,Fh=0,Xt&6)throw Error(ze(327));var r=e.callbackNode;if(Bu()&&e.callbackNode!==r)return null;var n=rm(e,e===ln?gn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=bm(e,n);else{t=n;var i=Xt;Xt|=2;var s=UP();(ln!==e||gn!==t)&&(ua=null,mc=Lr()+500,gl(e,t));do try{P6();break}catch(o){BP(e,o)}while(!0);vb(),ym.current=s,Xt=i,qr!==null?t=0:(ln=null,gn=0,t=Xr)}if(t!==0){if(t===2&&(i=f0(e),i!==0&&(n=i,t=L0(e,i))),t===1)throw r=Nf,gl(e,0),Ka(e,n),Yn(e,Lr()),r;if(t===6)Ka(e,n);else{if(i=e.current.alternate,!(n&30)&&!I6(i)&&(t=bm(e,n),t===2&&(s=f0(e),s!==0&&(n=s,t=L0(e,s))),t===1))throw r=Nf,gl(e,0),Ka(e,n),Yn(e,Lr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ze(345));case 2:Xo(e,Hn,ua);break;case 3:if(Ka(e,n),(n&130023424)===n&&(t=Rb+500-Lr(),10<t)){if(rm(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Mn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=b0(Xo.bind(null,e,Hn,ua),t);break}Xo(e,Hn,ua);break;case 4:if(Ka(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-ls(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Lr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*T6(n/1960))-n,10<n){e.timeoutHandle=b0(Xo.bind(null,e,Hn,ua),n);break}Xo(e,Hn,ua);break;case 5:Xo(e,Hn,ua);break;default:throw Error(ze(329))}}}return Yn(e,Lr()),e.callbackNode===r?LP.bind(null,e):null}function L0(e,t){var r=nf;return e.current.memoizedState.isDehydrated&&(gl(e,t).flags|=256),e=bm(e,t),e!==2&&(t=Hn,Hn=r,t!==null&&B0(t)),e}function B0(e){Hn===null?Hn=e:Hn.push.apply(Hn,e)}function I6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!fs(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ka(e,t){for(t&=~Ab,t&=~mg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ls(t),n=1<<r;e[r]=-1,t&=~n}}function z_(e){if(Xt&6)throw Error(ze(327));Bu();var t=rm(e,0);if(!(t&1))return Yn(e,Lr()),null;var r=bm(e,t);if(e.tag!==0&&r===2){var n=f0(e);n!==0&&(t=n,r=L0(e,n))}if(r===1)throw r=Nf,gl(e,0),Ka(e,t),Yn(e,Lr()),r;if(r===6)throw Error(ze(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xo(e,Hn,ua),Yn(e,Lr()),null}function Ob(e,t){var r=Xt;Xt|=1;try{return e(t)}finally{Xt=r,Xt===0&&(mc=Lr()+500,dg&&Io())}}function Cl(e){io!==null&&io.tag===0&&!(Xt&6)&&Bu();var t=Xt;Xt|=1;var r=Pi.transition,n=pr;try{if(Pi.transition=null,pr=1,e)return e()}finally{pr=n,Pi.transition=r,Xt=t,!(Xt&6)&&Io()}}function Db(){ai=Nu.current,_r(Nu)}function gl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,s6(r)),qr!==null)for(r=qr.return;r!==null;){var n=r;switch(mb(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&om();break;case 3:pc(),_r(Qn),_r(kn),Sb();break;case 5:$b(n);break;case 4:pc();break;case 13:_r(Nr);break;case 19:_r(Nr);break;case 10:wb(n.type._context);break;case 22:case 23:Db()}r=r.return}if(ln=e,qr=e=po(e.current,null),gn=ai=t,Xr=0,Nf=null,Ab=mg=Sl=0,Hn=nf=null,il!==null){for(t=0;t<il.length;t++)if(r=il[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}il=null}return e}function BP(e,t){do{var r=qr;try{if(vb(),Dh.current=gm,mm){for(var n=Pr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}mm=!1}if($l=0,on=Zr=Pr=null,tf=!1,Ef=0,Pb.current=null,r===null||r.return===null){Xr=1,Nf=t,qr=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=gn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var w=C_(a);if(w!==null){w.flags&=-257,k_(w,a,o,s,t),w.mode&1&&S_(s,u,t),t=w,l=u;var x=t.updateQueue;if(x===null){var v=new Set;v.add(l),t.updateQueue=v}else x.add(l);break e}else{if(!(t&1)){S_(s,u,t),jb();break e}l=Error(ze(426))}}else if(Cr&&o.mode&1){var C=C_(a);if(C!==null){!(C.flags&65536)&&(C.flags|=256),k_(C,a,o,s,t),gb(hc(l,o));break e}}s=l=hc(l,o),Xr!==4&&(Xr=2),nf===null?nf=[s]:nf.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=SP(s,l,t);v_(s,b);break e;case 1:o=l;var g=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(co===null||!co.has(S)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=CP(s,o,t);v_(s,E);break e}}s=s.return}while(s!==null)}qP(r)}catch(A){t=A,qr===r&&r!==null&&(qr=r=r.return);continue}break}while(!0)}function UP(){var e=ym.current;return ym.current=gm,e===null?gm:e}function jb(){(Xr===0||Xr===3||Xr===2)&&(Xr=4),ln===null||!(Sl&268435455)&&!(mg&268435455)||Ka(ln,gn)}function bm(e,t){var r=Xt;Xt|=2;var n=UP();(ln!==e||gn!==t)&&(ua=null,gl(e,t));do try{N6();break}catch(i){BP(e,i)}while(!0);if(vb(),Xt=r,ym.current=n,qr!==null)throw Error(ze(261));return ln=null,gn=0,Xr}function N6(){for(;qr!==null;)VP(qr)}function P6(){for(;qr!==null&&!rV();)VP(qr)}function VP(e){var t=KP(e.alternate,e,ai);e.memoizedProps=e.pendingProps,t===null?qP(e):qr=t,Pb.current=null}function qP(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=S6(r,t),r!==null){r.flags&=32767,qr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xr=6,qr=null;return}}else if(r=$6(r,t,ai),r!==null){qr=r;return}if(t=t.sibling,t!==null){qr=t;return}qr=t=e}while(t!==null);Xr===0&&(Xr=5)}function Xo(e,t,r){var n=pr,i=Pi.transition;try{Pi.transition=null,pr=1,A6(e,t,r,n)}finally{Pi.transition=i,pr=n}return null}function A6(e,t,r,n){do Bu();while(io!==null);if(Xt&6)throw Error(ze(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ze(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(fV(e,s),e===ln&&(qr=ln=null,gn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||rh||(rh=!0,HP(tm,function(){return Bu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Pi.transition,Pi.transition=null;var a=pr;pr=1;var o=Xt;Xt|=4,Pb.current=null,k6(e,r),zP(r,e),XV(v0),nm=!!y0,v0=y0=null,e.current=r,E6(r),nV(),Xt=o,pr=a,Pi.transition=s}else e.current=r;if(rh&&(rh=!1,io=e,wm=i),s=e.pendingLanes,s===0&&(co=null),aV(r.stateNode),Yn(e,Lr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(vm)throw vm=!1,e=z0,z0=null,e;return wm&1&&e.tag!==0&&Bu(),s=e.pendingLanes,s&1?e===F0?sf++:(sf=0,F0=e):sf=0,Io(),null}function Bu(){if(io!==null){var e=S3(wm),t=Pi.transition,r=pr;try{if(Pi.transition=null,pr=16>e?16:e,io===null)var n=!1;else{if(e=io,io=null,wm=0,Xt&6)throw Error(ze(331));var i=Xt;for(Xt|=4,lt=e.current;lt!==null;){var s=lt,a=s.child;if(lt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(lt=u;lt!==null;){var c=lt;switch(c.tag){case 0:case 11:case 15:rf(8,c,s)}var f=c.child;if(f!==null)f.return=c,lt=f;else for(;lt!==null;){c=lt;var p=c.sibling,w=c.return;if(DP(c),c===u){lt=null;break}if(p!==null){p.return=w,lt=p;break}lt=w}}}var x=s.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var C=v.sibling;v.sibling=null,v=C}while(v!==null)}}lt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,lt=a;else e:for(;lt!==null;){if(s=lt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:rf(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,lt=b;break e}lt=s.return}}var g=e.current;for(lt=g;lt!==null;){a=lt;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,lt=S;else e:for(a=g;lt!==null;){if(o=lt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:hg(9,o)}}catch(A){Dr(o,o.return,A)}if(o===a){lt=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,lt=E;break e}lt=o.return}}if(Xt=i,Io(),js&&typeof js.onPostCommitFiberRoot=="function")try{js.onPostCommitFiberRoot(ag,e)}catch{}n=!0}return n}finally{pr=r,Pi.transition=t}}return!1}function F_(e,t,r){t=hc(r,t),t=SP(e,t,1),e=uo(e,t,1),t=Mn(),e!==null&&(rp(e,1,t),Yn(e,t))}function Dr(e,t,r){if(e.tag===3)F_(e,e,r);else for(;t!==null;){if(t.tag===3){F_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(co===null||!co.has(n))){e=hc(r,e),e=CP(t,e,1),t=uo(t,e,1),e=Mn(),t!==null&&(rp(t,1,e),Yn(t,e));break}}t=t.return}}function R6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Mn(),e.pingedLanes|=e.suspendedLanes&r,ln===e&&(gn&r)===r&&(Xr===4||Xr===3&&(gn&130023424)===gn&&500>Lr()-Rb?gl(e,0):Ab|=r),Yn(e,t)}function WP(e,t){t===0&&(e.mode&1?(t=Kp,Kp<<=1,!(Kp&130023424)&&(Kp=4194304)):t=1);var r=Mn();e=_a(e,t),e!==null&&(rp(e,t,r),Yn(e,r))}function O6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),WP(e,r)}function D6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ze(314))}n!==null&&n.delete(t),WP(e,r)}var KP;KP=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qn.current)Gn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Gn=!1,_6(e,t,r);Gn=!!(e.flags&131072)}else Gn=!1,Cr&&t.flags&1048576&&Z3(t,cm,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Mh(e,t),e=t.pendingProps;var i=cc(t,kn.current);Lu(t,r),i=kb(null,t,n,e,i,r);var s=Eb();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zn(n)?(s=!0,lm(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,xb(t),i.updater=pg,t.stateNode=i,i._reactInternals=t,E0(t,n,e,r),t=N0(null,t,n,!0,s,r)):(t.tag=0,Cr&&s&&hb(t),Dn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Mh(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=M6(n),e=Ji(n,e),i){case 0:t=I0(null,t,n,e,r);break e;case 1:t=I_(null,t,n,e,r);break e;case 11:t=E_(null,t,n,e,r);break e;case 14:t=T_(null,t,n,Ji(n.type,e),r);break e}throw Error(ze(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ji(n,i),I0(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ji(n,i),I_(e,t,n,i,r);case 3:e:{if(IP(t),e===null)throw Error(ze(387));n=t.pendingProps,s=t.memoizedState,i=s.element,rP(e,t),pm(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=hc(Error(ze(423)),t),t=N_(e,t,n,r,i);break e}else if(n!==i){i=hc(Error(ze(424)),t),t=N_(e,t,n,r,i);break e}else for(di=lo(t.stateNode.containerInfo.firstChild),fi=t,Cr=!0,rs=null,r=eP(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(dc(),n===i){t=$a(e,t,r);break e}Dn(e,t,n,r)}t=t.child}return t;case 5:return nP(t),e===null&&S0(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,w0(n,i)?a=null:s!==null&&w0(n,s)&&(t.flags|=32),TP(e,t),Dn(e,t,a,r),t.child;case 6:return e===null&&S0(t),null;case 13:return NP(e,t,r);case 4:return _b(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=fc(t,null,n,r):Dn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ji(n,i),E_(e,t,n,i,r);case 7:return Dn(e,t,t.pendingProps,r),t.child;case 8:return Dn(e,t,t.pendingProps.children,r),t.child;case 12:return Dn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,wr(dm,n._currentValue),n._currentValue=a,s!==null)if(fs(s.value,a)){if(s.children===i.children&&!Qn.current){t=$a(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=va(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),C0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ze(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),C0(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Dn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Lu(t,r),i=Ai(i),n=n(i),t.flags|=1,Dn(e,t,n,r),t.child;case 14:return n=t.type,i=Ji(n,t.pendingProps),i=Ji(n.type,i),T_(e,t,n,i,r);case 15:return kP(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ji(n,i),Mh(e,t),t.tag=1,Zn(n)?(e=!0,lm(t)):e=!1,Lu(t,r),$P(t,n,i),E0(t,n,i,r),N0(null,t,n,!0,e,r);case 19:return PP(e,t,r);case 22:return EP(e,t,r)}throw Error(ze(156,t.tag))};function HP(e,t){return b3(e,t)}function j6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ni(e,t,r,n){return new j6(e,t,r,n)}function Mb(e){return e=e.prototype,!(!e||!e.isReactComponent)}function M6(e){if(typeof e=="function")return Mb(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rb)return 11;if(e===nb)return 14}return 2}function po(e,t){var r=e.alternate;return r===null?(r=Ni(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lh(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Mb(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case bu:return yl(r.children,i,s,t);case tb:a=8,i|=8;break;case Yv:return e=Ni(12,r,t,i|2),e.elementType=Yv,e.lanes=s,e;case Xv:return e=Ni(13,r,t,i),e.elementType=Xv,e.lanes=s,e;case Jv:return e=Ni(19,r,t,i),e.elementType=Jv,e.lanes=s,e;case n3:return gg(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case t3:a=10;break e;case r3:a=9;break e;case rb:a=11;break e;case nb:a=14;break e;case Va:a=16,n=null;break e}throw Error(ze(130,e==null?e:typeof e,""))}return t=Ni(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function yl(e,t,r,n){return e=Ni(7,e,n,t),e.lanes=r,e}function gg(e,t,r,n){return e=Ni(22,e,n,t),e.elementType=n3,e.lanes=r,e.stateNode={isHidden:!1},e}function Ty(e,t,r){return e=Ni(6,e,null,t),e.lanes=r,e}function Iy(e,t,r){return t=Ni(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function z6(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uy(0),this.expirationTimes=uy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uy(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zb(e,t,r,n,i,s,a,o,l){return e=new z6(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ni(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xb(s),e}function F6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function GP(e){if(!e)return yo;e=e._reactInternals;e:{if(zl(e)!==e||e.tag!==1)throw Error(ze(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ze(171))}if(e.tag===1){var r=e.type;if(Zn(r))return G3(e,r,t)}return t}function QP(e,t,r,n,i,s,a,o,l){return e=zb(r,n,!0,e,i,s,a,o,l),e.context=GP(null),r=e.current,n=Mn(),i=fo(r),s=va(n,i),s.callback=t??null,uo(r,s,i),e.current.lanes=i,rp(e,i,n),Yn(e,n),e}function yg(e,t,r,n){var i=t.current,s=Mn(),a=fo(i);return r=GP(r),t.context===null?t.context=r:t.pendingContext=r,t=va(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=uo(i,t,a),e!==null&&(us(e,i,a,s),Oh(e,i,a)),a}function xm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function L_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Fb(e,t){L_(e,t),(e=e.alternate)&&L_(e,t)}function L6(){return null}var ZP=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lb(e){this._internalRoot=e}vg.prototype.render=Lb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ze(409));yg(e,t,null,null)};vg.prototype.unmount=Lb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cl(function(){yg(null,e,null,null)}),t[xa]=null}};function vg(e){this._internalRoot=e}vg.prototype.unstable_scheduleHydration=function(e){if(e){var t=E3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Wa.length&&t!==0&&t<Wa[r].priority;r++);Wa.splice(r,0,e),r===0&&I3(e)}};function Bb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function B_(){}function B6(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=xm(a);s.call(u)}}var a=QP(t,n,e,0,null,!1,!1,"",B_);return e._reactRootContainer=a,e[xa]=a.current,_f(e.nodeType===8?e.parentNode:e),Cl(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=xm(l);o.call(u)}}var l=zb(e,0,!1,null,null,!1,!1,"",B_);return e._reactRootContainer=l,e[xa]=l.current,_f(e.nodeType===8?e.parentNode:e),Cl(function(){yg(t,l,r,n)}),l}function bg(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=xm(a);o.call(l)}}yg(t,a,e,i)}else a=B6(r,t,e,i,n);return xm(a)}C3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Od(t.pendingLanes);r!==0&&(ab(t,r|1),Yn(t,Lr()),!(Xt&6)&&(mc=Lr()+500,Io()))}break;case 13:Cl(function(){var n=_a(e,1);if(n!==null){var i=Mn();us(n,e,1,i)}}),Fb(e,1)}};ob=function(e){if(e.tag===13){var t=_a(e,134217728);if(t!==null){var r=Mn();us(t,e,134217728,r)}Fb(e,134217728)}};k3=function(e){if(e.tag===13){var t=fo(e),r=_a(e,t);if(r!==null){var n=Mn();us(r,e,t,n)}Fb(e,t)}};E3=function(){return pr};T3=function(e,t){var r=pr;try{return pr=e,t()}finally{pr=r}};u0=function(e,t,r){switch(t){case"input":if(r0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=cg(n);if(!i)throw Error(ze(90));s3(n),r0(n,i)}}}break;case"textarea":o3(e,r);break;case"select":t=r.value,t!=null&&ju(e,!!r.multiple,t,!1)}};h3=Ob;m3=Cl;var U6={usingClientEntryPoint:!1,Events:[ip,Su,cg,f3,p3,Ob]},gd={findFiberByHostInstance:nl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},V6={bundleType:gd.bundleType,version:gd.version,rendererPackageName:gd.rendererPackageName,rendererConfig:gd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=v3(e),e===null?null:e.stateNode},findFiberByHostInstance:gd.findFiberByHostInstance||L6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nh.isDisabled&&nh.supportsFiber)try{ag=nh.inject(V6),js=nh}catch{}}yi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U6;yi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bb(t))throw Error(ze(200));return F6(e,t,null,r)};yi.createRoot=function(e,t){if(!Bb(e))throw Error(ze(299));var r=!1,n="",i=ZP;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=zb(e,1,!1,null,null,r,!1,n,i),e[xa]=t.current,_f(e.nodeType===8?e.parentNode:e),new Lb(t)};yi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ze(188)):(e=Object.keys(e).join(","),Error(ze(268,e)));return e=v3(t),e=e===null?null:e.stateNode,e};yi.flushSync=function(e){return Cl(e)};yi.hydrate=function(e,t,r){if(!wg(t))throw Error(ze(200));return bg(null,e,t,!0,r)};yi.hydrateRoot=function(e,t,r){if(!Bb(e))throw Error(ze(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=ZP;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=QP(t,null,e,1,r??null,i,!1,s,a),e[xa]=t.current,_f(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new vg(t)};yi.render=function(e,t,r){if(!wg(t))throw Error(ze(200));return bg(null,e,t,!1,r)};yi.unmountComponentAtNode=function(e){if(!wg(e))throw Error(ze(40));return e._reactRootContainer?(Cl(function(){bg(null,null,e,!1,function(){e._reactRootContainer=null,e[xa]=null})}),!0):!1};yi.unstable_batchedUpdates=Ob;yi.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!wg(r))throw Error(ze(200));if(e==null||e._reactInternals===void 0)throw Error(ze(38));return bg(e,t,r,!1,n)};yi.version="18.3.1-next-f1338f8080-20240426";function YP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YP)}catch(e){console.error(e)}}YP(),YN.exports=yi;var Fl=YN.exports;const q6=Hw(Fl);var XP,U_=Fl;XP=U_.createRoot,U_.hydrateRoot;function W6(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,i,s,a=[],o="",l=e.split("/");for(l[0]||l.shift();i=l.shift();)r=i[0],r==="*"?(a.push(r),o+=i[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=i.indexOf("?",1),s=i.indexOf(".",1),a.push(i.substring(1,~n?n:~s?s:i.length)),o+=~n&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~n?"?":"")+"\\"+i.substring(s))):o+="/"+i;return{keys:a,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}var JP={exports:{}},eA={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gc=P;function K6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var H6=typeof Object.is=="function"?Object.is:K6,G6=gc.useState,Q6=gc.useEffect,Z6=gc.useLayoutEffect,Y6=gc.useDebugValue;function X6(e,t){var r=t(),n=G6({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return Z6(function(){i.value=r,i.getSnapshot=t,Ny(i)&&s({inst:i})},[e,r,t]),Q6(function(){return Ny(i)&&s({inst:i}),e(function(){Ny(i)&&s({inst:i})})},[e]),Y6(r),r}function Ny(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!H6(e,r)}catch{return!0}}function J6(e,t){return t()}var e5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?J6:X6;eA.useSyncExternalStore=gc.useSyncExternalStore!==void 0?gc.useSyncExternalStore:e5;JP.exports=eA;var t5=JP.exports;const r5=QN.useInsertionEffect,n5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",i5=n5?P.useLayoutEffect:P.useEffect,s5=r5||i5,tA=e=>{const t=P.useRef([e,(...r)=>t[0](...r)]).current;return s5(()=>{t[0]=e}),t[1]},a5="popstate",Ub="pushState",Vb="replaceState",o5="hashchange",V_=[a5,Ub,Vb,o5],l5=e=>{for(const t of V_)addEventListener(t,e);return()=>{for(const t of V_)removeEventListener(t,e)}},rA=(e,t)=>t5.useSyncExternalStore(l5,e,t),u5=()=>location.search,c5=({ssrSearch:e=""}={})=>rA(u5,()=>e),q_=()=>location.pathname,d5=({ssrPath:e}={})=>rA(q_,e?()=>e:q_),f5=(e,{replace:t=!1,state:r=null}={})=>history[t?Vb:Ub](r,"",e),p5=(e={})=>[d5(e),f5],W_=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[W_]>"u"){for(const e of[Ub,Vb]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,W_,{value:!0})}const h5=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",nA=(e="")=>e==="/"?"":e,m5=(e,t)=>e[0]==="~"?e.slice(1):nA(t)+e,g5=(e="",t)=>h5(K_(nA(e)),K_(t)),K_=e=>{try{return decodeURI(e)}catch{return e}},iA={hook:p5,searchHook:c5,parser:W6,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},sA=P.createContext(iA),xg=()=>P.useContext(sA),aA={},oA=P.createContext(aA),y5=()=>P.useContext(oA),qb=e=>{const[t,r]=e.hook(e);return[g5(e.base,t),tA((n,i)=>r(m5(n,e.base),i))]},lA=(e,t,r,n)=>{const{pattern:i,keys:s}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",n),a=i.exec(r)||[],[o,...l]=a;return o!==void 0?[!0,(()=>{const u=s!==!1?Object.fromEntries(s.map((f,p)=>[f,l[p]])):a.groups;let c={...l};return u&&Object.assign(c,u),c})(),...n?[o]:[]]:[!1,null]},uA=({children:e,...t})=>{var c,f;const r=xg(),n=t.hook?iA:r;let i=n;const[s,a]=((c=t.ssrPath)==null?void 0:c.split("?"))??[];a&&(t.ssrSearch=a,t.ssrPath=s),t.hrefs=t.hrefs??((f=t.hook)==null?void 0:f.hrefs);let o=P.useRef({}),l=o.current,u=l;for(let p in n){const w=p==="base"?n[p]+(t[p]||""):t[p]||n[p];l===u&&w!==u[p]&&(o.current=u={...u}),u[p]=w,w!==n[p]&&(i=u)}return P.createElement(sA.Provider,{value:i,children:e})},H_=({children:e,component:t},r)=>t?P.createElement(t,{params:r}):typeof e=="function"?e(r):e,v5=e=>{let t=P.useRef(aA),r=t.current;for(const n in e)e[n]!==r[n]&&(r=e);return Object.keys(e).length===0&&(r=e),t.current=r},G_=({path:e,nest:t,match:r,...n})=>{const i=xg(),[s]=qb(i),[a,o,l]=r??lA(i.parser,e,s,t),u=v5({...y5(),...o});if(!a)return null;const c=l?P.createElement(uA,{base:l},H_(n,u)):H_(n,u);return P.createElement(oA.Provider,{value:u,children:c})};P.forwardRef((e,t)=>{const r=xg(),[n,i]=qb(r),{to:s="",href:a=s,onClick:o,asChild:l,children:u,className:c,replace:f,state:p,...w}=e,x=tA(C=>{C.ctrlKey||C.metaKey||C.altKey||C.shiftKey||C.button!==0||(o==null||o(C),C.defaultPrevented||(C.preventDefault(),i(a,e)))}),v=r.hrefs(a[0]==="~"?a.slice(1):r.base+a,r);return l&&P.isValidElement(u)?P.cloneElement(u,{onClick:x,href:v}):P.createElement("a",{...w,onClick:x,href:v,className:c!=null&&c.call?c(n===a):c,children:u,ref:t})});const cA=e=>Array.isArray(e)?e.flatMap(t=>cA(t&&t.type===P.Fragment?t.props.children:t)):[e],w5=({children:e,location:t})=>{const r=xg(),[n]=qb(r);for(const i of cA(e)){let s=0;if(P.isValidElement(i)&&(s=lA(r.parser,i.props.path,t||n,i.props.nest))[0])return P.cloneElement(i,{match:s})}return null};var Nc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},kl=typeof window>"u"||"Deno"in globalThis;function Ci(){}function b5(e,t){return typeof e=="function"?e(t):e}function U0(e){return typeof e=="number"&&e>=0&&e!==1/0}function dA(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Uu(e,t){return typeof e=="function"?e(t):e}function ns(e,t){return typeof e=="function"?e(t):e}function Q_(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:a,stale:o}=e;if(a){if(n){if(t.queryHash!==Wb(a,t.options))return!1}else if(!Pf(t.queryKey,a))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||i&&i!==t.state.fetchStatus||s&&!s(t))}function Z_(e,t){const{exact:r,status:n,predicate:i,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(El(t.options.mutationKey)!==El(s))return!1}else if(!Pf(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function Wb(e,t){return((t==null?void 0:t.queryKeyHashFn)||El)(e)}function El(e){return JSON.stringify(e,(t,r)=>V0(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Pf(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!Pf(e[r],t[r])):!1}function fA(e,t){if(e===t)return e;const r=Y_(e)&&Y_(t);if(r||V0(e)&&V0(t)){const n=r?e:Object.keys(e),i=n.length,s=r?t:Object.keys(t),a=s.length,o=r?[]:{};let l=0;for(let u=0;u<a;u++){const c=r?u:s[u];(!r&&n.includes(c)||r)&&e[c]===void 0&&t[c]===void 0?(o[c]=void 0,l++):(o[c]=fA(e[c],t[c]),o[c]===e[c]&&e[c]!==void 0&&l++)}return i===a&&l===i?e:o}return t}function _m(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Y_(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function V0(e){if(!X_(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!X_(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function X_(e){return Object.prototype.toString.call(e)==="[object Object]"}function x5(e){return new Promise(t=>{setTimeout(t,e)})}function q0(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?fA(e,t):t}function _5(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function $5(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Kb=Symbol();function pA(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Kb?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ul,Ga,Zu,Hk,S5=(Hk=class extends Nc{constructor(){super();yt(this,ul);yt(this,Ga);yt(this,Zu);it(this,Zu,t=>{if(!kl&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){J(this,Ga)||this.setEventListener(J(this,Zu))}onUnsubscribe(){var t;this.hasListeners()||((t=J(this,Ga))==null||t.call(this),it(this,Ga,void 0))}setEventListener(t){var r;it(this,Zu,t),(r=J(this,Ga))==null||r.call(this),it(this,Ga,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){J(this,ul)!==t&&(it(this,ul,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof J(this,ul)=="boolean"?J(this,ul):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ul=new WeakMap,Ga=new WeakMap,Zu=new WeakMap,Hk),Hb=new S5,Yu,Qa,Xu,Gk,C5=(Gk=class extends Nc{constructor(){super();yt(this,Yu,!0);yt(this,Qa);yt(this,Xu);it(this,Xu,t=>{if(!kl&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){J(this,Qa)||this.setEventListener(J(this,Xu))}onUnsubscribe(){var t;this.hasListeners()||((t=J(this,Qa))==null||t.call(this),it(this,Qa,void 0))}setEventListener(t){var r;it(this,Xu,t),(r=J(this,Qa))==null||r.call(this),it(this,Qa,t(this.setOnline.bind(this)))}setOnline(t){J(this,Yu)!==t&&(it(this,Yu,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return J(this,Yu)}},Yu=new WeakMap,Qa=new WeakMap,Xu=new WeakMap,Gk),$m=new C5;function W0(){let e,t;const r=new Promise((i,s)=>{e=i,t=s});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}function k5(e){return Math.min(1e3*2**e,3e4)}function hA(e){return(e??"online")==="online"?$m.isOnline():!0}var mA=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Py(e){return e instanceof mA}function gA(e){let t=!1,r=0,n=!1,i;const s=W0(),a=v=>{var C;n||(p(new mA(v)),(C=e.abort)==null||C.call(e))},o=()=>{t=!0},l=()=>{t=!1},u=()=>Hb.isFocused()&&(e.networkMode==="always"||$m.isOnline())&&e.canRun(),c=()=>hA(e.networkMode)&&e.canRun(),f=v=>{var C;n||(n=!0,(C=e.onSuccess)==null||C.call(e,v),i==null||i(),s.resolve(v))},p=v=>{var C;n||(n=!0,(C=e.onError)==null||C.call(e,v),i==null||i(),s.reject(v))},w=()=>new Promise(v=>{var C;i=b=>{(n||u())&&v(b)},(C=e.onPause)==null||C.call(e)}).then(()=>{var v;i=void 0,n||(v=e.onContinue)==null||v.call(e)}),x=()=>{if(n)return;let v;const C=r===0?e.initialPromise:void 0;try{v=C??e.fn()}catch(b){v=Promise.reject(b)}Promise.resolve(v).then(f).catch(b=>{var M;if(n)return;const g=e.retry??(kl?0:3),S=e.retryDelay??k5,E=typeof S=="function"?S(r,b):S,A=g===!0||typeof g=="number"&&r<g||typeof g=="function"&&g(r,b);if(t||!A){p(b);return}r++,(M=e.onFail)==null||M.call(e,r,b),x5(E).then(()=>u()?void 0:w()).then(()=>{t?p(b):x()})})};return{promise:s,cancel:a,continue:()=>(i==null||i(),s),cancelRetry:o,continueRetry:l,canStart:c,start:()=>(c()?x():w().then(x),s)}}function E5(){let e=[],t=0,r=o=>{o()},n=o=>{o()},i=o=>setTimeout(o,0);const s=o=>{t?e.push(o):i(()=>{r(o)})},a=()=>{const o=e;e=[],o.length&&i(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{i=o}}}var Yr=E5(),cl,Qk,yA=(Qk=class{constructor(){yt(this,cl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),U0(this.gcTime)&&it(this,cl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(kl?1/0:5*60*1e3))}clearGcTimeout(){J(this,cl)&&(clearTimeout(J(this,cl)),it(this,cl,void 0))}},cl=new WeakMap,Qk),Ju,ec,Si,$n,Yf,dl,es,oa,Zk,T5=(Zk=class extends yA{constructor(t){super();yt(this,es);yt(this,Ju);yt(this,ec);yt(this,Si);yt(this,$n);yt(this,Yf);yt(this,dl);it(this,dl,!1),it(this,Yf,t.defaultOptions),this.setOptions(t.options),this.observers=[],it(this,Si,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,it(this,Ju,I5(this.options)),this.state=t.state??J(this,Ju),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=J(this,$n))==null?void 0:t.promise}setOptions(t){this.options={...J(this,Yf),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&J(this,Si).remove(this)}setData(t,r){const n=q0(this.state.data,t,this.options);return Dt(this,es,oa).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Dt(this,es,oa).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=J(this,$n))==null?void 0:n.promise;return(i=J(this,$n))==null||i.cancel(t),r?r.then(Ci).catch(Ci):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(J(this,Ju))}isActive(){return this.observers.some(t=>ns(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Kb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!dA(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=J(this,$n))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=J(this,$n))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),J(this,Si).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(J(this,$n)&&(J(this,dl)?J(this,$n).cancel({revert:!0}):J(this,$n).cancelRetry()),this.scheduleGc()),J(this,Si).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Dt(this,es,oa).call(this,{type:"invalidate"})}fetch(t,r){var l,u,c;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(J(this,$n))return J(this,$n).continueRetry(),J(this,$n).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,i=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(it(this,dl,!0),n.signal)})},s=()=>{const f=pA(this.options,r),p={queryKey:this.queryKey,meta:this.meta};return i(p),it(this,dl,!1),this.options.persister?this.options.persister(f,p,this):f(p)},a={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:s};i(a),(l=this.options.behavior)==null||l.onFetch(a,this),it(this,ec,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=a.fetchOptions)==null?void 0:u.meta))&&Dt(this,es,oa).call(this,{type:"fetch",meta:(c=a.fetchOptions)==null?void 0:c.meta});const o=f=>{var p,w,x,v;Py(f)&&f.silent||Dt(this,es,oa).call(this,{type:"error",error:f}),Py(f)||((w=(p=J(this,Si).config).onError)==null||w.call(p,f,this),(v=(x=J(this,Si).config).onSettled)==null||v.call(x,this.state.data,f,this)),this.scheduleGc()};return it(this,$n,gA({initialPromise:r==null?void 0:r.initialPromise,fn:a.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{var p,w,x,v;if(f===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(C){o(C);return}(w=(p=J(this,Si).config).onSuccess)==null||w.call(p,f,this),(v=(x=J(this,Si).config).onSettled)==null||v.call(x,f,this.state.error,this),this.scheduleGc()},onError:o,onFail:(f,p)=>{Dt(this,es,oa).call(this,{type:"failed",failureCount:f,error:p})},onPause:()=>{Dt(this,es,oa).call(this,{type:"pause"})},onContinue:()=>{Dt(this,es,oa).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),J(this,$n).start()}},Ju=new WeakMap,ec=new WeakMap,Si=new WeakMap,$n=new WeakMap,Yf=new WeakMap,dl=new WeakMap,es=new WeakSet,oa=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...vA(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=t.error;return Py(i)&&i.revert&&J(this,ec)?{...J(this,ec),fetchStatus:"idle"}:{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Yr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),J(this,Si).notify({query:this,type:"updated",action:t})})},Zk);function vA(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hA(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function I5(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Es,Yk,N5=(Yk=class extends Nc{constructor(t={}){super();yt(this,Es);this.config=t,it(this,Es,new Map)}build(t,r,n){const i=r.queryKey,s=r.queryHash??Wb(i,r);let a=this.get(s);return a||(a=new T5({cache:this,queryKey:i,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(a)),a}add(t){J(this,Es).has(t.queryHash)||(J(this,Es).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=J(this,Es).get(t.queryHash);r&&(t.destroy(),r===t&&J(this,Es).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Yr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return J(this,Es).get(t)}getAll(){return[...J(this,Es).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Q_(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>Q_(t,n)):r}notify(t){Yr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Yr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Yr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Es=new WeakMap,Yk),Ts,An,fl,Is,Ba,Xk,P5=(Xk=class extends yA{constructor(t){super();yt(this,Is);yt(this,Ts);yt(this,An);yt(this,fl);this.mutationId=t.mutationId,it(this,An,t.mutationCache),it(this,Ts,[]),this.state=t.state||wA(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){J(this,Ts).includes(t)||(J(this,Ts).push(t),this.clearGcTimeout(),J(this,An).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){it(this,Ts,J(this,Ts).filter(r=>r!==t)),this.scheduleGc(),J(this,An).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){J(this,Ts).length||(this.state.status==="pending"?this.scheduleGc():J(this,An).remove(this))}continue(){var t;return((t=J(this,fl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,s,a,o,l,u,c,f,p,w,x,v,C,b,g,S,E,A,M,D;it(this,fl,gA({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(I,U)=>{Dt(this,Is,Ba).call(this,{type:"failed",failureCount:I,error:U})},onPause:()=>{Dt(this,Is,Ba).call(this,{type:"pause"})},onContinue:()=>{Dt(this,Is,Ba).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>J(this,An).canRun(this)}));const r=this.state.status==="pending",n=!J(this,fl).canStart();try{if(!r){Dt(this,Is,Ba).call(this,{type:"pending",variables:t,isPaused:n}),await((s=(i=J(this,An).config).onMutate)==null?void 0:s.call(i,t,this));const U=await((o=(a=this.options).onMutate)==null?void 0:o.call(a,t));U!==this.state.context&&Dt(this,Is,Ba).call(this,{type:"pending",context:U,variables:t,isPaused:n})}const I=await J(this,fl).start();return await((u=(l=J(this,An).config).onSuccess)==null?void 0:u.call(l,I,t,this.state.context,this)),await((f=(c=this.options).onSuccess)==null?void 0:f.call(c,I,t,this.state.context)),await((w=(p=J(this,An).config).onSettled)==null?void 0:w.call(p,I,null,this.state.variables,this.state.context,this)),await((v=(x=this.options).onSettled)==null?void 0:v.call(x,I,null,t,this.state.context)),Dt(this,Is,Ba).call(this,{type:"success",data:I}),I}catch(I){try{throw await((b=(C=J(this,An).config).onError)==null?void 0:b.call(C,I,t,this.state.context,this)),await((S=(g=this.options).onError)==null?void 0:S.call(g,I,t,this.state.context)),await((A=(E=J(this,An).config).onSettled)==null?void 0:A.call(E,void 0,I,this.state.variables,this.state.context,this)),await((D=(M=this.options).onSettled)==null?void 0:D.call(M,void 0,I,t,this.state.context)),I}finally{Dt(this,Is,Ba).call(this,{type:"error",error:I})}}finally{J(this,An).runNext(this)}}},Ts=new WeakMap,An=new WeakMap,fl=new WeakMap,Is=new WeakSet,Ba=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Yr.batch(()=>{J(this,Ts).forEach(n=>{n.onMutationUpdate(t)}),J(this,An).notify({mutation:this,type:"updated",action:t})})},Xk);function wA(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var si,Xf,Jk,A5=(Jk=class extends Nc{constructor(t={}){super();yt(this,si);yt(this,Xf);this.config=t,it(this,si,new Map),it(this,Xf,Date.now())}build(t,r,n){const i=new P5({mutationCache:this,mutationId:++Lp(this,Xf)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){const r=ih(t),n=J(this,si).get(r)??[];n.push(t),J(this,si).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=ih(t);if(J(this,si).has(r)){const i=(n=J(this,si).get(r))==null?void 0:n.filter(s=>s!==t);i&&(i.length===0?J(this,si).delete(r):J(this,si).set(r,i))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=J(this,si).get(ih(t)))==null?void 0:n.find(i=>i.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=J(this,si).get(ih(t)))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){Yr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...J(this,si).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Z_(r,n))}findAll(t={}){return this.getAll().filter(r=>Z_(t,r))}notify(t){Yr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Yr.batch(()=>Promise.all(t.map(r=>r.continue().catch(Ci))))}},si=new WeakMap,Xf=new WeakMap,Jk);function ih(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function J_(e){return{onFetch:(t,r)=>{var c,f,p,w,x;const n=t.options,i=(p=(f=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,s=((w=t.state.data)==null?void 0:w.pages)||[],a=((x=t.state.data)==null?void 0:x.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let v=!1;const C=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},b=pA(t.options,t.fetchOptions),g=async(S,E,A)=>{if(v)return Promise.reject();if(E==null&&S.pages.length)return Promise.resolve(S);const M={queryKey:t.queryKey,pageParam:E,direction:A?"backward":"forward",meta:t.options.meta};C(M);const D=await b(M),{maxPages:I}=t.options,U=A?$5:_5;return{pages:U(S.pages,D,I),pageParams:U(S.pageParams,E,I)}};if(i&&s.length){const S=i==="backward",E=S?R5:e$,A={pages:s,pageParams:a},M=E(n,A);o=await g(A,M,S)}else{const S=e??s.length;do{const E=l===0?a[0]??n.initialPageParam:e$(n,o);if(l>0&&E==null)break;o=await g(o,E),l++}while(l<S)}return o};t.options.persister?t.fetchFn=()=>{var v,C;return(C=(v=t.options).persister)==null?void 0:C.call(v,u,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function e$(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function R5(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Or,Za,Ya,tc,rc,Xa,nc,ic,eE,O5=(eE=class{constructor(e={}){yt(this,Or);yt(this,Za);yt(this,Ya);yt(this,tc);yt(this,rc);yt(this,Xa);yt(this,nc);yt(this,ic);it(this,Or,e.queryCache||new N5),it(this,Za,e.mutationCache||new A5),it(this,Ya,e.defaultOptions||{}),it(this,tc,new Map),it(this,rc,new Map),it(this,Xa,0)}mount(){Lp(this,Xa)._++,J(this,Xa)===1&&(it(this,nc,Hb.subscribe(async e=>{e&&(await this.resumePausedMutations(),J(this,Or).onFocus())})),it(this,ic,$m.subscribe(async e=>{e&&(await this.resumePausedMutations(),J(this,Or).onOnline())})))}unmount(){var e,t;Lp(this,Xa)._--,J(this,Xa)===0&&((e=J(this,nc))==null||e.call(this),it(this,nc,void 0),(t=J(this,ic))==null||t.call(this),it(this,ic,void 0))}isFetching(e){return J(this,Or).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return J(this,Za).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=J(this,Or).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=J(this,Or).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(Uu(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return J(this,Or).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=J(this,Or).get(n.queryHash),s=i==null?void 0:i.state.data,a=b5(t,s);if(a!==void 0)return J(this,Or).build(this,n).setData(a,{...r,manual:!0})}setQueriesData(e,t,r){return Yr.batch(()=>J(this,Or).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=J(this,Or).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=J(this,Or);Yr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=J(this,Or),n={type:"active",...e};return Yr.batch(()=>(r.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=Yr.batch(()=>J(this,Or).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(Ci).catch(Ci)}invalidateQueries(e={},t={}){return Yr.batch(()=>{if(J(this,Or).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=Yr.batch(()=>J(this,Or).findAll(e).filter(i=>!i.isDisabled()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch(Ci)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(Ci)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=J(this,Or).build(this,t);return r.isStaleByTime(Uu(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ci).catch(Ci)}fetchInfiniteQuery(e){return e.behavior=J_(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ci).catch(Ci)}ensureInfiniteQueryData(e){return e.behavior=J_(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return $m.isOnline()?J(this,Za).resumePausedMutations():Promise.resolve()}getQueryCache(){return J(this,Or)}getMutationCache(){return J(this,Za)}getDefaultOptions(){return J(this,Ya)}setDefaultOptions(e){it(this,Ya,e)}setQueryDefaults(e,t){J(this,tc).set(El(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...J(this,tc).values()];let r={};return t.forEach(n=>{Pf(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){J(this,rc).set(El(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...J(this,rc).values()];let r={};return t.forEach(n=>{Pf(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...J(this,Ya).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Wb(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===Kb&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...J(this,Ya).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){J(this,Or).clear(),J(this,Za).clear()}},Or=new WeakMap,Za=new WeakMap,Ya=new WeakMap,tc=new WeakMap,rc=new WeakMap,Xa=new WeakMap,nc=new WeakMap,ic=new WeakMap,eE),Wn,qt,Jf,Rn,pl,sc,Ja,Ns,ep,ac,oc,hl,ml,eo,lc,ar,jd,K0,H0,G0,Q0,Z0,Y0,X0,bA,tE,D5=(tE=class extends Nc{constructor(t,r){super();yt(this,ar);yt(this,Wn);yt(this,qt);yt(this,Jf);yt(this,Rn);yt(this,pl);yt(this,sc);yt(this,Ja);yt(this,Ns);yt(this,ep);yt(this,ac);yt(this,oc);yt(this,hl);yt(this,ml);yt(this,eo);yt(this,lc,new Set);this.options=r,it(this,Wn,t),it(this,Ns,null),it(this,Ja,W0()),this.options.experimental_prefetchInRender||J(this,Ja).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(J(this,qt).addObserver(this),t$(J(this,qt),this.options)?Dt(this,ar,jd).call(this):this.updateResult(),Dt(this,ar,Q0).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return J0(J(this,qt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return J0(J(this,qt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Dt(this,ar,Z0).call(this),Dt(this,ar,Y0).call(this),J(this,qt).removeObserver(this)}setOptions(t,r){const n=this.options,i=J(this,qt);if(this.options=J(this,Wn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ns(this.options.enabled,J(this,qt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Dt(this,ar,X0).call(this),J(this,qt).setOptions(this.options),n._defaulted&&!_m(this.options,n)&&J(this,Wn).getQueryCache().notify({type:"observerOptionsUpdated",query:J(this,qt),observer:this});const s=this.hasListeners();s&&r$(J(this,qt),i,this.options,n)&&Dt(this,ar,jd).call(this),this.updateResult(r),s&&(J(this,qt)!==i||ns(this.options.enabled,J(this,qt))!==ns(n.enabled,J(this,qt))||Uu(this.options.staleTime,J(this,qt))!==Uu(n.staleTime,J(this,qt)))&&Dt(this,ar,K0).call(this);const a=Dt(this,ar,H0).call(this);s&&(J(this,qt)!==i||ns(this.options.enabled,J(this,qt))!==ns(n.enabled,J(this,qt))||a!==J(this,eo))&&Dt(this,ar,G0).call(this,a)}getOptimisticResult(t){const r=J(this,Wn).getQueryCache().build(J(this,Wn),t),n=this.createResult(r,t);return M5(this,n)&&(it(this,Rn,n),it(this,sc,this.options),it(this,pl,J(this,qt).state)),n}getCurrentResult(){return J(this,Rn)}trackResult(t,r){const n={};return Object.keys(t).forEach(i=>{Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),r==null||r(i),t[i])})}),n}trackProp(t){J(this,lc).add(t)}getCurrentQuery(){return J(this,qt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=J(this,Wn).defaultQueryOptions(t),n=J(this,Wn).getQueryCache().build(J(this,Wn),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Dt(this,ar,jd).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),J(this,Rn)))}createResult(t,r){var I;const n=J(this,qt),i=this.options,s=J(this,Rn),a=J(this,pl),o=J(this,sc),u=t!==n?t.state:J(this,Jf),{state:c}=t;let f={...c},p=!1,w;if(r._optimisticResults){const U=this.hasListeners(),Z=!U&&t$(t,r),ue=U&&r$(t,n,r,i);(Z||ue)&&(f={...f,...vA(c.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:x,errorUpdatedAt:v,status:C}=f;if(r.select&&f.data!==void 0)if(s&&f.data===(a==null?void 0:a.data)&&r.select===J(this,ep))w=J(this,ac);else try{it(this,ep,r.select),w=r.select(f.data),w=q0(s==null?void 0:s.data,w,r),it(this,ac,w),it(this,Ns,null)}catch(U){it(this,Ns,U)}else w=f.data;if(r.placeholderData!==void 0&&w===void 0&&C==="pending"){let U;if(s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData))U=s.data;else if(U=typeof r.placeholderData=="function"?r.placeholderData((I=J(this,oc))==null?void 0:I.state.data,J(this,oc)):r.placeholderData,r.select&&U!==void 0)try{U=r.select(U),it(this,Ns,null)}catch(Z){it(this,Ns,Z)}U!==void 0&&(C="success",w=q0(s==null?void 0:s.data,U,r),p=!0)}J(this,Ns)&&(x=J(this,Ns),w=J(this,ac),v=Date.now(),C="error");const b=f.fetchStatus==="fetching",g=C==="pending",S=C==="error",E=g&&b,A=w!==void 0,D={status:C,fetchStatus:f.fetchStatus,isPending:g,isSuccess:C==="success",isError:S,isInitialLoading:E,isLoading:E,data:w,dataUpdatedAt:f.dataUpdatedAt,error:x,errorUpdatedAt:v,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:b,isRefetching:b&&!g,isLoadingError:S&&!A,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:S&&A,isStale:Gb(t,r),refetch:this.refetch,promise:J(this,Ja)};if(this.options.experimental_prefetchInRender){const U=X=>{D.status==="error"?X.reject(D.error):D.data!==void 0&&X.resolve(D.data)},Z=()=>{const X=it(this,Ja,D.promise=W0());U(X)},ue=J(this,Ja);switch(ue.status){case"pending":t.queryHash===n.queryHash&&U(ue);break;case"fulfilled":(D.status==="error"||D.data!==ue.value)&&Z();break;case"rejected":(D.status!=="error"||D.error!==ue.reason)&&Z();break}}return D}updateResult(t){const r=J(this,Rn),n=this.createResult(J(this,qt),this.options);if(it(this,pl,J(this,qt).state),it(this,sc,this.options),J(this,pl).data!==void 0&&it(this,oc,J(this,qt)),_m(n,r))return;it(this,Rn,n);const i={},s=()=>{if(!r)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!J(this,lc).size)return!0;const l=new Set(o??J(this,lc));return this.options.throwOnError&&l.add("error"),Object.keys(J(this,Rn)).some(u=>{const c=u;return J(this,Rn)[c]!==r[c]&&l.has(c)})};(t==null?void 0:t.listeners)!==!1&&s()&&(i.listeners=!0),Dt(this,ar,bA).call(this,{...i,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Dt(this,ar,Q0).call(this)}},Wn=new WeakMap,qt=new WeakMap,Jf=new WeakMap,Rn=new WeakMap,pl=new WeakMap,sc=new WeakMap,Ja=new WeakMap,Ns=new WeakMap,ep=new WeakMap,ac=new WeakMap,oc=new WeakMap,hl=new WeakMap,ml=new WeakMap,eo=new WeakMap,lc=new WeakMap,ar=new WeakSet,jd=function(t){Dt(this,ar,X0).call(this);let r=J(this,qt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Ci)),r},K0=function(){Dt(this,ar,Z0).call(this);const t=Uu(this.options.staleTime,J(this,qt));if(kl||J(this,Rn).isStale||!U0(t))return;const n=dA(J(this,Rn).dataUpdatedAt,t)+1;it(this,hl,setTimeout(()=>{J(this,Rn).isStale||this.updateResult()},n))},H0=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(J(this,qt)):this.options.refetchInterval)??!1},G0=function(t){Dt(this,ar,Y0).call(this),it(this,eo,t),!(kl||ns(this.options.enabled,J(this,qt))===!1||!U0(J(this,eo))||J(this,eo)===0)&&it(this,ml,setInterval(()=>{(this.options.refetchIntervalInBackground||Hb.isFocused())&&Dt(this,ar,jd).call(this)},J(this,eo)))},Q0=function(){Dt(this,ar,K0).call(this),Dt(this,ar,G0).call(this,Dt(this,ar,H0).call(this))},Z0=function(){J(this,hl)&&(clearTimeout(J(this,hl)),it(this,hl,void 0))},Y0=function(){J(this,ml)&&(clearInterval(J(this,ml)),it(this,ml,void 0))},X0=function(){const t=J(this,Wn).getQueryCache().build(J(this,Wn),this.options);if(t===J(this,qt))return;const r=J(this,qt);it(this,qt,t),it(this,Jf,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},bA=function(t){Yr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(J(this,Rn))}),J(this,Wn).getQueryCache().notify({query:J(this,qt),type:"observerResultsUpdated"})})},tE);function j5(e,t){return ns(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function t$(e,t){return j5(e,t)||e.state.data!==void 0&&J0(e,t,t.refetchOnMount)}function J0(e,t,r){if(ns(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Gb(e,t)}return!1}function r$(e,t,r,n){return(e!==t||ns(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Gb(e,r)}function Gb(e,t){return ns(t.enabled,e)!==!1&&e.isStaleByTime(Uu(t.staleTime,e))}function M5(e,t){return!_m(e.getCurrentResult(),t)}var to,ro,Kn,pa,wa,Bh,ew,rE,z5=(rE=class extends Nc{constructor(r,n){super();yt(this,wa);yt(this,to);yt(this,ro);yt(this,Kn);yt(this,pa);it(this,to,r),this.setOptions(n),this.bindMethods(),Dt(this,wa,Bh).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=J(this,to).defaultMutationOptions(r),_m(this.options,n)||J(this,to).getMutationCache().notify({type:"observerOptionsUpdated",mutation:J(this,Kn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&El(n.mutationKey)!==El(this.options.mutationKey)?this.reset():((i=J(this,Kn))==null?void 0:i.state.status)==="pending"&&J(this,Kn).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=J(this,Kn))==null||r.removeObserver(this)}onMutationUpdate(r){Dt(this,wa,Bh).call(this),Dt(this,wa,ew).call(this,r)}getCurrentResult(){return J(this,ro)}reset(){var r;(r=J(this,Kn))==null||r.removeObserver(this),it(this,Kn,void 0),Dt(this,wa,Bh).call(this),Dt(this,wa,ew).call(this)}mutate(r,n){var i;return it(this,pa,n),(i=J(this,Kn))==null||i.removeObserver(this),it(this,Kn,J(this,to).getMutationCache().build(J(this,to),this.options)),J(this,Kn).addObserver(this),J(this,Kn).execute(r)}},to=new WeakMap,ro=new WeakMap,Kn=new WeakMap,pa=new WeakMap,wa=new WeakSet,Bh=function(){var n;const r=((n=J(this,Kn))==null?void 0:n.state)??wA();it(this,ro,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},ew=function(r){Yr.batch(()=>{var n,i,s,a,o,l,u,c;if(J(this,pa)&&this.hasListeners()){const f=J(this,ro).variables,p=J(this,ro).context;(r==null?void 0:r.type)==="success"?((i=(n=J(this,pa)).onSuccess)==null||i.call(n,r.data,f,p),(a=(s=J(this,pa)).onSettled)==null||a.call(s,r.data,null,f,p)):(r==null?void 0:r.type)==="error"&&((l=(o=J(this,pa)).onError)==null||l.call(o,r.error,f,p),(c=(u=J(this,pa)).onSettled)==null||c.call(u,void 0,r.error,f,p))}this.listeners.forEach(f=>{f(J(this,ro))})})},rE),xA=P.createContext(void 0),_A=e=>{const t=P.useContext(xA);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},F5=({client:e,children:t})=>(P.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),y.jsx(xA.Provider,{value:e,children:t})),$A=P.createContext(!1),L5=()=>P.useContext($A);$A.Provider;function B5(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var U5=P.createContext(B5()),V5=()=>P.useContext(U5);function SA(e,t){return typeof e=="function"?e(...t):!!e}function tw(){}var q5=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},W5=e=>{P.useEffect(()=>{e.clearReset()},[e])},K5=({result:e,errorResetBoundary:t,throwOnError:r,query:n})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&SA(r,[e.error,n]),H5=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},G5=(e,t)=>e.isLoading&&e.isFetching&&!t,Q5=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,n$=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Z5(e,t,r){var c,f,p,w,x;const n=_A(),i=L5(),s=V5(),a=n.defaultQueryOptions(e);(f=(c=n.getDefaultOptions().queries)==null?void 0:c._experimental_beforeQuery)==null||f.call(c,a),a._optimisticResults=i?"isRestoring":"optimistic",H5(a),q5(a,s),W5(s);const o=!n.getQueryCache().get(a.queryHash),[l]=P.useState(()=>new t(n,a)),u=l.getOptimisticResult(a);if(P.useSyncExternalStore(P.useCallback(v=>{const C=i?tw:l.subscribe(Yr.batchCalls(v));return l.updateResult(),C},[l,i]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),P.useEffect(()=>{l.setOptions(a,{listeners:!1})},[a,l]),Q5(a,u))throw n$(a,l,s);if(K5({result:u,errorResetBoundary:s,throwOnError:a.throwOnError,query:n.getQueryCache().get(a.queryHash)}))throw u.error;if((w=(p=n.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||w.call(p,a,u),a.experimental_prefetchInRender&&!kl&&G5(u,i)){const v=o?n$(a,l,s):(x=n.getQueryCache().get(a.queryHash))==null?void 0:x.promise;v==null||v.catch(tw).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?u:l.trackResult(u)}function af(e,t){return Z5(e,D5)}function ha(e,t){const r=_A(),[n]=P.useState(()=>new z5(r,e));P.useEffect(()=>{n.setOptions(e)},[n,e]);const i=P.useSyncExternalStore(P.useCallback(a=>n.subscribe(Yr.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=P.useCallback((a,o)=>{n.mutate(a,o).catch(tw)},[n]);if(i.error&&SA(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}var CA={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(R1,function(){var r=function(d,m){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,k){$.__proto__=k}||function($,k){for(var R in k)Object.prototype.hasOwnProperty.call(k,R)&&($[R]=k[R])})(d,m)},n=function(){return(n=Object.assign||function(d){for(var m,$=1,k=arguments.length;$<k;$++)for(var R in m=arguments[$])Object.prototype.hasOwnProperty.call(m,R)&&(d[R]=m[R]);return d}).apply(this,arguments)};function i(d,m,$){for(var k,R=0,O=m.length;R<O;R++)!k&&R in m||((k=k||Array.prototype.slice.call(m,0,R))[R]=m[R]);return d.concat(k||Array.prototype.slice.call(m))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:R1,a=Object.keys,o=Array.isArray;function l(d,m){return typeof m!="object"||a(m).forEach(function($){d[$]=m[$]}),d}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var u=Object.getPrototypeOf,c={}.hasOwnProperty;function f(d,m){return c.call(d,m)}function p(d,m){typeof m=="function"&&(m=m(u(d))),(typeof Reflect>"u"?a:Reflect.ownKeys)(m).forEach(function($){x(d,$,m[$])})}var w=Object.defineProperty;function x(d,m,$,k){w(d,m,l($&&f($,"get")&&typeof $.get=="function"?{get:$.get,set:$.set,configurable:!0}:{value:$,configurable:!0,writable:!0},k))}function v(d){return{from:function(m){return d.prototype=Object.create(m.prototype),x(d.prototype,"constructor",d),{extend:p.bind(null,d.prototype)}}}}var C=Object.getOwnPropertyDescriptor,b=[].slice;function g(d,m,$){return b.call(d,m,$)}function S(d,m){return m(d)}function E(d){if(!d)throw new Error("Assertion Failed")}function A(d){s.setImmediate?setImmediate(d):setTimeout(d,0)}function M(d,m){if(typeof m=="string"&&f(d,m))return d[m];if(!m)return d;if(typeof m!="string"){for(var $=[],k=0,R=m.length;k<R;++k){var O=M(d,m[k]);$.push(O)}return $}var L=m.indexOf(".");if(L!==-1){var q=d[m.substr(0,L)];return q==null?void 0:M(q,m.substr(L+1))}}function D(d,m,$){if(d&&m!==void 0&&!("isFrozen"in Object&&Object.isFrozen(d)))if(typeof m!="string"&&"length"in m){E(typeof $!="string"&&"length"in $);for(var k=0,R=m.length;k<R;++k)D(d,m[k],$[k])}else{var O,L,q=m.indexOf(".");q!==-1?(O=m.substr(0,q),(L=m.substr(q+1))===""?$===void 0?o(d)&&!isNaN(parseInt(O))?d.splice(O,1):delete d[O]:d[O]=$:D(q=!(q=d[O])||!f(d,O)?d[O]={}:q,L,$)):$===void 0?o(d)&&!isNaN(parseInt(m))?d.splice(m,1):delete d[m]:d[m]=$}}function I(d){var m,$={};for(m in d)f(d,m)&&($[m]=d[m]);return $}var U=[].concat;function Z(d){return U.apply([],d)}var ke="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Z([8,16,32,64].map(function(d){return["Int","Uint","Float"].map(function(m){return m+d+"Array"})}))).filter(function(d){return s[d]}),ue=new Set(ke.map(function(d){return s[d]})),X=null;function ie(d){return X=new WeakMap,d=function m($){if(!$||typeof $!="object")return $;var k=X.get($);if(k)return k;if(o($)){k=[],X.set($,k);for(var R=0,O=$.length;R<O;++R)k.push(m($[R]))}else if(ue.has($.constructor))k=$;else{var L,q=u($);for(L in k=q===Object.prototype?{}:Object.create(q),X.set($,k),$)f($,L)&&(k[L]=m($[L]))}return k}(d),X=null,d}var j={}.toString;function le(d){return j.call(d).slice(8,-1)}var ne=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ce=typeof ne=="symbol"?function(d){var m;return d!=null&&(m=d[ne])&&m.apply(d)}:function(){return null};function W(d,m){return m=d.indexOf(m),0<=m&&d.splice(m,1),0<=m}var F={};function H(d){var m,$,k,R;if(arguments.length===1){if(o(d))return d.slice();if(this===F&&typeof d=="string")return[d];if(R=ce(d)){for($=[];!(k=R.next()).done;)$.push(k.value);return $}if(d==null)return[d];if(typeof(m=d.length)!="number")return[d];for($=new Array(m);m--;)$[m]=d[m];return $}for(m=arguments.length,$=new Array(m);m--;)$[m]=arguments[m];return $}var B=typeof Symbol<"u"?function(d){return d[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ne=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Er=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ne),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function me(d,m){this.name=d,this.message=m}function K(d,m){return d+". Errors: "+Object.keys(m).map(function($){return m[$].toString()}).filter(function($,k,R){return R.indexOf($)===k}).join(`
`)}function Ae(d,m,$,k){this.failures=m,this.failedKeys=k,this.successCount=$,this.message=K(d,m)}function Ze(d,m){this.name="BulkError",this.failures=Object.keys(m).map(function($){return m[$]}),this.failuresByPos=m,this.message=K(d,this.failures)}v(me).from(Error).extend({toString:function(){return this.name+": "+this.message}}),v(Ae).from(me),v(Ze).from(me);var be=Er.reduce(function(d,m){return d[m]=m+"Error",d},{}),ge=me,Te=Er.reduce(function(d,m){var $=m+"Error";function k(R,O){this.name=$,R?typeof R=="string"?(this.message="".concat(R).concat(O?`
 `+O:""),this.inner=O||null):typeof R=="object"&&(this.message="".concat(R.name," ").concat(R.message),this.inner=R):(this.message=ee[m]||$,this.inner=null)}return v(k).from(ge),d[m]=k,d},{});Te.Syntax=SyntaxError,Te.Type=TypeError,Te.Range=RangeError;var Ee=Ne.reduce(function(d,m){return d[m+"Error"]=Te[m],d},{}),We=Er.reduce(function(d,m){return["Syntax","Type","Range"].indexOf(m)===-1&&(d[m+"Error"]=Te[m]),d},{});function Fe(){}function He(d){return d}function Ve(d,m){return d==null||d===He?m:function($){return m(d($))}}function vt(d,m){return function(){d.apply(this,arguments),m.apply(this,arguments)}}function gt(d,m){return d===Fe?m:function(){var $=d.apply(this,arguments);$!==void 0&&(arguments[0]=$);var k=this.onsuccess,R=this.onerror;this.onsuccess=null,this.onerror=null;var O=m.apply(this,arguments);return k&&(this.onsuccess=this.onsuccess?vt(k,this.onsuccess):k),R&&(this.onerror=this.onerror?vt(R,this.onerror):R),O!==void 0?O:$}}function ot(d,m){return d===Fe?m:function(){d.apply(this,arguments);var $=this.onsuccess,k=this.onerror;this.onsuccess=this.onerror=null,m.apply(this,arguments),$&&(this.onsuccess=this.onsuccess?vt($,this.onsuccess):$),k&&(this.onerror=this.onerror?vt(k,this.onerror):k)}}function rr(d,m){return d===Fe?m:function($){var k=d.apply(this,arguments);l($,k);var R=this.onsuccess,O=this.onerror;return this.onsuccess=null,this.onerror=null,$=m.apply(this,arguments),R&&(this.onsuccess=this.onsuccess?vt(R,this.onsuccess):R),O&&(this.onerror=this.onerror?vt(O,this.onerror):O),k===void 0?$===void 0?void 0:$:l(k,$)}}function Zt(d,m){return d===Fe?m:function(){return m.apply(this,arguments)!==!1&&d.apply(this,arguments)}}function cn(d,m){return d===Fe?m:function(){var $=d.apply(this,arguments);if($&&typeof $.then=="function"){for(var k=this,R=arguments.length,O=new Array(R);R--;)O[R]=arguments[R];return $.then(function(){return m.apply(k,O)})}return m.apply(this,arguments)}}We.ModifyError=Ae,We.DexieError=me,We.BulkError=Ze;var Ut=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function G(d){Ut=d}var ve={},_e=100,ke=typeof Promise>"u"?[]:function(){var d=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[d,u(d),d];var m=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[m,u(m),d]}(),Ne=ke[0],Er=ke[1],ke=ke[2],Er=Er&&Er.then,Pe=Ne&&Ne.constructor,De=!!ke,tt=function(d,m){Vr.push([d,m]),wt&&(queueMicrotask(xi),wt=!1)},pt=!0,wt=!0,nr=[],Wt=[],lr=He,ir={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Fe,pgp:!1,env:{},finalize:Fe},Ye=ir,Vr=[],jr=0,tn=[];function Be(d){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var m=this._PSD=Ye;if(typeof d!="function"){if(d!==ve)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&dn(this,this._value))}this._state=null,this._value=null,++m.ref,function $(k,R){try{R(function(O){if(k._state===null){if(O===k)throw new TypeError("A promise cannot be resolved with itself.");var L=k._lib&&vn();O&&typeof O.then=="function"?$(k,function(q,Y){O instanceof Be?O._then(q,Y):O.then(q,Y)}):(k._state=!0,k._value=O,Jn(k)),L&&Yt()}},dn.bind(null,k))}catch(O){dn(k,O)}}(this,d)}var wi={get:function(){var d=Ye,m=jo;function $(k,R){var O=this,L=!d.global&&(d!==Ye||m!==jo),q=L&&!zi(),Y=new Be(function(te,de){Bn(O,new ji(Zs(k,d,L,q),Zs(R,d,L,q),te,de,d))});return this._consoleTask&&(Y._consoleTask=this._consoleTask),Y}return $.prototype=ve,$},set:function(d){x(this,"then",d&&d.prototype===ve?wi:{get:function(){return d},set:wi.set})}};function ji(d,m,$,k,R){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof m=="function"?m:null,this.resolve=$,this.reject=k,this.psd=R}function dn(d,m){var $,k;Wt.push(m),d._state===null&&($=d._lib&&vn(),m=lr(m),d._state=!1,d._value=m,k=d,nr.some(function(R){return R._value===k._value})||nr.push(k),Jn(d),$&&Yt())}function Jn(d){var m=d._listeners;d._listeners=[];for(var $=0,k=m.length;$<k;++$)Bn(d,m[$]);var R=d._PSD;--R.ref||R.finalize(),jr===0&&(++jr,tt(function(){--jr==0&&Hs()},[]))}function Bn(d,m){if(d._state!==null){var $=d._state?m.onFulfilled:m.onRejected;if($===null)return(d._state?m.resolve:m.reject)(d._value);++m.psd.ref,++jr,tt(bi,[$,d,m])}else d._listeners.push(m)}function bi(d,m,$){try{var k,R=m._value;!m._state&&Wt.length&&(Wt=[]),k=Ut&&m._consoleTask?m._consoleTask.run(function(){return d(R)}):d(R),m._state||Wt.indexOf(R)!==-1||function(O){for(var L=nr.length;L;)if(nr[--L]._value===O._value)return nr.splice(L,1)}(m),$.resolve(k)}catch(O){$.reject(O)}finally{--jr==0&&Hs(),--$.psd.ref||$.psd.finalize()}}function xi(){Fi(ir,function(){vn()&&Yt()})}function vn(){var d=pt;return wt=pt=!1,d}function Yt(){var d,m,$;do for(;0<Vr.length;)for(d=Vr,Vr=[],$=d.length,m=0;m<$;++m){var k=d[m];k[0].apply(null,k[1])}while(0<Vr.length);wt=pt=!0}function Hs(){var d=nr;nr=[],d.forEach(function(k){k._PSD.onunhandled.call(null,k._value,k)});for(var m=tn.slice(0),$=m.length;$;)m[--$]()}function Gs(d){return new Be(ve,!1,d)}function ur(d,m){var $=Ye;return function(){var k=vn(),R=Ye;try{return Wr($,!0),d.apply(this,arguments)}catch(O){m&&m(O)}finally{Wr(R,!1),k&&Yt()}}}p(Be.prototype,{then:wi,_then:function(d,m){Bn(this,new ji(null,null,d,m,Ye))},catch:function(d){if(arguments.length===1)return this.then(null,d);var m=d,$=arguments[1];return typeof m=="function"?this.then(null,function(k){return(k instanceof m?$:Gs)(k)}):this.then(null,function(k){return(k&&k.name===m?$:Gs)(k)})},finally:function(d){return this.then(function(m){return Be.resolve(d()).then(function(){return m})},function(m){return Be.resolve(d()).then(function(){return Gs(m)})})},timeout:function(d,m){var $=this;return d<1/0?new Be(function(k,R){var O=setTimeout(function(){return R(new Te.Timeout(m))},d);$.then(k,R).finally(clearTimeout.bind(null,O))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&x(Be.prototype,Symbol.toStringTag,"Dexie.Promise"),ir.env=Ul(),p(Be,{all:function(){var d=H.apply(null,arguments).map(Mo);return new Be(function(m,$){d.length===0&&m([]);var k=d.length;d.forEach(function(R,O){return Be.resolve(R).then(function(L){d[O]=L,--k||m(d)},$)})})},resolve:function(d){return d instanceof Be?d:d&&typeof d.then=="function"?new Be(function(m,$){d.then(m,$)}):new Be(ve,!0,d)},reject:Gs,race:function(){var d=H.apply(null,arguments).map(Mo);return new Be(function(m,$){d.map(function(k){return Be.resolve(k).then(m,$)})})},PSD:{get:function(){return Ye},set:function(d){return Ye=d}},totalEchoes:{get:function(){return jo}},newPSD:Mi,usePSD:Fi,scheduler:{get:function(){return tt},set:function(d){tt=d}},rejectionMapper:{get:function(){return lr},set:function(d){lr=d}},follow:function(d,m){return new Be(function($,k){return Mi(function(R,O){var L=Ye;L.unhandleds=[],L.onunhandled=O,L.finalize=vt(function(){var q,Y=this;q=function(){Y.unhandleds.length===0?R():O(Y.unhandleds[0])},tn.push(function te(){q(),tn.splice(tn.indexOf(te),1)}),++jr,tt(function(){--jr==0&&Hs()},[])},L.finalize),d()},m,$,k)})}}),Pe&&(Pe.allSettled&&x(Be,"allSettled",function(){var d=H.apply(null,arguments).map(Mo);return new Be(function(m){d.length===0&&m([]);var $=d.length,k=new Array($);d.forEach(function(R,O){return Be.resolve(R).then(function(L){return k[O]={status:"fulfilled",value:L}},function(L){return k[O]={status:"rejected",reason:L}}).then(function(){return--$||m(k)})})})}),Pe.any&&typeof AggregateError<"u"&&x(Be,"any",function(){var d=H.apply(null,arguments).map(Mo);return new Be(function(m,$){d.length===0&&$(new AggregateError([]));var k=d.length,R=new Array(k);d.forEach(function(O,L){return Be.resolve(O).then(function(q){return m(q)},function(q){R[L]=q,--k||$(new AggregateError(R))})})})}),Pe.withResolvers&&(Be.withResolvers=Pe.withResolvers));var Mr={awaits:0,echoes:0,id:0},mp=0,Oo=[],Do=0,jo=0,gp=0;function Mi(d,m,$,k){var R=Ye,O=Object.create(R);return O.parent=R,O.ref=0,O.global=!1,O.id=++gp,ir.env,O.env=De?{Promise:Be,PromiseProp:{value:Be,configurable:!0,writable:!0},all:Be.all,race:Be.race,allSettled:Be.allSettled,any:Be.any,resolve:Be.resolve,reject:Be.reject}:{},m&&l(O,m),++R.ref,O.finalize=function(){--this.parent.ref||this.parent.finalize()},k=Fi(O,d,$,k),O.ref===0&&O.finalize(),k}function Qs(){return Mr.id||(Mr.id=++mp),++Mr.awaits,Mr.echoes+=_e,Mr.id}function zi(){return!!Mr.awaits&&(--Mr.awaits==0&&(Mr.id=0),Mr.echoes=Mr.awaits*_e,!0)}function Mo(d){return Mr.echoes&&d&&d.constructor===Pe?(Qs(),d.then(function(m){return zi(),m},function(m){return zi(),$r(m)})):d}function Vg(){var d=Oo[Oo.length-1];Oo.pop(),Wr(d,!1)}function Wr(d,m){var $,k=Ye;(m?!Mr.echoes||Do++&&d===Ye:!Do||--Do&&d===Ye)||queueMicrotask(m?(function(R){++jo,Mr.echoes&&--Mr.echoes!=0||(Mr.echoes=Mr.awaits=Mr.id=0),Oo.push(Ye),Wr(R,!0)}).bind(null,d):Vg),d!==Ye&&(Ye=d,k===ir&&(ir.env=Ul()),De&&($=ir.env.Promise,m=d.env,(k.global||d.global)&&(Object.defineProperty(s,"Promise",m.PromiseProp),$.all=m.all,$.race=m.race,$.resolve=m.resolve,$.reject=m.reject,m.allSettled&&($.allSettled=m.allSettled),m.any&&($.any=m.any))))}function Ul(){var d=s.Promise;return De?{Promise:d,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:d.all,race:d.race,allSettled:d.allSettled,any:d.any,resolve:d.resolve,reject:d.reject}:{}}function Fi(d,m,$,k,R){var O=Ye;try{return Wr(d,!0),m($,k,R)}finally{Wr(O,!1)}}function Zs(d,m,$,k){return typeof d!="function"?d:function(){var R=Ye;$&&Qs(),Wr(m,!0);try{return d.apply(this,arguments)}finally{Wr(R,!1),k&&queueMicrotask(zi)}}}function ei(d){Promise===Pe&&Mr.echoes===0?Do===0?d():enqueueNativeMicroTask(d):setTimeout(d,0)}(""+Er).indexOf("[native code]")===-1&&(Qs=zi=Fe);var $r=Be.reject,Ys="",Li="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zc="String expected.",Un=[],Na="__dbnames",wn="readonly",In="readwrite";function Bi(d,m){return d?m?function(){return d.apply(this,arguments)&&m.apply(this,arguments)}:d:m}var yp={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Vl(d){return typeof d!="string"||/\./.test(d)?function(m){return m}:function(m){return m[d]===void 0&&d in m&&delete(m=ie(m))[d],m}}function vp(){throw Te.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function zt(d,m){try{var $=wp(d),k=wp(m);if($!==k)return $==="Array"?1:k==="Array"?-1:$==="binary"?1:k==="binary"?-1:$==="string"?1:k==="string"?-1:$==="Date"?1:k!=="Date"?NaN:-1;switch($){case"number":case"Date":case"string":return m<d?1:d<m?-1:0;case"binary":return function(R,O){for(var L=R.length,q=O.length,Y=L<q?L:q,te=0;te<Y;++te)if(R[te]!==O[te])return R[te]<O[te]?-1:1;return L===q?0:L<q?-1:1}(bp(d),bp(m));case"Array":return function(R,O){for(var L=R.length,q=O.length,Y=L<q?L:q,te=0;te<Y;++te){var de=zt(R[te],O[te]);if(de!==0)return de}return L===q?0:L<q?-1:1}(d,m)}}catch{}return NaN}function wp(d){var m=typeof d;return m!="object"?m:ArrayBuffer.isView(d)?"binary":(d=le(d),d==="ArrayBuffer"?"binary":d)}function bp(d){return d instanceof Uint8Array?d:ArrayBuffer.isView(d)?new Uint8Array(d.buffer,d.byteOffset,d.byteLength):new Uint8Array(d)}function ti(d,m,$){var k=d.schema.yProps;return k?(m&&0<$.numFailures&&(m=m.filter(function(R,O){return!$.failures[O]})),Promise.all(k.map(function(R){return R=R.updatesTable,m?d.db.table(R).where("k").anyOf(m).delete():d.db.table(R).clear()})).then(function(){return $})):$}var ys=(xp.prototype.execute=function(d){var m=this["@@propmod"];if(m.add!==void 0){var $=m.add;if(o($))return i(i([],o(d)?d:[],!0),$).sort();if(typeof $=="number")return(Number(d)||0)+$;if(typeof $=="bigint")try{return BigInt(d)+$}catch{return BigInt(0)+$}throw new TypeError("Invalid term ".concat($))}if(m.remove!==void 0){var k=m.remove;if(o(k))return o(d)?d.filter(function(R){return!k.includes(R)}).sort():[];if(typeof k=="number")return Number(d)-k;if(typeof k=="bigint")try{return BigInt(d)-k}catch{return BigInt(0)-k}throw new TypeError("Invalid subtrahend ".concat(k))}return $=($=m.replacePrefix)===null||$===void 0?void 0:$[0],$&&typeof d=="string"&&d.startsWith($)?m.replacePrefix[1]+d.substring($.length):d},xp);function xp(d){this["@@propmod"]=d}function Fc(d,m){for(var $=a(m),k=$.length,R=!1,O=0;O<k;++O){var L=$[O],q=m[L],Y=M(d,L);q instanceof ys?(D(d,L,q.execute(Y)),R=!0):Y!==q&&(D(d,L,q),R=!0)}return R}var _p=(hr.prototype._trans=function(d,m,$){var k=this._tx||Ye.trans,R=this.name,O=Ut&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(d==="readonly"?"read":"write"," ").concat(this.name));function L(te,de,Q){if(!Q.schema[R])throw new Te.NotFound("Table "+R+" not part of transaction");return m(Q.idbtrans,Q)}var q=vn();try{var Y=k&&k.db._novip===this.db._novip?k===Ye.trans?k._promise(d,L,$):Mi(function(){return k._promise(d,L,$)},{trans:k,transless:Ye.transless||Ye}):function te(de,Q,he,re){if(de.idbdb&&(de._state.openComplete||Ye.letThrough||de._vip)){var se=de._createTransaction(Q,he,de._dbSchema);try{se.create(),de._state.PR1398_maxLoop=3}catch(ae){return ae.name===be.InvalidState&&de.isOpen()&&0<--de._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),de.close({disableAutoOpen:!1}),de.open().then(function(){return te(de,Q,he,re)})):$r(ae)}return se._promise(Q,function(ae,pe){return Mi(function(){return Ye.trans=se,re(ae,pe,se)})}).then(function(ae){if(Q==="readwrite")try{se.idbtrans.commit()}catch{}return Q==="readonly"?ae:se._completion.then(function(){return ae})})}if(de._state.openComplete)return $r(new Te.DatabaseClosed(de._state.dbOpenError));if(!de._state.isBeingOpened){if(!de._state.autoOpen)return $r(new Te.DatabaseClosed);de.open().catch(Fe)}return de._state.dbReadyPromise.then(function(){return te(de,Q,he,re)})}(this.db,d,[this.name],L);return O&&(Y._consoleTask=O,Y=Y.catch(function(te){return console.trace(te),$r(te)})),Y}finally{q&&Yt()}},hr.prototype.get=function(d,m){var $=this;return d&&d.constructor===Object?this.where(d).first(m):d==null?$r(new Te.Type("Invalid argument to Table.get()")):this._trans("readonly",function(k){return $.core.get({trans:k,key:d}).then(function(R){return $.hook.reading.fire(R)})}).then(m)},hr.prototype.where=function(d){if(typeof d=="string")return new this.db.WhereClause(this,d);if(o(d))return new this.db.WhereClause(this,"[".concat(d.join("+"),"]"));var m=a(d);if(m.length===1)return this.where(m[0]).equals(d[m[0]]);var $=this.schema.indexes.concat(this.schema.primKey).filter(function(q){if(q.compound&&m.every(function(te){return 0<=q.keyPath.indexOf(te)})){for(var Y=0;Y<m.length;++Y)if(m.indexOf(q.keyPath[Y])===-1)return!1;return!0}return!1}).sort(function(q,Y){return q.keyPath.length-Y.keyPath.length})[0];if($&&this.db._maxKey!==Ys){var O=$.keyPath.slice(0,m.length);return this.where(O).equals(O.map(function(Y){return d[Y]}))}!$&&Ut&&console.warn("The query ".concat(JSON.stringify(d)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(m.join("+"),"]"));var k=this.schema.idxByName;function R(q,Y){return zt(q,Y)===0}var L=m.reduce(function(Q,Y){var te=Q[0],de=Q[1],Q=k[Y],he=d[Y];return[te||Q,te||!Q?Bi(de,Q&&Q.multi?function(re){return re=M(re,Y),o(re)&&re.some(function(se){return R(he,se)})}:function(re){return R(he,M(re,Y))}):de]},[null,null]),O=L[0],L=L[1];return O?this.where(O.name).equals(d[O.keyPath]).filter(L):$?this.filter(L):this.where(m).equals("")},hr.prototype.filter=function(d){return this.toCollection().and(d)},hr.prototype.count=function(d){return this.toCollection().count(d)},hr.prototype.offset=function(d){return this.toCollection().offset(d)},hr.prototype.limit=function(d){return this.toCollection().limit(d)},hr.prototype.each=function(d){return this.toCollection().each(d)},hr.prototype.toArray=function(d){return this.toCollection().toArray(d)},hr.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},hr.prototype.orderBy=function(d){return new this.db.Collection(new this.db.WhereClause(this,o(d)?"[".concat(d.join("+"),"]"):d))},hr.prototype.reverse=function(){return this.toCollection().reverse()},hr.prototype.mapToClass=function(d){var m,$=this.db,k=this.name;function R(){return m!==null&&m.apply(this,arguments)||this}(this.schema.mappedClass=d).prototype instanceof vp&&(function(Y,te){if(typeof te!="function"&&te!==null)throw new TypeError("Class extends value "+String(te)+" is not a constructor or null");function de(){this.constructor=Y}r(Y,te),Y.prototype=te===null?Object.create(te):(de.prototype=te.prototype,new de)}(R,m=d),Object.defineProperty(R.prototype,"db",{get:function(){return $},enumerable:!1,configurable:!0}),R.prototype.table=function(){return k},d=R);for(var O=new Set,L=d.prototype;L;L=u(L))Object.getOwnPropertyNames(L).forEach(function(Y){return O.add(Y)});function q(Y){if(!Y)return Y;var te,de=Object.create(d.prototype);for(te in Y)if(!O.has(te))try{de[te]=Y[te]}catch{}return de}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=q,this.hook("reading",q),d},hr.prototype.defineClass=function(){return this.mapToClass(function(d){l(this,d)})},hr.prototype.add=function(d,m){var $=this,k=this.schema.primKey,R=k.auto,O=k.keyPath,L=d;return O&&R&&(L=Vl(O)(d)),this._trans("readwrite",function(q){return $.core.mutate({trans:q,type:"add",keys:m!=null?[m]:null,values:[L]})}).then(function(q){return q.numFailures?Be.reject(q.failures[0]):q.lastResult}).then(function(q){if(O)try{D(d,O,q)}catch{}return q})},hr.prototype.upsert=function(d,m){var $=this,k=this.schema.primKey.keyPath;return this._trans("readwrite",function(R){return $.core.get({trans:R,key:d}).then(function(O){var L=O??{};return Fc(L,m),k&&D(L,k,d),$.core.mutate({trans:R,type:"put",values:[L],keys:[d],upsert:!0,updates:{keys:[d],changeSpecs:[m]}}).then(function(q){return q.numFailures?Be.reject(q.failures[0]):!!O})})})},hr.prototype.update=function(d,m){return typeof d!="object"||o(d)?this.where(":id").equals(d).modify(m):(d=M(d,this.schema.primKey.keyPath),d===void 0?$r(new Te.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(d).modify(m))},hr.prototype.put=function(d,m){var $=this,k=this.schema.primKey,R=k.auto,O=k.keyPath,L=d;return O&&R&&(L=Vl(O)(d)),this._trans("readwrite",function(q){return $.core.mutate({trans:q,type:"put",values:[L],keys:m!=null?[m]:null})}).then(function(q){return q.numFailures?Be.reject(q.failures[0]):q.lastResult}).then(function(q){if(O)try{D(d,O,q)}catch{}return q})},hr.prototype.delete=function(d){var m=this;return this._trans("readwrite",function($){return m.core.mutate({trans:$,type:"delete",keys:[d]}).then(function(k){return ti(m,[d],k)}).then(function(k){return k.numFailures?Be.reject(k.failures[0]):void 0})})},hr.prototype.clear=function(){var d=this;return this._trans("readwrite",function(m){return d.core.mutate({trans:m,type:"deleteRange",range:yp}).then(function($){return ti(d,null,$)})}).then(function(m){return m.numFailures?Be.reject(m.failures[0]):void 0})},hr.prototype.bulkGet=function(d){var m=this;return this._trans("readonly",function($){return m.core.getMany({keys:d,trans:$}).then(function(k){return k.map(function(R){return m.hook.reading.fire(R)})})})},hr.prototype.bulkAdd=function(d,m,$){var k=this,R=Array.isArray(m)?m:void 0,O=($=$||(R?void 0:m))?$.allKeys:void 0;return this._trans("readwrite",function(L){var te=k.schema.primKey,q=te.auto,te=te.keyPath;if(te&&R)throw new Te.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(R&&R.length!==d.length)throw new Te.InvalidArgument("Arguments objects and keys must have the same length");var Y=d.length,te=te&&q?d.map(Vl(te)):d;return k.core.mutate({trans:L,type:"add",keys:R,values:te,wantResults:O}).then(function(se){var Q=se.numFailures,he=se.results,re=se.lastResult,se=se.failures;if(Q===0)return O?he:re;throw new Ze("".concat(k.name,".bulkAdd(): ").concat(Q," of ").concat(Y," operations failed"),se)})})},hr.prototype.bulkPut=function(d,m,$){var k=this,R=Array.isArray(m)?m:void 0,O=($=$||(R?void 0:m))?$.allKeys:void 0;return this._trans("readwrite",function(L){var te=k.schema.primKey,q=te.auto,te=te.keyPath;if(te&&R)throw new Te.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(R&&R.length!==d.length)throw new Te.InvalidArgument("Arguments objects and keys must have the same length");var Y=d.length,te=te&&q?d.map(Vl(te)):d;return k.core.mutate({trans:L,type:"put",keys:R,values:te,wantResults:O}).then(function(se){var Q=se.numFailures,he=se.results,re=se.lastResult,se=se.failures;if(Q===0)return O?he:re;throw new Ze("".concat(k.name,".bulkPut(): ").concat(Q," of ").concat(Y," operations failed"),se)})})},hr.prototype.bulkUpdate=function(d){var m=this,$=this.core,k=d.map(function(L){return L.key}),R=d.map(function(L){return L.changes}),O=[];return this._trans("readwrite",function(L){return $.getMany({trans:L,keys:k,cache:"clone"}).then(function(q){var Y=[],te=[];d.forEach(function(Q,he){var re=Q.key,se=Q.changes,ae=q[he];if(ae){for(var pe=0,ye=Object.keys(se);pe<ye.length;pe++){var we=ye[pe],Se=se[we];if(we===m.schema.primKey.keyPath){if(zt(Se,re)!==0)throw new Te.Constraint("Cannot update primary key in bulkUpdate()")}else D(ae,we,Se)}O.push(he),Y.push(re),te.push(ae)}});var de=Y.length;return $.mutate({trans:L,type:"put",keys:Y,values:te,updates:{keys:k,changeSpecs:R}}).then(function(Q){var he=Q.numFailures,re=Q.failures;if(he===0)return de;for(var se=0,ae=Object.keys(re);se<ae.length;se++){var pe,ye=ae[se],we=O[Number(ye)];we!=null&&(pe=re[ye],delete re[ye],re[we]=pe)}throw new Ze("".concat(m.name,".bulkUpdate(): ").concat(he," of ").concat(de," operations failed"),re)})})})},hr.prototype.bulkDelete=function(d){var m=this,$=d.length;return this._trans("readwrite",function(k){return m.core.mutate({trans:k,type:"delete",keys:d}).then(function(R){return ti(m,d,R)})}).then(function(L){var R=L.numFailures,O=L.lastResult,L=L.failures;if(R===0)return O;throw new Ze("".concat(m.name,".bulkDelete(): ").concat(R," of ").concat($," operations failed"),L)})},hr);function hr(){}function zo(d){function m(L,q){if(q){for(var Y=arguments.length,te=new Array(Y-1);--Y;)te[Y-1]=arguments[Y];return $[L].subscribe.apply(null,te),d}if(typeof L=="string")return $[L]}var $={};m.addEventType=O;for(var k=1,R=arguments.length;k<R;++k)O(arguments[k]);return m;function O(L,q,Y){if(typeof L!="object"){var te;q=q||Zt;var de={subscribers:[],fire:Y=Y||Fe,subscribe:function(Q){de.subscribers.indexOf(Q)===-1&&(de.subscribers.push(Q),de.fire=q(de.fire,Q))},unsubscribe:function(Q){de.subscribers=de.subscribers.filter(function(he){return he!==Q}),de.fire=de.subscribers.reduce(q,Y)}};return $[L]=m[L]=de}a(te=L).forEach(function(Q){var he=te[Q];if(o(he))O(Q,te[Q][0],te[Q][1]);else{if(he!=="asap")throw new Te.InvalidArgument("Invalid event config");var re=O(Q,He,function(){for(var se=arguments.length,ae=new Array(se);se--;)ae[se]=arguments[se];re.subscribers.forEach(function(pe){A(function(){pe.apply(null,ae)})})})}})}}function Fo(d,m){return v(m).from({prototype:d}),m}function Pa(d,m){return!(d.filter||d.algorithm||d.or)&&(m?d.justLimit:!d.replayFilter)}function Lc(d,m){d.filter=Bi(d.filter,m)}function Bc(d,m,$){var k=d.replayFilter;d.replayFilter=k?function(){return Bi(k(),m())}:m,d.justLimit=$&&!k}function ql(d,m){if(d.isPrimKey)return m.primaryKey;var $=m.getIndexByKeyPath(d.index);if(!$)throw new Te.Schema("KeyPath "+d.index+" on object store "+m.name+" is not indexed");return $}function $p(d,m,$){var k=ql(d,m.schema);return m.openCursor({trans:$,values:!d.keysOnly,reverse:d.dir==="prev",unique:!!d.unique,query:{index:k,range:d.range}})}function Xs(d,m,$,k){var R=d.replayFilter?Bi(d.filter,d.replayFilter()):d.filter;if(d.or){var O={},L=function(q,Y,te){var de,Q;R&&!R(Y,te,function(he){return Y.stop(he)},function(he){return Y.fail(he)})||((Q=""+(de=Y.primaryKey))=="[object ArrayBuffer]"&&(Q=""+new Uint8Array(de)),f(O,Q)||(O[Q]=!0,m(q,Y,te)))};return Promise.all([d.or._iterate(L,$),Sp($p(d,k,$),d.algorithm,L,!d.keysOnly&&d.valueMapper)])}return Sp($p(d,k,$),Bi(d.algorithm,R),m,!d.keysOnly&&d.valueMapper)}function Sp(d,m,$,k){var R=ur(k?function(O,L,q){return $(k(O),L,q)}:$);return d.then(function(O){if(O)return O.start(function(){var L=function(){return O.continue()};m&&!m(O,function(q){return L=q},function(q){O.stop(q),L=Fe},function(q){O.fail(q),L=Fe})||R(O.value,O,function(q){return L=q}),L()})})}var Uc=(Ft.prototype._read=function(d,m){var $=this._ctx;return $.error?$.table._trans(null,$r.bind(null,$.error)):$.table._trans("readonly",d).then(m)},Ft.prototype._write=function(d){var m=this._ctx;return m.error?m.table._trans(null,$r.bind(null,m.error)):m.table._trans("readwrite",d,"locked")},Ft.prototype._addAlgorithm=function(d){var m=this._ctx;m.algorithm=Bi(m.algorithm,d)},Ft.prototype._iterate=function(d,m){return Xs(this._ctx,d,m,this._ctx.table.core)},Ft.prototype.clone=function(d){var m=Object.create(this.constructor.prototype),$=Object.create(this._ctx);return d&&l($,d),m._ctx=$,m},Ft.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ft.prototype.each=function(d){var m=this._ctx;return this._read(function($){return Xs(m,d,$,m.table.core)})},Ft.prototype.count=function(d){var m=this;return this._read(function($){var k=m._ctx,R=k.table.core;if(Pa(k,!0))return R.count({trans:$,query:{index:ql(k,R.schema),range:k.range}}).then(function(L){return Math.min(L,k.limit)});var O=0;return Xs(k,function(){return++O,!1},$,R).then(function(){return O})}).then(d)},Ft.prototype.sortBy=function(d,m){var $=d.split(".").reverse(),k=$[0],R=$.length-1;function O(Y,te){return te?O(Y[$[te]],te-1):Y[k]}var L=this._ctx.dir==="next"?1:-1;function q(Y,te){return zt(O(Y,R),O(te,R))*L}return this.toArray(function(Y){return Y.sort(q)}).then(m)},Ft.prototype.toArray=function(d){var m=this;return this._read(function($){var k=m._ctx;if(k.dir==="next"&&Pa(k,!0)&&0<k.limit){var R=k.valueMapper,O=ql(k,k.table.core.schema);return k.table.core.query({trans:$,limit:k.limit,values:!0,query:{index:O,range:k.range}}).then(function(q){return q=q.result,R?q.map(R):q})}var L=[];return Xs(k,function(q){return L.push(q)},$,k.table.core).then(function(){return L})},d)},Ft.prototype.offset=function(d){var m=this._ctx;return d<=0||(m.offset+=d,Pa(m)?Bc(m,function(){var $=d;return function(k,R){return $===0||($===1?--$:R(function(){k.advance($),$=0}),!1)}}):Bc(m,function(){var $=d;return function(){return--$<0}})),this},Ft.prototype.limit=function(d){return this._ctx.limit=Math.min(this._ctx.limit,d),Bc(this._ctx,function(){var m=d;return function($,k,R){return--m<=0&&k(R),0<=m}},!0),this},Ft.prototype.until=function(d,m){return Lc(this._ctx,function($,k,R){return!d($.value)||(k(R),m)}),this},Ft.prototype.first=function(d){return this.limit(1).toArray(function(m){return m[0]}).then(d)},Ft.prototype.last=function(d){return this.reverse().first(d)},Ft.prototype.filter=function(d){var m;return Lc(this._ctx,function($){return d($.value)}),(m=this._ctx).isMatch=Bi(m.isMatch,d),this},Ft.prototype.and=function(d){return this.filter(d)},Ft.prototype.or=function(d){return new this.db.WhereClause(this._ctx.table,d,this)},Ft.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ft.prototype.desc=function(){return this.reverse()},Ft.prototype.eachKey=function(d){var m=this._ctx;return m.keysOnly=!m.isMatch,this.each(function($,k){d(k.key,k)})},Ft.prototype.eachUniqueKey=function(d){return this._ctx.unique="unique",this.eachKey(d)},Ft.prototype.eachPrimaryKey=function(d){var m=this._ctx;return m.keysOnly=!m.isMatch,this.each(function($,k){d(k.primaryKey,k)})},Ft.prototype.keys=function(d){var m=this._ctx;m.keysOnly=!m.isMatch;var $=[];return this.each(function(k,R){$.push(R.key)}).then(function(){return $}).then(d)},Ft.prototype.primaryKeys=function(d){var m=this._ctx;if(m.dir==="next"&&Pa(m,!0)&&0<m.limit)return this._read(function(k){var R=ql(m,m.table.core.schema);return m.table.core.query({trans:k,values:!1,limit:m.limit,query:{index:R,range:m.range}})}).then(function(k){return k.result}).then(d);m.keysOnly=!m.isMatch;var $=[];return this.each(function(k,R){$.push(R.primaryKey)}).then(function(){return $}).then(d)},Ft.prototype.uniqueKeys=function(d){return this._ctx.unique="unique",this.keys(d)},Ft.prototype.firstKey=function(d){return this.limit(1).keys(function(m){return m[0]}).then(d)},Ft.prototype.lastKey=function(d){return this.reverse().firstKey(d)},Ft.prototype.distinct=function(){var d=this._ctx,d=d.index&&d.table.schema.idxByName[d.index];if(!d||!d.multi)return this;var m={};return Lc(this._ctx,function(R){var k=R.primaryKey.toString(),R=f(m,k);return m[k]=!0,!R}),this},Ft.prototype.modify=function(d){var m=this,$=this._ctx;return this._write(function(k){var R=typeof d=="function"?d:function(ae){return Fc(ae,d)},O=$.table.core,te=O.schema.primaryKey,L=te.outbound,q=te.extractKey,Y=200,te=m.db._options.modifyChunkSize;te&&(Y=typeof te=="object"?te[O.name]||te["*"]||200:te);function de(ae,we){var ye=we.failures,we=we.numFailures;he+=ae-we;for(var Se=0,Ie=a(ye);Se<Ie.length;Se++){var Le=Ie[Se];Q.push(ye[Le])}}var Q=[],he=0,re=[],se=d===Cp;return m.clone().primaryKeys().then(function(ae){function pe(we){var Se=Math.min(Y,ae.length-we),Ie=ae.slice(we,we+Se);return(se?Promise.resolve([]):O.getMany({trans:k,keys:Ie,cache:"immutable"})).then(function(Le){var Ge=[],Me=[],Ue=L?[]:null,Qe=se?Ie:[];if(!se)for(var Ke=0;Ke<Se;++Ke){var nt=Le[Ke],Ct={value:ie(nt),primKey:ae[we+Ke]};R.call(Ct,Ct.value,Ct)!==!1&&(Ct.value==null?Qe.push(ae[we+Ke]):L||zt(q(nt),q(Ct.value))===0?(Me.push(Ct.value),L&&Ue.push(ae[we+Ke])):(Qe.push(ae[we+Ke]),Ge.push(Ct.value)))}return Promise.resolve(0<Ge.length&&O.mutate({trans:k,type:"add",values:Ge}).then(function(Tt){for(var Rt in Tt.failures)Qe.splice(parseInt(Rt),1);de(Ge.length,Tt)})).then(function(){return(0<Me.length||ye&&typeof d=="object")&&O.mutate({trans:k,type:"put",keys:Ue,values:Me,criteria:ye,changeSpec:typeof d!="function"&&d,isAdditionalChunk:0<we}).then(function(Tt){return de(Me.length,Tt)})}).then(function(){return(0<Qe.length||ye&&se)&&O.mutate({trans:k,type:"delete",keys:Qe,criteria:ye,isAdditionalChunk:0<we}).then(function(Tt){return ti($.table,Qe,Tt)}).then(function(Tt){return de(Qe.length,Tt)})}).then(function(){return ae.length>we+Se&&pe(we+Y)})})}var ye=Pa($)&&$.limit===1/0&&(typeof d!="function"||se)&&{index:$.index,range:$.range};return pe(0).then(function(){if(0<Q.length)throw new Ae("Error modifying one or more objects",Q,he,re);return ae.length})})})},Ft.prototype.delete=function(){var d=this._ctx,m=d.range;return!Pa(d)||d.table.schema.yProps||!d.isPrimKey&&m.type!==3?this.modify(Cp):this._write(function($){var k=d.table.core.schema.primaryKey,R=m;return d.table.core.count({trans:$,query:{index:k,range:R}}).then(function(O){return d.table.core.mutate({trans:$,type:"deleteRange",range:R}).then(function(Y){var q=Y.failures,Y=Y.numFailures;if(Y)throw new Ae("Could not delete some values",Object.keys(q).map(function(te){return q[te]}),O-Y);return O-Y})})})},Ft);function Ft(){}var Cp=function(d,m){return m.value=null};function Vc(d,m){return d<m?-1:d===m?0:1}function qg(d,m){return m<d?-1:d===m?0:1}function Nn(d,m,$){return d=d instanceof Ui?new d.Collection(d):d,d._ctx.error=new($||TypeError)(m),d}function Aa(d){return new d.Collection(d,function(){return kp("")}).limit(0)}function Wl(d,m,$,k){var R,O,L,q,Y,te,de,Q=$.length;if(!$.every(function(se){return typeof se=="string"}))return Nn(d,zc);function he(se){R=se==="next"?function(pe){return pe.toUpperCase()}:function(pe){return pe.toLowerCase()},O=se==="next"?function(pe){return pe.toLowerCase()}:function(pe){return pe.toUpperCase()},L=se==="next"?Vc:qg;var ae=$.map(function(pe){return{lower:O(pe),upper:R(pe)}}).sort(function(pe,ye){return L(pe.lower,ye.lower)});q=ae.map(function(pe){return pe.upper}),Y=ae.map(function(pe){return pe.lower}),de=(te=se)==="next"?"":k}he("next"),d=new d.Collection(d,function(){return ri(q[0],Y[Q-1]+k)}),d._ondirectionchange=function(se){he(se)};var re=0;return d._addAlgorithm(function(se,ae,pe){var ye=se.key;if(typeof ye!="string")return!1;var we=O(ye);if(m(we,Y,re))return!0;for(var Se=null,Ie=re;Ie<Q;++Ie){var Le=function(Ge,Me,Ue,Qe,Ke,nt){for(var Ct=Math.min(Ge.length,Qe.length),Tt=-1,Rt=0;Rt<Ct;++Rt){var bn=Me[Rt];if(bn!==Qe[Rt])return Ke(Ge[Rt],Ue[Rt])<0?Ge.substr(0,Rt)+Ue[Rt]+Ue.substr(Rt+1):Ke(Ge[Rt],Qe[Rt])<0?Ge.substr(0,Rt)+Qe[Rt]+Ue.substr(Rt+1):0<=Tt?Ge.substr(0,Tt)+Me[Tt]+Ue.substr(Tt+1):null;Ke(Ge[Rt],bn)<0&&(Tt=Rt)}return Ct<Qe.length&&nt==="next"?Ge+Ue.substr(Ge.length):Ct<Ge.length&&nt==="prev"?Ge.substr(0,Ue.length):Tt<0?null:Ge.substr(0,Tt)+Qe[Tt]+Ue.substr(Tt+1)}(ye,we,q[Ie],Y[Ie],L,te);Le===null&&Se===null?re=Ie+1:(Se===null||0<L(Se,Le))&&(Se=Le)}return ae(Se!==null?function(){se.continue(Se+de)}:pe),!1}),d}function ri(d,m,$,k){return{type:2,lower:d,upper:m,lowerOpen:$,upperOpen:k}}function kp(d){return{type:1,lower:d,upper:d}}var Ui=(Object.defineProperty(cr.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),cr.prototype.between=function(d,m,$,k){$=$!==!1,k=k===!0;try{return 0<this._cmp(d,m)||this._cmp(d,m)===0&&($||k)&&(!$||!k)?Aa(this):new this.Collection(this,function(){return ri(d,m,!$,!k)})}catch{return Nn(this,Li)}},cr.prototype.equals=function(d){return d==null?Nn(this,Li):new this.Collection(this,function(){return kp(d)})},cr.prototype.above=function(d){return d==null?Nn(this,Li):new this.Collection(this,function(){return ri(d,void 0,!0)})},cr.prototype.aboveOrEqual=function(d){return d==null?Nn(this,Li):new this.Collection(this,function(){return ri(d,void 0,!1)})},cr.prototype.below=function(d){return d==null?Nn(this,Li):new this.Collection(this,function(){return ri(void 0,d,!1,!0)})},cr.prototype.belowOrEqual=function(d){return d==null?Nn(this,Li):new this.Collection(this,function(){return ri(void 0,d)})},cr.prototype.startsWith=function(d){return typeof d!="string"?Nn(this,zc):this.between(d,d+Ys,!0,!0)},cr.prototype.startsWithIgnoreCase=function(d){return d===""?this.startsWith(d):Wl(this,function(m,$){return m.indexOf($[0])===0},[d],Ys)},cr.prototype.equalsIgnoreCase=function(d){return Wl(this,function(m,$){return m===$[0]},[d],"")},cr.prototype.anyOfIgnoreCase=function(){var d=H.apply(F,arguments);return d.length===0?Aa(this):Wl(this,function(m,$){return $.indexOf(m)!==-1},d,"")},cr.prototype.startsWithAnyOfIgnoreCase=function(){var d=H.apply(F,arguments);return d.length===0?Aa(this):Wl(this,function(m,$){return $.some(function(k){return m.indexOf(k)===0})},d,Ys)},cr.prototype.anyOf=function(){var d=this,m=H.apply(F,arguments),$=this._cmp;try{m.sort($)}catch{return Nn(this,Li)}if(m.length===0)return Aa(this);var k=new this.Collection(this,function(){return ri(m[0],m[m.length-1])});k._ondirectionchange=function(O){$=O==="next"?d._ascending:d._descending,m.sort($)};var R=0;return k._addAlgorithm(function(O,L,q){for(var Y=O.key;0<$(Y,m[R]);)if(++R===m.length)return L(q),!1;return $(Y,m[R])===0||(L(function(){O.continue(m[R])}),!1)}),k},cr.prototype.notEqual=function(d){return this.inAnyRange([[-1/0,d],[d,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},cr.prototype.noneOf=function(){var d=H.apply(F,arguments);if(d.length===0)return new this.Collection(this);try{d.sort(this._ascending)}catch{return Nn(this,Li)}var m=d.reduce(function($,k){return $?$.concat([[$[$.length-1][1],k]]):[[-1/0,k]]},null);return m.push([d[d.length-1],this.db._maxKey]),this.inAnyRange(m,{includeLowers:!1,includeUppers:!1})},cr.prototype.inAnyRange=function(ye,m){var $=this,k=this._cmp,R=this._ascending,O=this._descending,L=this._min,q=this._max;if(ye.length===0)return Aa(this);if(!ye.every(function(we){return we[0]!==void 0&&we[1]!==void 0&&R(we[0],we[1])<=0}))return Nn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Te.InvalidArgument);var Y=!m||m.includeLowers!==!1,te=m&&m.includeUppers===!0,de,Q=R;function he(we,Se){return Q(we[0],Se[0])}try{(de=ye.reduce(function(we,Se){for(var Ie=0,Le=we.length;Ie<Le;++Ie){var Ge=we[Ie];if(k(Se[0],Ge[1])<0&&0<k(Se[1],Ge[0])){Ge[0]=L(Ge[0],Se[0]),Ge[1]=q(Ge[1],Se[1]);break}}return Ie===Le&&we.push(Se),we},[])).sort(he)}catch{return Nn(this,Li)}var re=0,se=te?function(we){return 0<R(we,de[re][1])}:function(we){return 0<=R(we,de[re][1])},ae=Y?function(we){return 0<O(we,de[re][0])}:function(we){return 0<=O(we,de[re][0])},pe=se,ye=new this.Collection(this,function(){return ri(de[0][0],de[de.length-1][1],!Y,!te)});return ye._ondirectionchange=function(we){Q=we==="next"?(pe=se,R):(pe=ae,O),de.sort(he)},ye._addAlgorithm(function(we,Se,Ie){for(var Le,Ge=we.key;pe(Ge);)if(++re===de.length)return Se(Ie),!1;return!se(Le=Ge)&&!ae(Le)||($._cmp(Ge,de[re][1])===0||$._cmp(Ge,de[re][0])===0||Se(function(){Q===R?we.continue(de[re][0]):we.continue(de[re][1])}),!1)}),ye},cr.prototype.startsWithAnyOf=function(){var d=H.apply(F,arguments);return d.every(function(m){return typeof m=="string"})?d.length===0?Aa(this):this.inAnyRange(d.map(function(m){return[m,m+Ys]})):Nn(this,"startsWithAnyOf() only works with strings")},cr);function cr(){}function ni(d){return ur(function(m){return vs(m),d(m.target.error),!1})}function vs(d){d.stopPropagation&&d.stopPropagation(),d.preventDefault&&d.preventDefault()}var Js="storagemutated",Kl="x-storagemutated-1",Vi=zo(null,Js),Wg=(Vn.prototype._lock=function(){return E(!Ye.global),++this._reculock,this._reculock!==1||Ye.global||(Ye.lockOwnerFor=this),this},Vn.prototype._unlock=function(){if(E(!Ye.global),--this._reculock==0)for(Ye.global||(Ye.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var d=this._blockedFuncs.shift();try{Fi(d[1],d[0])}catch{}}return this},Vn.prototype._locked=function(){return this._reculock&&Ye.lockOwnerFor!==this},Vn.prototype.create=function(d){var m=this;if(!this.mode)return this;var $=this.db.idbdb,k=this.db._state.dbOpenError;if(E(!this.idbtrans),!d&&!$)switch(k&&k.name){case"DatabaseClosedError":throw new Te.DatabaseClosed(k);case"MissingAPIError":throw new Te.MissingAPI(k.message,k);default:throw new Te.OpenFailed(k)}if(!this.active)throw new Te.TransactionInactive;return E(this._completion._state===null),(d=this.idbtrans=d||(this.db.core||$).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ur(function(R){vs(R),m._reject(d.error)}),d.onabort=ur(function(R){vs(R),m.active&&m._reject(new Te.Abort(d.error)),m.active=!1,m.on("abort").fire(R)}),d.oncomplete=ur(function(){m.active=!1,m._resolve(),"mutatedParts"in d&&Vi.storagemutated.fire(d.mutatedParts)}),this},Vn.prototype._promise=function(d,m,$){var k=this;if(d==="readwrite"&&this.mode!=="readwrite")return $r(new Te.ReadOnly("Transaction is readonly"));if(!this.active)return $r(new Te.TransactionInactive);if(this._locked())return new Be(function(O,L){k._blockedFuncs.push([function(){k._promise(d,m,$).then(O,L)},Ye])});if($)return Mi(function(){var O=new Be(function(L,q){k._lock();var Y=m(L,q,k);Y&&Y.then&&Y.then(L,q)});return O.finally(function(){return k._unlock()}),O._lib=!0,O});var R=new Be(function(O,L){var q=m(O,L,k);q&&q.then&&q.then(O,L)});return R._lib=!0,R},Vn.prototype._root=function(){return this.parent?this.parent._root():this},Vn.prototype.waitFor=function(d){var m,$=this._root(),k=Be.resolve(d);$._waitingFor?$._waitingFor=$._waitingFor.then(function(){return k}):($._waitingFor=k,$._waitingQueue=[],m=$.idbtrans.objectStore($.storeNames[0]),function O(){for(++$._spinCount;$._waitingQueue.length;)$._waitingQueue.shift()();$._waitingFor&&(m.get(-1/0).onsuccess=O)}());var R=$._waitingFor;return new Be(function(O,L){k.then(function(q){return $._waitingQueue.push(ur(O.bind(null,q)))},function(q){return $._waitingQueue.push(ur(L.bind(null,q)))}).finally(function(){$._waitingFor===R&&($._waitingFor=null)})})},Vn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Te.Abort))},Vn.prototype.table=function(d){var m=this._memoizedTables||(this._memoizedTables={});if(f(m,d))return m[d];var $=this.schema[d];if(!$)throw new Te.NotFound("Table "+d+" not part of transaction");return $=new this.db.Table(d,$,this),$.core=this.db.core.table(d),m[d]=$},Vn);function Vn(){}function qc(d,m,$,k,R,O,L,q){return{name:d,keyPath:m,unique:$,multi:k,auto:R,compound:O,src:($&&!L?"&":"")+(k?"*":"")+(R?"++":"")+Wc(m),type:q}}function Wc(d){return typeof d=="string"?d:d?"["+[].join.call(d,"+")+"]":""}function Kc(d,m,$){return{name:d,primKey:m,indexes:$,mappedClass:null,idxByName:(k=function(R){return[R.name,R]},$.reduce(function(R,O,L){return L=k(O,L),L&&(R[L[0]]=L[1]),R},{}))};var k}var ea=function(d){try{return d.only([[]]),ea=function(){return[[]]},[[]]}catch{return ea=function(){return Ys},Ys}};function Hc(d){return d==null?function(){}:typeof d=="string"?(m=d).split(".").length===1?function($){return $[m]}:function($){return M($,m)}:function($){return M($,d)};var m}function Ep(d){return[].slice.call(d)}var Kg=0;function Lo(d){return d==null?":id":typeof d=="string"?d:"[".concat(d.join("+"),"]")}function Hl(d,m,Y){function k(pe){if(pe.type===3)return null;if(pe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var re=pe.lower,se=pe.upper,ae=pe.lowerOpen,pe=pe.upperOpen;return re===void 0?se===void 0?null:m.upperBound(se,!!pe):se===void 0?m.lowerBound(re,!!ae):m.bound(re,se,!!ae,!!pe)}function R(he){var re,se=he.name;return{name:se,schema:he,mutate:function(ae){var pe=ae.trans,ye=ae.type,we=ae.keys,Se=ae.values,Ie=ae.range;return new Promise(function(Le,Ge){Le=ur(Le);var Me=pe.objectStore(se),Ue=Me.keyPath==null,Qe=ye==="put"||ye==="add";if(!Qe&&ye!=="delete"&&ye!=="deleteRange")throw new Error("Invalid operation type: "+ye);var Ke,nt=(we||Se||{length:1}).length;if(we&&Se&&we.length!==Se.length)throw new Error("Given keys array must have same length as given values array.");if(nt===0)return Le({numFailures:0,failures:{},results:[],lastResult:void 0});function Ct(rn){++bn,vs(rn)}var Tt=[],Rt=[],bn=0;if(ye==="deleteRange"){if(Ie.type===4)return Le({numFailures:bn,failures:Rt,results:[],lastResult:void 0});Ie.type===3?Tt.push(Ke=Me.clear()):Tt.push(Ke=Me.delete(k(Ie)))}else{var Ue=Qe?Ue?[Se,we]:[Se,null]:[we,null],$t=Ue[0],Hr=Ue[1];if(Qe)for(var Gr=0;Gr<nt;++Gr)Tt.push(Ke=Hr&&Hr[Gr]!==void 0?Me[ye]($t[Gr],Hr[Gr]):Me[ye]($t[Gr])),Ke.onerror=Ct;else for(Gr=0;Gr<nt;++Gr)Tt.push(Ke=Me[ye]($t[Gr])),Ke.onerror=Ct}function Wo(rn){rn=rn.target.result,Tt.forEach(function(_s,du){return _s.error!=null&&(Rt[du]=_s.error)}),Le({numFailures:bn,failures:Rt,results:ye==="delete"?we:Tt.map(function(_s){return _s.result}),lastResult:rn})}Ke.onerror=function(rn){Ct(rn),Wo(rn)},Ke.onsuccess=Wo})},getMany:function(ae){var pe=ae.trans,ye=ae.keys;return new Promise(function(we,Se){we=ur(we);for(var Ie,Le=pe.objectStore(se),Ge=ye.length,Me=new Array(Ge),Ue=0,Qe=0,Ke=function(Tt){Tt=Tt.target,Me[Tt._pos]=Tt.result,++Qe===Ue&&we(Me)},nt=ni(Se),Ct=0;Ct<Ge;++Ct)ye[Ct]!=null&&((Ie=Le.get(ye[Ct]))._pos=Ct,Ie.onsuccess=Ke,Ie.onerror=nt,++Ue);Ue===0&&we(Me)})},get:function(ae){var pe=ae.trans,ye=ae.key;return new Promise(function(we,Se){we=ur(we);var Ie=pe.objectStore(se).get(ye);Ie.onsuccess=function(Le){return we(Le.target.result)},Ie.onerror=ni(Se)})},query:(re=te,function(ae){return new Promise(function(pe,ye){pe=ur(pe);var we,Se,Ie,Ue=ae.trans,Le=ae.values,Ge=ae.limit,Ke=ae.query,Me=Ge===1/0?void 0:Ge,Qe=Ke.index,Ke=Ke.range,Ue=Ue.objectStore(se),Qe=Qe.isPrimaryKey?Ue:Ue.index(Qe.name),Ke=k(Ke);if(Ge===0)return pe({result:[]});re?((Me=Le?Qe.getAll(Ke,Me):Qe.getAllKeys(Ke,Me)).onsuccess=function(nt){return pe({result:nt.target.result})},Me.onerror=ni(ye)):(we=0,Se=!Le&&"openKeyCursor"in Qe?Qe.openKeyCursor(Ke):Qe.openCursor(Ke),Ie=[],Se.onsuccess=function(nt){var Ct=Se.result;return Ct?(Ie.push(Le?Ct.value:Ct.primaryKey),++we===Ge?pe({result:Ie}):void Ct.continue()):pe({result:Ie})},Se.onerror=ni(ye))})}),openCursor:function(ae){var pe=ae.trans,ye=ae.values,we=ae.query,Se=ae.reverse,Ie=ae.unique;return new Promise(function(Le,Ge){Le=ur(Le);var Qe=we.index,Me=we.range,Ue=pe.objectStore(se),Ue=Qe.isPrimaryKey?Ue:Ue.index(Qe.name),Qe=Se?Ie?"prevunique":"prev":Ie?"nextunique":"next",Ke=!ye&&"openKeyCursor"in Ue?Ue.openKeyCursor(k(Me),Qe):Ue.openCursor(k(Me),Qe);Ke.onerror=ni(Ge),Ke.onsuccess=ur(function(nt){var Ct,Tt,Rt,bn,$t=Ke.result;$t?($t.___id=++Kg,$t.done=!1,Ct=$t.continue.bind($t),Tt=(Tt=$t.continuePrimaryKey)&&Tt.bind($t),Rt=$t.advance.bind($t),bn=function(){throw new Error("Cursor not stopped")},$t.trans=pe,$t.stop=$t.continue=$t.continuePrimaryKey=$t.advance=function(){throw new Error("Cursor not started")},$t.fail=ur(Ge),$t.next=function(){var Hr=this,Gr=1;return this.start(function(){return Gr--?Hr.continue():Hr.stop()}).then(function(){return Hr})},$t.start=function(Hr){function Gr(){if(Ke.result)try{Hr()}catch(rn){$t.fail(rn)}else $t.done=!0,$t.start=function(){throw new Error("Cursor behind last entry")},$t.stop()}var Wo=new Promise(function(rn,_s){rn=ur(rn),Ke.onerror=ni(_s),$t.fail=_s,$t.stop=function(du){$t.stop=$t.continue=$t.continuePrimaryKey=$t.advance=bn,rn(du)}});return Ke.onsuccess=ur(function(rn){Ke.onsuccess=Gr,Gr()}),$t.continue=Ct,$t.continuePrimaryKey=Tt,$t.advance=Rt,Gr(),Wo},Le($t)):Le(null)},Ge)})},count:function(ae){var pe=ae.query,ye=ae.trans,we=pe.index,Se=pe.range;return new Promise(function(Ie,Le){var Ge=ye.objectStore(se),Me=we.isPrimaryKey?Ge:Ge.index(we.name),Ge=k(Se),Me=Ge?Me.count(Ge):Me.count();Me.onsuccess=ur(function(Ue){return Ie(Ue.target.result)}),Me.onerror=ni(Le)})}}}var O,L,q,de=(L=Y,q=Ep((O=d).objectStoreNames),{schema:{name:O.name,tables:q.map(function(he){return L.objectStore(he)}).map(function(he){var re=he.keyPath,pe=he.autoIncrement,se=o(re),ae={},pe={name:he.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:re==null,compound:se,keyPath:re,autoIncrement:pe,unique:!0,extractKey:Hc(re)},indexes:Ep(he.indexNames).map(function(ye){return he.index(ye)}).map(function(Ie){var we=Ie.name,Se=Ie.unique,Le=Ie.multiEntry,Ie=Ie.keyPath,Le={name:we,compound:o(Ie),keyPath:Ie,unique:Se,multiEntry:Le,extractKey:Hc(Ie)};return ae[Lo(Ie)]=Le}),getIndexByKeyPath:function(ye){return ae[Lo(ye)]}};return ae[":id"]=pe.primaryKey,re!=null&&(ae[Lo(re)]=pe.primaryKey),pe})},hasGetAll:0<q.length&&"getAll"in L.objectStore(q[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Y=de.schema,te=de.hasGetAll,de=Y.tables.map(R),Q={};return de.forEach(function(he){return Q[he.name]=he}),{stack:"dbcore",transaction:d.transaction.bind(d),table:function(he){if(!Q[he])throw new Error("Table '".concat(he,"' not found"));return Q[he]},MIN_KEY:-1/0,MAX_KEY:ea(m),schema:Y}}function Hg(d,m,$,k){var R=$.IDBKeyRange;return $.indexedDB,{dbcore:(k=Hl(m,R,k),d.dbcore.reduce(function(O,L){return L=L.create,n(n({},O),L(O))},k))}}function Gl(d,k){var $=k.db,k=Hg(d._middlewares,$,d._deps,k);d.core=k.dbcore,d.tables.forEach(function(R){var O=R.name;d.core.schema.tables.some(function(L){return L.name===O})&&(R.core=d.core.table(O),d[O]instanceof d.Table&&(d[O].core=R.core))})}function Ql(d,m,$,k){$.forEach(function(R){var O=k[R];m.forEach(function(L){var q=function Y(te,de){return C(te,de)||(te=u(te))&&Y(te,de)}(L,R);(!q||"value"in q&&q.value===void 0)&&(L===d.Transaction.prototype||L instanceof d.Transaction?x(L,R,{get:function(){return this.table(R)},set:function(Y){w(this,R,{value:Y,writable:!0,configurable:!0,enumerable:!0})}}):L[R]=new d.Table(R,O))})})}function Gc(d,m){m.forEach(function($){for(var k in $)$[k]instanceof d.Table&&delete $[k]})}function Gg(d,m){return d._cfg.version-m._cfg.version}function Qg(d,m,$,k){var R=d._dbSchema;$.objectStoreNames.contains("$meta")&&!R.$meta&&(R.$meta=Kc("$meta",Np("")[0],[]),d._storeNames.push("$meta"));var O=d._createTransaction("readwrite",d._storeNames,R);O.create($),O._completion.catch(k);var L=O._reject.bind(O),q=Ye.transless||Ye;Mi(function(){return Ye.trans=O,Ye.transless=q,m!==0?(Gl(d,$),te=m,((Y=O).storeNames.includes("$meta")?Y.table("$meta").get("version").then(function(de){return de??te}):Be.resolve(te)).then(function(de){return he=de,re=O,se=$,ae=[],de=(Q=d)._versions,pe=Q._dbSchema=Yl(0,Q.idbdb,se),(de=de.filter(function(ye){return ye._cfg.version>=he})).length!==0?(de.forEach(function(ye){ae.push(function(){var we=pe,Se=ye._cfg.dbschema;Xl(Q,we,se),Xl(Q,Se,se),pe=Q._dbSchema=Se;var Ie=Qc(we,Se);Ie.add.forEach(function(Qe){Zc(se,Qe[0],Qe[1].primKey,Qe[1].indexes)}),Ie.change.forEach(function(Qe){if(Qe.recreate)throw new Te.Upgrade("Not yet support for changing primary key");var Ke=se.objectStore(Qe.name);Qe.add.forEach(function(nt){return Zl(Ke,nt)}),Qe.change.forEach(function(nt){Ke.deleteIndex(nt.name),Zl(Ke,nt)}),Qe.del.forEach(function(nt){return Ke.deleteIndex(nt)})});var Le=ye._cfg.contentUpgrade;if(Le&&ye._cfg.version>he){Gl(Q,se),re._memoizedTables={};var Ge=I(Se);Ie.del.forEach(function(Qe){Ge[Qe]=we[Qe]}),Gc(Q,[Q.Transaction.prototype]),Ql(Q,[Q.Transaction.prototype],a(Ge),Ge),re.schema=Ge;var Me,Ue=B(Le);return Ue&&Qs(),Ie=Be.follow(function(){var Qe;(Me=Le(re))&&Ue&&(Qe=zi.bind(null,null),Me.then(Qe,Qe))}),Me&&typeof Me.then=="function"?Be.resolve(Me):Ie.then(function(){return Me})}}),ae.push(function(we){var Se,Ie,Le=ye._cfg.dbschema;Se=Le,Ie=we,[].slice.call(Ie.db.objectStoreNames).forEach(function(Ge){return Se[Ge]==null&&Ie.db.deleteObjectStore(Ge)}),Gc(Q,[Q.Transaction.prototype]),Ql(Q,[Q.Transaction.prototype],Q._storeNames,Q._dbSchema),re.schema=Q._dbSchema}),ae.push(function(we){Q.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Q.idbdb.version/10)===ye._cfg.version?(Q.idbdb.deleteObjectStore("$meta"),delete Q._dbSchema.$meta,Q._storeNames=Q._storeNames.filter(function(Se){return Se!=="$meta"})):we.objectStore("$meta").put(ye._cfg.version,"version"))})}),function ye(){return ae.length?Be.resolve(ae.shift()(re.idbtrans)).then(ye):Be.resolve()}().then(function(){Ip(pe,se)})):Be.resolve();var Q,he,re,se,ae,pe}).catch(L)):(a(R).forEach(function(de){Zc($,de,R[de].primKey,R[de].indexes)}),Gl(d,$),void Be.follow(function(){return d.on.populate.fire(O)}).catch(L));var Y,te})}function Tp(d,m){Ip(d._dbSchema,m),m.db.version%10!=0||m.objectStoreNames.contains("$meta")||m.db.createObjectStore("$meta").add(Math.ceil(m.db.version/10-1),"version");var $=Yl(0,d.idbdb,m);Xl(d,d._dbSchema,m);for(var k=0,R=Qc($,d._dbSchema).change;k<R.length;k++){var O=function(L){if(L.change.length||L.recreate)return console.warn("Unable to patch indexes of table ".concat(L.name," because it has changes on the type of index or primary key.")),{value:void 0};var q=m.objectStore(L.name);L.add.forEach(function(Y){Ut&&console.debug("Dexie upgrade patch: Creating missing index ".concat(L.name,".").concat(Y.src)),Zl(q,Y)})}(R[k]);if(typeof O=="object")return O.value}}function Qc(d,m){var $,k={del:[],add:[],change:[]};for($ in d)m[$]||k.del.push($);for($ in m){var R=d[$],O=m[$];if(R){var L={name:$,def:O,recreate:!1,del:[],add:[],change:[]};if(""+(R.primKey.keyPath||"")!=""+(O.primKey.keyPath||"")||R.primKey.auto!==O.primKey.auto)L.recreate=!0,k.change.push(L);else{var q=R.idxByName,Y=O.idxByName,te=void 0;for(te in q)Y[te]||L.del.push(te);for(te in Y){var de=q[te],Q=Y[te];de?de.src!==Q.src&&L.change.push(Q):L.add.push(Q)}(0<L.del.length||0<L.add.length||0<L.change.length)&&k.change.push(L)}}else k.add.push([$,O])}return k}function Zc(d,m,$,k){var R=d.db.createObjectStore(m,$.keyPath?{keyPath:$.keyPath,autoIncrement:$.auto}:{autoIncrement:$.auto});return k.forEach(function(O){return Zl(R,O)}),R}function Ip(d,m){a(d).forEach(function($){m.db.objectStoreNames.contains($)||(Ut&&console.debug("Dexie: Creating missing table",$),Zc(m,$,d[$].primKey,d[$].indexes))})}function Zl(d,m){d.createIndex(m.name,m.keyPath,{unique:m.unique,multiEntry:m.multi})}function Yl(d,m,$){var k={};return g(m.objectStoreNames,0).forEach(function(R){for(var O=$.objectStore(R),L=qc(Wc(te=O.keyPath),te||"",!0,!1,!!O.autoIncrement,te&&typeof te!="string",!0),q=[],Y=0;Y<O.indexNames.length;++Y){var de=O.index(O.indexNames[Y]),te=de.keyPath,de=qc(de.name,te,!!de.unique,!!de.multiEntry,!1,te&&typeof te!="string",!1);q.push(de)}k[R]=Kc(R,L,q)}),k}function Xl(d,m,$){for(var k=$.db.objectStoreNames,R=0;R<k.length;++R){var O=k[R],L=$.objectStore(O);d._hasGetAll="getAll"in L;for(var q=0;q<L.indexNames.length;++q){var Y=L.indexNames[q],te=L.index(Y).keyPath,de=typeof te=="string"?te:"["+g(te).join("+")+"]";!m[O]||(te=m[O].idxByName[de])&&(te.name=Y,delete m[O].idxByName[de],m[O].idxByName[Y]=te)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(d._hasGetAll=!1)}function Np(d){return d.split(",").map(function(m,$){var O=m.split(":"),k=(R=O[1])===null||R===void 0?void 0:R.trim(),R=(m=O[0].trim()).replace(/([&*]|\+\+)/g,""),O=/^\[/.test(R)?R.match(/^\[(.*)\]$/)[1].split("+"):R;return qc(R,O||null,/\&/.test(m),/\*/.test(m),/\+\+/.test(m),o(O),$===0,k)})}var Zg=(ta.prototype._createTableSchema=Kc,ta.prototype._parseIndexSyntax=Np,ta.prototype._parseStoresSpec=function(d,m){var $=this;a(d).forEach(function(k){if(d[k]!==null){var R=$._parseIndexSyntax(d[k]),O=R.shift();if(!O)throw new Te.Schema("Invalid schema for table "+k+": "+d[k]);if(O.unique=!0,O.multi)throw new Te.Schema("Primary key cannot be multiEntry*");R.forEach(function(L){if(L.auto)throw new Te.Schema("Only primary key can be marked as autoIncrement (++)");if(!L.keyPath)throw new Te.Schema("Index must have a name and cannot be an empty string")}),R=$._createTableSchema(k,O,R),m[k]=R}})},ta.prototype.stores=function($){var m=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,$):$;var $=m._versions,k={},R={};return $.forEach(function(O){l(k,O._cfg.storesSource),R=O._cfg.dbschema={},O._parseStoresSpec(k,R)}),m._dbSchema=R,Gc(m,[m._allTables,m,m.Transaction.prototype]),Ql(m,[m._allTables,m,m.Transaction.prototype,this._cfg.tables],a(R),R),m._storeNames=a(R),this},ta.prototype.upgrade=function(d){return this._cfg.contentUpgrade=cn(this._cfg.contentUpgrade||Fe,d),this},ta);function ta(){}function Jl(d,m){var $=d._dbNamesDB;return $||($=d._dbNamesDB=new $i(Na,{addons:[],indexedDB:d,IDBKeyRange:m})).version(1).stores({dbnames:"name"}),$.table("dbnames")}function eu(d){return d&&typeof d.databases=="function"}function Yc(d){return Mi(function(){return Ye.letThrough=!0,d()})}function Xc(d){return!("from"in d)}var Kr=function(d,m){if(!this){var $=new Kr;return d&&"d"in d&&l($,d),$}l(this,arguments.length?{d:1,from:d,to:1<arguments.length?m:d}:{d:0})};function Ra(d,m,$){var k=zt(m,$);if(!isNaN(k)){if(0<k)throw RangeError();if(Xc(d))return l(d,{from:m,to:$,d:1});var R=d.l,k=d.r;if(zt($,d.from)<0)return R?Ra(R,m,$):d.l={from:m,to:$,d:1,l:null,r:null},Ap(d);if(0<zt(m,d.to))return k?Ra(k,m,$):d.r={from:m,to:$,d:1,l:null,r:null},Ap(d);zt(m,d.from)<0&&(d.from=m,d.l=null,d.d=k?k.d+1:1),0<zt($,d.to)&&(d.to=$,d.r=null,d.d=d.l?d.l.d+1:1),$=!d.r,R&&!d.l&&qi(d,R),k&&$&&qi(d,k)}}function qi(d,m){Xc(m)||function $(k,Y){var O=Y.from,L=Y.to,q=Y.l,Y=Y.r;Ra(k,O,L),q&&$(k,q),Y&&$(k,Y)}(d,m)}function Pp(d,m){var $=Bo(m),k=$.next();if(k.done)return!1;for(var R=k.value,O=Bo(d),L=O.next(R.from),q=L.value;!k.done&&!L.done;){if(zt(q.from,R.to)<=0&&0<=zt(q.to,R.from))return!0;zt(R.from,q.from)<0?R=(k=$.next(q.from)).value:q=(L=O.next(R.from)).value}return!1}function Bo(d){var m=Xc(d)?null:{s:0,n:d};return{next:function($){for(var k=0<arguments.length;m;)switch(m.s){case 0:if(m.s=1,k)for(;m.n.l&&zt($,m.n.from)<0;)m={up:m,n:m.n.l,s:1};else for(;m.n.l;)m={up:m,n:m.n.l,s:1};case 1:if(m.s=2,!k||zt($,m.n.to)<=0)return{value:m.n,done:!1};case 2:if(m.n.r){m.s=3,m={up:m,n:m.n.r,s:0};continue}case 3:m=m.up}return{done:!0}}}}function Ap(d){var m,$,k=(((m=d.r)===null||m===void 0?void 0:m.d)||0)-((($=d.l)===null||$===void 0?void 0:$.d)||0),R=1<k?"r":k<-1?"l":"";R&&(m=R=="r"?"l":"r",$=n({},d),k=d[R],d.from=k.from,d.to=k.to,d[R]=k[R],$[R]=k[m],(d[m]=$).d=Rp($)),d.d=Rp(d)}function Rp($){var m=$.r,$=$.l;return(m?$?Math.max(m.d,$.d):m.d:$?$.d:0)+1}function tu(d,m){return a(m).forEach(function($){d[$]?qi(d[$],m[$]):d[$]=function k(R){var O,L,q={};for(O in R)f(R,O)&&(L=R[O],q[O]=!L||typeof L!="object"||ue.has(L.constructor)?L:k(L));return q}(m[$])}),d}function Uo(d,m){return d.all||m.all||Object.keys(d).some(function($){return m[$]&&Pp(m[$],d[$])})}p(Kr.prototype,((Er={add:function(d){return qi(this,d),this},addKey:function(d){return Ra(this,d,d),this},addKeys:function(d){var m=this;return d.forEach(function($){return Ra(m,$,$)}),this},hasKey:function(d){var m=Bo(this).next(d).value;return m&&zt(m.from,d)<=0&&0<=zt(m.to,d)}})[ne]=function(){return Bo(this)},Er));var ws={},Jc={},ed=!1;function ru(d){tu(Jc,d),ed||(ed=!0,setTimeout(function(){ed=!1,td(Jc,!(Jc={}))},0))}function td(d,m){m===void 0&&(m=!1);var $=new Set;if(d.all)for(var k=0,R=Object.values(ws);k<R.length;k++)Op(L=R[k],d,$,m);else for(var O in d){var L,q=/^idb\:\/\/(.*)\/(.*)\//.exec(O);q&&(O=q[1],q=q[2],(L=ws["idb://".concat(O,"/").concat(q)])&&Op(L,d,$,m))}$.forEach(function(Y){return Y()})}function Op(d,m,$,k){for(var R=[],O=0,L=Object.entries(d.queries.query);O<L.length;O++){for(var q=L[O],Y=q[0],te=[],de=0,Q=q[1];de<Q.length;de++){var he=Q[de];Uo(m,he.obsSet)?he.subscribers.forEach(function(pe){return $.add(pe)}):k&&te.push(he)}k&&R.push([Y,te])}if(k)for(var re=0,se=R;re<se.length;re++){var ae=se[re],Y=ae[0],te=ae[1];d.queries.query[Y]=te}}function Yg(d){var m=d._state,$=d._deps.indexedDB;if(m.isBeingOpened||d.idbdb)return m.dbReadyPromise.then(function(){return m.dbOpenError?$r(m.dbOpenError):d});m.isBeingOpened=!0,m.dbOpenError=null,m.openComplete=!1;var k=m.openCanceller,R=Math.round(10*d.verno),O=!1;function L(){if(m.openCanceller!==k)throw new Te.DatabaseClosed("db.open() was cancelled")}function q(){return new Be(function(he,re){if(L(),!$)throw new Te.MissingAPI;var se=d.name,ae=m.autoSchema||!R?$.open(se):$.open(se,R);if(!ae)throw new Te.MissingAPI;ae.onerror=ni(re),ae.onblocked=ur(d._fireOnBlocked),ae.onupgradeneeded=ur(function(pe){var ye;de=ae.transaction,m.autoSchema&&!d._options.allowEmptyDB?(ae.onerror=vs,de.abort(),ae.result.close(),(ye=$.deleteDatabase(se)).onsuccess=ye.onerror=ur(function(){re(new Te.NoSuchDatabase("Database ".concat(se," doesnt exist")))})):(de.onerror=ni(re),pe=pe.oldVersion>Math.pow(2,62)?0:pe.oldVersion,Q=pe<1,d.idbdb=ae.result,O&&Tp(d,de),Qg(d,pe/10,de,re))},re),ae.onsuccess=ur(function(){de=null;var pe,ye,we,Se,Ie,Le=d.idbdb=ae.result,Ge=g(Le.objectStoreNames);if(0<Ge.length)try{var Me=Le.transaction((Se=Ge).length===1?Se[0]:Se,"readonly");if(m.autoSchema)ye=Le,we=Me,(pe=d).verno=ye.version/10,we=pe._dbSchema=Yl(0,ye,we),pe._storeNames=g(ye.objectStoreNames,0),Ql(pe,[pe._allTables],a(we),we);else if(Xl(d,d._dbSchema,Me),((Ie=Qc(Yl(0,(Ie=d).idbdb,Me),Ie._dbSchema)).add.length||Ie.change.some(function(Ue){return Ue.add.length||Ue.change.length}))&&!O)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Le.close(),R=Le.version+1,O=!0,he(q());Gl(d,Me)}catch{}Un.push(d),Le.onversionchange=ur(function(Ue){m.vcFired=!0,d.on("versionchange").fire(Ue)}),Le.onclose=ur(function(){d.close({disableAutoOpen:!1})}),Q&&(Ie=d._deps,Me=se,Le=Ie.indexedDB,Ie=Ie.IDBKeyRange,eu(Le)||Me===Na||Jl(Le,Ie).put({name:Me}).catch(Fe)),he()},re)}).catch(function(he){switch(he==null?void 0:he.name){case"UnknownError":if(0<m.PR1398_maxLoop)return m.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),q();break;case"VersionError":if(0<R)return R=0,q()}return Be.reject(he)})}var Y,te=m.dbReadyResolve,de=null,Q=!1;return Be.race([k,(typeof navigator>"u"?Be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(he){function re(){return indexedDB.databases().finally(he)}Y=setInterval(re,100),re()}).finally(function(){return clearInterval(Y)}):Promise.resolve()).then(q)]).then(function(){return L(),m.onReadyBeingFired=[],Be.resolve(Yc(function(){return d.on.ready.fire(d.vip)})).then(function he(){if(0<m.onReadyBeingFired.length){var re=m.onReadyBeingFired.reduce(cn,Fe);return m.onReadyBeingFired=[],Be.resolve(Yc(function(){return re(d.vip)})).then(he)}})}).finally(function(){m.openCanceller===k&&(m.onReadyBeingFired=null,m.isBeingOpened=!1)}).catch(function(he){m.dbOpenError=he;try{de&&de.abort()}catch{}return k===m.openCanceller&&d._close(),$r(he)}).finally(function(){m.openComplete=!0,te()}).then(function(){var he;return Q&&(he={},d.tables.forEach(function(re){re.schema.indexes.forEach(function(se){se.name&&(he["idb://".concat(d.name,"/").concat(re.name,"/").concat(se.name)]=new Kr(-1/0,[[[]]]))}),he["idb://".concat(d.name,"/").concat(re.name,"/")]=he["idb://".concat(d.name,"/").concat(re.name,"/:dels")]=new Kr(-1/0,[[[]]])}),Vi(Js).fire(he),td(he,!0)),d})}function rd(d){function m(O){return d.next(O)}var $=R(m),k=R(function(O){return d.throw(O)});function R(O){return function(Y){var q=O(Y),Y=q.value;return q.done?Y:Y&&typeof Y.then=="function"?Y.then($,k):o(Y)?Promise.all(Y).then($,k):$(Y)}}return R(m)()}function _i(d,m,$){for(var k=o(d)?d.slice():[d],R=0;R<$;++R)k.push(m);return k}var nu={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(d){return n(n({},d),{table:function(m){var $=d.table(m),k=$.schema,R={},O=[];function L(Q,he,re){var se=Lo(Q),ae=R[se]=R[se]||[],pe=Q==null?0:typeof Q=="string"?1:Q.length,ye=0<he,ye=n(n({},re),{name:ye?"".concat(se,"(virtual-from:").concat(re.name,")"):re.name,lowLevelIndex:re,isVirtual:ye,keyTail:he,keyLength:pe,extractKey:Hc(Q),unique:!ye&&re.unique});return ae.push(ye),ye.isPrimaryKey||O.push(ye),1<pe&&L(pe===2?Q[0]:Q.slice(0,pe-1),he+1,re),ae.sort(function(we,Se){return we.keyTail-Se.keyTail}),ye}m=L(k.primaryKey.keyPath,0,k.primaryKey),R[":id"]=[m];for(var q=0,Y=k.indexes;q<Y.length;q++){var te=Y[q];L(te.keyPath,0,te)}function de(Q){var he,re=Q.query.index;return re.isVirtual?n(n({},Q),{query:{index:re.lowLevelIndex,range:(he=Q.query.range,re=re.keyTail,{type:he.type===1?2:he.type,lower:_i(he.lower,he.lowerOpen?d.MAX_KEY:d.MIN_KEY,re),lowerOpen:!0,upper:_i(he.upper,he.upperOpen?d.MIN_KEY:d.MAX_KEY,re),upperOpen:!0})}}):Q}return n(n({},$),{schema:n(n({},k),{primaryKey:m,indexes:O,getIndexByKeyPath:function(Q){return(Q=R[Lo(Q)])&&Q[0]}}),count:function(Q){return $.count(de(Q))},query:function(Q){return $.query(de(Q))},openCursor:function(Q){var he=Q.query.index,re=he.keyTail,se=he.isVirtual,ae=he.keyLength;return se?$.openCursor(de(Q)).then(function(ye){return ye&&pe(ye)}):$.openCursor(Q);function pe(ye){return Object.create(ye,{continue:{value:function(we){we!=null?ye.continue(_i(we,Q.reverse?d.MAX_KEY:d.MIN_KEY,re)):Q.unique?ye.continue(ye.key.slice(0,ae).concat(Q.reverse?d.MIN_KEY:d.MAX_KEY,re)):ye.continue()}},continuePrimaryKey:{value:function(we,Se){ye.continuePrimaryKey(_i(we,d.MAX_KEY,re),Se)}},primaryKey:{get:function(){return ye.primaryKey}},key:{get:function(){var we=ye.key;return ae===1?we[0]:we.slice(0,ae)}},value:{get:function(){return ye.value}}})}}})}})}};function iu(d,m,$,k){return $=$||{},k=k||"",a(d).forEach(function(R){var O,L,q;f(m,R)?(O=d[R],L=m[R],typeof O=="object"&&typeof L=="object"&&O&&L?(q=le(O))!==le(L)?$[k+R]=m[R]:q==="Object"?iu(O,L,$,k+R+"."):O!==L&&($[k+R]=m[R]):O!==L&&($[k+R]=m[R])):$[k+R]=void 0}),a(m).forEach(function(R){f(d,R)||($[k+R]=m[R])}),$}function nd(d,m){return m.type==="delete"?m.keys:m.keys||m.values.map(d.extractKey)}var su={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(d){return n(n({},d),{table:function(m){var $=d.table(m),k=$.schema.primaryKey;return n(n({},$),{mutate:function(R){var O=Ye.trans,L=O.table(m).hook,q=L.deleting,Y=L.creating,te=L.updating;switch(R.type){case"add":if(Y.fire===Fe)break;return O._promise("readwrite",function(){return de(R)},!0);case"put":if(Y.fire===Fe&&te.fire===Fe)break;return O._promise("readwrite",function(){return de(R)},!0);case"delete":if(q.fire===Fe)break;return O._promise("readwrite",function(){return de(R)},!0);case"deleteRange":if(q.fire===Fe)break;return O._promise("readwrite",function(){return function Q(he,re,se){return $.query({trans:he,values:!1,query:{index:k,range:re},limit:se}).then(function(ae){var pe=ae.result;return de({type:"delete",keys:pe,trans:he}).then(function(ye){return 0<ye.numFailures?Promise.reject(ye.failures[0]):pe.length<se?{failures:[],numFailures:0,lastResult:void 0}:Q(he,n(n({},re),{lower:pe[pe.length-1],lowerOpen:!0}),se)})})}(R.trans,R.range,1e4)},!0)}return $.mutate(R);function de(Q){var he,re,se,ae=Ye.trans,pe=Q.keys||nd(k,Q);if(!pe)throw new Error("Keys missing");return(Q=Q.type==="add"||Q.type==="put"?n(n({},Q),{keys:pe}):n({},Q)).type!=="delete"&&(Q.values=i([],Q.values)),Q.keys&&(Q.keys=i([],Q.keys)),he=$,se=pe,((re=Q).type==="add"?Promise.resolve([]):he.getMany({trans:re.trans,keys:se,cache:"immutable"})).then(function(ye){var we=pe.map(function(Se,Ie){var Le,Ge,Me,Ue=ye[Ie],Qe={onerror:null,onsuccess:null};return Q.type==="delete"?q.fire.call(Qe,Se,Ue,ae):Q.type==="add"||Ue===void 0?(Le=Y.fire.call(Qe,Se,Q.values[Ie],ae),Se==null&&Le!=null&&(Q.keys[Ie]=Se=Le,k.outbound||D(Q.values[Ie],k.keyPath,Se))):(Le=iu(Ue,Q.values[Ie]),(Ge=te.fire.call(Qe,Le,Se,Ue,ae))&&(Me=Q.values[Ie],Object.keys(Ge).forEach(function(Ke){f(Me,Ke)?Me[Ke]=Ge[Ke]:D(Me,Ke,Ge[Ke])}))),Qe});return $.mutate(Q).then(function(Se){for(var Ie=Se.failures,Le=Se.results,Ge=Se.numFailures,Se=Se.lastResult,Me=0;Me<pe.length;++Me){var Ue=(Le||pe)[Me],Qe=we[Me];Ue==null?Qe.onerror&&Qe.onerror(Ie[Me]):Qe.onsuccess&&Qe.onsuccess(Q.type==="put"&&ye[Me]?Q.values[Me]:Ue)}return{failures:Ie,results:Le,numFailures:Ge,lastResult:Se}}).catch(function(Se){return we.forEach(function(Ie){return Ie.onerror&&Ie.onerror(Se)}),Promise.reject(Se)})})}}})}})}};function Dp(d,m,$){try{if(!m||m.keys.length<d.length)return null;for(var k=[],R=0,O=0;R<m.keys.length&&O<d.length;++R)zt(m.keys[R],d[O])===0&&(k.push($?ie(m.values[R]):m.values[R]),++O);return k.length===d.length?k:null}catch{return null}}var Xg={stack:"dbcore",level:-1,create:function(d){return{table:function(m){var $=d.table(m);return n(n({},$),{getMany:function(k){if(!k.cache)return $.getMany(k);var R=Dp(k.keys,k.trans._cache,k.cache==="clone");return R?Be.resolve(R):$.getMany(k).then(function(O){return k.trans._cache={keys:k.keys,values:k.cache==="clone"?ie(O):O},O})},mutate:function(k){return k.type!=="add"&&(k.trans._cache=null),$.mutate(k)}})}}}};function au(d,m){return d.trans.mode==="readonly"&&!!d.subscr&&!d.trans.explicit&&d.trans.db._options.cache!=="disabled"&&!m.schema.primaryKey.outbound}function ou(d,m){switch(d){case"query":return m.values&&!m.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var jp={stack:"dbcore",level:0,name:"Observability",create:function(d){var m=d.schema.name,$=new Kr(d.MIN_KEY,d.MAX_KEY);return n(n({},d),{transaction:function(k,R,O){if(Ye.subscr&&R!=="readonly")throw new Te.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ye.querier));return d.transaction(k,R,O)},table:function(k){var R=d.table(k),O=R.schema,L=O.primaryKey,Q=O.indexes,q=L.extractKey,Y=L.outbound,te=L.autoIncrement&&Q.filter(function(re){return re.compound&&re.keyPath.includes(L.keyPath)}),de=n(n({},R),{mutate:function(re){function se(Ke){return Ke="idb://".concat(m,"/").concat(k,"/").concat(Ke),Se[Ke]||(Se[Ke]=new Kr)}var ae,pe,ye,we=re.trans,Se=re.mutatedParts||(re.mutatedParts={}),Ie=se(""),Le=se(":dels"),Ge=re.type,Qe=re.type==="deleteRange"?[re.range]:re.type==="delete"?[re.keys]:re.values.length<50?[nd(L,re).filter(function(Ke){return Ke}),re.values]:[],Me=Qe[0],Ue=Qe[1],Qe=re.trans._cache;return o(Me)?(Ie.addKeys(Me),(Qe=Ge==="delete"||Me.length===Ue.length?Dp(Me,Qe):null)||Le.addKeys(Me),(Qe||Ue)&&(ae=se,pe=Qe,ye=Ue,O.indexes.forEach(function(Ke){var nt=ae(Ke.name||"");function Ct(Rt){return Rt!=null?Ke.extractKey(Rt):null}function Tt(Rt){return Ke.multiEntry&&o(Rt)?Rt.forEach(function(bn){return nt.addKey(bn)}):nt.addKey(Rt)}(pe||ye).forEach(function(Rt,Hr){var $t=pe&&Ct(pe[Hr]),Hr=ye&&Ct(ye[Hr]);zt($t,Hr)!==0&&($t!=null&&Tt($t),Hr!=null&&Tt(Hr))})}))):Me?(Ue={from:(Ue=Me.lower)!==null&&Ue!==void 0?Ue:d.MIN_KEY,to:(Ue=Me.upper)!==null&&Ue!==void 0?Ue:d.MAX_KEY},Le.add(Ue),Ie.add(Ue)):(Ie.add($),Le.add($),O.indexes.forEach(function(Ke){return se(Ke.name).add($)})),R.mutate(re).then(function(Ke){return!Me||re.type!=="add"&&re.type!=="put"||(Ie.addKeys(Ke.results),te&&te.forEach(function(nt){for(var Ct=re.values.map(function($t){return nt.extractKey($t)}),Tt=nt.keyPath.findIndex(function($t){return $t===L.keyPath}),Rt=0,bn=Ke.results.length;Rt<bn;++Rt)Ct[Rt][Tt]=Ke.results[Rt];se(nt.name).addKeys(Ct)})),we.mutatedParts=tu(we.mutatedParts||{},Se),Ke})}}),Q=function(se){var ae=se.query,se=ae.index,ae=ae.range;return[se,new Kr((se=ae.lower)!==null&&se!==void 0?se:d.MIN_KEY,(ae=ae.upper)!==null&&ae!==void 0?ae:d.MAX_KEY)]},he={get:function(re){return[L,new Kr(re.key)]},getMany:function(re){return[L,new Kr().addKeys(re.keys)]},count:Q,query:Q,openCursor:Q};return a(he).forEach(function(re){de[re]=function(se){var ae=Ye.subscr,pe=!!ae,ye=au(Ye,R)&&ou(re,se)?se.obsSet={}:ae;if(pe){var we=function(Ue){return Ue="idb://".concat(m,"/").concat(k,"/").concat(Ue),ye[Ue]||(ye[Ue]=new Kr)},Se=we(""),Ie=we(":dels"),ae=he[re](se),pe=ae[0],ae=ae[1];if((re==="query"&&pe.isPrimaryKey&&!se.values?Ie:we(pe.name||"")).add(ae),!pe.isPrimaryKey){if(re!=="count"){var Le=re==="query"&&Y&&se.values&&R.query(n(n({},se),{values:!1}));return R[re].apply(this,arguments).then(function(Ue){if(re==="query"){if(Y&&se.values)return Le.then(function(Ct){return Ct=Ct.result,Se.addKeys(Ct),Ue});var Qe=se.values?Ue.result.map(q):Ue.result;(se.values?Se:Ie).addKeys(Qe)}else if(re==="openCursor"){var Ke=Ue,nt=se.values;return Ke&&Object.create(Ke,{key:{get:function(){return Ie.addKey(Ke.primaryKey),Ke.key}},primaryKey:{get:function(){var Ct=Ke.primaryKey;return Ie.addKey(Ct),Ct}},value:{get:function(){return nt&&Se.addKey(Ke.primaryKey),Ke.value}}})}return Ue})}Ie.add($)}}return R[re].apply(this,arguments)}}),de}})}};function id(d,m,$){if($.numFailures===0)return m;if(m.type==="deleteRange")return null;var k=m.keys?m.keys.length:"values"in m&&m.values?m.values.length:1;return $.numFailures===k?null:(m=n({},m),o(m.keys)&&(m.keys=m.keys.filter(function(R,O){return!(O in $.failures)})),"values"in m&&o(m.values)&&(m.values=m.values.filter(function(R,O){return!(O in $.failures)})),m)}function lu(d,m){return $=d,((k=m).lower===void 0||(k.lowerOpen?0<zt($,k.lower):0<=zt($,k.lower)))&&(d=d,(m=m).upper===void 0||(m.upperOpen?zt(d,m.upper)<0:zt(d,m.upper)<=0));var $,k}function sd(d,m,he,k,R,O){if(!he||he.length===0)return d;var L=m.query.index,q=L.multiEntry,Y=m.query.range,te=k.schema.primaryKey.extractKey,de=L.extractKey,Q=(L.lowLevelIndex||L).extractKey,he=he.reduce(function(re,se){var ae=re,pe=[];if(se.type==="add"||se.type==="put")for(var ye=new Kr,we=se.values.length-1;0<=we;--we){var Se,Ie=se.values[we],Le=te(Ie);ye.hasKey(Le)||(Se=de(Ie),(q&&o(Se)?Se.some(function(Ke){return lu(Ke,Y)}):lu(Se,Y))&&(ye.addKey(Le),pe.push(Ie)))}switch(se.type){case"add":var Ge=new Kr().addKeys(m.values?re.map(function(nt){return te(nt)}):re),ae=re.concat(m.values?pe.filter(function(nt){return nt=te(nt),!Ge.hasKey(nt)&&(Ge.addKey(nt),!0)}):pe.map(function(nt){return te(nt)}).filter(function(nt){return!Ge.hasKey(nt)&&(Ge.addKey(nt),!0)}));break;case"put":var Me=new Kr().addKeys(se.values.map(function(nt){return te(nt)}));ae=re.filter(function(nt){return!Me.hasKey(m.values?te(nt):nt)}).concat(m.values?pe:pe.map(function(nt){return te(nt)}));break;case"delete":var Ue=new Kr().addKeys(se.keys);ae=re.filter(function(nt){return!Ue.hasKey(m.values?te(nt):nt)});break;case"deleteRange":var Qe=se.range;ae=re.filter(function(nt){return!lu(te(nt),Qe)})}return ae},d);return he===d?d:(he.sort(function(re,se){return zt(Q(re),Q(se))||zt(te(re),te(se))}),m.limit&&m.limit<1/0&&(he.length>m.limit?he.length=m.limit:d.length===m.limit&&he.length<m.limit&&(R.dirty=!0)),O?Object.freeze(he):he)}function ad(d,m){return zt(d.lower,m.lower)===0&&zt(d.upper,m.upper)===0&&!!d.lowerOpen==!!m.lowerOpen&&!!d.upperOpen==!!m.upperOpen}function Mp(d,m){return function($,k,R,O){if($===void 0)return k!==void 0?-1:0;if(k===void 0)return 1;if((k=zt($,k))===0){if(R&&O)return 0;if(R)return 1;if(O)return-1}return k}(d.lower,m.lower,d.lowerOpen,m.lowerOpen)<=0&&0<=function($,k,R,O){if($===void 0)return k!==void 0?1:0;if(k===void 0)return-1;if((k=zt($,k))===0){if(R&&O)return 0;if(R)return-1;if(O)return 1}return k}(d.upper,m.upper,d.upperOpen,m.upperOpen)}function Jg(d,m,$,k){d.subscribers.add($),k.addEventListener("abort",function(){var R,O;d.subscribers.delete($),d.subscribers.size===0&&(R=d,O=m,setTimeout(function(){R.subscribers.size===0&&W(O,R)},3e3))})}var zp={stack:"dbcore",level:0,name:"Cache",create:function(d){var m=d.schema.name;return n(n({},d),{transaction:function($,k,R){var O,L,q=d.transaction($,k,R);return k==="readwrite"&&(L=(O=new AbortController).signal,R=function(Y){return function(){if(O.abort(),k==="readwrite"){for(var te=new Set,de=0,Q=$;de<Q.length;de++){var he=Q[de],re=ws["idb://".concat(m,"/").concat(he)];if(re){var se=d.table(he),ae=re.optimisticOps.filter(function(nt){return nt.trans===q});if(q._explicit&&Y&&q.mutatedParts)for(var pe=0,ye=Object.values(re.queries.query);pe<ye.length;pe++)for(var we=0,Se=(Ge=ye[pe]).slice();we<Se.length;we++)Uo((Me=Se[we]).obsSet,q.mutatedParts)&&(W(Ge,Me),Me.subscribers.forEach(function(nt){return te.add(nt)}));else if(0<ae.length){re.optimisticOps=re.optimisticOps.filter(function(nt){return nt.trans!==q});for(var Ie=0,Le=Object.values(re.queries.query);Ie<Le.length;Ie++)for(var Ge,Me,Ue,Qe=0,Ke=(Ge=Le[Ie]).slice();Qe<Ke.length;Qe++)(Me=Ke[Qe]).res!=null&&q.mutatedParts&&(Y&&!Me.dirty?(Ue=Object.isFrozen(Me.res),Ue=sd(Me.res,Me.req,ae,se,Me,Ue),Me.dirty?(W(Ge,Me),Me.subscribers.forEach(function(nt){return te.add(nt)})):Ue!==Me.res&&(Me.res=Ue,Me.promise=Be.resolve({result:Ue}))):(Me.dirty&&W(Ge,Me),Me.subscribers.forEach(function(nt){return te.add(nt)})))}}}te.forEach(function(nt){return nt()})}}},q.addEventListener("abort",R(!1),{signal:L}),q.addEventListener("error",R(!1),{signal:L}),q.addEventListener("complete",R(!0),{signal:L})),q},table:function($){var k=d.table($),R=k.schema.primaryKey;return n(n({},k),{mutate:function(O){var L=Ye.trans;if(R.outbound||L.db._options.cache==="disabled"||L.explicit||L.idbtrans.mode!=="readwrite")return k.mutate(O);var q=ws["idb://".concat(m,"/").concat($)];return q?(L=k.mutate(O),O.type!=="add"&&O.type!=="put"||!(50<=O.values.length||nd(R,O).some(function(Y){return Y==null}))?(q.optimisticOps.push(O),O.mutatedParts&&ru(O.mutatedParts),L.then(function(Y){0<Y.numFailures&&(W(q.optimisticOps,O),(Y=id(0,O,Y))&&q.optimisticOps.push(Y),O.mutatedParts&&ru(O.mutatedParts))}),L.catch(function(){W(q.optimisticOps,O),O.mutatedParts&&ru(O.mutatedParts)})):L.then(function(Y){var te=id(0,n(n({},O),{values:O.values.map(function(de,Q){var he;return Y.failures[Q]?de:(de=(he=R.keyPath)!==null&&he!==void 0&&he.includes(".")?ie(de):n({},de),D(de,R.keyPath,Y.results[Q]),de)})}),Y);q.optimisticOps.push(te),queueMicrotask(function(){return O.mutatedParts&&ru(O.mutatedParts)})}),L):k.mutate(O)},query:function(O){if(!au(Ye,k)||!ou("query",O))return k.query(O);var L=((te=Ye.trans)===null||te===void 0?void 0:te.db._options.cache)==="immutable",Q=Ye,q=Q.requery,Y=Q.signal,te=function(se,ae,pe,ye){var we=ws["idb://".concat(se,"/").concat(ae)];if(!we)return[];if(!(ae=we.queries[pe]))return[null,!1,we,null];var Se=ae[(ye.query?ye.query.index.name:null)||""];if(!Se)return[null,!1,we,null];switch(pe){case"query":var Ie=Se.find(function(Le){return Le.req.limit===ye.limit&&Le.req.values===ye.values&&ad(Le.req.query.range,ye.query.range)});return Ie?[Ie,!0,we,Se]:[Se.find(function(Le){return("limit"in Le.req?Le.req.limit:1/0)>=ye.limit&&(!ye.values||Le.req.values)&&Mp(Le.req.query.range,ye.query.range)}),!1,we,Se];case"count":return Ie=Se.find(function(Le){return ad(Le.req.query.range,ye.query.range)}),[Ie,!!Ie,we,Se]}}(m,$,"query",O),de=te[0],Q=te[1],he=te[2],re=te[3];return de&&Q?de.obsSet=O.obsSet:(Q=k.query(O).then(function(se){var ae=se.result;if(de&&(de.res=ae),L){for(var pe=0,ye=ae.length;pe<ye;++pe)Object.freeze(ae[pe]);Object.freeze(ae)}else se.result=ie(ae);return se}).catch(function(se){return re&&de&&W(re,de),Promise.reject(se)}),de={obsSet:O.obsSet,promise:Q,subscribers:new Set,type:"query",req:O,dirty:!1},re?re.push(de):(re=[de],(he=he||(ws["idb://".concat(m,"/").concat($)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[O.query.index.name||""]=re)),Jg(de,re,q,Y),de.promise.then(function(se){return{result:sd(se.result,O,he==null?void 0:he.optimisticOps,k,de,L)}})}})}})}};function uu(d,m){return new Proxy(d,{get:function($,k,R){return k==="db"?m:Reflect.get($,k,R)}})}var $i=(Sr.prototype.version=function(d){if(isNaN(d)||d<.1)throw new Te.Type("Given version is not a positive number");if(d=Math.round(10*d)/10,this.idbdb||this._state.isBeingOpened)throw new Te.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,d);var m=this._versions,$=m.filter(function(k){return k._cfg.version===d})[0];return $||($=new this.Version(d),m.push($),m.sort(Gg),$.stores({}),this._state.autoSchema=!1,$)},Sr.prototype._whenReady=function(d){var m=this;return this.idbdb&&(this._state.openComplete||Ye.letThrough||this._vip)?d():new Be(function($,k){if(m._state.openComplete)return k(new Te.DatabaseClosed(m._state.dbOpenError));if(!m._state.isBeingOpened){if(!m._state.autoOpen)return void k(new Te.DatabaseClosed);m.open().catch(Fe)}m._state.dbReadyPromise.then($,k)}).then(d)},Sr.prototype.use=function(d){var m=d.stack,$=d.create,k=d.level,R=d.name;return R&&this.unuse({stack:m,name:R}),d=this._middlewares[m]||(this._middlewares[m]=[]),d.push({stack:m,create:$,level:k??10,name:R}),d.sort(function(O,L){return O.level-L.level}),this},Sr.prototype.unuse=function(d){var m=d.stack,$=d.name,k=d.create;return m&&this._middlewares[m]&&(this._middlewares[m]=this._middlewares[m].filter(function(R){return k?R.create!==k:!!$&&R.name!==$})),this},Sr.prototype.open=function(){var d=this;return Fi(ir,function(){return Yg(d)})},Sr.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var d=this._state,m=Un.indexOf(this);if(0<=m&&Un.splice(m,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}d.isBeingOpened||(d.dbReadyPromise=new Be(function($){d.dbReadyResolve=$}),d.openCanceller=new Be(function($,k){d.cancelOpen=k}))},Sr.prototype.close=function($){var m=($===void 0?{disableAutoOpen:!0}:$).disableAutoOpen,$=this._state;m?($.isBeingOpened&&$.cancelOpen(new Te.DatabaseClosed),this._close(),$.autoOpen=!1,$.dbOpenError=new Te.DatabaseClosed):(this._close(),$.autoOpen=this._options.autoOpen||$.isBeingOpened,$.openComplete=!1,$.dbOpenError=null)},Sr.prototype.delete=function(d){var m=this;d===void 0&&(d={disableAutoOpen:!0});var $=0<arguments.length&&typeof arguments[0]!="object",k=this._state;return new Be(function(R,O){function L(){m.close(d);var q=m._deps.indexedDB.deleteDatabase(m.name);q.onsuccess=ur(function(){var Y,te,de;Y=m._deps,te=m.name,de=Y.indexedDB,Y=Y.IDBKeyRange,eu(de)||te===Na||Jl(de,Y).delete(te).catch(Fe),R()}),q.onerror=ni(O),q.onblocked=m._fireOnBlocked}if($)throw new Te.InvalidArgument("Invalid closeOptions argument to db.delete()");k.isBeingOpened?k.dbReadyPromise.then(L):L()})},Sr.prototype.backendDB=function(){return this.idbdb},Sr.prototype.isOpen=function(){return this.idbdb!==null},Sr.prototype.hasBeenClosed=function(){var d=this._state.dbOpenError;return d&&d.name==="DatabaseClosed"},Sr.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Sr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Sr.prototype,"tables",{get:function(){var d=this;return a(this._allTables).map(function(m){return d._allTables[m]})},enumerable:!1,configurable:!0}),Sr.prototype.transaction=function(){var d=(function(m,$,k){var R=arguments.length;if(R<2)throw new Te.InvalidArgument("Too few arguments");for(var O=new Array(R-1);--R;)O[R-1]=arguments[R];return k=O.pop(),[m,Z(O),k]}).apply(this,arguments);return this._transaction.apply(this,d)},Sr.prototype._transaction=function(d,m,$){var k=this,R=Ye.trans;R&&R.db===this&&d.indexOf("!")===-1||(R=null);var O,L,q=d.indexOf("?")!==-1;d=d.replace("!","").replace("?","");try{if(L=m.map(function(te){if(te=te instanceof k.Table?te.name:te,typeof te!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return te}),d=="r"||d===wn)O=wn;else{if(d!="rw"&&d!=In)throw new Te.InvalidArgument("Invalid transaction mode: "+d);O=In}if(R){if(R.mode===wn&&O===In){if(!q)throw new Te.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");R=null}R&&L.forEach(function(te){if(R&&R.storeNames.indexOf(te)===-1){if(!q)throw new Te.SubTransaction("Table "+te+" not included in parent transaction.");R=null}}),q&&R&&!R.active&&(R=null)}}catch(te){return R?R._promise(null,function(de,Q){Q(te)}):$r(te)}var Y=(function te(de,Q,he,re,se){return Be.resolve().then(function(){var ae=Ye.transless||Ye,pe=de._createTransaction(Q,he,de._dbSchema,re);if(pe.explicit=!0,ae={trans:pe,transless:ae},re)pe.idbtrans=re.idbtrans;else try{pe.create(),pe.idbtrans._explicit=!0,de._state.PR1398_maxLoop=3}catch(Se){return Se.name===be.InvalidState&&de.isOpen()&&0<--de._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),de.close({disableAutoOpen:!1}),de.open().then(function(){return te(de,Q,he,null,se)})):$r(Se)}var ye,we=B(se);return we&&Qs(),ae=Be.follow(function(){var Se;(ye=se.call(pe,pe))&&(we?(Se=zi.bind(null,null),ye.then(Se,Se)):typeof ye.next=="function"&&typeof ye.throw=="function"&&(ye=rd(ye)))},ae),(ye&&typeof ye.then=="function"?Be.resolve(ye).then(function(Se){return pe.active?Se:$r(new Te.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ae.then(function(){return ye})).then(function(Se){return re&&pe._resolve(),pe._completion.then(function(){return Se})}).catch(function(Se){return pe._reject(Se),$r(Se)})})}).bind(null,this,O,L,R,$);return R?R._promise(O,Y,"lock"):Ye.trans?Fi(Ye.transless,function(){return k._whenReady(Y)}):this._whenReady(Y)},Sr.prototype.table=function(d){if(!f(this._allTables,d))throw new Te.InvalidTable("Table ".concat(d," does not exist"));return this._allTables[d]},Sr);function Sr(d,m){var $=this;this._middlewares={},this.verno=0;var k=Sr.dependencies;this._options=m=n({addons:Sr.addons,autoOpen:!0,indexedDB:k.indexedDB,IDBKeyRange:k.IDBKeyRange,cache:"cloned"},m),this._deps={indexedDB:m.indexedDB,IDBKeyRange:m.IDBKeyRange},k=m.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var R,O,L,q,Y,te={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Fe,dbReadyPromise:null,cancelOpen:Fe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:m.autoOpen};te.dbReadyPromise=new Be(function(Q){te.dbReadyResolve=Q}),te.openCanceller=new Be(function(Q,he){te.cancelOpen=he}),this._state=te,this.name=d,this.on=zo(this,"populate","blocked","versionchange","close",{ready:[cn,Fe]}),this.once=function(Q,he){var re=function(){for(var se=[],ae=0;ae<arguments.length;ae++)se[ae]=arguments[ae];$.on(Q).unsubscribe(re),he.apply($,se)};return $.on(Q,re)},this.on.ready.subscribe=S(this.on.ready.subscribe,function(Q){return function(he,re){Sr.vip(function(){var se,ae=$._state;ae.openComplete?(ae.dbOpenError||Be.resolve().then(he),re&&Q(he)):ae.onReadyBeingFired?(ae.onReadyBeingFired.push(he),re&&Q(he)):(Q(he),se=$,re||Q(function pe(){se.on.ready.unsubscribe(he),se.on.ready.unsubscribe(pe)}))})}}),this.Collection=(R=this,Fo(Uc.prototype,function(ye,pe){this.db=R;var re=yp,se=null;if(pe)try{re=pe()}catch(we){se=we}var ae=ye._ctx,pe=ae.table,ye=pe.hook.reading.fire;this._ctx={table:pe,index:ae.index,isPrimKey:!ae.index||pe.schema.primKey.keyPath&&ae.index===pe.schema.primKey.name,range:re,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:se,or:ae.or,valueMapper:ye!==He?ye:null}})),this.Table=(O=this,Fo(_p.prototype,function(Q,he,re){this.db=O,this._tx=re,this.name=Q,this.schema=he,this.hook=O._allTables[Q]?O._allTables[Q].hook:zo(null,{creating:[gt,Fe],reading:[Ve,He],updating:[rr,Fe],deleting:[ot,Fe]})})),this.Transaction=(L=this,Fo(Wg.prototype,function(Q,he,re,se,ae){var pe=this;Q!=="readonly"&&he.forEach(function(ye){ye=(ye=re[ye])===null||ye===void 0?void 0:ye.yProps,ye&&(he=he.concat(ye.map(function(we){return we.updatesTable})))}),this.db=L,this.mode=Q,this.storeNames=he,this.schema=re,this.chromeTransactionDurability=se,this.idbtrans=null,this.on=zo(this,"complete","error","abort"),this.parent=ae||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Be(function(ye,we){pe._resolve=ye,pe._reject=we}),this._completion.then(function(){pe.active=!1,pe.on.complete.fire()},function(ye){var we=pe.active;return pe.active=!1,pe.on.error.fire(ye),pe.parent?pe.parent._reject(ye):we&&pe.idbtrans&&pe.idbtrans.abort(),$r(ye)})})),this.Version=(q=this,Fo(Zg.prototype,function(Q){this.db=q,this._cfg={version:Q,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Y=this,Fo(Ui.prototype,function(Q,he,re){if(this.db=Y,this._ctx={table:Q,index:he===":id"?null:he,or:re},this._cmp=this._ascending=zt,this._descending=function(se,ae){return zt(ae,se)},this._max=function(se,ae){return 0<zt(se,ae)?se:ae},this._min=function(se,ae){return zt(se,ae)<0?se:ae},this._IDBKeyRange=Y._deps.IDBKeyRange,!this._IDBKeyRange)throw new Te.MissingAPI})),this.on("versionchange",function(Q){0<Q.newVersion?console.warn("Another connection wants to upgrade database '".concat($.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat($.name,"'. Closing db now to resume the delete request.")),$.close({disableAutoOpen:!1})}),this.on("blocked",function(Q){!Q.newVersion||Q.newVersion<Q.oldVersion?console.warn("Dexie.delete('".concat($.name,"') was blocked")):console.warn("Upgrade '".concat($.name,"' blocked by other connection holding version ").concat(Q.oldVersion/10))}),this._maxKey=ea(m.IDBKeyRange),this._createTransaction=function(Q,he,re,se){return new $.Transaction(Q,he,re,$._options.chromeTransactionDurability,se)},this._fireOnBlocked=function(Q){$.on("blocked").fire(Q),Un.filter(function(he){return he.name===$.name&&he!==$&&!he._state.vcFired}).map(function(he){return he.on("versionchange").fire(Q)})},this.use(Xg),this.use(zp),this.use(jp),this.use(nu),this.use(su);var de=new Proxy(this,{get:function(Q,he,re){if(he==="_vip")return!0;if(he==="table")return function(ae){return uu($.table(ae),de)};var se=Reflect.get(Q,he,re);return se instanceof _p?uu(se,de):he==="tables"?se.map(function(ae){return uu(ae,de)}):he==="_createTransaction"?function(){return uu(se.apply(this,arguments),de)}:se}});this.vip=de,k.forEach(function(Q){return Q($)})}var ra,Er=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Vo=(qo.prototype.subscribe=function(d,m,$){return this._subscribe(d&&typeof d!="function"?d:{next:d,error:m,complete:$})},qo.prototype[Er]=function(){return this},qo);function qo(d){this._subscribe=d}try{ra={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{ra={indexedDB:null,IDBKeyRange:null}}function od(d){var m,$=!1,k=new Vo(function(R){var O=B(d),L,q=!1,Y={},te={},de={get closed(){return q},unsubscribe:function(){q||(q=!0,L&&L.abort(),Q&&Vi.storagemutated.unsubscribe(re))}};R.start&&R.start(de);var Q=!1,he=function(){return ei(se)},re=function(ae){tu(Y,ae),Uo(te,Y)&&he()},se=function(){var ae,pe,ye;!q&&ra.indexedDB&&(Y={},ae={},L&&L.abort(),L=new AbortController,ye=function(we){var Se=vn();try{O&&Qs();var Ie=Mi(d,we);return Ie=O?Ie.finally(zi):Ie}finally{Se&&Yt()}}(pe={subscr:ae,signal:L.signal,requery:he,querier:d,trans:null}),Promise.resolve(ye).then(function(we){$=!0,m=we,q||pe.signal.aborted||(Y={},function(Se){for(var Ie in Se)if(f(Se,Ie))return;return 1}(te=ae)||Q||(Vi(Js,re),Q=!0),ei(function(){return!q&&R.next&&R.next(we)}))},function(we){$=!1,["DatabaseClosedError","AbortError"].includes(we==null?void 0:we.name)||q||ei(function(){q||R.error&&R.error(we)})}))};return setTimeout(he,0),de});return k.hasValue=function(){return $},k.getValue=function(){return m},k}var bs=$i;function cu(d){var m=Wi;try{Wi=!0,Vi.storagemutated.fire(d),td(d,!0)}finally{Wi=m}}p(bs,n(n({},We),{delete:function(d){return new bs(d,{addons:[]}).delete()},exists:function(d){return new bs(d,{addons:[]}).open().then(function(m){return m.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(d){try{return m=bs.dependencies,$=m.indexedDB,m=m.IDBKeyRange,(eu($)?Promise.resolve($.databases()).then(function(k){return k.map(function(R){return R.name}).filter(function(R){return R!==Na})}):Jl($,m).toCollection().primaryKeys()).then(d)}catch{return $r(new Te.MissingAPI)}var m,$},defineClass:function(){return function(d){l(this,d)}},ignoreTransaction:function(d){return Ye.trans?Fi(Ye.transless,d):d()},vip:Yc,async:function(d){return function(){try{var m=rd(d.apply(this,arguments));return m&&typeof m.then=="function"?m:Be.resolve(m)}catch($){return $r($)}}},spawn:function(d,m,$){try{var k=rd(d.apply($,m||[]));return k&&typeof k.then=="function"?k:Be.resolve(k)}catch(R){return $r(R)}},currentTransaction:{get:function(){return Ye.trans||null}},waitFor:function(d,m){return m=Be.resolve(typeof d=="function"?bs.ignoreTransaction(d):d).timeout(m||6e4),Ye.trans?Ye.trans.waitFor(m):m},Promise:Be,debug:{get:function(){return Ut},set:function(d){G(d)}},derive:v,extend:l,props:p,override:S,Events:zo,on:Vi,liveQuery:od,extendObservabilitySet:tu,getByKeyPath:M,setByKeyPath:D,delByKeyPath:function(d,m){typeof m=="string"?D(d,m,void 0):"length"in m&&[].map.call(m,function($){D(d,$,void 0)})},shallowClone:I,deepClone:ie,getObjectDiff:iu,cmp:zt,asap:A,minKey:-1/0,addons:[],connections:Un,errnames:be,dependencies:ra,cache:ws,semVer:"4.2.1",version:"4.2.1".split(".").map(function(d){return parseInt(d)}).reduce(function(d,m,$){return d+m/Math.pow(10,2*$)})})),bs.maxKey=ea(bs.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Vi(Js,function(d){Wi||(d=new CustomEvent(Kl,{detail:d}),Wi=!0,dispatchEvent(d),Wi=!1)}),addEventListener(Kl,function(d){d=d.detail,Wi||cu(d)}));var xs,Wi=!1,ld=function(){};return typeof BroadcastChannel<"u"&&((ld=function(){(xs=new BroadcastChannel(Kl)).onmessage=function(d){return d.data&&cu(d.data)}})(),typeof xs.unref=="function"&&xs.unref(),Vi(Js,function(d){Wi||xs.postMessage(d)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(d){if(!$i.disableBfCache&&d.persisted){Ut&&console.debug("Dexie: handling persisted pagehide"),xs!=null&&xs.close();for(var m=0,$=Un;m<$.length;m++)$[m].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(d){!$i.disableBfCache&&d.persisted&&(Ut&&console.debug("Dexie: handling persisted pageshow"),ld(),cu({all:new Kr(-1/0,[[]])}))})),Be.rejectionMapper=function(d,m){return!d||d instanceof me||d instanceof TypeError||d instanceof SyntaxError||!d.name||!Ee[d.name]?d:(m=new Ee[d.name](m||d.message,d),"stack"in d&&x(m,"stack",{get:function(){return this.inner.stack}}),m)},G(Ut),n($i,Object.freeze({__proto__:null,Dexie:$i,liveQuery:od,Entity:vp,cmp:zt,PropModification:ys,replacePrefix:function(d,m){return new ys({replacePrefix:[d,m]})},add:function(d){return new ys({add:d})},remove:function(d){return new ys({remove:d})},default:$i,RangeSet:Kr,mergeRanges:qi,rangesOverlap:Pp}),{default:$i}),$i})})(CA);var Y5=CA.exports;const rw=Hw(Y5),i$=Symbol.for("Dexie"),nw=globalThis[i$]||(globalThis[i$]=rw);if(rw.semVer!==nw.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${rw.semVer} and ${nw.semVer}`);class X5 extends nw{constructor(){super("FiberSpliceDB"),this.version(2).stores({cables:"id, name, type",circuits:"id, cableId, position, isSpliced",saves:"id, createdAt"})}}const fr=new X5,J5=Object.freeze(Object.defineProperty({__proto__:null,db:fr},Symbol.toStringTag,{value:"Module"}));let Ay=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");const jt={async getAllCables(){return await fr.cables.toArray()},async getCable(e){return await fr.cables.get(e)},async createCable(e){const t={id:Ay(),ribbonSize:12,...e};return await fr.cables.add(t),t},async updateCable(e,t){await fr.cables.update(e,t)},async deleteCable(e){await fr.circuits.where("cableId").equals(e).delete(),await fr.cables.delete(e)},async getAllCircuits(){return await fr.circuits.toArray()},async getCircuit(e){return await fr.circuits.get(e)},async getCircuitsByCableId(e){return await fr.circuits.where("cableId").equals(e).sortBy("position")},async createCircuit(e){const t={id:Ay(),...e,isSpliced:0,feedCableId:null,feedFiberStart:null,feedFiberEnd:null};return await fr.circuits.add(t),t},async updateCircuit(e,t){await fr.circuits.update(e,t)},async bulkUpdateCircuits(e){await Promise.all(e.map(({id:t,changes:r})=>fr.circuits.update(t,r)))},async deleteCircuit(e){await fr.circuits.delete(e)},async getAllSaves(){return await fr.saves.orderBy("createdAt").reverse().toArray()},async getSave(e){return await fr.saves.get(e)},async createSave(e){const t=await fr.cables.toArray(),r=await fr.circuits.toArray(),n={id:Ay(),name:e,createdAt:new Date().toISOString(),data:JSON.stringify({cables:t,circuits:r})};await fr.saves.add(n);const i=await fr.saves.orderBy("createdAt").reverse().toArray();if(i.length>50){const s=i.slice(50);await Promise.all(s.map(a=>fr.saves.delete(a.id)))}return n},async deleteSave(e){await fr.saves.delete(e)},async loadSave(e){const t=await fr.saves.get(e);if(!t)throw new Error("Save not found");const r=JSON.parse(t.data);await fr.cables.clear(),await fr.circuits.clear(),await fr.cables.bulkAdd(r.cables),await fr.circuits.bulkAdd(r.circuits)},async resetAllData(){await fr.cables.clear(),await fr.circuits.clear()}},eq=Object.freeze(Object.defineProperty({__proto__:null,storage:jt},Symbol.toStringTag,{value:"Module"})),tq=()=>async({queryKey:e})=>{const[t,...r]=e;switch(t){case"/api/cables":return await jt.getAllCables();case"/api/circuits":return await jt.getAllCircuits();case"/api/circuits/cable":if(r.length>0)return await jt.getCircuitsByCableId(r[0]);throw new Error("Cable ID required for /api/circuits/cable");case"/api/saves":return await jt.getAllSaves();default:if(t.startsWith("/api/cables/")&&r.length===0){const n=t.split("/").pop();return await jt.getCable(n)}if(t.startsWith("/api/circuits/")&&r.length===0){const n=t.split("/").pop();return await jt.getCircuit(n)}if(t.startsWith("/api/saves/")&&r.length===0){const n=t.split("/").pop();return await jt.getSave(n)}throw new Error(`Unknown query endpoint: ${t}`)}};async function As(e,t,r){const n=t.replace(/^\/api\//,""),[i,s,...a]=n.split("/");try{let o;if(e==="POST"){if(i==="cables"){const l=r;if(o=await jt.createCable(l),l.circuitIds&&Array.isArray(l.circuitIds)&&l.circuitIds.length>0){let u=1;for(const c of l.circuitIds){const f=c.trim();if(!f)continue;const p=f.split(",");if(p.length!==2)continue;const w=p[1].split("-");if(w.length!==2)continue;const x=parseInt(w[0]),v=parseInt(w[1]);if(isNaN(x)||isNaN(v))continue;const C=v-x+1,b=u+C-1,S=(await jt.getCircuitsByCableId(o.id)).length;await jt.createCircuit({cableId:o.id,circuitId:f,position:S,fiberStart:u,fiberEnd:b}),u=b+1}}}else if(i==="circuits"){const l=r,u=await jt.getCable(l.cableId);if(!u)throw new Error("Cable not found");const c=l.circuitId.split(",");if(c.length!==2)throw new Error("Invalid circuit ID format");const f=c[1].split("-");if(f.length!==2)throw new Error("Invalid range format");const p=parseInt(f[0]),w=parseInt(f[1]);if(isNaN(p)||isNaN(w))throw new Error("Invalid range values");const x=w-p+1,v=await jt.getCircuitsByCableId(l.cableId),C=v.length;let b=1;v.length>0&&(b=v[v.length-1].fiberEnd+1);const g=b+x-1;if(g>u.fiberCount)throw new Error(`Circuit requires ${x} fibers but only ${u.fiberCount-b+1} fibers remaining`);o=await jt.createCircuit({...l,position:C,fiberStart:b,fiberEnd:g})}else if(i==="saves")if(a.includes("load"))await jt.loadSave(s),o={success:!0};else{const{name:l}=r;o=await jt.createSave(l)}}else if(e==="PATCH"||e==="PUT")if(i==="cables")await jt.updateCable(s,r),o={success:!0};else if(i==="circuits"&&a.includes("toggle-spliced")){const l=await jt.getCircuit(s);if(!l)throw new Error("Circuit not found");const u=l.isSpliced===1?0:1,c={isSpliced:u};if(u===1){const{feedCableId:f,feedFiberStart:p,feedFiberEnd:w}=r;c.feedCableId=f||null,c.feedFiberStart=p!==void 0?p:null,c.feedFiberEnd=w!==void 0?w:null}else c.feedCableId=null,c.feedFiberStart=null,c.feedFiberEnd=null;await jt.updateCircuit(s,c),o={success:!0}}else if(i==="circuits"&&a.includes("update-circuit-id")){const l=await jt.getCircuit(s);if(!l)throw new Error("Circuit not found");const{circuitId:u}=r,c=u.split(",");if(c.length!==2)throw new Error("Invalid circuit ID format");const f=c[1].split("-");if(f.length!==2)throw new Error("Invalid range format");const p=parseInt(f[0]),w=parseInt(f[1]);if(isNaN(p)||isNaN(w))throw new Error("Invalid range values");const x=w-p+1;await jt.updateCircuit(s,{circuitId:u});const v=await jt.getCircuitsByCableId(l.cableId);let C=1;const b=[];for(const S of v){const E=S.id===s?{...S,circuitId:u}:S;if(!E.circuitId||!E.circuitId.includes(","))continue;const A=E.circuitId.split(",");if(!A[1])continue;const M=A[1].split("-");if(M.length!==2)continue;const D=parseInt(M[0]),I=parseInt(M[1]);if(isNaN(D)||isNaN(I))continue;const U=I-D+1,Z=C,ue=Z+U-1;b.push({id:S.id,changes:{fiberStart:Z,fiberEnd:ue}}),C=ue+1}await jt.bulkUpdateCircuits(b);const g=await jt.getCable(l.cableId);if((g==null?void 0:g.type)==="Feed"){const S=await jt.getAllCircuits(),E=await jt.getCircuitsByCableId(l.cableId),A=[];for(const M of S)if(M.isSpliced===1&&M.feedCableId===l.cableId){const D=M.circuitId.split(",");if(D.length===2){const I=D[0].trim(),U=D[1].trim().split("-");if(U.length===2){const Z=parseInt(U[0]),ue=parseInt(U[1]);for(const X of E){const ie=X.circuitId.split(",");if(ie.length===2&&ie[0].trim()===I){const le=ie[1].trim().split("-");if(le.length===2){const ne=parseInt(le[0]),ce=parseInt(le[1]);if(Z>=ne&&ue<=ce){const W=Z-ne,F=ue-ne,H=X.fiberStart+W,B=X.fiberStart+F;A.push({id:M.id,changes:{feedFiberStart:H,feedFiberEnd:B}});break}}}}}}}A.length>0&&await jt.bulkUpdateCircuits(A)}o={success:!0}}else if(i==="circuits"&&a.includes("move")){const{direction:l}=r,u=await jt.getCircuit(s);if(!u)throw new Error("Circuit not found");const c=await jt.getCircuitsByCableId(u.cableId),f=c.findIndex(b=>b.id===s);if(f===-1)throw new Error("Circuit not found in cable");let p=f;if(l==="up"&&f>0)p=f-1;else if(l==="down"&&f<c.length-1)p=f+1;else throw new Error("Cannot move circuit in that direction");const w=c[f];c[f]=c[p],c[p]=w;let x=1;const v=[];for(let b=0;b<c.length;b++){const g=c[b];if(!g.circuitId||!g.circuitId.includes(","))continue;const S=g.circuitId.split(",");if(!S[1])continue;const E=S[1].split("-");if(E.length!==2)continue;const A=parseInt(E[0]),M=parseInt(E[1]);if(isNaN(A)||isNaN(M))continue;const D=M-A+1,I=x,U=I+D-1;v.push({id:g.id,changes:{position:b,fiberStart:I,fiberEnd:U}}),x=U+1}await jt.bulkUpdateCircuits(v);const C=await jt.getCable(u.cableId);if((C==null?void 0:C.type)==="Feed"){const b=await jt.getAllCircuits(),g=await jt.getCircuitsByCableId(u.cableId),S=[];for(const E of b)if(E.isSpliced===1&&E.feedCableId===u.cableId){const A=E.circuitId.split(",");if(A.length===2){const M=A[0].trim(),D=A[1].trim().split("-");if(D.length===2){const I=parseInt(D[0]),U=parseInt(D[1]);for(const Z of g){const ue=Z.circuitId.split(",");if(ue.length===2&&ue[0].trim()===M){const ie=ue[1].trim().split("-");if(ie.length===2){const j=parseInt(ie[0]),le=parseInt(ie[1]);if(I>=j&&U<=le){const ne=I-j,ce=U-j,W=Z.fiberStart+ne,F=Z.fiberStart+ce;S.push({id:E.id,changes:{feedFiberStart:W,feedFiberEnd:F}});break}}}}}}}S.length>0&&await jt.bulkUpdateCircuits(S)}o={success:!0}}else i==="circuits"&&(await jt.updateCircuit(s,r),o={success:!0});else if(e==="DELETE"){if(i==="reset")await jt.resetAllData(),o={success:!0};else if(i==="cables")await jt.deleteCable(s),o={success:!0};else if(i==="circuits")await jt.deleteCircuit(s),o={success:!0};else if(i==="saves")if(s==="load"){const{id:l}=r;await jt.loadSave(l),o={success:!0}}else await jt.deleteSave(s),o={success:!0}}return{json:async()=>o}}catch(o){throw new Error(o instanceof Error?o.message:"Storage operation failed")}}const vr=new O5({defaultOptions:{queries:{queryFn:tq(),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),rq=1,nq=1e6;let Ry=0;function iq(){return Ry=(Ry+1)%Number.MAX_SAFE_INTEGER,Ry.toString()}const Oy=new Map,s$=e=>{if(Oy.has(e))return;const t=setTimeout(()=>{Oy.delete(e),of({type:"REMOVE_TOAST",toastId:e})},nq);Oy.set(e,t)},sq=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,rq)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?s$(r):e.toasts.forEach(n=>{s$(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Uh=[];let Vh={toasts:[]};function of(e){Vh=sq(Vh,e),Uh.forEach(t=>{t(Vh)})}function aq({...e}){const t=iq(),r=i=>of({type:"UPDATE_TOAST",toast:{...i,id:t}}),n=()=>of({type:"DISMISS_TOAST",toastId:t});return of({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:i=>{i||n()}}}),{id:t,dismiss:n,update:r}}function _g(){const[e,t]=P.useState(Vh);return P.useEffect(()=>(Uh.push(t),()=>{const r=Uh.indexOf(t);r>-1&&Uh.splice(r,1)}),[e]),{...e,toast:aq,dismiss:r=>of({type:"DISMISS_TOAST",toastId:r})}}function ht(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e==null||e(i),r===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function a$(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function kA(...e){return t=>{let r=!1;const n=e.map(i=>{const s=a$(i,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let i=0;i<n.length;i++){const s=n[i];typeof s=="function"?s():a$(e[i],null)}}}}function or(...e){return P.useCallback(kA(...e),e)}function oq(e,t){const r=P.createContext(t),n=s=>{const{children:a,...o}=s,l=P.useMemo(()=>o,Object.values(o));return y.jsx(r.Provider,{value:l,children:a})};n.displayName=e+"Provider";function i(s){const a=P.useContext(r);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,i]}function Oi(e,t=[]){let r=[];function n(s,a){const o=P.createContext(a),l=r.length;r=[...r,a];const u=f=>{var b;const{scope:p,children:w,...x}=f,v=((b=p==null?void 0:p[e])==null?void 0:b[l])||o,C=P.useMemo(()=>x,Object.values(x));return y.jsx(v.Provider,{value:C,children:w})};u.displayName=s+"Provider";function c(f,p){var v;const w=((v=p==null?void 0:p[e])==null?void 0:v[l])||o,x=P.useContext(w);if(x)return x;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${s}\``)}return[u,c]}const i=()=>{const s=r.map(a=>P.createContext(a));return function(o){const l=(o==null?void 0:o[e])||s;return P.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return i.scopeName=e,[n,lq(i,...t)]}function lq(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=n.reduce((o,{useScope:l,scopeName:u})=>{const f=l(s)[`__scope${u}`];return{...o,...f}},{});return P.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function yc(e){const t=uq(e),r=P.forwardRef((n,i)=>{const{children:s,...a}=n,o=P.Children.toArray(s),l=o.find(cq);if(l){const u=l.props.children,c=o.map(f=>f===l?P.Children.count(u)>1?P.Children.only(null):P.isValidElement(u)?u.props.children:null:f);return y.jsx(t,{...a,ref:i,children:P.isValidElement(u)?P.cloneElement(u,void 0,c):null})}return y.jsx(t,{...a,ref:i,children:s})});return r.displayName=`${e}.Slot`,r}var EA=yc("Slot");function uq(e){const t=P.forwardRef((r,n)=>{const{children:i,...s}=r;if(P.isValidElement(i)){const a=fq(i),o=dq(s,i.props);return i.type!==P.Fragment&&(o.ref=n?kA(n,a):a),P.cloneElement(i,o)}return P.Children.count(i)>1?P.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var TA=Symbol("radix.slottable");function IA(e){const t=({children:r})=>y.jsx(y.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=TA,t}function cq(e){return P.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===TA}function dq(e,t){const r={...t};for(const n in t){const i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...o)=>{s(...o),i(...o)}:i&&(r[n]=i):n==="style"?r[n]={...i,...s}:n==="className"&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}function fq(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Qb(e){const t=e+"CollectionProvider",[r,n]=Oi(t),[i,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=v=>{const{scope:C,children:b}=v,g=Nt.useRef(null),S=Nt.useRef(new Map).current;return y.jsx(i,{scope:C,itemMap:S,collectionRef:g,children:b})};a.displayName=t;const o=e+"CollectionSlot",l=yc(o),u=Nt.forwardRef((v,C)=>{const{scope:b,children:g}=v,S=s(o,b),E=or(C,S.collectionRef);return y.jsx(l,{ref:E,children:g})});u.displayName=o;const c=e+"CollectionItemSlot",f="data-radix-collection-item",p=yc(c),w=Nt.forwardRef((v,C)=>{const{scope:b,children:g,...S}=v,E=Nt.useRef(null),A=or(C,E),M=s(c,b);return Nt.useEffect(()=>(M.itemMap.set(E,{ref:E,...S}),()=>void M.itemMap.delete(E))),y.jsx(p,{[f]:"",ref:A,children:g})});w.displayName=c;function x(v){const C=s(e+"CollectionConsumer",v);return Nt.useCallback(()=>{const g=C.collectionRef.current;if(!g)return[];const S=Array.from(g.querySelectorAll(`[${f}]`));return Array.from(C.itemMap.values()).sort((M,D)=>S.indexOf(M.ref.current)-S.indexOf(D.ref.current))},[C.collectionRef,C.itemMap])}return[{Provider:a,Slot:u,ItemSlot:w},x,n]}var pq=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],kt=pq.reduce((e,t)=>{const r=yc(`Primitive.${t}`),n=P.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),y.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function NA(e,t){e&&Fl.flushSync(()=>e.dispatchEvent(t))}function Xn(e){const t=P.useRef(e);return P.useEffect(()=>{t.current=e}),P.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function hq(e,t=globalThis==null?void 0:globalThis.document){const r=Xn(e);P.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var mq="DismissableLayer",iw="dismissableLayer.update",gq="dismissableLayer.pointerDownOutside",yq="dismissableLayer.focusOutside",o$,PA=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ap=P.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=e,u=P.useContext(PA),[c,f]=P.useState(null),p=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,w]=P.useState({}),x=or(t,D=>f(D)),v=Array.from(u.layers),[C]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=v.indexOf(C),g=c?v.indexOf(c):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,E=g>=b,A=wq(D=>{const I=D.target,U=[...u.branches].some(Z=>Z.contains(I));!E||U||(i==null||i(D),a==null||a(D),D.defaultPrevented||o==null||o())},p),M=bq(D=>{const I=D.target;[...u.branches].some(Z=>Z.contains(I))||(s==null||s(D),a==null||a(D),D.defaultPrevented||o==null||o())},p);return hq(D=>{g===u.layers.size-1&&(n==null||n(D),!D.defaultPrevented&&o&&(D.preventDefault(),o()))},p),P.useEffect(()=>{if(c)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(o$=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),l$(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=o$)}},[c,p,r,u]),P.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),l$())},[c,u]),P.useEffect(()=>{const D=()=>w({});return document.addEventListener(iw,D),()=>document.removeEventListener(iw,D)},[]),y.jsx(kt.div,{...l,ref:x,style:{pointerEvents:S?E?"auto":"none":void 0,...e.style},onFocusCapture:ht(e.onFocusCapture,M.onFocusCapture),onBlurCapture:ht(e.onBlurCapture,M.onBlurCapture),onPointerDownCapture:ht(e.onPointerDownCapture,A.onPointerDownCapture)})});ap.displayName=mq;var vq="DismissableLayerBranch",AA=P.forwardRef((e,t)=>{const r=P.useContext(PA),n=P.useRef(null),i=or(t,n);return P.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),y.jsx(kt.div,{...e,ref:i})});AA.displayName=vq;function wq(e,t=globalThis==null?void 0:globalThis.document){const r=Xn(e),n=P.useRef(!1),i=P.useRef(()=>{});return P.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){RA(gq,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=l,t.addEventListener("click",i.current,{once:!0})):l()}else t.removeEventListener("click",i.current);n.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",s),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function bq(e,t=globalThis==null?void 0:globalThis.document){const r=Xn(e),n=P.useRef(!1);return P.useEffect(()=>{const i=s=>{s.target&&!n.current&&RA(yq,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function l$(){const e=new CustomEvent(iw);document.dispatchEvent(e)}function RA(e,t,r,{discrete:n}){const i=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?NA(i,s):i.dispatchEvent(s)}var xq=ap,_q=AA,En=globalThis!=null&&globalThis.document?P.useLayoutEffect:()=>{},$q="Portal",$g=P.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[i,s]=P.useState(!1);En(()=>s(!0),[]);const a=r||i&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?q6.createPortal(y.jsx(kt.div,{...n,ref:t}),a):null});$g.displayName=$q;function Sq(e,t){return P.useReducer((r,n)=>t[r][n]??r,e)}var No=e=>{const{present:t,children:r}=e,n=Cq(t),i=typeof r=="function"?r({present:n.isPresent}):P.Children.only(r),s=or(n.ref,kq(i));return typeof r=="function"||n.isPresent?P.cloneElement(i,{ref:s}):null};No.displayName="Presence";function Cq(e){const[t,r]=P.useState(),n=P.useRef({}),i=P.useRef(e),s=P.useRef("none"),a=e?"mounted":"unmounted",[o,l]=Sq(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const u=sh(n.current);s.current=o==="mounted"?u:"none"},[o]),En(()=>{const u=n.current,c=i.current;if(c!==e){const p=s.current,w=sh(u);e?l("MOUNT"):w==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&p!==w?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),En(()=>{if(t){let u;const c=t.ownerDocument.defaultView??window,f=w=>{const v=sh(n.current).includes(w.animationName);if(w.target===t&&v&&(l("ANIMATION_END"),!i.current)){const C=t.style.animationFillMode;t.style.animationFillMode="forwards",u=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=C)})}},p=w=>{w.target===t&&(s.current=sh(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{c.clearTimeout(u),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:P.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function sh(e){return(e==null?void 0:e.animationName)||"none"}function kq(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function vo({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,i]=Eq({defaultProp:t,onChange:r}),s=e!==void 0,a=s?e:n,o=Xn(r),l=P.useCallback(u=>{if(s){const f=typeof u=="function"?u(e):u;f!==e&&o(f)}else i(u)},[s,e,i,o]);return[a,l]}function Eq({defaultProp:e,onChange:t}){const r=P.useState(e),[n]=r,i=P.useRef(n),s=Xn(t);return P.useEffect(()=>{i.current!==n&&(s(n),i.current=n)},[n,i,s]),r}var Tq="VisuallyHidden",op=P.forwardRef((e,t)=>y.jsx(kt.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));op.displayName=Tq;var Iq=op,Zb="ToastProvider",[Yb,Nq,Pq]=Qb("Toast"),[OA,jX]=Oi("Toast",[Pq]),[Aq,Sg]=OA(Zb),DA=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:a}=e,[o,l]=P.useState(null),[u,c]=P.useState(0),f=P.useRef(!1),p=P.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Zb}\`. Expected non-empty \`string\`.`),y.jsx(Yb.Provider,{scope:t,children:y.jsx(Aq,{scope:t,label:r,duration:n,swipeDirection:i,swipeThreshold:s,toastCount:u,viewport:o,onViewportChange:l,onToastAdd:P.useCallback(()=>c(w=>w+1),[]),onToastRemove:P.useCallback(()=>c(w=>w-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:a})})};DA.displayName=Zb;var jA="ToastViewport",Rq=["F8"],sw="toast.viewportPause",aw="toast.viewportResume",MA=P.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Rq,label:i="Notifications ({hotkey})",...s}=e,a=Sg(jA,r),o=Nq(r),l=P.useRef(null),u=P.useRef(null),c=P.useRef(null),f=P.useRef(null),p=or(t,f,a.onViewportChange),w=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),x=a.toastCount>0;P.useEffect(()=>{const C=b=>{var S;n.length!==0&&n.every(E=>b[E]||b.code===E)&&((S=f.current)==null||S.focus())};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[n]),P.useEffect(()=>{const C=l.current,b=f.current;if(x&&C&&b){const g=()=>{if(!a.isClosePausedRef.current){const M=new CustomEvent(sw);b.dispatchEvent(M),a.isClosePausedRef.current=!0}},S=()=>{if(a.isClosePausedRef.current){const M=new CustomEvent(aw);b.dispatchEvent(M),a.isClosePausedRef.current=!1}},E=M=>{!C.contains(M.relatedTarget)&&S()},A=()=>{C.contains(document.activeElement)||S()};return C.addEventListener("focusin",g),C.addEventListener("focusout",E),C.addEventListener("pointermove",g),C.addEventListener("pointerleave",A),window.addEventListener("blur",g),window.addEventListener("focus",S),()=>{C.removeEventListener("focusin",g),C.removeEventListener("focusout",E),C.removeEventListener("pointermove",g),C.removeEventListener("pointerleave",A),window.removeEventListener("blur",g),window.removeEventListener("focus",S)}}},[x,a.isClosePausedRef]);const v=P.useCallback(({tabbingDirection:C})=>{const g=o().map(S=>{const E=S.ref.current,A=[E,...Kq(E)];return C==="forwards"?A:A.reverse()});return(C==="forwards"?g.reverse():g).flat()},[o]);return P.useEffect(()=>{const C=f.current;if(C){const b=g=>{var A,M,D;const S=g.altKey||g.ctrlKey||g.metaKey;if(g.key==="Tab"&&!S){const I=document.activeElement,U=g.shiftKey;if(g.target===C&&U){(A=u.current)==null||A.focus();return}const X=v({tabbingDirection:U?"backwards":"forwards"}),ie=X.findIndex(j=>j===I);Dy(X.slice(ie+1))?g.preventDefault():U?(M=u.current)==null||M.focus():(D=c.current)==null||D.focus()}};return C.addEventListener("keydown",b),()=>C.removeEventListener("keydown",b)}},[o,v]),y.jsxs(_q,{ref:l,role:"region","aria-label":i.replace("{hotkey}",w),tabIndex:-1,style:{pointerEvents:x?void 0:"none"},children:[x&&y.jsx(ow,{ref:u,onFocusFromOutsideViewport:()=>{const C=v({tabbingDirection:"forwards"});Dy(C)}}),y.jsx(Yb.Slot,{scope:r,children:y.jsx(kt.ol,{tabIndex:-1,...s,ref:p})}),x&&y.jsx(ow,{ref:c,onFocusFromOutsideViewport:()=>{const C=v({tabbingDirection:"backwards"});Dy(C)}})]})});MA.displayName=jA;var zA="ToastFocusProxy",ow=P.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...i}=e,s=Sg(zA,r);return y.jsx(op,{"aria-hidden":!0,tabIndex:0,...i,ref:t,style:{position:"fixed"},onFocus:a=>{var u;const o=a.relatedTarget;!((u=s.viewport)!=null&&u.contains(o))&&n()}})});ow.displayName=zA;var Cg="Toast",Oq="toast.swipeStart",Dq="toast.swipeMove",jq="toast.swipeCancel",Mq="toast.swipeEnd",FA=P.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:i,onOpenChange:s,...a}=e,[o=!0,l]=vo({prop:n,defaultProp:i,onChange:s});return y.jsx(No,{present:r||o,children:y.jsx(Lq,{open:o,...a,ref:t,onClose:()=>l(!1),onPause:Xn(e.onPause),onResume:Xn(e.onResume),onSwipeStart:ht(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ht(e.onSwipeMove,u=>{const{x:c,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:ht(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ht(e.onSwipeEnd,u=>{const{x:c,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),l(!1)})})})});FA.displayName=Cg;var[zq,Fq]=OA(Cg,{onClose(){}}),Lq=P.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:i,open:s,onClose:a,onEscapeKeyDown:o,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:w,...x}=e,v=Sg(Cg,r),[C,b]=P.useState(null),g=or(t,j=>b(j)),S=P.useRef(null),E=P.useRef(null),A=i||v.duration,M=P.useRef(0),D=P.useRef(A),I=P.useRef(0),{onToastAdd:U,onToastRemove:Z}=v,ue=Xn(()=>{var le;(C==null?void 0:C.contains(document.activeElement))&&((le=v.viewport)==null||le.focus()),a()}),X=P.useCallback(j=>{!j||j===1/0||(window.clearTimeout(I.current),M.current=new Date().getTime(),I.current=window.setTimeout(ue,j))},[ue]);P.useEffect(()=>{const j=v.viewport;if(j){const le=()=>{X(D.current),u==null||u()},ne=()=>{const ce=new Date().getTime()-M.current;D.current=D.current-ce,window.clearTimeout(I.current),l==null||l()};return j.addEventListener(sw,ne),j.addEventListener(aw,le),()=>{j.removeEventListener(sw,ne),j.removeEventListener(aw,le)}}},[v.viewport,A,l,u,X]),P.useEffect(()=>{s&&!v.isClosePausedRef.current&&X(A)},[s,A,v.isClosePausedRef,X]),P.useEffect(()=>(U(),()=>Z()),[U,Z]);const ie=P.useMemo(()=>C?KA(C):null,[C]);return v.viewport?y.jsxs(y.Fragment,{children:[ie&&y.jsx(Bq,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ie}),y.jsx(zq,{scope:r,onClose:ue,children:Fl.createPortal(y.jsx(Yb.ItemSlot,{scope:r,children:y.jsx(xq,{asChild:!0,onEscapeKeyDown:ht(o,()=>{v.isFocusedToastEscapeKeyDownRef.current||ue(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:y.jsx(kt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":v.swipeDirection,...x,ref:g,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ht(e.onKeyDown,j=>{j.key==="Escape"&&(o==null||o(j.nativeEvent),j.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,ue()))}),onPointerDown:ht(e.onPointerDown,j=>{j.button===0&&(S.current={x:j.clientX,y:j.clientY})}),onPointerMove:ht(e.onPointerMove,j=>{if(!S.current)return;const le=j.clientX-S.current.x,ne=j.clientY-S.current.y,ce=!!E.current,W=["left","right"].includes(v.swipeDirection),F=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,H=W?F(0,le):0,B=W?0:F(0,ne),ee=j.pointerType==="touch"?10:2,me={x:H,y:B},K={originalEvent:j,delta:me};ce?(E.current=me,ah(Dq,f,K,{discrete:!1})):u$(me,v.swipeDirection,ee)?(E.current=me,ah(Oq,c,K,{discrete:!1}),j.target.setPointerCapture(j.pointerId)):(Math.abs(le)>ee||Math.abs(ne)>ee)&&(S.current=null)}),onPointerUp:ht(e.onPointerUp,j=>{const le=E.current,ne=j.target;if(ne.hasPointerCapture(j.pointerId)&&ne.releasePointerCapture(j.pointerId),E.current=null,S.current=null,le){const ce=j.currentTarget,W={originalEvent:j,delta:le};u$(le,v.swipeDirection,v.swipeThreshold)?ah(Mq,w,W,{discrete:!0}):ah(jq,p,W,{discrete:!0}),ce.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),Bq=e=>{const{__scopeToast:t,children:r,...n}=e,i=Sg(Cg,t),[s,a]=P.useState(!1),[o,l]=P.useState(!1);return qq(()=>a(!0)),P.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),o?null:y.jsx($g,{asChild:!0,children:y.jsx(op,{...n,children:s&&y.jsxs(y.Fragment,{children:[i.label," ",r]})})})},Uq="ToastTitle",LA=P.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return y.jsx(kt.div,{...n,ref:t})});LA.displayName=Uq;var Vq="ToastDescription",BA=P.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return y.jsx(kt.div,{...n,ref:t})});BA.displayName=Vq;var UA="ToastAction",VA=P.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?y.jsx(WA,{altText:r,asChild:!0,children:y.jsx(Xb,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${UA}\`. Expected non-empty \`string\`.`),null)});VA.displayName=UA;var qA="ToastClose",Xb=P.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,i=Fq(qA,r);return y.jsx(WA,{asChild:!0,children:y.jsx(kt.button,{type:"button",...n,ref:t,onClick:ht(e.onClick,i.onClose)})})});Xb.displayName=qA;var WA=P.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...i}=e;return y.jsx(kt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...i,ref:t})});function KA(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Wq(n)){const i=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!i)if(s){const a=n.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...KA(n))}}),t}function ah(e,t,r,{discrete:n}){const i=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?NA(i,s):i.dispatchEvent(s)}var u$=(e,t,r=0)=>{const n=Math.abs(e.x),i=Math.abs(e.y),s=n>i;return t==="left"||t==="right"?s&&n>r:!s&&i>r};function qq(e=()=>{}){const t=Xn(e);En(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Wq(e){return e.nodeType===e.ELEMENT_NODE}function Kq(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Dy(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Hq=DA,HA=MA,GA=FA,QA=LA,ZA=BA,YA=VA,XA=Xb;function JA(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=JA(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function eR(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=JA(e))&&(n&&(n+=" "),n+=t);return n}const c$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,d$=eR,kg=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return d$(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:s}=t,a=Object.keys(i).map(u=>{const c=r==null?void 0:r[u],f=s==null?void 0:s[u];if(c===null)return null;const p=c$(c)||c$(f);return i[u][p]}),o=r&&Object.entries(r).reduce((u,c)=>{let[f,p]=c;return p===void 0||(u[f]=p),u},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,c)=>{let{class:f,className:p,...w}=c;return Object.entries(w).every(x=>{let[v,C]=x;return Array.isArray(C)?C.includes({...s,...o}[v]):{...s,...o}[v]===C})?[...u,f,p]:u},[]);return d$(e,a,l,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gq=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tR=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qq={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zq=P.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},l)=>P.createElement("svg",{ref:l,...Qq,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:tR("lucide",i),...o},[...a.map(([u,c])=>P.createElement(u,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=(e,t)=>{const r=P.forwardRef(({className:n,...i},s)=>P.createElement(Zq,{ref:s,iconNode:t,className:tR(`lucide-${Gq(e)}`,n),...i}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=Ur("Cable",[["path",{d:"M17 21v-2a1 1 0 0 1-1-1v-1a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1",key:"10bnsj"}],["path",{d:"M19 15V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V9",key:"1eqmu1"}],["path",{d:"M21 21v-2h-4",key:"14zm7j"}],["path",{d:"M3 5h4V3",key:"z442eg"}],["path",{d:"M7 5a1 1 0 0 1 1 1v1a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1V3",key:"ebdjd7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yq=Ur("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Ur("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=Ur("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=Ur("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xq=Ur("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=Ur("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jq=Ur("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=Ur("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t8=Ur("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=Ur("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=Ur("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Ur("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=Ur("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=Ur("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p$=Ur("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=Ur("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=Ur("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=Ur("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h$=Ur("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=Ur("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ex="-",s8=e=>{const t=o8(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:a=>{const o=a.split(ex);return o[0]===""&&o.length!==1&&o.shift(),lR(o,t)||a8(a)},getConflictingClassGroupIds:(a,o)=>{const l=r[a]||[];return o&&n[a]?[...l,...n[a]]:l}}},lR=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?lR(e.slice(1),n):void 0;if(i)return i;if(t.validators.length===0)return;const s=e.join(ex);return(a=t.validators.find(({validator:o})=>o(s)))==null?void 0:a.classGroupId},m$=/^\[(.+)\]$/,a8=e=>{if(m$.test(e)){const t=m$.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},o8=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return u8(Object.entries(e.classGroups),r).forEach(([s,a])=>{lw(a,n,s,t)}),n},lw=(e,t,r,n)=>{e.forEach(i=>{if(typeof i=="string"){const s=i===""?t:g$(t,i);s.classGroupId=r;return}if(typeof i=="function"){if(l8(i)){lw(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([s,a])=>{lw(a,g$(t,s),r,n)})})},g$=(e,t)=>{let r=e;return t.split(ex).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},l8=e=>e.isThemeGetter,u8=(e,t)=>t?e.map(([r,n])=>{const i=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,o])=>[t+a,o])):s);return[r,i]}):e,c8=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const i=(s,a)=>{r.set(s,a),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let a=r.get(s);if(a!==void 0)return a;if((a=n.get(s))!==void 0)return i(s,a),a},set(s,a){r.has(s)?r.set(s,a):i(s,a)}}},uR="!",d8=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,i=t[0],s=t.length,a=o=>{const l=[];let u=0,c=0,f;for(let C=0;C<o.length;C++){let b=o[C];if(u===0){if(b===i&&(n||o.slice(C,C+s)===t)){l.push(o.slice(c,C)),c=C+s;continue}if(b==="/"){f=C;continue}}b==="["?u++:b==="]"&&u--}const p=l.length===0?o:o.substring(c),w=p.startsWith(uR),x=w?p.substring(1):p,v=f&&f>c?f-c:void 0;return{modifiers:l,hasImportantModifier:w,baseClassName:x,maybePostfixModifierPosition:v}};return r?o=>r({className:o,parseClassName:a}):a},f8=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},p8=e=>({cache:c8(e.cacheSize),parseClassName:d8(e),...s8(e)}),h8=/\s+/,m8=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,s=[],a=e.trim().split(h8);let o="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{modifiers:c,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:w}=r(u);let x=!!w,v=n(x?p.substring(0,w):p);if(!v){if(!x){o=u+(o.length>0?" "+o:o);continue}if(v=n(p),!v){o=u+(o.length>0?" "+o:o);continue}x=!1}const C=f8(c).join(":"),b=f?C+uR:C,g=b+v;if(s.includes(g))continue;s.push(g);const S=i(v,x);for(let E=0;E<S.length;++E){const A=S[E];s.push(b+A)}o=u+(o.length>0?" "+o:o)}return o};function g8(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=cR(t))&&(n&&(n+=" "),n+=r);return n}const cR=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=cR(e[n]))&&(r&&(r+=" "),r+=t);return r};function y8(e,...t){let r,n,i,s=a;function a(l){const u=t.reduce((c,f)=>f(c),e());return r=p8(u),n=r.cache.get,i=r.cache.set,s=o,o(l)}function o(l){const u=n(l);if(u)return u;const c=m8(l,r);return i(l,c),c}return function(){return s(g8.apply(null,arguments))}}const br=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},dR=/^\[(?:([a-z-]+):)?(.+)\]$/i,v8=/^\d+\/\d+$/,w8=new Set(["px","full","screen"]),b8=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,x8=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,_8=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,$8=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,S8=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ia=e=>Vu(e)||w8.has(e)||v8.test(e),ja=e=>Pc(e,"length",A8),Vu=e=>!!e&&!Number.isNaN(Number(e)),jy=e=>Pc(e,"number",Vu),yd=e=>!!e&&Number.isInteger(Number(e)),C8=e=>e.endsWith("%")&&Vu(e.slice(0,-1)),Ot=e=>dR.test(e),Ma=e=>b8.test(e),k8=new Set(["length","size","percentage"]),E8=e=>Pc(e,k8,fR),T8=e=>Pc(e,"position",fR),I8=new Set(["image","url"]),N8=e=>Pc(e,I8,O8),P8=e=>Pc(e,"",R8),vd=()=>!0,Pc=(e,t,r)=>{const n=dR.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},A8=e=>x8.test(e)&&!_8.test(e),fR=()=>!1,R8=e=>$8.test(e),O8=e=>S8.test(e),D8=()=>{const e=br("colors"),t=br("spacing"),r=br("blur"),n=br("brightness"),i=br("borderColor"),s=br("borderRadius"),a=br("borderSpacing"),o=br("borderWidth"),l=br("contrast"),u=br("grayscale"),c=br("hueRotate"),f=br("invert"),p=br("gap"),w=br("gradientColorStops"),x=br("gradientColorStopPositions"),v=br("inset"),C=br("margin"),b=br("opacity"),g=br("padding"),S=br("saturate"),E=br("scale"),A=br("sepia"),M=br("skew"),D=br("space"),I=br("translate"),U=()=>["auto","contain","none"],Z=()=>["auto","hidden","clip","visible","scroll"],ue=()=>["auto",Ot,t],X=()=>[Ot,t],ie=()=>["",ia,ja],j=()=>["auto",Vu,Ot],le=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ne=()=>["solid","dashed","dotted","double","none"],ce=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",Ot],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],B=()=>[Vu,Ot];return{cacheSize:500,separator:":",theme:{colors:[vd],spacing:[ia,ja],blur:["none","",Ma,Ot],brightness:B(),borderColor:[e],borderRadius:["none","","full",Ma,Ot],borderSpacing:X(),borderWidth:ie(),contrast:B(),grayscale:F(),hueRotate:B(),invert:F(),gap:X(),gradientColorStops:[e],gradientColorStopPositions:[C8,ja],inset:ue(),margin:ue(),opacity:B(),padding:X(),saturate:B(),scale:B(),sepia:F(),skew:B(),space:X(),translate:X()},classGroups:{aspect:[{aspect:["auto","square","video",Ot]}],container:["container"],columns:[{columns:[Ma]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...le(),Ot]}],overflow:[{overflow:Z()}],"overflow-x":[{"overflow-x":Z()}],"overflow-y":[{"overflow-y":Z()}],overscroll:[{overscroll:U()}],"overscroll-x":[{"overscroll-x":U()}],"overscroll-y":[{"overscroll-y":U()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",yd,Ot]}],basis:[{basis:ue()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ot]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",yd,Ot]}],"grid-cols":[{"grid-cols":[vd]}],"col-start-end":[{col:["auto",{span:["full",yd,Ot]},Ot]}],"col-start":[{"col-start":j()}],"col-end":[{"col-end":j()}],"grid-rows":[{"grid-rows":[vd]}],"row-start-end":[{row:["auto",{span:[yd,Ot]},Ot]}],"row-start":[{"row-start":j()}],"row-end":[{"row-end":j()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ot]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ot]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...W()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...W(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...W(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ot,t]}],"min-w":[{"min-w":[Ot,t,"min","max","fit"]}],"max-w":[{"max-w":[Ot,t,"none","full","min","max","fit","prose",{screen:[Ma]},Ma]}],h:[{h:[Ot,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ot,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ot,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ot,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ma,ja]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",jy]}],"font-family":[{font:[vd]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ot]}],"line-clamp":[{"line-clamp":["none",Vu,jy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ia,Ot]}],"list-image":[{"list-image":["none",Ot]}],"list-style-type":[{list:["none","disc","decimal",Ot]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ia,ja]}],"underline-offset":[{"underline-offset":["auto",ia,Ot]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:X()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ot]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ot]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...le(),T8]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",E8]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},N8]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...ne(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:ne()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...ne()]}],"outline-offset":[{"outline-offset":[ia,Ot]}],"outline-w":[{outline:[ia,ja]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ie()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[ia,ja]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ma,P8]}],"shadow-color":[{shadow:[vd]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...ce(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ce()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ma,Ot]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[f]}],saturate:[{saturate:[S]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ot]}],duration:[{duration:B()}],ease:[{ease:["linear","in","out","in-out",Ot]}],delay:[{delay:B()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ot]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[yd,Ot]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ot]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ot]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":X()}],"scroll-mx":[{"scroll-mx":X()}],"scroll-my":[{"scroll-my":X()}],"scroll-ms":[{"scroll-ms":X()}],"scroll-me":[{"scroll-me":X()}],"scroll-mt":[{"scroll-mt":X()}],"scroll-mr":[{"scroll-mr":X()}],"scroll-mb":[{"scroll-mb":X()}],"scroll-ml":[{"scroll-ml":X()}],"scroll-p":[{"scroll-p":X()}],"scroll-px":[{"scroll-px":X()}],"scroll-py":[{"scroll-py":X()}],"scroll-ps":[{"scroll-ps":X()}],"scroll-pe":[{"scroll-pe":X()}],"scroll-pt":[{"scroll-pt":X()}],"scroll-pr":[{"scroll-pr":X()}],"scroll-pb":[{"scroll-pb":X()}],"scroll-pl":[{"scroll-pl":X()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ot]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ia,ja,jy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},j8=y8(D8);function ft(...e){return j8(eR(e))}const M8=Hq,pR=P.forwardRef(({className:e,...t},r)=>y.jsx(HA,{ref:r,className:ft("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));pR.displayName=HA.displayName;const z8=kg("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),hR=P.forwardRef(({className:e,variant:t,...r},n)=>y.jsx(GA,{ref:n,className:ft(z8({variant:t}),e),...r}));hR.displayName=GA.displayName;const F8=P.forwardRef(({className:e,...t},r)=>y.jsx(YA,{ref:r,className:ft("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));F8.displayName=YA.displayName;const mR=P.forwardRef(({className:e,...t},r)=>y.jsx(XA,{ref:r,className:ft("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:y.jsx(Rf,{className:"h-4 w-4"})}));mR.displayName=XA.displayName;const gR=P.forwardRef(({className:e,...t},r)=>y.jsx(QA,{ref:r,className:ft("text-sm font-semibold",e),...t}));gR.displayName=QA.displayName;const yR=P.forwardRef(({className:e,...t},r)=>y.jsx(ZA,{ref:r,className:ft("text-sm opacity-90",e),...t}));yR.displayName=ZA.displayName;function L8(){const{toasts:e}=_g();return y.jsxs(M8,{children:[e.map(function({id:t,title:r,description:n,action:i,...s}){return y.jsxs(hR,{...s,children:[y.jsxs("div",{className:"grid gap-1",children:[r&&y.jsx(gR,{children:r}),n&&y.jsx(yR,{children:n})]}),i,y.jsx(mR,{})]},t)}),y.jsx(pR,{})]})}var B8=QN[" useId ".trim().toString()]||(()=>{}),U8=0;function ho(e){const[t,r]=P.useState(B8());return En(()=>{e||r(n=>n??String(U8++))},[e]),e||(t?`radix-${t}`:"")}const V8=["top","right","bottom","left"],wo=Math.min,li=Math.max,Sm=Math.round,oh=Math.floor,zs=e=>({x:e,y:e}),q8={left:"right",right:"left",bottom:"top",top:"bottom"},W8={start:"end",end:"start"};function uw(e,t,r){return li(e,wo(t,r))}function Sa(e,t){return typeof e=="function"?e(t):e}function Ca(e){return e.split("-")[0]}function Ac(e){return e.split("-")[1]}function tx(e){return e==="x"?"y":"x"}function rx(e){return e==="y"?"height":"width"}function bo(e){return["top","bottom"].includes(Ca(e))?"y":"x"}function nx(e){return tx(bo(e))}function K8(e,t,r){r===void 0&&(r=!1);const n=Ac(e),i=nx(e),s=rx(i);let a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=Cm(a)),[a,Cm(a)]}function H8(e){const t=Cm(e);return[cw(e),t,cw(t)]}function cw(e){return e.replace(/start|end/g,t=>W8[t])}function G8(e,t,r){const n=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return r?t?i:n:t?n:i;case"left":case"right":return t?s:a;default:return[]}}function Q8(e,t,r,n){const i=Ac(e);let s=G8(Ca(e),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),t&&(s=s.concat(s.map(cw)))),s}function Cm(e){return e.replace(/left|right|bottom|top/g,t=>q8[t])}function Z8(e){return{top:0,right:0,bottom:0,left:0,...e}}function vR(e){return typeof e!="number"?Z8(e):{top:e,right:e,bottom:e,left:e}}function km(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function y$(e,t,r){let{reference:n,floating:i}=e;const s=bo(t),a=nx(t),o=rx(a),l=Ca(t),u=s==="y",c=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,p=n[o]/2-i[o]/2;let w;switch(l){case"top":w={x:c,y:n.y-i.height};break;case"bottom":w={x:c,y:n.y+n.height};break;case"right":w={x:n.x+n.width,y:f};break;case"left":w={x:n.x-i.width,y:f};break;default:w={x:n.x,y:n.y}}switch(Ac(t)){case"start":w[a]-=p*(r&&u?-1:1);break;case"end":w[a]+=p*(r&&u?-1:1);break}return w}const Y8=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:f}=y$(u,n,l),p=n,w={},x=0;for(let v=0;v<o.length;v++){const{name:C,fn:b}=o[v],{x:g,y:S,data:E,reset:A}=await b({x:c,y:f,initialPlacement:n,placement:p,strategy:i,middlewareData:w,rects:u,platform:a,elements:{reference:e,floating:t}});c=g??c,f=S??f,w={...w,[C]:{...w[C],...E}},A&&x<=50&&(x++,typeof A=="object"&&(A.placement&&(p=A.placement),A.rects&&(u=A.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):A.rects),{x:c,y:f}=y$(u,p,l)),v=-1)}return{x:c,y:f,placement:p,strategy:i,middlewareData:w}};async function Of(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:f="floating",altBoundary:p=!1,padding:w=0}=Sa(t,e),x=vR(w),C=o[p?f==="floating"?"reference":"floating":f],b=km(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(C)))==null||r?C:C.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),g=f==="floating"?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),E=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},A=km(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:g,offsetParent:S,strategy:l}):g);return{top:(b.top-A.top+x.top)/E.y,bottom:(A.bottom-b.bottom+x.bottom)/E.y,left:(b.left-A.left+x.left)/E.x,right:(A.right-b.right+x.right)/E.x}}const X8=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:u,padding:c=0}=Sa(e,t)||{};if(u==null)return{};const f=vR(c),p={x:r,y:n},w=nx(i),x=rx(w),v=await a.getDimensions(u),C=w==="y",b=C?"top":"left",g=C?"bottom":"right",S=C?"clientHeight":"clientWidth",E=s.reference[x]+s.reference[w]-p[w]-s.floating[x],A=p[w]-s.reference[w],M=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let D=M?M[S]:0;(!D||!await(a.isElement==null?void 0:a.isElement(M)))&&(D=o.floating[S]||s.floating[x]);const I=E/2-A/2,U=D/2-v[x]/2-1,Z=wo(f[b],U),ue=wo(f[g],U),X=Z,ie=D-v[x]-ue,j=D/2-v[x]/2+I,le=uw(X,j,ie),ne=!l.arrow&&Ac(i)!=null&&j!==le&&s.reference[x]/2-(j<X?Z:ue)-v[x]/2<0,ce=ne?j<X?j-X:j-ie:0;return{[w]:p[w]+ce,data:{[w]:le,centerOffset:j-le-ce,...ne&&{alignmentOffset:ce}},reset:ne}}}),J8=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:u}=t,{mainAxis:c=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:v=!0,...C}=Sa(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const b=Ca(i),g=bo(o),S=Ca(o)===o,E=await(l.isRTL==null?void 0:l.isRTL(u.floating)),A=p||(S||!v?[Cm(o)]:H8(o)),M=x!=="none";!p&&M&&A.push(...Q8(o,v,x,E));const D=[o,...A],I=await Of(t,C),U=[];let Z=((n=s.flip)==null?void 0:n.overflows)||[];if(c&&U.push(I[b]),f){const j=K8(i,a,E);U.push(I[j[0]],I[j[1]])}if(Z=[...Z,{placement:i,overflows:U}],!U.every(j=>j<=0)){var ue,X;const j=(((ue=s.flip)==null?void 0:ue.index)||0)+1,le=D[j];if(le)return{data:{index:j,overflows:Z},reset:{placement:le}};let ne=(X=Z.filter(ce=>ce.overflows[0]<=0).sort((ce,W)=>ce.overflows[1]-W.overflows[1])[0])==null?void 0:X.placement;if(!ne)switch(w){case"bestFit":{var ie;const ce=(ie=Z.filter(W=>{if(M){const F=bo(W.placement);return F===g||F==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(F=>F>0).reduce((F,H)=>F+H,0)]).sort((W,F)=>W[1]-F[1])[0])==null?void 0:ie[0];ce&&(ne=ce);break}case"initialPlacement":ne=o;break}if(i!==ne)return{reset:{placement:ne}}}return{}}}};function v$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function w$(e){return V8.some(t=>e[t]>=0)}const eW=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...i}=Sa(e,t);switch(n){case"referenceHidden":{const s=await Of(t,{...i,elementContext:"reference"}),a=v$(s,r.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:w$(a)}}}case"escaped":{const s=await Of(t,{...i,altBoundary:!0}),a=v$(s,r.floating);return{data:{escapedOffsets:a,escaped:w$(a)}}}default:return{}}}}};async function tW(e,t){const{placement:r,platform:n,elements:i}=e,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),a=Ca(r),o=Ac(r),l=bo(r)==="y",u=["left","top"].includes(a)?-1:1,c=s&&l?-1:1,f=Sa(t,e);let{mainAxis:p,crossAxis:w,alignmentAxis:x}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof x=="number"&&(w=o==="end"?x*-1:x),l?{x:w*c,y:p*u}:{x:p*u,y:w*c}}const rW=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:s,placement:a,middlewareData:o}=t,l=await tW(t,e);return a===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},nW=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:C=>{let{x:b,y:g}=C;return{x:b,y:g}}},...l}=Sa(e,t),u={x:r,y:n},c=await Of(t,l),f=bo(Ca(i)),p=tx(f);let w=u[p],x=u[f];if(s){const C=p==="y"?"top":"left",b=p==="y"?"bottom":"right",g=w+c[C],S=w-c[b];w=uw(g,w,S)}if(a){const C=f==="y"?"top":"left",b=f==="y"?"bottom":"right",g=x+c[C],S=x-c[b];x=uw(g,x,S)}const v=o.fn({...t,[p]:w,[f]:x});return{...v,data:{x:v.x-r,y:v.y-n,enabled:{[p]:s,[f]:a}}}}}},iW=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=Sa(e,t),c={x:r,y:n},f=bo(i),p=tx(f);let w=c[p],x=c[f];const v=Sa(o,t),C=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(l){const S=p==="y"?"height":"width",E=s.reference[p]-s.floating[S]+C.mainAxis,A=s.reference[p]+s.reference[S]-C.mainAxis;w<E?w=E:w>A&&(w=A)}if(u){var b,g;const S=p==="y"?"width":"height",E=["top","left"].includes(Ca(i)),A=s.reference[f]-s.floating[S]+(E&&((b=a.offset)==null?void 0:b[f])||0)+(E?0:C.crossAxis),M=s.reference[f]+s.reference[S]+(E?0:((g=a.offset)==null?void 0:g[f])||0)-(E?C.crossAxis:0);x<A?x=A:x>M&&(x=M)}return{[p]:w,[f]:x}}}},sW=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:s,platform:a,elements:o}=t,{apply:l=()=>{},...u}=Sa(e,t),c=await Of(t,u),f=Ca(i),p=Ac(i),w=bo(i)==="y",{width:x,height:v}=s.floating;let C,b;f==="top"||f==="bottom"?(C=f,b=p===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(b=f,C=p==="end"?"top":"bottom");const g=v-c.top-c.bottom,S=x-c.left-c.right,E=wo(v-c[C],g),A=wo(x-c[b],S),M=!t.middlewareData.shift;let D=E,I=A;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(I=S),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(D=g),M&&!p){const Z=li(c.left,0),ue=li(c.right,0),X=li(c.top,0),ie=li(c.bottom,0);w?I=x-2*(Z!==0||ue!==0?Z+ue:li(c.left,c.right)):D=v-2*(X!==0||ie!==0?X+ie:li(c.top,c.bottom))}await l({...t,availableWidth:I,availableHeight:D});const U=await a.getDimensions(o.floating);return x!==U.width||v!==U.height?{reset:{rects:!0}}:{}}}};function Eg(){return typeof window<"u"}function Rc(e){return wR(e)?(e.nodeName||"").toLowerCase():"#document"}function pi(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ks(e){var t;return(t=(wR(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function wR(e){return Eg()?e instanceof Node||e instanceof pi(e).Node:!1}function ps(e){return Eg()?e instanceof Element||e instanceof pi(e).Element:!1}function Bs(e){return Eg()?e instanceof HTMLElement||e instanceof pi(e).HTMLElement:!1}function b$(e){return!Eg()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof pi(e).ShadowRoot}function lp(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=hs(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function aW(e){return["table","td","th"].includes(Rc(e))}function Tg(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function ix(e){const t=sx(),r=ps(e)?hs(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function oW(e){let t=xo(e);for(;Bs(t)&&!vc(t);){if(ix(t))return t;if(Tg(t))return null;t=xo(t)}return null}function sx(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function vc(e){return["html","body","#document"].includes(Rc(e))}function hs(e){return pi(e).getComputedStyle(e)}function Ig(e){return ps(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function xo(e){if(Rc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||b$(e)&&e.host||Ks(e);return b$(t)?t.host:t}function bR(e){const t=xo(e);return vc(t)?e.ownerDocument?e.ownerDocument.body:e.body:Bs(t)&&lp(t)?t:bR(t)}function Df(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=bR(e),s=i===((n=e.ownerDocument)==null?void 0:n.body),a=pi(i);if(s){const o=dw(a);return t.concat(a,a.visualViewport||[],lp(i)?i:[],o&&r?Df(o):[])}return t.concat(i,Df(i,[],r))}function dw(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function xR(e){const t=hs(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=Bs(e),s=i?e.offsetWidth:r,a=i?e.offsetHeight:n,o=Sm(r)!==s||Sm(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function ax(e){return ps(e)?e:e.contextElement}function qu(e){const t=ax(e);if(!Bs(t))return zs(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:s}=xR(t);let a=(s?Sm(r.width):r.width)/n,o=(s?Sm(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const lW=zs(0);function _R(e){const t=pi(e);return!sx()||!t.visualViewport?lW:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function uW(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==pi(e)?!1:t}function Tl(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),s=ax(e);let a=zs(1);t&&(n?ps(n)&&(a=qu(n)):a=qu(e));const o=uW(s,r,n)?_R(s):zs(0);let l=(i.left+o.x)/a.x,u=(i.top+o.y)/a.y,c=i.width/a.x,f=i.height/a.y;if(s){const p=pi(s),w=n&&ps(n)?pi(n):n;let x=p,v=dw(x);for(;v&&n&&w!==x;){const C=qu(v),b=v.getBoundingClientRect(),g=hs(v),S=b.left+(v.clientLeft+parseFloat(g.paddingLeft))*C.x,E=b.top+(v.clientTop+parseFloat(g.paddingTop))*C.y;l*=C.x,u*=C.y,c*=C.x,f*=C.y,l+=S,u+=E,x=pi(v),v=dw(x)}}return km({width:c,height:f,x:l,y:u})}function ox(e,t){const r=Ig(e).scrollLeft;return t?t.left+r:Tl(Ks(e)).left+r}function $R(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=n.left+t.scrollLeft-(r?0:ox(e,n)),s=n.top+t.scrollTop;return{x:i,y:s}}function cW(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const s=i==="fixed",a=Ks(n),o=t?Tg(t.floating):!1;if(n===a||o&&s)return r;let l={scrollLeft:0,scrollTop:0},u=zs(1);const c=zs(0),f=Bs(n);if((f||!f&&!s)&&((Rc(n)!=="body"||lp(a))&&(l=Ig(n)),Bs(n))){const w=Tl(n);u=qu(n),c.x=w.x+n.clientLeft,c.y=w.y+n.clientTop}const p=a&&!f&&!s?$R(a,l,!0):zs(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-l.scrollLeft*u.x+c.x+p.x,y:r.y*u.y-l.scrollTop*u.y+c.y+p.y}}function dW(e){return Array.from(e.getClientRects())}function fW(e){const t=Ks(e),r=Ig(e),n=e.ownerDocument.body,i=li(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=li(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+ox(e);const o=-r.scrollTop;return hs(n).direction==="rtl"&&(a+=li(t.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function pW(e,t){const r=pi(e),n=Ks(e),i=r.visualViewport;let s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const u=sx();(!u||u&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function hW(e,t){const r=Tl(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,s=Bs(e)?qu(e):zs(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=i*s.x,u=n*s.y;return{width:a,height:o,x:l,y:u}}function x$(e,t,r){let n;if(t==="viewport")n=pW(e,r);else if(t==="document")n=fW(Ks(e));else if(ps(t))n=hW(t,r);else{const i=_R(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return km(n)}function SR(e,t){const r=xo(e);return r===t||!ps(r)||vc(r)?!1:hs(r).position==="fixed"||SR(r,t)}function mW(e,t){const r=t.get(e);if(r)return r;let n=Df(e,[],!1).filter(o=>ps(o)&&Rc(o)!=="body"),i=null;const s=hs(e).position==="fixed";let a=s?xo(e):e;for(;ps(a)&&!vc(a);){const o=hs(a),l=ix(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||lp(a)&&!l&&SR(e,a))?n=n.filter(c=>c!==a):i=o,a=xo(a)}return t.set(e,n),n}function gW(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const a=[...r==="clippingAncestors"?Tg(t)?[]:mW(t,this._c):[].concat(r),n],o=a[0],l=a.reduce((u,c)=>{const f=x$(t,c,i);return u.top=li(f.top,u.top),u.right=wo(f.right,u.right),u.bottom=wo(f.bottom,u.bottom),u.left=li(f.left,u.left),u},x$(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function yW(e){const{width:t,height:r}=xR(e);return{width:t,height:r}}function vW(e,t,r){const n=Bs(t),i=Ks(t),s=r==="fixed",a=Tl(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=zs(0);if(n||!n&&!s)if((Rc(t)!=="body"||lp(i))&&(o=Ig(t)),n){const p=Tl(t,!0,s,t);l.x=p.x+t.clientLeft,l.y=p.y+t.clientTop}else i&&(l.x=ox(i));const u=i&&!n&&!s?$R(i,o):zs(0),c=a.left+o.scrollLeft-l.x-u.x,f=a.top+o.scrollTop-l.y-u.y;return{x:c,y:f,width:a.width,height:a.height}}function My(e){return hs(e).position==="static"}function _$(e,t){if(!Bs(e)||hs(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Ks(e)===r&&(r=r.ownerDocument.body),r}function CR(e,t){const r=pi(e);if(Tg(e))return r;if(!Bs(e)){let i=xo(e);for(;i&&!vc(i);){if(ps(i)&&!My(i))return i;i=xo(i)}return r}let n=_$(e,t);for(;n&&aW(n)&&My(n);)n=_$(n,t);return n&&vc(n)&&My(n)&&!ix(n)?r:n||oW(e)||r}const wW=async function(e){const t=this.getOffsetParent||CR,r=this.getDimensions,n=await r(e.floating);return{reference:vW(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function bW(e){return hs(e).direction==="rtl"}const xW={convertOffsetParentRelativeRectToViewportRelativeRect:cW,getDocumentElement:Ks,getClippingRect:gW,getOffsetParent:CR,getElementRects:wW,getClientRects:dW,getDimensions:yW,getScale:qu,isElement:ps,isRTL:bW};function kR(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function _W(e,t){let r=null,n;const i=Ks(e);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const u=e.getBoundingClientRect(),{left:c,top:f,width:p,height:w}=u;if(o||t(),!p||!w)return;const x=oh(f),v=oh(i.clientWidth-(c+p)),C=oh(i.clientHeight-(f+w)),b=oh(c),S={rootMargin:-x+"px "+-v+"px "+-C+"px "+-b+"px",threshold:li(0,wo(1,l))||1};let E=!0;function A(M){const D=M[0].intersectionRatio;if(D!==l){if(!E)return a();D?a(!1,D):n=setTimeout(()=>{a(!1,1e-7)},1e3)}D===1&&!kR(u,e.getBoundingClientRect())&&a(),E=!1}try{r=new IntersectionObserver(A,{...S,root:i.ownerDocument})}catch{r=new IntersectionObserver(A,S)}r.observe(e)}return a(!0),s}function $W(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=ax(e),c=i||s?[...u?Df(u):[],...Df(t)]:[];c.forEach(b=>{i&&b.addEventListener("scroll",r,{passive:!0}),s&&b.addEventListener("resize",r)});const f=u&&o?_W(u,r):null;let p=-1,w=null;a&&(w=new ResizeObserver(b=>{let[g]=b;g&&g.target===u&&w&&(w.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var S;(S=w)==null||S.observe(t)})),r()}),u&&!l&&w.observe(u),w.observe(t));let x,v=l?Tl(e):null;l&&C();function C(){const b=Tl(e);v&&!kR(v,b)&&r(),v=b,x=requestAnimationFrame(C)}return r(),()=>{var b;c.forEach(g=>{i&&g.removeEventListener("scroll",r),s&&g.removeEventListener("resize",r)}),f==null||f(),(b=w)==null||b.disconnect(),w=null,l&&cancelAnimationFrame(x)}}const SW=rW,CW=nW,kW=J8,EW=sW,TW=eW,$$=X8,IW=iW,NW=(e,t,r)=>{const n=new Map,i={platform:xW,...r},s={...i.platform,_c:n};return Y8(e,t,{...i,platform:s})};var Wh=typeof document<"u"?P.useLayoutEffect:P.useEffect;function Em(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Em(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const s=i[n];if(!(s==="_owner"&&e.$$typeof)&&!Em(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function ER(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function S$(e,t){const r=ER(e);return Math.round(t*r)/r}function zy(e){const t=P.useRef(e);return Wh(()=>{t.current=e}),t}function PW(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:u}=e,[c,f]=P.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[p,w]=P.useState(n);Em(p,n)||w(n);const[x,v]=P.useState(null),[C,b]=P.useState(null),g=P.useCallback(W=>{W!==M.current&&(M.current=W,v(W))},[]),S=P.useCallback(W=>{W!==D.current&&(D.current=W,b(W))},[]),E=s||x,A=a||C,M=P.useRef(null),D=P.useRef(null),I=P.useRef(c),U=l!=null,Z=zy(l),ue=zy(i),X=zy(u),ie=P.useCallback(()=>{if(!M.current||!D.current)return;const W={placement:t,strategy:r,middleware:p};ue.current&&(W.platform=ue.current),NW(M.current,D.current,W).then(F=>{const H={...F,isPositioned:X.current!==!1};j.current&&!Em(I.current,H)&&(I.current=H,Fl.flushSync(()=>{f(H)}))})},[p,t,r,ue,X]);Wh(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,f(W=>({...W,isPositioned:!1})))},[u]);const j=P.useRef(!1);Wh(()=>(j.current=!0,()=>{j.current=!1}),[]),Wh(()=>{if(E&&(M.current=E),A&&(D.current=A),E&&A){if(Z.current)return Z.current(E,A,ie);ie()}},[E,A,ie,Z,U]);const le=P.useMemo(()=>({reference:M,floating:D,setReference:g,setFloating:S}),[g,S]),ne=P.useMemo(()=>({reference:E,floating:A}),[E,A]),ce=P.useMemo(()=>{const W={position:r,left:0,top:0};if(!ne.floating)return W;const F=S$(ne.floating,c.x),H=S$(ne.floating,c.y);return o?{...W,transform:"translate("+F+"px, "+H+"px)",...ER(ne.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:F,top:H}},[r,o,ne.floating,c.x,c.y]);return P.useMemo(()=>({...c,update:ie,refs:le,elements:ne,floatingStyles:ce}),[c,ie,le,ne,ce])}const AW=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?$$({element:n.current,padding:i}).fn(r):{}:n?$$({element:n,padding:i}).fn(r):{}}}},RW=(e,t)=>({...SW(e),options:[e,t]}),OW=(e,t)=>({...CW(e),options:[e,t]}),DW=(e,t)=>({...IW(e),options:[e,t]}),jW=(e,t)=>({...kW(e),options:[e,t]}),MW=(e,t)=>({...EW(e),options:[e,t]}),zW=(e,t)=>({...TW(e),options:[e,t]}),FW=(e,t)=>({...AW(e),options:[e,t]});var LW="Arrow",TR=P.forwardRef((e,t)=>{const{children:r,width:n=10,height:i=5,...s}=e;return y.jsx(kt.svg,{...s,ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:y.jsx("polygon",{points:"0,0 30,0 15,10"})})});TR.displayName=LW;var BW=TR;function lx(e){const[t,r]=P.useState(void 0);return En(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;a=u.inlineSize,o=u.blockSize}else a=e.offsetWidth,o=e.offsetHeight;r({width:a,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var ux="Popper",[IR,Ng]=Oi(ux),[UW,NR]=IR(ux),PR=e=>{const{__scopePopper:t,children:r}=e,[n,i]=P.useState(null);return y.jsx(UW,{scope:t,anchor:n,onAnchorChange:i,children:r})};PR.displayName=ux;var AR="PopperAnchor",RR=P.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...i}=e,s=NR(AR,r),a=P.useRef(null),o=or(t,a);return P.useEffect(()=>{s.onAnchorChange((n==null?void 0:n.current)||a.current)}),n?null:y.jsx(kt.div,{...i,ref:o})});RR.displayName=AR;var cx="PopperContent",[VW,qW]=IR(cx),OR=P.forwardRef((e,t)=>{var be,ge,Te,Ee,We,Fe;const{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:c=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:w="optimized",onPlaced:x,...v}=e,C=NR(cx,r),[b,g]=P.useState(null),S=or(t,He=>g(He)),[E,A]=P.useState(null),M=lx(E),D=(M==null?void 0:M.width)??0,I=(M==null?void 0:M.height)??0,U=n+(s!=="center"?"-"+s:""),Z=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},ue=Array.isArray(u)?u:[u],X=ue.length>0,ie={padding:Z,boundary:ue.filter(KW),altBoundary:X},{refs:j,floatingStyles:le,placement:ne,isPositioned:ce,middlewareData:W}=PW({strategy:"fixed",placement:U,whileElementsMounted:(...He)=>$W(...He,{animationFrame:w==="always"}),elements:{reference:C.anchor},middleware:[RW({mainAxis:i+I,alignmentAxis:a}),l&&OW({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?DW():void 0,...ie}),l&&jW({...ie}),MW({...ie,apply:({elements:He,rects:Ve,availableWidth:vt,availableHeight:gt})=>{const{width:ot,height:rr}=Ve.reference,Zt=He.floating.style;Zt.setProperty("--radix-popper-available-width",`${vt}px`),Zt.setProperty("--radix-popper-available-height",`${gt}px`),Zt.setProperty("--radix-popper-anchor-width",`${ot}px`),Zt.setProperty("--radix-popper-anchor-height",`${rr}px`)}}),E&&FW({element:E,padding:o}),HW({arrowWidth:D,arrowHeight:I}),p&&zW({strategy:"referenceHidden",...ie})]}),[F,H]=MR(ne),B=Xn(x);En(()=>{ce&&(B==null||B())},[ce,B]);const ee=(be=W.arrow)==null?void 0:be.x,me=(ge=W.arrow)==null?void 0:ge.y,K=((Te=W.arrow)==null?void 0:Te.centerOffset)!==0,[Ae,Ze]=P.useState();return En(()=>{b&&Ze(window.getComputedStyle(b).zIndex)},[b]),y.jsx("div",{ref:j.setFloating,"data-radix-popper-content-wrapper":"",style:{...le,transform:ce?le.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ae,"--radix-popper-transform-origin":[(Ee=W.transformOrigin)==null?void 0:Ee.x,(We=W.transformOrigin)==null?void 0:We.y].join(" "),...((Fe=W.hide)==null?void 0:Fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:y.jsx(VW,{scope:r,placedSide:F,onArrowChange:A,arrowX:ee,arrowY:me,shouldHideArrow:K,children:y.jsx(kt.div,{"data-side":F,"data-align":H,...v,ref:S,style:{...v.style,animation:ce?void 0:"none"}})})})});OR.displayName=cx;var DR="PopperArrow",WW={top:"bottom",right:"left",bottom:"top",left:"right"},jR=P.forwardRef(function(t,r){const{__scopePopper:n,...i}=t,s=qW(DR,n),a=WW[s.placedSide];return y.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:y.jsx(BW,{...i,ref:r,style:{...i.style,display:"block"}})})});jR.displayName=DR;function KW(e){return e!==null}var HW=e=>({name:"transformOrigin",options:e,fn(t){var C,b,g;const{placement:r,rects:n,middlewareData:i}=t,a=((C=i.arrow)==null?void 0:C.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[u,c]=MR(r),f={start:"0%",center:"50%",end:"100%"}[c],p=(((b=i.arrow)==null?void 0:b.x)??0)+o/2,w=(((g=i.arrow)==null?void 0:g.y)??0)+l/2;let x="",v="";return u==="bottom"?(x=a?f:`${p}px`,v=`${-l}px`):u==="top"?(x=a?f:`${p}px`,v=`${n.floating.height+l}px`):u==="right"?(x=`${-l}px`,v=a?f:`${w}px`):u==="left"&&(x=`${n.floating.width+l}px`,v=a?f:`${w}px`),{data:{x,y:v}}}});function MR(e){const[t,r="center"]=e.split("-");return[t,r]}var GW=PR,zR=RR,FR=OR,LR=jR,[Pg,MX]=Oi("Tooltip",[Ng]),dx=Ng(),BR="TooltipProvider",QW=700,C$="tooltip.open",[ZW,UR]=Pg(BR),VR=e=>{const{__scopeTooltip:t,delayDuration:r=QW,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:s}=e,a=P.useRef(!0),o=P.useRef(!1),l=P.useRef(0);return P.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),y.jsx(ZW,{scope:t,isOpenDelayedRef:a,delayDuration:r,onOpen:P.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:P.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:P.useCallback(u=>{o.current=u},[]),disableHoverableContent:i,children:s})};VR.displayName=BR;var qR="Tooltip",[zX,Ag]=Pg(qR),fw="TooltipTrigger",YW=P.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,i=Ag(fw,r),s=UR(fw,r),a=dx(r),o=P.useRef(null),l=or(t,o,i.onTriggerChange),u=P.useRef(!1),c=P.useRef(!1),f=P.useCallback(()=>u.current=!1,[]);return P.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),y.jsx(zR,{asChild:!0,...a,children:y.jsx(kt.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:l,onPointerMove:ht(e.onPointerMove,p=>{p.pointerType!=="touch"&&!c.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),c.current=!0)}),onPointerLeave:ht(e.onPointerLeave,()=>{i.onTriggerLeave(),c.current=!1}),onPointerDown:ht(e.onPointerDown,()=>{i.open&&i.onClose(),u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:ht(e.onFocus,()=>{u.current||i.onOpen()}),onBlur:ht(e.onBlur,i.onClose),onClick:ht(e.onClick,i.onClose)})})});YW.displayName=fw;var XW="TooltipPortal",[FX,JW]=Pg(XW,{forceMount:void 0}),wc="TooltipContent",WR=P.forwardRef((e,t)=>{const r=JW(wc,e.__scopeTooltip),{forceMount:n=r.forceMount,side:i="top",...s}=e,a=Ag(wc,e.__scopeTooltip);return y.jsx(No,{present:n||a.open,children:a.disableHoverableContent?y.jsx(KR,{side:i,...s,ref:t}):y.jsx(e9,{side:i,...s,ref:t})})}),e9=P.forwardRef((e,t)=>{const r=Ag(wc,e.__scopeTooltip),n=UR(wc,e.__scopeTooltip),i=P.useRef(null),s=or(t,i),[a,o]=P.useState(null),{trigger:l,onClose:u}=r,c=i.current,{onPointerInTransitChange:f}=n,p=P.useCallback(()=>{o(null),f(!1)},[f]),w=P.useCallback((x,v)=>{const C=x.currentTarget,b={x:x.clientX,y:x.clientY},g=s9(b,C.getBoundingClientRect()),S=a9(b,g),E=o9(v.getBoundingClientRect()),A=u9([...S,...E]);o(A),f(!0)},[f]);return P.useEffect(()=>()=>p(),[p]),P.useEffect(()=>{if(l&&c){const x=C=>w(C,c),v=C=>w(C,l);return l.addEventListener("pointerleave",x),c.addEventListener("pointerleave",v),()=>{l.removeEventListener("pointerleave",x),c.removeEventListener("pointerleave",v)}}},[l,c,w,p]),P.useEffect(()=>{if(a){const x=v=>{const C=v.target,b={x:v.clientX,y:v.clientY},g=(l==null?void 0:l.contains(C))||(c==null?void 0:c.contains(C)),S=!l9(b,a);g?p():S&&(p(),u())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[l,c,a,u,p]),y.jsx(KR,{...e,ref:s})}),[t9,r9]=Pg(qR,{isInside:!1}),n9=IA("TooltipContent"),KR=P.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...o}=e,l=Ag(wc,r),u=dx(r),{onClose:c}=l;return P.useEffect(()=>(document.addEventListener(C$,c),()=>document.removeEventListener(C$,c)),[c]),P.useEffect(()=>{if(l.trigger){const f=p=>{const w=p.target;w!=null&&w.contains(l.trigger)&&c()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,c]),y.jsx(ap,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:f=>f.preventDefault(),onDismiss:c,children:y.jsxs(FR,{"data-state":l.stateAttribute,...u,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[y.jsx(n9,{children:n}),y.jsx(t9,{scope:r,isInside:!0,children:y.jsx(Iq,{id:l.contentId,role:"tooltip",children:i||n})})]})})});WR.displayName=wc;var HR="TooltipArrow",i9=P.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,i=dx(r);return r9(HR,r).isInside?null:y.jsx(LR,{...i,...n,ref:t})});i9.displayName=HR;function s9(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,i,s)){case s:return"left";case i:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function a9(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function o9(e){const{top:t,right:r,bottom:n,left:i}=e;return[{x:i,y:t},{x:r,y:t},{x:r,y:n},{x:i,y:n}]}function l9(e,t){const{x:r,y:n}=e;let i=!1;for(let s=0,a=t.length-1;s<t.length;a=s++){const o=t[s].x,l=t[s].y,u=t[a].x,c=t[a].y;l>n!=c>n&&r<(u-o)*(n-l)/(c-l)+o&&(i=!i)}return i}function u9(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),c9(t)}function c9(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const i=e[n];for(;t.length>=2;){const s=t[t.length-1],a=t[t.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))t.pop();else break}t.push(i)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const i=e[n];for(;r.length>=2;){const s=r[r.length-1],a=r[r.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))r.pop();else break}r.push(i)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var d9=VR,GR=WR;const f9=d9,p9=P.forwardRef(({className:e,sideOffset:t=4,...r},n)=>y.jsx(GR,{ref:n,sideOffset:t,className:ft("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...r}));p9.displayName=GR.displayName;const h9="modulepreload",m9=function(e){return"/FiberMapConnect/"+e},k$={},pw=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=m9(l),l in k$)return;k$[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":h9,u||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((p,w)=>{f.addEventListener("load",p),f.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};var g9=P.createContext(void 0);function fx(e){const t=P.useContext(g9);return e||t||"ltr"}var Fy="rovingFocusGroup.onEntryFocus",y9={bubbles:!1,cancelable:!0},Rg="RovingFocusGroup",[hw,QR,v9]=Qb(Rg),[w9,ZR]=Oi(Rg,[v9]),[b9,x9]=w9(Rg),YR=P.forwardRef((e,t)=>y.jsx(hw.Provider,{scope:e.__scopeRovingFocusGroup,children:y.jsx(hw.Slot,{scope:e.__scopeRovingFocusGroup,children:y.jsx(_9,{...e,ref:t})})}));YR.displayName=Rg;var _9=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:c=!1,...f}=e,p=P.useRef(null),w=or(t,p),x=fx(s),[v=null,C]=vo({prop:a,defaultProp:o,onChange:l}),[b,g]=P.useState(!1),S=Xn(u),E=QR(r),A=P.useRef(!1),[M,D]=P.useState(0);return P.useEffect(()=>{const I=p.current;if(I)return I.addEventListener(Fy,S),()=>I.removeEventListener(Fy,S)},[S]),y.jsx(b9,{scope:r,orientation:n,dir:x,loop:i,currentTabStopId:v,onItemFocus:P.useCallback(I=>C(I),[C]),onItemShiftTab:P.useCallback(()=>g(!0),[]),onFocusableItemAdd:P.useCallback(()=>D(I=>I+1),[]),onFocusableItemRemove:P.useCallback(()=>D(I=>I-1),[]),children:y.jsx(kt.div,{tabIndex:b||M===0?-1:0,"data-orientation":n,...f,ref:w,style:{outline:"none",...e.style},onMouseDown:ht(e.onMouseDown,()=>{A.current=!0}),onFocus:ht(e.onFocus,I=>{const U=!A.current;if(I.target===I.currentTarget&&U&&!b){const Z=new CustomEvent(Fy,y9);if(I.currentTarget.dispatchEvent(Z),!Z.defaultPrevented){const ue=E().filter(ne=>ne.focusable),X=ue.find(ne=>ne.active),ie=ue.find(ne=>ne.id===v),le=[X,ie,...ue].filter(Boolean).map(ne=>ne.ref.current);eO(le,c)}}A.current=!1}),onBlur:ht(e.onBlur,()=>g(!1))})})}),XR="RovingFocusGroupItem",JR=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:s,...a}=e,o=ho(),l=s||o,u=x9(XR,r),c=u.currentTabStopId===l,f=QR(r),{onFocusableItemAdd:p,onFocusableItemRemove:w}=u;return P.useEffect(()=>{if(n)return p(),()=>w()},[n,p,w]),y.jsx(hw.ItemSlot,{scope:r,id:l,focusable:n,active:i,children:y.jsx(kt.span,{tabIndex:c?0:-1,"data-orientation":u.orientation,...a,ref:t,onMouseDown:ht(e.onMouseDown,x=>{n?u.onItemFocus(l):x.preventDefault()}),onFocus:ht(e.onFocus,()=>u.onItemFocus(l)),onKeyDown:ht(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const v=C9(x,u.orientation,u.dir);if(v!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let b=f().filter(g=>g.focusable).map(g=>g.ref.current);if(v==="last")b.reverse();else if(v==="prev"||v==="next"){v==="prev"&&b.reverse();const g=b.indexOf(x.currentTarget);b=u.loop?k9(b,g+1):b.slice(g+1)}setTimeout(()=>eO(b))}})})})});JR.displayName=XR;var $9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function S9(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function C9(e,t,r){const n=S9(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return $9[n]}function eO(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function k9(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var E9=YR,T9=JR,px="Tabs",[I9,LX]=Oi(px,[ZR]),tO=ZR(),[N9,hx]=I9(px),rO=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:i,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...u}=e,c=fx(o),[f,p]=vo({prop:n,onChange:i,defaultProp:s});return y.jsx(N9,{scope:r,baseId:ho(),value:f,onValueChange:p,orientation:a,dir:c,activationMode:l,children:y.jsx(kt.div,{dir:c,"data-orientation":a,...u,ref:t})})});rO.displayName=px;var nO="TabsList",iO=P.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...i}=e,s=hx(nO,r),a=tO(r);return y.jsx(E9,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:n,children:y.jsx(kt.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:t})})});iO.displayName=nO;var sO="TabsTrigger",aO=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:i=!1,...s}=e,a=hx(sO,r),o=tO(r),l=uO(a.baseId,n),u=cO(a.baseId,n),c=n===a.value;return y.jsx(T9,{asChild:!0,...o,focusable:!i,active:c,children:y.jsx(kt.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l,...s,ref:t,onMouseDown:ht(e.onMouseDown,f=>{!i&&f.button===0&&f.ctrlKey===!1?a.onValueChange(n):f.preventDefault()}),onKeyDown:ht(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&a.onValueChange(n)}),onFocus:ht(e.onFocus,()=>{const f=a.activationMode!=="manual";!c&&!i&&f&&a.onValueChange(n)})})})});aO.displayName=sO;var oO="TabsContent",lO=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:i,children:s,...a}=e,o=hx(oO,r),l=uO(o.baseId,n),u=cO(o.baseId,n),c=n===o.value,f=P.useRef(c);return P.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),y.jsx(No,{present:i||c,children:({present:p})=>y.jsx(kt.div,{"data-state":c?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!p,id:u,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:p&&s})})});lO.displayName=oO;function uO(e,t){return`${e}-trigger-${t}`}function cO(e,t){return`${e}-content-${t}`}var P9=rO,dO=iO,fO=aO,pO=lO;const A9=P9,hO=P.forwardRef(({className:e,...t},r)=>y.jsx(dO,{ref:r,className:ft("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));hO.displayName=dO.displayName;const Md=P.forwardRef(({className:e,...t},r)=>y.jsx(fO,{ref:r,className:ft("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Md.displayName=fO.displayName;const zd=P.forwardRef(({className:e,...t},r)=>y.jsx(pO,{ref:r,className:ft("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));zd.displayName=pO.displayName;const mx=kg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ht=P.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},s)=>{const a=n?EA:"button";return y.jsx(a,{className:ft(mx({variant:t,size:r,className:e})),ref:s,...i})});Ht.displayName="Button";const al=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{ref:r,className:ft("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...t}));al.displayName="Card";const Pu=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{ref:r,className:ft("flex flex-col space-y-1.5 p-6",e),...t}));Pu.displayName="CardHeader";const Au=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{ref:r,className:ft("text-2xl font-semibold leading-none tracking-tight",e),...t}));Au.displayName="CardTitle";const R9=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{ref:r,className:ft("text-sm text-muted-foreground",e),...t}));R9.displayName="CardDescription";const ol=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{ref:r,className:ft("p-6 pt-0",e),...t}));ol.displayName="CardContent";const O9=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{ref:r,className:ft("flex items-center p-6 pt-0",e),...t}));O9.displayName="CardFooter";var Ly="focusScope.autoFocusOnMount",By="focusScope.autoFocusOnUnmount",E$={bubbles:!1,cancelable:!0},D9="FocusScope",gx=P.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=e,[o,l]=P.useState(null),u=Xn(i),c=Xn(s),f=P.useRef(null),p=or(t,v=>l(v)),w=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(n){let v=function(S){if(w.paused||!o)return;const E=S.target;o.contains(E)?f.current=E:Ua(f.current,{select:!0})},C=function(S){if(w.paused||!o)return;const E=S.relatedTarget;E!==null&&(o.contains(E)||Ua(f.current,{select:!0}))},b=function(S){if(document.activeElement===document.body)for(const A of S)A.removedNodes.length>0&&Ua(o)};document.addEventListener("focusin",v),document.addEventListener("focusout",C);const g=new MutationObserver(b);return o&&g.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",C),g.disconnect()}}},[n,o,w.paused]),P.useEffect(()=>{if(o){I$.add(w);const v=document.activeElement;if(!o.contains(v)){const b=new CustomEvent(Ly,E$);o.addEventListener(Ly,u),o.dispatchEvent(b),b.defaultPrevented||(j9(B9(mO(o)),{select:!0}),document.activeElement===v&&Ua(o))}return()=>{o.removeEventListener(Ly,u),setTimeout(()=>{const b=new CustomEvent(By,E$);o.addEventListener(By,c),o.dispatchEvent(b),b.defaultPrevented||Ua(v??document.body,{select:!0}),o.removeEventListener(By,c),I$.remove(w)},0)}}},[o,u,c,w]);const x=P.useCallback(v=>{if(!r&&!n||w.paused)return;const C=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,b=document.activeElement;if(C&&b){const g=v.currentTarget,[S,E]=M9(g);S&&E?!v.shiftKey&&b===E?(v.preventDefault(),r&&Ua(S,{select:!0})):v.shiftKey&&b===S&&(v.preventDefault(),r&&Ua(E,{select:!0})):b===g&&v.preventDefault()}},[r,n,w.paused]);return y.jsx(kt.div,{tabIndex:-1,...a,ref:p,onKeyDown:x})});gx.displayName=D9;function j9(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Ua(n,{select:t}),document.activeElement!==r)return}function M9(e){const t=mO(e),r=T$(t,e),n=T$(t.reverse(),e);return[r,n]}function mO(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function T$(e,t){for(const r of e)if(!z9(r,{upTo:t}))return r}function z9(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function F9(e){return e instanceof HTMLInputElement&&"select"in e}function Ua(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&F9(e)&&t&&e.select()}}var I$=L9();function L9(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=N$(e,t),e.unshift(t)},remove(t){var r;e=N$(e,t),(r=e[0])==null||r.resume()}}}function N$(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function B9(e){return e.filter(t=>t.tagName!=="A")}var Uy=0;function gO(){P.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??P$()),document.body.insertAdjacentElement("beforeend",e[1]??P$()),Uy++,()=>{Uy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Uy--}},[])}function P$(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Rs=function(){return Rs=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Rs.apply(this,arguments)};function yO(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function U9(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var Kh="right-scroll-bar-position",Hh="width-before-scroll-bar",V9="with-scroll-bars-hidden",q9="--removed-body-scroll-bar-size";function Vy(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function W9(e,t){var r=P.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var K9=typeof window<"u"?P.useLayoutEffect:P.useEffect,A$=new WeakMap;function H9(e,t){var r=W9(null,function(n){return e.forEach(function(i){return Vy(i,n)})});return K9(function(){var n=A$.get(r);if(n){var i=new Set(n),s=new Set(e),a=r.current;i.forEach(function(o){s.has(o)||Vy(o,null)}),s.forEach(function(o){i.has(o)||Vy(o,a)})}A$.set(r,e)},[e]),r}function G9(e){return e}function Q9(e,t){t===void 0&&(t=G9);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var a=t(s,n);return r.push(a),function(){r=r.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(n=!0;r.length;){var a=r;r=[],a.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var a=[];if(r.length){var o=r;r=[],o.forEach(s),a=r}var l=function(){var c=a;a=[],c.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),r={push:function(c){a.push(c),u()},filter:function(c){return a=a.filter(c),r}}}};return i}function Z9(e){e===void 0&&(e={});var t=Q9(null);return t.options=Rs({async:!0,ssr:!1},e),t}var vO=function(e){var t=e.sideCar,r=yO(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return P.createElement(n,Rs({},r))};vO.isSideCarExport=!0;function Y9(e,t){return e.useMedium(t),vO}var wO=Z9(),qy=function(){},Og=P.forwardRef(function(e,t){var r=P.useRef(null),n=P.useState({onScrollCapture:qy,onWheelCapture:qy,onTouchMoveCapture:qy}),i=n[0],s=n[1],a=e.forwardProps,o=e.children,l=e.className,u=e.removeScrollBar,c=e.enabled,f=e.shards,p=e.sideCar,w=e.noIsolation,x=e.inert,v=e.allowPinchZoom,C=e.as,b=C===void 0?"div":C,g=e.gapMode,S=yO(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=p,A=H9([r,t]),M=Rs(Rs({},S),i);return P.createElement(P.Fragment,null,c&&P.createElement(E,{sideCar:wO,removeScrollBar:u,shards:f,noIsolation:w,inert:x,setCallbacks:s,allowPinchZoom:!!v,lockRef:r,gapMode:g}),a?P.cloneElement(P.Children.only(o),Rs(Rs({},M),{ref:A})):P.createElement(b,Rs({},M,{className:l,ref:A}),o))});Og.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Og.classNames={fullWidth:Hh,zeroRight:Kh};var X9=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function J9(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=X9();return t&&e.setAttribute("nonce",t),e}function eK(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function tK(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var rK=function(){var e=0,t=null;return{add:function(r){e==0&&(t=J9())&&(eK(t,r),tK(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},nK=function(){var e=rK();return function(t,r){P.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},bO=function(){var e=nK(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},iK={left:0,top:0,right:0,gap:0},Wy=function(e){return parseInt(e||"",10)||0},sK=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[Wy(r),Wy(n),Wy(i)]},aK=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return iK;var t=sK(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},oK=bO(),Wu="data-scroll-locked",lK=function(e,t,r,n){var i=e.left,s=e.top,a=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(V9,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(Wu,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Kh,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Hh,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Kh," .").concat(Kh,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Hh," .").concat(Hh,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Wu,`] {
    `).concat(q9,": ").concat(o,`px;
  }
`)},R$=function(){var e=parseInt(document.body.getAttribute(Wu)||"0",10);return isFinite(e)?e:0},uK=function(){P.useEffect(function(){return document.body.setAttribute(Wu,(R$()+1).toString()),function(){var e=R$()-1;e<=0?document.body.removeAttribute(Wu):document.body.setAttribute(Wu,e.toString())}},[])},cK=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;uK();var s=P.useMemo(function(){return aK(i)},[i]);return P.createElement(oK,{styles:lK(s,!t,i,r?"":"!important")})},mw=!1;if(typeof window<"u")try{var lh=Object.defineProperty({},"passive",{get:function(){return mw=!0,!0}});window.addEventListener("test",lh,lh),window.removeEventListener("test",lh,lh)}catch{mw=!1}var pu=mw?{passive:!1}:!1,dK=function(e){return e.tagName==="TEXTAREA"},xO=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!dK(e)&&r[t]==="visible")},fK=function(e){return xO(e,"overflowY")},pK=function(e){return xO(e,"overflowX")},O$=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=_O(e,n);if(i){var s=$O(e,n),a=s[1],o=s[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},hK=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},mK=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},_O=function(e,t){return e==="v"?fK(t):pK(t)},$O=function(e,t){return e==="v"?hK(t):mK(t)},gK=function(e,t){return e==="h"&&t==="rtl"?-1:1},yK=function(e,t,r,n,i){var s=gK(e,window.getComputedStyle(t).direction),a=s*n,o=r.target,l=t.contains(o),u=!1,c=a>0,f=0,p=0;do{var w=$O(e,o),x=w[0],v=w[1],C=w[2],b=v-C-s*x;(x||b)&&_O(e,o)&&(f+=b,p+=x),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(c&&(Math.abs(f)<1||!i)||!c&&(Math.abs(p)<1||!i))&&(u=!0),u},uh=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},D$=function(e){return[e.deltaX,e.deltaY]},j$=function(e){return e&&"current"in e?e.current:e},vK=function(e,t){return e[0]===t[0]&&e[1]===t[1]},wK=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},bK=0,hu=[];function xK(e){var t=P.useRef([]),r=P.useRef([0,0]),n=P.useRef(),i=P.useState(bK++)[0],s=P.useState(bO)[0],a=P.useRef(e);P.useEffect(function(){a.current=e},[e]),P.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var v=U9([e.lockRef.current],(e.shards||[]).map(j$),!0).filter(Boolean);return v.forEach(function(C){return C.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),v.forEach(function(C){return C.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=P.useCallback(function(v,C){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!a.current.allowPinchZoom;var b=uh(v),g=r.current,S="deltaX"in v?v.deltaX:g[0]-b[0],E="deltaY"in v?v.deltaY:g[1]-b[1],A,M=v.target,D=Math.abs(S)>Math.abs(E)?"h":"v";if("touches"in v&&D==="h"&&M.type==="range")return!1;var I=O$(D,M);if(!I)return!0;if(I?A=D:(A=D==="v"?"h":"v",I=O$(D,M)),!I)return!1;if(!n.current&&"changedTouches"in v&&(S||E)&&(n.current=A),!A)return!0;var U=n.current||A;return yK(U,C,v,U==="h"?S:E,!0)},[]),l=P.useCallback(function(v){var C=v;if(!(!hu.length||hu[hu.length-1]!==s)){var b="deltaY"in C?D$(C):uh(C),g=t.current.filter(function(A){return A.name===C.type&&(A.target===C.target||C.target===A.shadowParent)&&vK(A.delta,b)})[0];if(g&&g.should){C.cancelable&&C.preventDefault();return}if(!g){var S=(a.current.shards||[]).map(j$).filter(Boolean).filter(function(A){return A.contains(C.target)}),E=S.length>0?o(C,S[0]):!a.current.noIsolation;E&&C.cancelable&&C.preventDefault()}}},[]),u=P.useCallback(function(v,C,b,g){var S={name:v,delta:C,target:b,should:g,shadowParent:_K(b)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(E){return E!==S})},1)},[]),c=P.useCallback(function(v){r.current=uh(v),n.current=void 0},[]),f=P.useCallback(function(v){u(v.type,D$(v),v.target,o(v,e.lockRef.current))},[]),p=P.useCallback(function(v){u(v.type,uh(v),v.target,o(v,e.lockRef.current))},[]);P.useEffect(function(){return hu.push(s),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",l,pu),document.addEventListener("touchmove",l,pu),document.addEventListener("touchstart",c,pu),function(){hu=hu.filter(function(v){return v!==s}),document.removeEventListener("wheel",l,pu),document.removeEventListener("touchmove",l,pu),document.removeEventListener("touchstart",c,pu)}},[]);var w=e.removeScrollBar,x=e.inert;return P.createElement(P.Fragment,null,x?P.createElement(s,{styles:wK(i)}):null,w?P.createElement(cK,{gapMode:e.gapMode}):null)}function _K(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const $K=Y9(wO,xK);var yx=P.forwardRef(function(e,t){return P.createElement(Og,Rs({},e,{ref:t,sideCar:$K}))});yx.classNames=Og.classNames;var SK=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},mu=new WeakMap,ch=new WeakMap,dh={},Ky=0,SO=function(e){return e&&(e.host||SO(e.parentNode))},CK=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=SO(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},kK=function(e,t,r,n){var i=CK(t,Array.isArray(e)?e:[e]);dh[r]||(dh[r]=new WeakMap);var s=dh[r],a=[],o=new Set,l=new Set(i),u=function(f){!f||o.has(f)||(o.add(f),u(f.parentNode))};i.forEach(u);var c=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(p){if(o.has(p))c(p);else try{var w=p.getAttribute(n),x=w!==null&&w!=="false",v=(mu.get(p)||0)+1,C=(s.get(p)||0)+1;mu.set(p,v),s.set(p,C),a.push(p),v===1&&x&&ch.set(p,!0),C===1&&p.setAttribute(r,"true"),x||p.setAttribute(n,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return c(t),o.clear(),Ky++,function(){a.forEach(function(f){var p=mu.get(f)-1,w=s.get(f)-1;mu.set(f,p),s.set(f,w),p||(ch.has(f)||f.removeAttribute(n),ch.delete(f)),w||f.removeAttribute(r)}),Ky--,Ky||(mu=new WeakMap,mu=new WeakMap,ch=new WeakMap,dh={})}},CO=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=SK(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),kK(n,i,r,"aria-hidden")):function(){return null}},vx="Dialog",[kO,EO]=Oi(vx),[EK,gs]=kO(vx),TO=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:i,onOpenChange:s,modal:a=!0}=e,o=P.useRef(null),l=P.useRef(null),[u=!1,c]=vo({prop:n,defaultProp:i,onChange:s});return y.jsx(EK,{scope:t,triggerRef:o,contentRef:l,contentId:ho(),titleId:ho(),descriptionId:ho(),open:u,onOpenChange:c,onOpenToggle:P.useCallback(()=>c(f=>!f),[c]),modal:a,children:r})};TO.displayName=vx;var IO="DialogTrigger",NO=P.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gs(IO,r),s=or(t,i.triggerRef);return y.jsx(kt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":xx(i.open),...n,ref:s,onClick:ht(e.onClick,i.onOpenToggle)})});NO.displayName=IO;var wx="DialogPortal",[TK,PO]=kO(wx,{forceMount:void 0}),AO=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:i}=e,s=gs(wx,t);return y.jsx(TK,{scope:t,forceMount:r,children:P.Children.map(n,a=>y.jsx(No,{present:r||s.open,children:y.jsx($g,{asChild:!0,container:i,children:a})}))})};AO.displayName=wx;var Tm="DialogOverlay",RO=P.forwardRef((e,t)=>{const r=PO(Tm,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,s=gs(Tm,e.__scopeDialog);return s.modal?y.jsx(No,{present:n||s.open,children:y.jsx(NK,{...i,ref:t})}):null});RO.displayName=Tm;var IK=yc("DialogOverlay.RemoveScroll"),NK=P.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gs(Tm,r);return y.jsx(yx,{as:IK,allowPinchZoom:!0,shards:[i.contentRef],children:y.jsx(kt.div,{"data-state":xx(i.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Il="DialogContent",OO=P.forwardRef((e,t)=>{const r=PO(Il,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,s=gs(Il,e.__scopeDialog);return y.jsx(No,{present:n||s.open,children:s.modal?y.jsx(PK,{...i,ref:t}):y.jsx(AK,{...i,ref:t})})});OO.displayName=Il;var PK=P.forwardRef((e,t)=>{const r=gs(Il,e.__scopeDialog),n=P.useRef(null),i=or(t,r.contentRef,n);return P.useEffect(()=>{const s=n.current;if(s)return CO(s)},[]),y.jsx(DO,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ht(e.onCloseAutoFocus,s=>{var a;s.preventDefault(),(a=r.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ht(e.onPointerDownOutside,s=>{const a=s.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&s.preventDefault()}),onFocusOutside:ht(e.onFocusOutside,s=>s.preventDefault())})}),AK=P.forwardRef((e,t)=>{const r=gs(Il,e.__scopeDialog),n=P.useRef(!1),i=P.useRef(!1);return y.jsx(DO,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:s=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),DO=P.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=e,o=gs(Il,r),l=P.useRef(null),u=or(t,l);return gO(),y.jsxs(y.Fragment,{children:[y.jsx(gx,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:s,children:y.jsx(ap,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":xx(o.open),...a,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),y.jsxs(y.Fragment,{children:[y.jsx(OK,{titleId:o.titleId}),y.jsx(jK,{contentRef:l,descriptionId:o.descriptionId})]})]})}),bx="DialogTitle",jO=P.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gs(bx,r);return y.jsx(kt.h2,{id:i.titleId,...n,ref:t})});jO.displayName=bx;var MO="DialogDescription",zO=P.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gs(MO,r);return y.jsx(kt.p,{id:i.descriptionId,...n,ref:t})});zO.displayName=MO;var FO="DialogClose",LO=P.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gs(FO,r);return y.jsx(kt.button,{type:"button",...n,ref:t,onClick:ht(e.onClick,()=>i.onOpenChange(!1))})});LO.displayName=FO;function xx(e){return e?"open":"closed"}var BO="DialogTitleWarning",[RK,UO]=oq(BO,{contentName:Il,titleName:bx,docsSlug:"dialog"}),OK=({titleId:e})=>{const t=UO(BO),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return P.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},DK="DialogDescriptionWarning",jK=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${UO(DK).contentName}}.`;return P.useEffect(()=>{var s;const i=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},VO=TO,MK=NO,qO=AO,_x=RO,$x=OO,Sx=jO,Cx=zO,kx=LO;const gw=VO,zK=qO,WO=P.forwardRef(({className:e,...t},r)=>y.jsx(_x,{ref:r,className:ft("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));WO.displayName=_x.displayName;const Im=P.forwardRef(({className:e,children:t,...r},n)=>y.jsxs(zK,{children:[y.jsx(WO,{}),y.jsxs($x,{ref:n,className:ft("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,y.jsxs(kx,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[y.jsx(Rf,{className:"h-4 w-4"}),y.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Im.displayName=$x.displayName;const Nm=({className:e,...t})=>y.jsx("div",{className:ft("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Nm.displayName="DialogHeader";const Pm=P.forwardRef(({className:e,...t},r)=>y.jsx(Sx,{ref:r,className:ft("text-lg font-semibold leading-none tracking-tight",e),...t}));Pm.displayName=Sx.displayName;const Am=P.forwardRef(({className:e,...t},r)=>y.jsx(Cx,{ref:r,className:ft("text-sm text-muted-foreground",e),...t}));Am.displayName=Cx.displayName;var KO="AlertDialog",[FK,BX]=Oi(KO,[EO]),Ta=EO(),HO=e=>{const{__scopeAlertDialog:t,...r}=e,n=Ta(t);return y.jsx(VO,{...n,...r,modal:!0})};HO.displayName=KO;var LK="AlertDialogTrigger",BK=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,i=Ta(r);return y.jsx(MK,{...i,...n,ref:t})});BK.displayName=LK;var UK="AlertDialogPortal",GO=e=>{const{__scopeAlertDialog:t,...r}=e,n=Ta(t);return y.jsx(qO,{...n,...r})};GO.displayName=UK;var VK="AlertDialogOverlay",QO=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,i=Ta(r);return y.jsx(_x,{...i,...n,ref:t})});QO.displayName=VK;var Ku="AlertDialogContent",[qK,WK]=FK(Ku),KK=IA("AlertDialogContent"),ZO=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...i}=e,s=Ta(r),a=P.useRef(null),o=or(t,a),l=P.useRef(null);return y.jsx(RK,{contentName:Ku,titleName:YO,docsSlug:"alert-dialog",children:y.jsx(qK,{scope:r,cancelRef:l,children:y.jsxs($x,{role:"alertdialog",...s,...i,ref:o,onOpenAutoFocus:ht(i.onOpenAutoFocus,u=>{var c;u.preventDefault(),(c=l.current)==null||c.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[y.jsx(KK,{children:n}),y.jsx(GK,{contentRef:a})]})})})});ZO.displayName=Ku;var YO="AlertDialogTitle",XO=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,i=Ta(r);return y.jsx(Sx,{...i,...n,ref:t})});XO.displayName=YO;var JO="AlertDialogDescription",eD=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,i=Ta(r);return y.jsx(Cx,{...i,...n,ref:t})});eD.displayName=JO;var HK="AlertDialogAction",tD=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,i=Ta(r);return y.jsx(kx,{...i,...n,ref:t})});tD.displayName=HK;var rD="AlertDialogCancel",nD=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:i}=WK(rD,r),s=Ta(r),a=or(t,i);return y.jsx(kx,{...s,...n,ref:a})});nD.displayName=rD;var GK=({contentRef:e})=>{const t=`\`${Ku}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ku}\` by passing a \`${JO}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ku}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return P.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},QK=HO,ZK=GO,iD=QO,sD=ZO,aD=tD,oD=nD,lD=XO,uD=eD;const YK=QK,XK=ZK,cD=P.forwardRef(({className:e,...t},r)=>y.jsx(iD,{className:ft("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));cD.displayName=iD.displayName;const dD=P.forwardRef(({className:e,...t},r)=>y.jsxs(XK,{children:[y.jsx(cD,{}),y.jsx(sD,{ref:r,className:ft("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));dD.displayName=sD.displayName;const fD=({className:e,...t})=>y.jsx("div",{className:ft("flex flex-col space-y-2 text-center sm:text-left",e),...t});fD.displayName="AlertDialogHeader";const pD=({className:e,...t})=>y.jsx("div",{className:ft("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});pD.displayName="AlertDialogFooter";const hD=P.forwardRef(({className:e,...t},r)=>y.jsx(lD,{ref:r,className:ft("text-lg font-semibold",e),...t}));hD.displayName=lD.displayName;const mD=P.forwardRef(({className:e,...t},r)=>y.jsx(uD,{ref:r,className:ft("text-sm text-muted-foreground",e),...t}));mD.displayName=uD.displayName;const gD=P.forwardRef(({className:e,...t},r)=>y.jsx(aD,{ref:r,className:ft(mx(),e),...t}));gD.displayName=aD.displayName;const yD=P.forwardRef(({className:e,...t},r)=>y.jsx(oD,{ref:r,className:ft(mx({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));yD.displayName=oD.displayName;var up=e=>e.type==="checkbox",ll=e=>e instanceof Date,jn=e=>e==null;const vD=e=>typeof e=="object";var Br=e=>!jn(e)&&!Array.isArray(e)&&vD(e)&&!ll(e),wD=e=>Br(e)&&e.target?up(e.target)?e.target.checked:e.target.value:e,JK=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,bD=(e,t)=>e.has(JK(t)),eH=e=>{const t=e.constructor&&e.constructor.prototype;return Br(t)&&t.hasOwnProperty("isPrototypeOf")},Ex=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function fn(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Ex&&(e instanceof Blob||n))&&(r||Br(e)))if(t=r?[]:{},!r&&!eH(e))t=e;else for(const i in e)e.hasOwnProperty(i)&&(t[i]=fn(e[i]));else return e;return t}var Dg=e=>Array.isArray(e)?e.filter(Boolean):[],Fr=e=>e===void 0,Je=(e,t,r)=>{if(!t||!Br(e))return r;const n=Dg(t.split(/[,[\].]+?/)).reduce((i,s)=>jn(i)?i:i[s],e);return Fr(n)||n===e?Fr(e[t])?r:e[t]:n},oi=e=>typeof e=="boolean",Tx=e=>/^\w*$/.test(e),xD=e=>Dg(e.replace(/["|']|\]/g,"").split(/\.|\[/)),sr=(e,t,r)=>{let n=-1;const i=Tx(t)?[t]:xD(t),s=i.length,a=s-1;for(;++n<s;){const o=i[n];let l=r;if(n!==a){const u=e[o];l=Br(u)||Array.isArray(u)?u:isNaN(+i[n+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;e[o]=l,e=e[o]}};const Rm={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ss={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},sa={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},_D=Nt.createContext(null),jg=()=>Nt.useContext(_D),tH=e=>{const{children:t,...r}=e;return Nt.createElement(_D.Provider,{value:r},t)};var $D=(e,t,r,n=!0)=>{const i={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(i,s,{get:()=>{const a=s;return t._proxyFormState[a]!==ss.all&&(t._proxyFormState[a]=!n||ss.all),r&&(r[a]=!0),e[a]}});return i};function rH(e){const t=jg(),{control:r=t.control,disabled:n,name:i,exact:s}=e||{},[a,o]=Nt.useState(r._formState),l=Nt.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),u=Nt.useRef(i);return u.current=i,Nt.useEffect(()=>r._subscribe({name:u.current,formState:l.current,exact:s,callback:c=>{!n&&o({...r._formState,...c})}}),[r,n,s]),Nt.useEffect(()=>{l.current.isValid&&r._setValid(!0)},[r]),Nt.useMemo(()=>$D(a,r,l.current,!1),[a,r])}var Ds=e=>typeof e=="string",SD=(e,t,r,n,i)=>Ds(e)?(n&&t.watch.add(e),Je(r,e,i)):Array.isArray(e)?e.map(s=>(n&&t.watch.add(s),Je(r,s))):(n&&(t.watchAll=!0),r);function nH(e){const t=jg(),{control:r=t.control,name:n,defaultValue:i,disabled:s,exact:a}=e||{},o=Nt.useRef(n),l=Nt.useRef(i);o.current=n,Nt.useEffect(()=>r._subscribe({name:o.current,formState:{values:!0},exact:a,callback:f=>!s&&c(SD(o.current,r._names,f.values||r._formValues,!1,l.current))}),[r,s,a]);const[u,c]=Nt.useState(r._getWatch(n,i));return Nt.useEffect(()=>r._removeUnmounted()),u}function iH(e){const t=jg(),{name:r,disabled:n,control:i=t.control,shouldUnregister:s}=e,a=bD(i._names.array,r),o=nH({control:i,name:r,defaultValue:Je(i._formValues,r,Je(i._defaultValues,r,e.defaultValue)),exact:!0}),l=rH({control:i,name:r,exact:!0}),u=Nt.useRef(e),c=Nt.useRef(i.register(r,{...e.rules,value:o,...oi(e.disabled)?{disabled:e.disabled}:{}})),f=Nt.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Je(l.errors,r)},isDirty:{enumerable:!0,get:()=>!!Je(l.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Je(l.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Je(l.validatingFields,r)},error:{enumerable:!0,get:()=>Je(l.errors,r)}}),[l,r]),p=Nt.useCallback(C=>c.current.onChange({target:{value:wD(C),name:r},type:Rm.CHANGE}),[r]),w=Nt.useCallback(()=>c.current.onBlur({target:{value:Je(i._formValues,r),name:r},type:Rm.BLUR}),[r,i._formValues]),x=Nt.useCallback(C=>{const b=Je(i._fields,r);b&&C&&(b._f.ref={focus:()=>C.focus(),select:()=>C.select(),setCustomValidity:g=>C.setCustomValidity(g),reportValidity:()=>C.reportValidity()})},[i._fields,r]),v=Nt.useMemo(()=>({name:r,value:o,...oi(n)||l.disabled?{disabled:l.disabled||n}:{},onChange:p,onBlur:w,ref:x}),[r,n,l.disabled,p,w,x,o]);return Nt.useEffect(()=>{const C=i._options.shouldUnregister||s;i.register(r,{...u.current.rules,...oi(u.current.disabled)?{disabled:u.current.disabled}:{}});const b=(g,S)=>{const E=Je(i._fields,g);E&&E._f&&(E._f.mount=S)};if(b(r,!0),C){const g=fn(Je(i._options.defaultValues,r));sr(i._defaultValues,r,g),Fr(Je(i._formValues,r))&&sr(i._formValues,r,g)}return!a&&i.register(r),()=>{(a?C&&!i._state.action:C)?i.unregister(r):b(r,!1)}},[r,i,a,s]),Nt.useEffect(()=>{i._setDisabledField({disabled:n,name:r})},[n,r,i]),Nt.useMemo(()=>({field:v,formState:l,fieldState:f}),[v,l,f])}const sH=e=>e.render(iH(e));var CD=(e,t,r,n,i)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:i||!0}}:{},lf=e=>Array.isArray(e)?e:[e],M$=()=>{let e=[];return{get observers(){return e},next:i=>{for(const s of e)s.next&&s.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(s=>s!==i)}}),unsubscribe:()=>{e=[]}}},yw=e=>jn(e)||!vD(e);function Ha(e,t){if(yw(e)||yw(t))return e===t;if(ll(e)&&ll(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const i of r){const s=e[i];if(!n.includes(i))return!1;if(i!=="ref"){const a=t[i];if(ll(s)&&ll(a)||Br(s)&&Br(a)||Array.isArray(s)&&Array.isArray(a)?!Ha(s,a):s!==a)return!1}}return!0}var On=e=>Br(e)&&!Object.keys(e).length,Ix=e=>e.type==="file",as=e=>typeof e=="function",Om=e=>{if(!Ex)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},kD=e=>e.type==="select-multiple",Nx=e=>e.type==="radio",aH=e=>Nx(e)||up(e),Hy=e=>Om(e)&&e.isConnected;function oH(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=Fr(e)?n++:e[t[n++]];return e}function lH(e){for(const t in e)if(e.hasOwnProperty(t)&&!Fr(e[t]))return!1;return!0}function Qr(e,t){const r=Array.isArray(t)?t:Tx(t)?[t]:xD(t),n=r.length===1?e:oH(e,r),i=r.length-1,s=r[i];return n&&delete n[s],i!==0&&(Br(n)&&On(n)||Array.isArray(n)&&lH(n))&&Qr(e,r.slice(0,-1)),e}var ED=e=>{for(const t in e)if(as(e[t]))return!0;return!1};function Dm(e,t={}){const r=Array.isArray(e);if(Br(e)||r)for(const n in e)Array.isArray(e[n])||Br(e[n])&&!ED(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Dm(e[n],t[n])):jn(e[n])||(t[n]=!0);return t}function TD(e,t,r){const n=Array.isArray(e);if(Br(e)||n)for(const i in e)Array.isArray(e[i])||Br(e[i])&&!ED(e[i])?Fr(t)||yw(r[i])?r[i]=Array.isArray(e[i])?Dm(e[i],[]):{...Dm(e[i])}:TD(e[i],jn(t)?{}:t[i],r[i]):r[i]=!Ha(e[i],t[i]);return r}var wd=(e,t)=>TD(e,t,Dm(t));const z$={value:!1,isValid:!1},F$={value:!0,isValid:!0};var ID=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Fr(e[0].attributes.value)?Fr(e[0].value)||e[0].value===""?F$:{value:e[0].value,isValid:!0}:F$:z$}return z$},ND=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Fr(e)?e:t?e===""?NaN:e&&+e:r&&Ds(e)?new Date(e):n?n(e):e;const L$={isValid:!1,value:null};var PD=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,L$):L$;function B$(e){const t=e.ref;return Ix(t)?t.files:Nx(t)?PD(e.refs).value:kD(t)?[...t.selectedOptions].map(({value:r})=>r):up(t)?ID(e.refs).value:ND(Fr(t.value)?e.ref.value:t.value,e)}var uH=(e,t,r,n)=>{const i={};for(const s of e){const a=Je(t,s);a&&sr(i,s,a._f)}return{criteriaMode:r,names:[...e],fields:i,shouldUseNativeValidation:n}},jm=e=>e instanceof RegExp,bd=e=>Fr(e)?e:jm(e)?e.source:Br(e)?jm(e.value)?e.value.source:e.value:e,U$=e=>({isOnSubmit:!e||e===ss.onSubmit,isOnBlur:e===ss.onBlur,isOnChange:e===ss.onChange,isOnAll:e===ss.all,isOnTouch:e===ss.onTouched});const V$="AsyncFunction";var cH=e=>!!e&&!!e.validate&&!!(as(e.validate)&&e.validate.constructor.name===V$||Br(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===V$)),dH=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),q$=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const uf=(e,t,r,n)=>{for(const i of r||Object.keys(e)){const s=Je(e,i);if(s){const{_f:a,...o}=s;if(a){if(a.refs&&a.refs[0]&&t(a.refs[0],i)&&!n)return!0;if(a.ref&&t(a.ref,a.name)&&!n)return!0;if(uf(o,t))break}else if(Br(o)&&uf(o,t))break}}};function W$(e,t,r){const n=Je(e,r);if(n||Tx(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const s=i.join("."),a=Je(t,s),o=Je(e,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};i.pop()}return{name:r}}var fH=(e,t,r,n)=>{r(e);const{name:i,...s}=e;return On(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(a=>t[a]===(!n||ss.all))},pH=(e,t,r)=>!e||!t||e===t||lf(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),hH=(e,t,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(t||e):(r?n.isOnBlur:i.isOnBlur)?!e:(r?n.isOnChange:i.isOnChange)?e:!0,mH=(e,t)=>!Dg(Je(e,t)).length&&Qr(e,t),gH=(e,t,r)=>{const n=lf(Je(e,r));return sr(n,"root",t[r]),sr(e,r,n),e},Gh=e=>Ds(e);function K$(e,t,r="validate"){if(Gh(e)||Array.isArray(e)&&e.every(Gh)||oi(e)&&!e)return{type:r,message:Gh(e)?e:"",ref:t}}var gu=e=>Br(e)&&!jm(e)?e:{value:e,message:""},H$=async(e,t,r,n,i,s)=>{const{ref:a,refs:o,required:l,maxLength:u,minLength:c,min:f,max:p,pattern:w,validate:x,name:v,valueAsNumber:C,mount:b}=e._f,g=Je(r,v);if(!b||t.has(v))return{};const S=o?o[0]:a,E=X=>{i&&S.reportValidity&&(S.setCustomValidity(oi(X)?"":X||""),S.reportValidity())},A={},M=Nx(a),D=up(a),I=M||D,U=(C||Ix(a))&&Fr(a.value)&&Fr(g)||Om(a)&&a.value===""||g===""||Array.isArray(g)&&!g.length,Z=CD.bind(null,v,n,A),ue=(X,ie,j,le=sa.maxLength,ne=sa.minLength)=>{const ce=X?ie:j;A[v]={type:X?le:ne,message:ce,ref:a,...Z(X?le:ne,ce)}};if(s?!Array.isArray(g)||!g.length:l&&(!I&&(U||jn(g))||oi(g)&&!g||D&&!ID(o).isValid||M&&!PD(o).isValid)){const{value:X,message:ie}=Gh(l)?{value:!!l,message:l}:gu(l);if(X&&(A[v]={type:sa.required,message:ie,ref:S,...Z(sa.required,ie)},!n))return E(ie),A}if(!U&&(!jn(f)||!jn(p))){let X,ie;const j=gu(p),le=gu(f);if(!jn(g)&&!isNaN(g)){const ne=a.valueAsNumber||g&&+g;jn(j.value)||(X=ne>j.value),jn(le.value)||(ie=ne<le.value)}else{const ne=a.valueAsDate||new Date(g),ce=H=>new Date(new Date().toDateString()+" "+H),W=a.type=="time",F=a.type=="week";Ds(j.value)&&g&&(X=W?ce(g)>ce(j.value):F?g>j.value:ne>new Date(j.value)),Ds(le.value)&&g&&(ie=W?ce(g)<ce(le.value):F?g<le.value:ne<new Date(le.value))}if((X||ie)&&(ue(!!X,j.message,le.message,sa.max,sa.min),!n))return E(A[v].message),A}if((u||c)&&!U&&(Ds(g)||s&&Array.isArray(g))){const X=gu(u),ie=gu(c),j=!jn(X.value)&&g.length>+X.value,le=!jn(ie.value)&&g.length<+ie.value;if((j||le)&&(ue(j,X.message,ie.message),!n))return E(A[v].message),A}if(w&&!U&&Ds(g)){const{value:X,message:ie}=gu(w);if(jm(X)&&!g.match(X)&&(A[v]={type:sa.pattern,message:ie,ref:a,...Z(sa.pattern,ie)},!n))return E(ie),A}if(x){if(as(x)){const X=await x(g,r),ie=K$(X,S);if(ie&&(A[v]={...ie,...Z(sa.validate,ie.message)},!n))return E(ie.message),A}else if(Br(x)){let X={};for(const ie in x){if(!On(X)&&!n)break;const j=K$(await x[ie](g,r),S,ie);j&&(X={...j,...Z(ie,j.message)},E(j.message),n&&(A[v]=X))}if(!On(X)&&(A[v]={ref:S,...X},!n))return A}}return E(!0),A};const yH={mode:ss.onSubmit,reValidateMode:ss.onChange,shouldFocusError:!0};function vH(e={}){let t={...yH,...e},r={submitCount:0,isDirty:!1,isLoading:as(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1};const n={};let i=Br(t.defaultValues)||Br(t.values)?fn(t.values||t.defaultValues)||{}:{},s=t.shouldUnregister?{}:fn(i),a={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const c={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...c};const p={array:M$(),state:M$()},w=U$(t.mode),x=U$(t.reValidateMode),v=t.criteriaMode===ss.all,C=G=>ve=>{clearTimeout(u),u=setTimeout(G,ve)},b=async G=>{if(!t.disabled&&(c.isValid||f.isValid||G)){const ve=t.resolver?On((await U()).errors):await ue(n,!0);ve!==r.isValid&&p.state.next({isValid:ve})}},g=(G,ve)=>{!t.disabled&&(c.isValidating||c.validatingFields||f.isValidating||f.validatingFields)&&((G||Array.from(o.mount)).forEach(_e=>{_e&&(ve?sr(r.validatingFields,_e,ve):Qr(r.validatingFields,_e))}),p.state.next({validatingFields:r.validatingFields,isValidating:!On(r.validatingFields)}))},S=(G,ve=[],_e,Ne,ke=!0,Pe=!0)=>{if(Ne&&_e&&!t.disabled){if(a.action=!0,Pe&&Array.isArray(Je(n,G))){const De=_e(Je(n,G),Ne.argA,Ne.argB);ke&&sr(n,G,De)}if(Pe&&Array.isArray(Je(r.errors,G))){const De=_e(Je(r.errors,G),Ne.argA,Ne.argB);ke&&sr(r.errors,G,De),mH(r.errors,G)}if((c.touchedFields||f.touchedFields)&&Pe&&Array.isArray(Je(r.touchedFields,G))){const De=_e(Je(r.touchedFields,G),Ne.argA,Ne.argB);ke&&sr(r.touchedFields,G,De)}(c.dirtyFields||f.dirtyFields)&&(r.dirtyFields=wd(i,s)),p.state.next({name:G,isDirty:ie(G,ve),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else sr(s,G,ve)},E=(G,ve)=>{sr(r.errors,G,ve),p.state.next({errors:r.errors})},A=G=>{r.errors=G,p.state.next({errors:r.errors,isValid:!1})},M=(G,ve,_e,Ne)=>{const ke=Je(n,G);if(ke){const Pe=Je(s,G,Fr(_e)?Je(i,G):_e);Fr(Pe)||Ne&&Ne.defaultChecked||ve?sr(s,G,ve?Pe:B$(ke._f)):ne(G,Pe),a.mount&&b()}},D=(G,ve,_e,Ne,ke)=>{let Pe=!1,De=!1;const tt={name:G};if(!t.disabled){if(!_e||Ne){(c.isDirty||f.isDirty)&&(De=r.isDirty,r.isDirty=tt.isDirty=ie(),Pe=De!==tt.isDirty);const pt=Ha(Je(i,G),ve);De=!!Je(r.dirtyFields,G),pt?Qr(r.dirtyFields,G):sr(r.dirtyFields,G,!0),tt.dirtyFields=r.dirtyFields,Pe=Pe||(c.dirtyFields||f.dirtyFields)&&De!==!pt}if(_e){const pt=Je(r.touchedFields,G);pt||(sr(r.touchedFields,G,_e),tt.touchedFields=r.touchedFields,Pe=Pe||(c.touchedFields||f.touchedFields)&&pt!==_e)}Pe&&ke&&p.state.next(tt)}return Pe?tt:{}},I=(G,ve,_e,Ne)=>{const ke=Je(r.errors,G),Pe=(c.isValid||f.isValid)&&oi(ve)&&r.isValid!==ve;if(t.delayError&&_e?(l=C(()=>E(G,_e)),l(t.delayError)):(clearTimeout(u),l=null,_e?sr(r.errors,G,_e):Qr(r.errors,G)),(_e?!Ha(ke,_e):ke)||!On(Ne)||Pe){const De={...Ne,...Pe&&oi(ve)?{isValid:ve}:{},errors:r.errors,name:G};r={...r,...De},p.state.next(De)}},U=async G=>{g(G,!0);const ve=await t.resolver(s,t.context,uH(G||o.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return g(G),ve},Z=async G=>{const{errors:ve}=await U(G);if(G)for(const _e of G){const Ne=Je(ve,_e);Ne?sr(r.errors,_e,Ne):Qr(r.errors,_e)}else r.errors=ve;return ve},ue=async(G,ve,_e={valid:!0})=>{for(const Ne in G){const ke=G[Ne];if(ke){const{_f:Pe,...De}=ke;if(Pe){const tt=o.array.has(Pe.name),pt=ke._f&&cH(ke._f);pt&&c.validatingFields&&g([Ne],!0);const wt=await H$(ke,o.disabled,s,v,t.shouldUseNativeValidation&&!ve,tt);if(pt&&c.validatingFields&&g([Ne]),wt[Pe.name]&&(_e.valid=!1,ve))break;!ve&&(Je(wt,Pe.name)?tt?gH(r.errors,wt,Pe.name):sr(r.errors,Pe.name,wt[Pe.name]):Qr(r.errors,Pe.name))}!On(De)&&await ue(De,ve,_e)}}return _e.valid},X=()=>{for(const G of o.unMount){const ve=Je(n,G);ve&&(ve._f.refs?ve._f.refs.every(_e=>!Hy(_e)):!Hy(ve._f.ref))&&Te(G)}o.unMount=new Set},ie=(G,ve)=>!t.disabled&&(G&&ve&&sr(s,G,ve),!Ha(ee(),i)),j=(G,ve,_e)=>SD(G,o,{...a.mount?s:Fr(ve)?i:Ds(G)?{[G]:ve}:ve},_e,ve),le=G=>Dg(Je(a.mount?s:i,G,t.shouldUnregister?Je(i,G,[]):[])),ne=(G,ve,_e={})=>{const Ne=Je(n,G);let ke=ve;if(Ne){const Pe=Ne._f;Pe&&(!Pe.disabled&&sr(s,G,ND(ve,Pe)),ke=Om(Pe.ref)&&jn(ve)?"":ve,kD(Pe.ref)?[...Pe.ref.options].forEach(De=>De.selected=ke.includes(De.value)):Pe.refs?up(Pe.ref)?Pe.refs.length>1?Pe.refs.forEach(De=>(!De.defaultChecked||!De.disabled)&&(De.checked=Array.isArray(ke)?!!ke.find(tt=>tt===De.value):ke===De.value)):Pe.refs[0]&&(Pe.refs[0].checked=!!ke):Pe.refs.forEach(De=>De.checked=De.value===ke):Ix(Pe.ref)?Pe.ref.value="":(Pe.ref.value=ke,Pe.ref.type||p.state.next({name:G,values:fn(s)})))}(_e.shouldDirty||_e.shouldTouch)&&D(G,ke,_e.shouldTouch,_e.shouldDirty,!0),_e.shouldValidate&&B(G)},ce=(G,ve,_e)=>{for(const Ne in ve){const ke=ve[Ne],Pe=`${G}.${Ne}`,De=Je(n,Pe);(o.array.has(G)||Br(ke)||De&&!De._f)&&!ll(ke)?ce(Pe,ke,_e):ne(Pe,ke,_e)}},W=(G,ve,_e={})=>{const Ne=Je(n,G),ke=o.array.has(G),Pe=fn(ve);sr(s,G,Pe),ke?(p.array.next({name:G,values:fn(s)}),(c.isDirty||c.dirtyFields||f.isDirty||f.dirtyFields)&&_e.shouldDirty&&p.state.next({name:G,dirtyFields:wd(i,s),isDirty:ie(G,Pe)})):Ne&&!Ne._f&&!jn(Pe)?ce(G,Pe,_e):ne(G,Pe,_e),q$(G,o)&&p.state.next({...r}),p.state.next({name:a.mount?G:void 0,values:fn(s)})},F=async G=>{a.mount=!0;const ve=G.target;let _e=ve.name,Ne=!0;const ke=Je(n,_e),Pe=De=>{Ne=Number.isNaN(De)||ll(De)&&isNaN(De.getTime())||Ha(De,Je(s,_e,De))};if(ke){let De,tt;const pt=ve.type?B$(ke._f):wD(G),wt=G.type===Rm.BLUR||G.type===Rm.FOCUS_OUT,nr=!dH(ke._f)&&!t.resolver&&!Je(r.errors,_e)&&!ke._f.deps||hH(wt,Je(r.touchedFields,_e),r.isSubmitted,x,w),Wt=q$(_e,o,wt);sr(s,_e,pt),wt?(ke._f.onBlur&&ke._f.onBlur(G),l&&l(0)):ke._f.onChange&&ke._f.onChange(G);const lr=D(_e,pt,wt),ir=!On(lr)||Wt;if(!wt&&p.state.next({name:_e,type:G.type,values:fn(s)}),nr)return(c.isValid||f.isValid)&&(t.mode==="onBlur"?wt&&b():wt||b()),ir&&p.state.next({name:_e,...Wt?{}:lr});if(!wt&&Wt&&p.state.next({...r}),t.resolver){const{errors:Ye}=await U([_e]);if(Pe(pt),Ne){const Vr=W$(r.errors,n,_e),jr=W$(Ye,n,Vr.name||_e);De=jr.error,_e=jr.name,tt=On(Ye)}}else g([_e],!0),De=(await H$(ke,o.disabled,s,v,t.shouldUseNativeValidation))[_e],g([_e]),Pe(pt),Ne&&(De?tt=!1:(c.isValid||f.isValid)&&(tt=await ue(n,!0)));Ne&&(ke._f.deps&&B(ke._f.deps),I(_e,tt,De,lr))}},H=(G,ve)=>{if(Je(r.errors,ve)&&G.focus)return G.focus(),1},B=async(G,ve={})=>{let _e,Ne;const ke=lf(G);if(t.resolver){const Pe=await Z(Fr(G)?G:ke);_e=On(Pe),Ne=G?!ke.some(De=>Je(Pe,De)):_e}else G?(Ne=(await Promise.all(ke.map(async Pe=>{const De=Je(n,Pe);return await ue(De&&De._f?{[Pe]:De}:De)}))).every(Boolean),!(!Ne&&!r.isValid)&&b()):Ne=_e=await ue(n);return p.state.next({...!Ds(G)||(c.isValid||f.isValid)&&_e!==r.isValid?{}:{name:G},...t.resolver||!G?{isValid:_e}:{},errors:r.errors}),ve.shouldFocus&&!Ne&&uf(n,H,G?ke:o.mount),Ne},ee=G=>{const ve={...a.mount?s:i};return Fr(G)?ve:Ds(G)?Je(ve,G):G.map(_e=>Je(ve,_e))},me=(G,ve)=>({invalid:!!Je((ve||r).errors,G),isDirty:!!Je((ve||r).dirtyFields,G),error:Je((ve||r).errors,G),isValidating:!!Je(r.validatingFields,G),isTouched:!!Je((ve||r).touchedFields,G)}),K=G=>{G&&lf(G).forEach(ve=>Qr(r.errors,ve)),p.state.next({errors:G?r.errors:{}})},Ae=(G,ve,_e)=>{const Ne=(Je(n,G,{_f:{}})._f||{}).ref,ke=Je(r.errors,G)||{},{ref:Pe,message:De,type:tt,...pt}=ke;sr(r.errors,G,{...pt,...ve,ref:Ne}),p.state.next({name:G,errors:r.errors,isValid:!1}),_e&&_e.shouldFocus&&Ne&&Ne.focus&&Ne.focus()},Ze=(G,ve)=>as(G)?p.state.subscribe({next:_e=>G(j(void 0,ve),_e)}):j(G,ve,!0),be=G=>p.state.subscribe({next:ve=>{pH(G.name,ve.name,G.exact)&&fH(ve,G.formState||c,Zt,G.reRenderRoot)&&G.callback({values:{...s},...r,...ve})}}).unsubscribe,ge=G=>(a.mount=!0,f={...f,...G.formState},be({...G,formState:f})),Te=(G,ve={})=>{for(const _e of G?lf(G):o.mount)o.mount.delete(_e),o.array.delete(_e),ve.keepValue||(Qr(n,_e),Qr(s,_e)),!ve.keepError&&Qr(r.errors,_e),!ve.keepDirty&&Qr(r.dirtyFields,_e),!ve.keepTouched&&Qr(r.touchedFields,_e),!ve.keepIsValidating&&Qr(r.validatingFields,_e),!t.shouldUnregister&&!ve.keepDefaultValue&&Qr(i,_e);p.state.next({values:fn(s)}),p.state.next({...r,...ve.keepDirty?{isDirty:ie()}:{}}),!ve.keepIsValid&&b()},Ee=({disabled:G,name:ve})=>{(oi(G)&&a.mount||G||o.disabled.has(ve))&&(G?o.disabled.add(ve):o.disabled.delete(ve))},We=(G,ve={})=>{let _e=Je(n,G);const Ne=oi(ve.disabled)||oi(t.disabled);return sr(n,G,{..._e||{},_f:{..._e&&_e._f?_e._f:{ref:{name:G}},name:G,mount:!0,...ve}}),o.mount.add(G),_e?Ee({disabled:oi(ve.disabled)?ve.disabled:t.disabled,name:G}):M(G,!0,ve.value),{...Ne?{disabled:ve.disabled||t.disabled}:{},...t.progressive?{required:!!ve.required,min:bd(ve.min),max:bd(ve.max),minLength:bd(ve.minLength),maxLength:bd(ve.maxLength),pattern:bd(ve.pattern)}:{},name:G,onChange:F,onBlur:F,ref:ke=>{if(ke){We(G,ve),_e=Je(n,G);const Pe=Fr(ke.value)&&ke.querySelectorAll&&ke.querySelectorAll("input,select,textarea")[0]||ke,De=aH(Pe),tt=_e._f.refs||[];if(De?tt.find(pt=>pt===Pe):Pe===_e._f.ref)return;sr(n,G,{_f:{..._e._f,...De?{refs:[...tt.filter(Hy),Pe,...Array.isArray(Je(i,G))?[{}]:[]],ref:{type:Pe.type,name:G}}:{ref:Pe}}}),M(G,!1,void 0,Pe)}else _e=Je(n,G,{}),_e._f&&(_e._f.mount=!1),(t.shouldUnregister||ve.shouldUnregister)&&!(bD(o.array,G)&&a.action)&&o.unMount.add(G)}}},Fe=()=>t.shouldFocusError&&uf(n,H,o.mount),He=G=>{oi(G)&&(p.state.next({disabled:G}),uf(n,(ve,_e)=>{const Ne=Je(n,_e);Ne&&(ve.disabled=Ne._f.disabled||G,Array.isArray(Ne._f.refs)&&Ne._f.refs.forEach(ke=>{ke.disabled=Ne._f.disabled||G}))},0,!1))},Ve=(G,ve)=>async _e=>{let Ne;_e&&(_e.preventDefault&&_e.preventDefault(),_e.persist&&_e.persist());let ke=fn(s);if(p.state.next({isSubmitting:!0}),t.resolver){const{errors:Pe,values:De}=await U();r.errors=Pe,ke=De}else await ue(n);if(o.disabled.size)for(const Pe of o.disabled)sr(ke,Pe,void 0);if(Qr(r.errors,"root"),On(r.errors)){p.state.next({errors:{}});try{await G(ke,_e)}catch(Pe){Ne=Pe}}else ve&&await ve({...r.errors},_e),Fe(),setTimeout(Fe);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:On(r.errors)&&!Ne,submitCount:r.submitCount+1,errors:r.errors}),Ne)throw Ne},vt=(G,ve={})=>{Je(n,G)&&(Fr(ve.defaultValue)?W(G,fn(Je(i,G))):(W(G,ve.defaultValue),sr(i,G,fn(ve.defaultValue))),ve.keepTouched||Qr(r.touchedFields,G),ve.keepDirty||(Qr(r.dirtyFields,G),r.isDirty=ve.defaultValue?ie(G,fn(Je(i,G))):ie()),ve.keepError||(Qr(r.errors,G),c.isValid&&b()),p.state.next({...r}))},gt=(G,ve={})=>{const _e=G?fn(G):i,Ne=fn(_e),ke=On(G),Pe=ke?i:Ne;if(ve.keepDefaultValues||(i=_e),!ve.keepValues){if(ve.keepDirtyValues){const De=new Set([...o.mount,...Object.keys(wd(i,s))]);for(const tt of Array.from(De))Je(r.dirtyFields,tt)?sr(Pe,tt,Je(s,tt)):W(tt,Je(Pe,tt))}else{if(Ex&&Fr(G))for(const De of o.mount){const tt=Je(n,De);if(tt&&tt._f){const pt=Array.isArray(tt._f.refs)?tt._f.refs[0]:tt._f.ref;if(Om(pt)){const wt=pt.closest("form");if(wt){wt.reset();break}}}}for(const De of o.mount)W(De,Je(Pe,De))}s=fn(Pe),p.array.next({values:{...Pe}}),p.state.next({values:{...Pe}})}o={mount:ve.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!c.isValid||!!ve.keepIsValid||!!ve.keepDirtyValues,a.watch=!!t.shouldUnregister,p.state.next({submitCount:ve.keepSubmitCount?r.submitCount:0,isDirty:ke?!1:ve.keepDirty?r.isDirty:!!(ve.keepDefaultValues&&!Ha(G,i)),isSubmitted:ve.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:ke?{}:ve.keepDirtyValues?ve.keepDefaultValues&&s?wd(i,s):r.dirtyFields:ve.keepDefaultValues&&G?wd(i,G):ve.keepDirty?r.dirtyFields:{},touchedFields:ve.keepTouched?r.touchedFields:{},errors:ve.keepErrors?r.errors:{},isSubmitSuccessful:ve.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},ot=(G,ve)=>gt(as(G)?G(s):G,ve),rr=(G,ve={})=>{const _e=Je(n,G),Ne=_e&&_e._f;if(Ne){const ke=Ne.refs?Ne.refs[0]:Ne.ref;ke.focus&&(ke.focus(),ve.shouldSelect&&as(ke.select)&&ke.select())}},Zt=G=>{r={...r,...G}},Ut={control:{register:We,unregister:Te,getFieldState:me,handleSubmit:Ve,setError:Ae,_subscribe:be,_runSchema:U,_getWatch:j,_getDirty:ie,_setValid:b,_setFieldArray:S,_setDisabledField:Ee,_setErrors:A,_getFieldArray:le,_reset:gt,_resetDefaultValues:()=>as(t.defaultValues)&&t.defaultValues().then(G=>{ot(G,t.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:X,_disableForm:He,_subjects:p,_proxyFormState:c,get _fields(){return n},get _formValues(){return s},get _state(){return a},set _state(G){a=G},get _defaultValues(){return i},get _names(){return o},set _names(G){o=G},get _formState(){return r},get _options(){return t},set _options(G){t={...t,...G}}},subscribe:ge,trigger:B,register:We,handleSubmit:Ve,watch:Ze,setValue:W,getValues:ee,reset:ot,resetField:vt,clearErrors:K,unregister:Te,setError:Ae,setFocus:rr,getFieldState:me};return{...Ut,formControl:Ut}}function wH(e={}){const t=Nt.useRef(void 0),r=Nt.useRef(void 0),[n,i]=Nt.useState({isDirty:!1,isValidating:!1,isLoading:as(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:as(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...e.formControl?e.formControl:vH(e),formState:n},e.formControl&&e.defaultValues&&!as(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions));const s=t.current.control;return s._options=e,Nt.useLayoutEffect(()=>s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0}),[s]),Nt.useEffect(()=>s._disableForm(e.disabled),[s,e.disabled]),Nt.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==n.isDirty&&s._subjects.state.next({isDirty:a})}},[s,n.isDirty]),Nt.useEffect(()=>{e.values&&!Ha(e.values,r.current)?(s._reset(e.values,s._options.resetOptions),r.current=e.values,i(a=>({...a}))):s._resetDefaultValues()},[e.values,s]),Nt.useEffect(()=>{e.errors&&!On(e.errors)&&s._setErrors(e.errors)},[e.errors,s]),Nt.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),Nt.useEffect(()=>{e.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[e.shouldUnregister,s]),t.current.formState=$D(n,s),t.current}const G$=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Je(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},AD=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?G$(n.ref,r,e):n.refs&&n.refs.forEach(i=>G$(i,r,e))}},bH=(e,t)=>{t.shouldUseNativeValidation&&AD(e,t);const r={};for(const n in e){const i=Je(t.fields,n),s=Object.assign(e[n]||{},{ref:i&&i.ref});if(xH(t.names||Object.keys(e),n)){const a=Object.assign({},Je(r,n));sr(a,"root",s),sr(r,n,a)}else sr(r,n,s)}return r},xH=(e,t)=>e.some(r=>r.startsWith(t+"."));var _H=function(e,t){for(var r={};e.length;){var n=e[0],i=n.code,s=n.message,a=n.path.join(".");if(!r[a])if("unionErrors"in n){var o=n.unionErrors[0].errors[0];r[a]={message:o.message,type:o.code}}else r[a]={message:s,type:i};if("unionErrors"in n&&n.unionErrors.forEach(function(c){return c.errors.forEach(function(f){return e.push(f)})}),t){var l=r[a].types,u=l&&l[n.code];r[a]=CD(a,t,r,i,u?[].concat(u,n.message):n.message)}e.shift()}return r},$H=function(e,t,r){return r===void 0&&(r={}),function(n,i,s){try{return Promise.resolve(function(a,o){try{var l=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(u){return s.shouldUseNativeValidation&&AD({},s),{errors:{},values:r.raw?n:u}})}catch(u){return o(u)}return l&&l.then?l.then(void 0,o):l}(0,function(a){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(a))return{values:{},errors:bH(_H(a.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw a}))}catch(a){return Promise.reject(a)}}};const Re=Symbol.for("drizzle:entityKind");function hn(e,t){if(!e||typeof e!="object")return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,Re))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(e).constructor;if(r)for(;r;){if(Re in r&&r[Re]===t[Re])return!0;r=Object.getPrototypeOf(r)}return!1}var nE;nE=Re;class bc{constructor(t,r){fe(this,"name");fe(this,"keyAsName");fe(this,"primary");fe(this,"notNull");fe(this,"default");fe(this,"defaultFn");fe(this,"onUpdateFn");fe(this,"hasDefault");fe(this,"isUnique");fe(this,"uniqueName");fe(this,"uniqueType");fe(this,"dataType");fe(this,"columnType");fe(this,"enumValues");fe(this,"generated");fe(this,"generatedIdentity");fe(this,"config");this.table=t,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}fe(bc,nE,"Column");var iE;iE=Re;class RD{constructor(t,r,n){fe(this,"config");fe(this,"$default",this.$defaultFn);fe(this,"$onUpdate",this.$onUpdateFn);this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}fe(RD,iE,"ColumnBuilder");const Hu=Symbol.for("drizzle:Name");var sE;sE=Re;class OD{constructor(t,r){fe(this,"reference");fe(this,"_onUpdate","no action");fe(this,"_onDelete","no action");this.reference=()=>{const{name:n,columns:i,foreignColumns:s}=t();return{name:n,columns:i,foreignTable:s[0].table,foreignColumns:s}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(t){return this._onUpdate=t===void 0?"no action":t,this}onDelete(t){return this._onDelete=t===void 0?"no action":t,this}build(t){return new DD(t,this)}}fe(OD,sE,"PgForeignKeyBuilder");var aE;aE=Re;class DD{constructor(t,r){fe(this,"reference");fe(this,"onUpdate");fe(this,"onDelete");this.table=t,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:t,columns:r,foreignColumns:n}=this.reference(),i=r.map(o=>o.name),s=n.map(o=>o.name),a=[this.table[Hu],...i,n[0].table[Hu],...s];return t??`${a.join("_")}_fk`}}fe(DD,aE,"PgForeignKey");function SH(e,...t){return e(...t)}function CH(e,t){return`${e[Hu]}_${t.join("_")}_unique`}function Q$(e,t,r){for(let n=t;n<e.length;n++){const i=e[n];if(i==="\\"){n++;continue}if(i==='"')return[e.slice(t,n).replace(/\\/g,""),n+1];if(!r&&(i===","||i==="}"))return[e.slice(t,n).replace(/\\/g,""),n]}return[e.slice(t).replace(/\\/g,""),e.length]}function jD(e,t=0){const r=[];let n=t,i=!1;for(;n<e.length;){const s=e[n];if(s===","){(i||n===t)&&r.push(""),i=!0,n++;continue}if(i=!1,s==="\\"){n+=2;continue}if(s==='"'){const[l,u]=Q$(e,n+1,!0);r.push(l),n=u;continue}if(s==="}")return[r,n+1];if(s==="{"){const[l,u]=jD(e,n+1);r.push(l),n=u;continue}const[a,o]=Q$(e,n,!1);r.push(a),n=o}return[r,n]}function kH(e){const[t]=jD(e,1);return t}function MD(e){return`{${e.map(t=>Array.isArray(t)?MD(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}var oE,lE;class Qt extends(lE=RD,oE=Re,lE){constructor(){super(...arguments);fe(this,"foreignKeyConfigs",[])}array(r){return new FD(this.config.name,this,r)}references(r,n={}){return this.foreignKeyConfigs.push({ref:r,actions:n}),this}unique(r,n){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=n==null?void 0:n.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,n){return this.foreignKeyConfigs.map(({ref:i,actions:s})=>SH((a,o)=>{const l=new OD(()=>{const u=a();return{columns:[r],foreignColumns:[u]}});return o.onUpdate&&l.onUpdate(o.onUpdate),o.onDelete&&l.onDelete(o.onDelete),l.build(n)},i,s))}buildExtraConfigColumn(r){return new zD(r,this.config)}}fe(Qt,oE,"PgColumnBuilder");var uE,cE;class At extends(cE=bc,uE=Re,cE){constructor(t,r){r.uniqueName||(r.uniqueName=CH(t,[r.name])),super(t,r),this.table=t}}fe(At,uE,"PgColumn");var dE,fE;class zD extends(fE=At,dE=Re,fE){constructor(){super(...arguments);fe(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});fe(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}fe(zD,dE,"ExtraConfigColumn");var pE,hE;class FD extends(hE=Qt,pE=Re,hE){constructor(t,r,n){super(t,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(t){const r=this.config.baseBuilder.build(t);return new vw(t,this.config,r)}}fe(FD,pE,"PgArrayBuilder");var mE,gE;const ig=class ig extends(gE=At,mE=Re,gE){constructor(r,n,i,s){super(r,n);fe(this,"size");this.baseColumn=i,this.range=s,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=kH(r)),r.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(r,n=!1){const i=r.map(s=>s===null?null:hn(this.baseColumn,ig)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return n?i:MD(i)}};fe(ig,mE,"PgArray");let vw=ig;const Z$=Symbol.for("drizzle:isPgEnum");function EH(e){return!!e&&typeof e=="function"&&Z$ in e&&e[Z$]===!0}var yE;yE=Re;class Px{constructor(t,r,n,i=!1){this._={brand:"Subquery",sql:t,selectedFields:r,alias:n,isWith:i}}}fe(Px,yE,"Subquery");const TH={startActiveSpan(e,t){return t()}},Gu=Symbol.for("drizzle:ViewBaseConfig"),Gy=Symbol.for("drizzle:Schema"),Y$=Symbol.for("drizzle:Columns"),X$=Symbol.for("drizzle:ExtraConfigColumns"),Qy=Symbol.for("drizzle:OriginalName"),Zy=Symbol.for("drizzle:BaseName"),Mm=Symbol.for("drizzle:IsAlias"),J$=Symbol.for("drizzle:ExtraConfigBuilder"),LD=Symbol.for("drizzle:IsDrizzleTable");var vE,wE,bE,xE,_E,$E,SE,CE,kE,EE,Th;let ui=(EE=Re,kE=Hu,CE=Qy,SE=Gy,$E=Y$,_E=X$,xE=Zy,bE=Mm,wE=LD,vE=J$,Th=class{constructor(t,r,n){fe(this,kE);fe(this,CE);fe(this,SE);fe(this,$E);fe(this,_E);fe(this,xE);fe(this,bE,!1);fe(this,wE,!0);fe(this,vE);this[Hu]=this[Qy]=t,this[Gy]=r,this[Zy]=n}},fe(Th,EE,"Table"),fe(Th,"Symbol",{Name:Hu,Schema:Gy,OriginalName:Qy,Columns:Y$,ExtraConfigColumns:X$,BaseName:Zy,IsAlias:Mm,ExtraConfigBuilder:J$}),Th);function BD(e){return typeof e=="object"&&e!==null&&LD in e}function IH(e){return e!=null&&typeof e.getSQL=="function"}function NH(e){var r;const t={sql:"",params:[]};for(const n of e)t.sql+=n.sql,t.params.push(...n.params),(r=n.typings)!=null&&r.length&&(t.typings||(t.typings=[]),t.typings.push(...n.typings));return t}var TE;TE=Re;class ki{constructor(t){fe(this,"value");this.value=Array.isArray(t)?t:[t]}getSQL(){return new Jr([this])}}fe(ki,TE,"StringChunk");var IE;IE=Re;const rl=class rl{constructor(t){fe(this,"decoder",UD);fe(this,"shouldInlineParams",!1);this.queryChunks=t}append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return TH.startActiveSpan("drizzle.buildSQL",r=>{const n=this.buildQueryFromSourceParams(this.queryChunks,t);return r==null||r.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(t,r){const n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:i,escapeName:s,escapeParam:a,prepareTyping:o,inlineParams:l,paramStartIndex:u}=n;return NH(t.map(c=>{var f;if(hn(c,ki))return{sql:c.value.join(""),params:[]};if(hn(c,zm))return{sql:s(c.value),params:[]};if(c===void 0)return{sql:"",params:[]};if(Array.isArray(c)){const p=[new ki("(")];for(const[w,x]of c.entries())p.push(x),w<c.length-1&&p.push(new ki(", "));return p.push(new ki(")")),this.buildQueryFromSourceParams(p,n)}if(hn(c,rl))return this.buildQueryFromSourceParams(c.queryChunks,{...n,inlineParams:l||c.shouldInlineParams});if(hn(c,ui)){const p=c[ui.Symbol.Schema],w=c[ui.Symbol.Name];return{sql:p===void 0||c[Mm]?s(w):s(p)+"."+s(w),params:[]}}if(hn(c,bc)){const p=i.getColumnCasing(c);if(r.invokeSource==="indexes")return{sql:s(p),params:[]};const w=c.table[ui.Symbol.Schema];return{sql:c.table[Mm]||w===void 0?s(c.table[ui.Symbol.Name])+"."+s(p):s(w)+"."+s(c.table[ui.Symbol.Name])+"."+s(p),params:[]}}if(hn(c,WD)){const p=c[Gu].schema,w=c[Gu].name;return{sql:p===void 0||c[Gu].isAlias?s(w):s(p)+"."+s(w),params:[]}}if(hn(c,Ax)){if(hn(c.value,Fm))return{sql:a(u.value++,c),params:[c],typings:["none"]};const p=c.value===null?null:c.encoder.mapToDriverValue(c.value);if(hn(p,rl))return this.buildQueryFromSourceParams([p],n);if(l)return{sql:this.mapInlineParam(p,n),params:[]};let w=["none"];return o&&(w=[o(c.encoder)]),{sql:a(u.value++,p),params:[p],typings:w}}return hn(c,Fm)?{sql:a(u.value++,c),params:[c],typings:["none"]}:hn(c,rl.Aliased)&&c.fieldAlias!==void 0?{sql:s(c.fieldAlias),params:[]}:hn(c,Px)?c._.isWith?{sql:s(c._.alias),params:[]}:this.buildQueryFromSourceParams([new ki("("),c._.sql,new ki(") "),new zm(c._.alias)],n):EH(c)?c.schema?{sql:s(c.schema)+"."+s(c.enumName),params:[]}:{sql:s(c.enumName),params:[]}:IH(c)?(f=c.shouldOmitSQLParens)!=null&&f.call(c)?this.buildQueryFromSourceParams([c.getSQL()],n):this.buildQueryFromSourceParams([new ki("("),c.getSQL(),new ki(")")],n):l?{sql:this.mapInlineParam(c,n),params:[]}:{sql:a(u.value++,c),params:[c],typings:["none"]}}))}mapInlineParam(t,{escapeString:r}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return r(t);if(typeof t=="object"){const n=t.toString();return r(n==="[object Object]"?JSON.stringify(t):n)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new rl.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}};fe(rl,IE,"SQL");let Jr=rl;var NE;NE=Re;class zm{constructor(t){fe(this,"brand");this.value=t}getSQL(){return new Jr([this])}}fe(zm,NE,"Name");const UD={mapFromDriverValue:e=>e},VD={mapToDriverValue:e=>e};({...UD,...VD});var PE;PE=Re;class Ax{constructor(t,r=VD){fe(this,"brand");this.value=t,this.encoder=r}getSQL(){return new Jr([this])}}fe(Ax,PE,"Param");function Us(e,...t){const r=[];(t.length>0||e.length>0&&e[0]!=="")&&r.push(new ki(e[0]));for(const[n,i]of t.entries())r.push(i,new ki(e[n+1]));return new Jr(r)}(e=>{function t(){return new Jr([])}e.empty=t;function r(l){return new Jr(l)}e.fromList=r;function n(l){return new Jr([new ki(l)])}e.raw=n;function i(l,u){const c=[];for(const[f,p]of l.entries())f>0&&u!==void 0&&c.push(u),c.push(p);return new Jr(c)}e.join=i;function s(l){return new zm(l)}e.identifier=s;function a(l){return new Fm(l)}e.placeholder=a;function o(l,u){return new Ax(l,u)}e.param=o})(Us||(Us={}));(e=>{var r;r=Re;const n=class n{constructor(s,a){fe(this,"isSelectionField",!1);this.sql=s,this.fieldAlias=a}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}};fe(n,r,"SQL.Aliased");let t=n;e.Aliased=t})(Jr||(Jr={}));var AE;AE=Re;class Fm{constructor(t){this.name=t}getSQL(){return new Jr([this])}}fe(Fm,AE,"Placeholder");const qD=Symbol.for("drizzle:IsDrizzleView");var RE,OE,DE;DE=Re,OE=Gu,RE=qD;class WD{constructor({name:t,schema:r,selectedFields:n,query:i}){fe(this,OE);fe(this,RE,!0);this[Gu]={name:t,originalName:t,schema:r,selectedFields:n,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new Jr([this])}}fe(WD,DE,"View");function PH(e){return typeof e=="object"&&e!==null&&qD in e}bc.prototype.getSQL=function(){return new Jr([this])};ui.prototype.getSQL=function(){return new Jr([this])};Px.prototype.getSQL=function(){return new Jr([this])};function AH(e){return e[ui.Symbol.Columns]}function RH(e){return e[Gu].selectedFields}function un(e,t){return{name:typeof e=="string"&&e.length>0?e:"",config:typeof e=="object"?e:t}}var jE,ME;class cp extends(ME=Qt,jE=Re,ME){generatedAlwaysAsIdentity(t){if(t){const{name:r,...n}=t;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(t){if(t){const{name:r,...n}=t;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}fe(cp,jE,"PgIntColumnBaseBuilder");var zE,FE;class KD extends(FE=cp,zE=Re,FE){constructor(t){super(t,"number","PgBigInt53")}build(t){return new HD(t,this.config)}}fe(KD,zE,"PgBigInt53Builder");var LE,BE;class HD extends(BE=At,LE=Re,BE){getSQLType(){return"bigint"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}fe(HD,LE,"PgBigInt53");var UE,VE;class GD extends(VE=cp,UE=Re,VE){constructor(t){super(t,"bigint","PgBigInt64")}build(t){return new QD(t,this.config)}}fe(GD,UE,"PgBigInt64Builder");var qE,WE;class QD extends(WE=At,qE=Re,WE){getSQLType(){return"bigint"}mapFromDriverValue(t){return BigInt(t)}}fe(QD,qE,"PgBigInt64");function OH(e,t){const{name:r,config:n}=un(e,t);return n.mode==="number"?new KD(r):new GD(r)}var KE,HE;class ZD extends(HE=Qt,KE=Re,HE){constructor(t){super(t,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new YD(t,this.config)}}fe(ZD,KE,"PgBigSerial53Builder");var GE,QE;class YD extends(QE=At,GE=Re,QE){getSQLType(){return"bigserial"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}fe(YD,GE,"PgBigSerial53");var ZE,YE;class XD extends(YE=Qt,ZE=Re,YE){constructor(t){super(t,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(t){return new JD(t,this.config)}}fe(XD,ZE,"PgBigSerial64Builder");var XE,JE;class JD extends(JE=At,XE=Re,JE){getSQLType(){return"bigserial"}mapFromDriverValue(t){return BigInt(t)}}fe(JD,XE,"PgBigSerial64");function DH(e,t){const{name:r,config:n}=un(e,t);return n.mode==="number"?new ZD(r):new XD(r)}var eT,tT;class ej extends(tT=Qt,eT=Re,tT){constructor(t){super(t,"boolean","PgBoolean")}build(t){return new tj(t,this.config)}}fe(ej,eT,"PgBooleanBuilder");var rT,nT;class tj extends(nT=At,rT=Re,nT){getSQLType(){return"boolean"}}fe(tj,rT,"PgBoolean");function jH(e){return new ej(e??"")}var iT,sT;class rj extends(sT=Qt,iT=Re,sT){constructor(t,r){super(t,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(t){return new nj(t,this.config)}}fe(rj,iT,"PgCharBuilder");var aT,oT;class nj extends(oT=At,aT=Re,oT){constructor(){super(...arguments);fe(this,"length",this.config.length);fe(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}fe(nj,aT,"PgChar");function MH(e,t={}){const{name:r,config:n}=un(e,t);return new rj(r,n)}var lT,uT;class ij extends(uT=Qt,lT=Re,uT){constructor(t){super(t,"string","PgCidr")}build(t){return new sj(t,this.config)}}fe(ij,lT,"PgCidrBuilder");var cT,dT;class sj extends(dT=At,cT=Re,dT){getSQLType(){return"cidr"}}fe(sj,cT,"PgCidr");function zH(e){return new ij(e??"")}var fT,pT;class aj extends(pT=Qt,fT=Re,pT){constructor(t,r,n){super(t,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(t){return new oj(t,this.config)}}fe(aj,fT,"PgCustomColumnBuilder");var hT,mT;class oj extends(mT=At,hT=Re,mT){constructor(r,n){super(r,n);fe(this,"sqlName");fe(this,"mapTo");fe(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}fe(oj,hT,"PgCustomColumn");function FH(e){return(t,r)=>{const{name:n,config:i}=un(t,r);return new aj(n,i,e)}}var gT,yT;class Oc extends(yT=Qt,gT=Re,yT){defaultNow(){return this.default(Us`now()`)}}fe(Oc,gT,"PgDateColumnBaseBuilder");var vT,wT;class lj extends(wT=Oc,vT=Re,wT){constructor(t){super(t,"date","PgDate")}build(t){return new uj(t,this.config)}}fe(lj,vT,"PgDateBuilder");var bT,xT;class uj extends(xT=At,bT=Re,xT){getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}mapToDriverValue(t){return t.toISOString()}}fe(uj,bT,"PgDate");var _T,$T;class cj extends($T=Oc,_T=Re,$T){constructor(t){super(t,"string","PgDateString")}build(t){return new dj(t,this.config)}}fe(cj,_T,"PgDateStringBuilder");var ST,CT;class dj extends(CT=At,ST=Re,CT){getSQLType(){return"date"}}fe(dj,ST,"PgDateString");function LH(e,t){const{name:r,config:n}=un(e,t);return(n==null?void 0:n.mode)==="date"?new lj(r):new cj(r)}var kT,ET;class fj extends(ET=Qt,kT=Re,ET){constructor(t){super(t,"number","PgDoublePrecision")}build(t){return new pj(t,this.config)}}fe(fj,kT,"PgDoublePrecisionBuilder");var TT,IT;class pj extends(IT=At,TT=Re,IT){getSQLType(){return"double precision"}mapFromDriverValue(t){return typeof t=="string"?Number.parseFloat(t):t}}fe(pj,TT,"PgDoublePrecision");function BH(e){return new fj(e??"")}var NT,PT;class hj extends(PT=Qt,NT=Re,PT){constructor(t){super(t,"string","PgInet")}build(t){return new mj(t,this.config)}}fe(hj,NT,"PgInetBuilder");var AT,RT;class mj extends(RT=At,AT=Re,RT){getSQLType(){return"inet"}}fe(mj,AT,"PgInet");function UH(e){return new hj(e??"")}var OT,DT;class gj extends(DT=cp,OT=Re,DT){constructor(t){super(t,"number","PgInteger")}build(t){return new yj(t,this.config)}}fe(gj,OT,"PgIntegerBuilder");var jT,MT;class yj extends(MT=At,jT=Re,MT){getSQLType(){return"integer"}mapFromDriverValue(t){return typeof t=="string"?Number.parseInt(t):t}}fe(yj,jT,"PgInteger");function an(e){return new gj(e??"")}var zT,FT;class vj extends(FT=Qt,zT=Re,FT){constructor(t,r){super(t,"string","PgInterval"),this.config.intervalConfig=r}build(t){return new wj(t,this.config)}}fe(vj,zT,"PgIntervalBuilder");var LT,BT;class wj extends(BT=At,LT=Re,BT){constructor(){super(...arguments);fe(this,"fields",this.config.intervalConfig.fields);fe(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${r}${n}`}}fe(wj,LT,"PgInterval");function VH(e,t={}){const{name:r,config:n}=un(e,t);return new vj(r,n)}var UT,VT;class bj extends(VT=Qt,UT=Re,VT){constructor(t){super(t,"json","PgJson")}build(t){return new xj(t,this.config)}}fe(bj,UT,"PgJsonBuilder");var qT,WT;class xj extends(WT=At,qT=Re,WT){constructor(t,r){super(t,r)}getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}fe(xj,qT,"PgJson");function qH(e){return new bj(e??"")}var KT,HT;class _j extends(HT=Qt,KT=Re,HT){constructor(t){super(t,"json","PgJsonb")}build(t){return new $j(t,this.config)}}fe(_j,KT,"PgJsonbBuilder");var GT,QT;class $j extends(QT=At,GT=Re,QT){constructor(t,r){super(t,r)}getSQLType(){return"jsonb"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}fe($j,GT,"PgJsonb");function WH(e){return new _j(e??"")}var ZT,YT;class Sj extends(YT=Qt,ZT=Re,YT){constructor(t){super(t,"array","PgLine")}build(t){return new Cj(t,this.config)}}fe(Sj,ZT,"PgLineBuilder");var XT,JT;class Cj extends(JT=At,XT=Re,JT){getSQLType(){return"line"}mapFromDriverValue(t){const[r,n,i]=t.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(t){return`{${t[0]},${t[1]},${t[2]}}`}}fe(Cj,XT,"PgLine");var eI,tI;class kj extends(tI=Qt,eI=Re,tI){constructor(t){super(t,"json","PgLineABC")}build(t){return new Ej(t,this.config)}}fe(kj,eI,"PgLineABCBuilder");var rI,nI;class Ej extends(nI=At,rI=Re,nI){getSQLType(){return"line"}mapFromDriverValue(t){const[r,n,i]=t.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(t){return`{${t.a},${t.b},${t.c}}`}}fe(Ej,rI,"PgLineABC");function KH(e,t){const{name:r,config:n}=un(e,t);return!(n!=null&&n.mode)||n.mode==="tuple"?new Sj(r):new kj(r)}var iI,sI;class Tj extends(sI=Qt,iI=Re,sI){constructor(t){super(t,"string","PgMacaddr")}build(t){return new Ij(t,this.config)}}fe(Tj,iI,"PgMacaddrBuilder");var aI,oI;class Ij extends(oI=At,aI=Re,oI){getSQLType(){return"macaddr"}}fe(Ij,aI,"PgMacaddr");function HH(e){return new Tj(e??"")}var lI,uI;class Nj extends(uI=Qt,lI=Re,uI){constructor(t){super(t,"string","PgMacaddr8")}build(t){return new Pj(t,this.config)}}fe(Nj,lI,"PgMacaddr8Builder");var cI,dI;class Pj extends(dI=At,cI=Re,dI){getSQLType(){return"macaddr8"}}fe(Pj,cI,"PgMacaddr8");function GH(e){return new Nj(e??"")}var fI,pI;class Aj extends(pI=Qt,fI=Re,pI){constructor(t,r,n){super(t,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(t){return new Rj(t,this.config)}}fe(Aj,fI,"PgNumericBuilder");var hI,mI;class Rj extends(mI=At,hI=Re,mI){constructor(r,n){super(r,n);fe(this,"precision");fe(this,"scale");this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}fe(Rj,hI,"PgNumeric");function QH(e,t){const{name:r,config:n}=un(e,t);return new Aj(r,n==null?void 0:n.precision,n==null?void 0:n.scale)}var gI,yI;class Oj extends(yI=Qt,gI=Re,yI){constructor(t){super(t,"array","PgPointTuple")}build(t){return new Dj(t,this.config)}}fe(Oj,gI,"PgPointTupleBuilder");var vI,wI;class Dj extends(wI=At,vI=Re,wI){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[r,n]=t.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[t.x,t.y]}mapToDriverValue(t){return`(${t[0]},${t[1]})`}}fe(Dj,vI,"PgPointTuple");var bI,xI;class jj extends(xI=Qt,bI=Re,xI){constructor(t){super(t,"json","PgPointObject")}build(t){return new Mj(t,this.config)}}fe(jj,bI,"PgPointObjectBuilder");var _I,$I;class Mj extends($I=At,_I=Re,$I){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[r,n]=t.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return t}mapToDriverValue(t){return`(${t.x},${t.y})`}}fe(Mj,_I,"PgPointObject");function ZH(e,t){const{name:r,config:n}=un(e,t);return!(n!=null&&n.mode)||n.mode==="tuple"?new Oj(r):new jj(r)}function YH(e){const t=[];for(let r=0;r<e.length;r+=2)t.push(Number.parseInt(e.slice(r,r+2),16));return new Uint8Array(t)}function e2(e,t){const r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,e[t+i]);return n.getFloat64(0,!0)}function zj(e){const t=YH(e);let r=0;const n=t[r];r+=1;const i=new DataView(t.buffer),s=i.getUint32(r,n===1);if(r+=4,s&536870912&&(i.getUint32(r,n===1),r+=4),(s&65535)===1){const a=e2(t,r);r+=8;const o=e2(t,r);return r+=8,[a,o]}throw new Error("Unsupported geometry type")}var SI,CI;class Fj extends(CI=Qt,SI=Re,CI){constructor(t){super(t,"array","PgGeometry")}build(t){return new Lj(t,this.config)}}fe(Fj,SI,"PgGeometryBuilder");var kI,EI;class Lj extends(EI=At,kI=Re,EI){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){return zj(t)}mapToDriverValue(t){return`point(${t[0]} ${t[1]})`}}fe(Lj,kI,"PgGeometry");var TI,II;class Bj extends(II=Qt,TI=Re,II){constructor(t){super(t,"json","PgGeometryObject")}build(t){return new Uj(t,this.config)}}fe(Bj,TI,"PgGeometryObjectBuilder");var NI,PI;class Uj extends(PI=At,NI=Re,PI){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){const r=zj(t);return{x:r[0],y:r[1]}}mapToDriverValue(t){return`point(${t.x} ${t.y})`}}fe(Uj,NI,"PgGeometryObject");function XH(e,t){const{name:r,config:n}=un(e,t);return!(n!=null&&n.mode)||n.mode==="tuple"?new Fj(r):new Bj(r)}var AI,RI;class Vj extends(RI=Qt,AI=Re,RI){constructor(t,r){super(t,"number","PgReal"),this.config.length=r}build(t){return new qj(t,this.config)}}fe(Vj,AI,"PgRealBuilder");var OI,DI;class qj extends(DI=At,OI=Re,DI){constructor(r,n){super(r,n);fe(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}fe(qj,OI,"PgReal");function JH(e){return new Vj(e??"")}var jI,MI;class Wj extends(MI=Qt,jI=Re,MI){constructor(t){super(t,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new Kj(t,this.config)}}fe(Wj,jI,"PgSerialBuilder");var zI,FI;class Kj extends(FI=At,zI=Re,FI){getSQLType(){return"serial"}}fe(Kj,zI,"PgSerial");function eG(e){return new Wj(e??"")}var LI,BI;class Hj extends(BI=cp,LI=Re,BI){constructor(t){super(t,"number","PgSmallInt")}build(t){return new Gj(t,this.config)}}fe(Hj,LI,"PgSmallIntBuilder");var UI,VI;class Gj extends(VI=At,UI=Re,VI){constructor(){super(...arguments);fe(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}fe(Gj,UI,"PgSmallInt");function tG(e){return new Hj(e??"")}var qI,WI;class Qj extends(WI=Qt,qI=Re,WI){constructor(t){super(t,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new Zj(t,this.config)}}fe(Qj,qI,"PgSmallSerialBuilder");var KI,HI;class Zj extends(HI=At,KI=Re,HI){getSQLType(){return"smallserial"}}fe(Zj,KI,"PgSmallSerial");function rG(e){return new Qj(e??"")}var GI,QI;class Yj extends(QI=Qt,GI=Re,QI){constructor(t,r){super(t,"string","PgText"),this.config.enumValues=r.enum}build(t){return new Xj(t,this.config)}}fe(Yj,GI,"PgTextBuilder");var ZI,YI;class Xj extends(YI=At,ZI=Re,YI){constructor(){super(...arguments);fe(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}fe(Xj,ZI,"PgText");function Ii(e,t={}){const{name:r,config:n}=un(e,t);return new Yj(r,n)}var XI,JI;class Jj extends(JI=Oc,XI=Re,JI){constructor(t,r,n){super(t,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}build(t){return new eM(t,this.config)}}fe(Jj,XI,"PgTimeBuilder");var eN,tN;class eM extends(tN=At,eN=Re,tN){constructor(r,n){super(r,n);fe(this,"withTimezone");fe(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}fe(eM,eN,"PgTime");function nG(e,t={}){const{name:r,config:n}=un(e,t);return new Jj(r,n.withTimezone??!1,n.precision)}var rN,nN;class tM extends(nN=Oc,rN=Re,nN){constructor(t,r,n){super(t,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(t){return new rM(t,this.config)}}fe(tM,rN,"PgTimestampBuilder");var iN,sN;class rM extends(sN=At,iN=Re,sN){constructor(r,n){super(r,n);fe(this,"withTimezone");fe(this,"precision");fe(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));fe(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}fe(rM,iN,"PgTimestamp");var aN,oN;class nM extends(oN=Oc,aN=Re,oN){constructor(t,r,n){super(t,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(t){return new iM(t,this.config)}}fe(nM,aN,"PgTimestampStringBuilder");var lN,uN;class iM extends(uN=At,lN=Re,uN){constructor(r,n){super(r,n);fe(this,"withTimezone");fe(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}fe(iM,lN,"PgTimestampString");function iG(e,t={}){const{name:r,config:n}=un(e,t);return(n==null?void 0:n.mode)==="string"?new nM(r,n.withTimezone??!1,n.precision):new tM(r,(n==null?void 0:n.withTimezone)??!1,n==null?void 0:n.precision)}var cN,dN;class sM extends(dN=Qt,cN=Re,dN){constructor(t){super(t,"string","PgUUID")}defaultRandom(){return this.default(Us`gen_random_uuid()`)}build(t){return new aM(t,this.config)}}fe(sM,cN,"PgUUIDBuilder");var fN,pN;class aM extends(pN=At,fN=Re,pN){getSQLType(){return"uuid"}}fe(aM,fN,"PgUUID");function sG(e){return new sM(e??"")}var hN,mN;class oM extends(mN=Qt,hN=Re,mN){constructor(t,r){super(t,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(t){return new lM(t,this.config)}}fe(oM,hN,"PgVarcharBuilder");var gN,yN;class lM extends(yN=At,gN=Re,yN){constructor(){super(...arguments);fe(this,"length",this.config.length);fe(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}fe(lM,gN,"PgVarchar");function Fs(e,t={}){const{name:r,config:n}=un(e,t);return new oM(r,n)}var vN,wN;class uM extends(wN=Qt,vN=Re,wN){constructor(t,r){super(t,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(t){return new cM(t,this.config)}}fe(uM,vN,"PgBinaryVectorBuilder");var bN,xN;class cM extends(xN=At,bN=Re,xN){constructor(){super(...arguments);fe(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}fe(cM,bN,"PgBinaryVector");function aG(e,t){const{name:r,config:n}=un(e,t);return new uM(r,n)}var _N,$N;class dM extends($N=Qt,_N=Re,$N){constructor(t,r){super(t,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(t){return new fM(t,this.config)}}fe(dM,_N,"PgHalfVectorBuilder");var SN,CN;class fM extends(CN=At,SN=Re,CN){constructor(){super(...arguments);fe(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}fe(fM,SN,"PgHalfVector");function oG(e,t){const{name:r,config:n}=un(e,t);return new dM(r,n)}var kN,EN;class pM extends(EN=Qt,kN=Re,EN){constructor(t,r){super(t,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(t){return new hM(t,this.config)}}fe(pM,kN,"PgSparseVectorBuilder");var TN,IN;class hM extends(IN=At,TN=Re,IN){constructor(){super(...arguments);fe(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}fe(hM,TN,"PgSparseVector");function lG(e,t){const{name:r,config:n}=un(e,t);return new pM(r,n)}var NN,PN;class mM extends(PN=Qt,NN=Re,PN){constructor(t,r){super(t,"array","PgVector"),this.config.dimensions=r.dimensions}build(t){return new gM(t,this.config)}}fe(mM,NN,"PgVectorBuilder");var AN,RN;class gM extends(RN=At,AN=Re,RN){constructor(){super(...arguments);fe(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}fe(gM,AN,"PgVector");function uG(e,t){const{name:r,config:n}=un(e,t);return new mM(r,n)}function cG(){return{bigint:OH,bigserial:DH,boolean:jH,char:MH,cidr:zH,customType:FH,date:LH,doublePrecision:BH,inet:UH,integer:an,interval:VH,json:qH,jsonb:WH,line:KH,macaddr:HH,macaddr8:GH,numeric:QH,point:ZH,geometry:XH,real:JH,serial:eG,smallint:tG,smallserial:rG,text:Ii,time:nG,timestamp:iG,uuid:sG,varchar:Fs,bit:aG,halfvec:oG,sparsevec:lG,vector:uG}}const ww=Symbol.for("drizzle:PgInlineForeignKeys"),t2=Symbol.for("drizzle:EnableRLS");var ON,DN,jN,MN,zN;class Lm extends(zN=ui,MN=Re,jN=ww,DN=t2,ON=ui.Symbol.ExtraConfigBuilder,zN){constructor(){super(...arguments);fe(this,jN,[]);fe(this,DN,!1);fe(this,ON)}}fe(Lm,MN,"PgTable"),fe(Lm,"Symbol",Object.assign({},ui.Symbol,{InlineForeignKeys:ww,EnableRLS:t2}));function dG(e,t,r,n,i=e){const s=new Lm(e,n,i),a=typeof t=="function"?t(cG()):t,o=Object.fromEntries(Object.entries(a).map(([c,f])=>{const p=f;p.setName(c);const w=p.build(s);return s[ww].push(...p.buildForeignKeys(w,s)),[c,w]})),l=Object.fromEntries(Object.entries(a).map(([c,f])=>{const p=f;p.setName(c);const w=p.buildExtraConfigColumn(s);return[c,w]})),u=Object.assign(s,o);return u[ui.Symbol.Columns]=o,u[ui.Symbol.ExtraConfigColumns]=l,Object.assign(u,{enableRLS:()=>(u[Lm.Symbol.EnableRLS]=!0,u)})}const dp=(e,t,r)=>dG(e,t,r,void 0);var Gt;(function(e){e.assertEqual=i=>i;function t(i){}e.assertIs=t;function r(i){throw new Error}e.assertNever=r,e.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},e.getValidEnumValues=i=>{const s=e.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return e.objectValues(a)},e.objectValues=i=>e.objectKeys(i).map(function(s){return i[s]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},e.find=(i,s)=>{for(const a of i)if(s(a))return a},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}e.joinValues=n,e.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(Gt||(Gt={}));var bw;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(bw||(bw={}));const st=Gt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),da=e=>{switch(typeof e){case"undefined":return st.undefined;case"string":return st.string;case"number":return isNaN(e)?st.nan:st.number;case"boolean":return st.boolean;case"function":return st.function;case"bigint":return st.bigint;case"symbol":return st.symbol;case"object":return Array.isArray(e)?st.array:e===null?st.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?st.promise:typeof Map<"u"&&e instanceof Map?st.map:typeof Set<"u"&&e instanceof Set?st.set:typeof Date<"u"&&e instanceof Date?st.date:st.object;default:return st.unknown}},je=Gt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),fG=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class hi extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(s){return s.message},n={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else{let o=n,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(r(a))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return i(this),n}static assert(t){if(!(t instanceof hi))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Gt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(t(i))):n.push(t(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}hi.create=e=>new hi(e);const xc=(e,t)=>{let r;switch(e.code){case je.invalid_type:e.received===st.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case je.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Gt.jsonStringifyReplacer)}`;break;case je.unrecognized_keys:r=`Unrecognized key(s) in object: ${Gt.joinValues(e.keys,", ")}`;break;case je.invalid_union:r="Invalid input";break;case je.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Gt.joinValues(e.options)}`;break;case je.invalid_enum_value:r=`Invalid enum value. Expected ${Gt.joinValues(e.options)}, received '${e.received}'`;break;case je.invalid_arguments:r="Invalid function arguments";break;case je.invalid_return_type:r="Invalid function return type";break;case je.invalid_date:r="Invalid date";break;case je.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Gt.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case je.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case je.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case je.custom:r="Invalid input";break;case je.invalid_intersection_types:r="Intersection results could not be merged";break;case je.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case je.not_finite:r="Number must be finite";break;default:r=t.defaultError,Gt.assertNever(e)}return{message:r}};let yM=xc;function pG(e){yM=e}function Bm(){return yM}const Um=e=>{const{data:t,path:r,errorMaps:n,issueData:i}=e,s=[...r,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=n.filter(u=>!!u).slice().reverse();for(const u of l)o=u(a,{data:t,defaultError:o}).message;return{...i,path:s,message:o}},hG=[];function et(e,t){const r=Bm(),n=Um({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===xc?void 0:xc].filter(i=>!!i)});e.common.issues.push(n)}class Tn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const i of r){if(i.status==="aborted")return xt;i.status==="dirty"&&t.dirty(),n.push(i.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const i of r){const s=await i.key,a=await i.value;n.push({key:s,value:a})}return Tn.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const i of r){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return xt;s.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(n[s.value]=a.value)}return{status:t.value,value:n}}}const xt=Object.freeze({status:"aborted"}),Ru=e=>({status:"dirty",value:e}),zn=e=>({status:"valid",value:e}),xw=e=>e.status==="aborted",_w=e=>e.status==="dirty",Nl=e=>e.status==="valid",jf=e=>typeof Promise<"u"&&e instanceof Promise;function Vm(e,t,r,n){if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function vM(e,t,r,n,i){if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var dt;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(dt||(dt={}));var Fd,Ld;class Vs{constructor(t,r,n,i){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const r2=(e,t)=>{if(Nl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new hi(e.common.issues);return this._error=r,this._error}}};function Pt(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:i}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(a,o)=>{var l,u;const{message:c}=e;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??n)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??r)!==null&&u!==void 0?u:o.defaultError}},description:i}}class Mt{get description(){return this._def.description}_getType(t){return da(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:da(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Tn,ctx:{common:t.parent.common,data:t.data,parsedType:da(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(jf(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const i={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:da(t)},s=this._parseSync({data:t,path:i.path,parent:i});return r2(i,s)}"~validate"(t){var r,n;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:da(t)};if(!this["~standard"].async)try{const s=this._parseSync({data:t,path:[],parent:i});return Nl(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((n=(r=s==null?void 0:s.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:i}).then(s=>Nl(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:da(t)},i=this._parse({data:t,path:n.path,parent:n}),s=await(jf(i)?i:Promise.resolve(i));return r2(n,s)}refine(t,r){const n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,s)=>{const a=t(i),o=()=>s.addIssue({code:je.custom,...n(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,r){return this._refinement((n,i)=>t(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(t){return new ms({schema:this,typeName:bt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ls.create(this,this._def)}nullable(){return Co.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return cs.create(this)}promise(){return $c.create(this,this._def)}or(t){return Lf.create([this,t],this._def)}and(t){return Bf.create(this,t,this._def)}transform(t){return new ms({...Pt(this._def),schema:this,typeName:bt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Kf({...Pt(this._def),innerType:this,defaultValue:r,typeName:bt.ZodDefault})}brand(){return new Rx({typeName:bt.ZodBranded,type:this,...Pt(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Hf({...Pt(this._def),innerType:this,catchValue:r,typeName:bt.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return fp.create(this,t)}readonly(){return Gf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const mG=/^c[^\s-]{8,}$/i,gG=/^[0-9a-z]+$/,yG=/^[0-9A-HJKMNP-TV-Z]{26}$/i,vG=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,wG=/^[a-z0-9_-]{21}$/i,bG=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,xG=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_G=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$G="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Yy;const SG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,CG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,kG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,EG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,TG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,IG=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,wM="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",NG=new RegExp(`^${wM}$`);function bM(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function PG(e){return new RegExp(`^${bM(e)}$`)}function xM(e){let t=`${wM}T${bM(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function AG(e,t){return!!((t==="v4"||!t)&&SG.test(e)||(t==="v6"||!t)&&kG.test(e))}function RG(e,t){if(!bG.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||!i.typ||!i.alg||t&&i.alg!==t)}catch{return!1}}function OG(e,t){return!!((t==="v4"||!t)&&CG.test(e)||(t==="v6"||!t)&&EG.test(e))}class os extends Mt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==st.string){const s=this._getOrReturnCtx(t);return et(s,{code:je.invalid_type,expected:st.string,received:s.parsedType}),xt}const n=new Tn;let i;for(const s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(i=this._getOrReturnCtx(t,i),et(i,{code:je.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")t.data.length>s.value&&(i=this._getOrReturnCtx(t,i),et(i,{code:je.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const a=t.data.length>s.value,o=t.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(t,i),a?et(i,{code:je.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&et(i,{code:je.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")_G.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"email",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")Yy||(Yy=new RegExp($G,"u")),Yy.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"emoji",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")vG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"uuid",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")wG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"nanoid",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")mG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"cuid",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")gG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"cuid2",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")yG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"ulid",code:je.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),et(i,{validation:"url",code:je.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"regex",code:je.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(t,i),et(i,{code:je.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(i=this._getOrReturnCtx(t,i),et(i,{code:je.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(i=this._getOrReturnCtx(t,i),et(i,{code:je.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?xM(s).test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{code:je.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?NG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{code:je.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?PG(s).test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{code:je.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?xG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"duration",code:je.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?AG(t.data,s.version)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"ip",code:je.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?RG(t.data,s.alg)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"jwt",code:je.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?OG(t.data,s.version)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"cidr",code:je.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?TG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"base64",code:je.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?IG.test(t.data)||(i=this._getOrReturnCtx(t,i),et(i,{validation:"base64url",code:je.invalid_string,message:s.message}),n.dirty()):Gt.assertNever(s);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(i=>t.test(i),{validation:r,code:je.invalid_string,...dt.errToObj(n)})}_addCheck(t){return new os({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...dt.errToObj(t)})}url(t){return this._addCheck({kind:"url",...dt.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...dt.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...dt.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...dt.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...dt.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...dt.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...dt.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...dt.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...dt.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...dt.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...dt.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...dt.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...dt.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...dt.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...dt.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...dt.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...dt.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...dt.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...dt.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...dt.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...dt.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...dt.errToObj(r)})}nonempty(t){return this.min(1,dt.errToObj(t))}trim(){return new os({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new os({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new os({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}os.create=e=>{var t;return new os({checks:[],typeName:bt.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Pt(e)})};function DG(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n,s=parseInt(e.toFixed(i).replace(".","")),a=parseInt(t.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class _o extends Mt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==st.number){const s=this._getOrReturnCtx(t);return et(s,{code:je.invalid_type,expected:st.number,received:s.parsedType}),xt}let n;const i=new Tn;for(const s of this._def.checks)s.kind==="int"?Gt.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),et(n,{code:je.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),et(n,{code:je.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),et(n,{code:je.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?DG(t.data,s.value)!==0&&(n=this._getOrReturnCtx(t,n),et(n,{code:je.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),et(n,{code:je.not_finite,message:s.message}),i.dirty()):Gt.assertNever(s);return{status:i.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,dt.toString(r))}gt(t,r){return this.setLimit("min",t,!1,dt.toString(r))}lte(t,r){return this.setLimit("max",t,!0,dt.toString(r))}lt(t,r){return this.setLimit("max",t,!1,dt.toString(r))}setLimit(t,r,n,i){return new _o({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:dt.toString(i)}]})}_addCheck(t){return new _o({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:dt.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:dt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:dt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:dt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:dt.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:dt.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:dt.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:dt.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:dt.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Gt.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}_o.create=e=>new _o({checks:[],typeName:bt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Pt(e)});class $o extends Mt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==st.bigint)return this._getInvalidInput(t);let n;const i=new Tn;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),et(n,{code:je.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),et(n,{code:je.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),et(n,{code:je.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):Gt.assertNever(s);return{status:i.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return et(r,{code:je.invalid_type,expected:st.bigint,received:r.parsedType}),xt}gte(t,r){return this.setLimit("min",t,!0,dt.toString(r))}gt(t,r){return this.setLimit("min",t,!1,dt.toString(r))}lte(t,r){return this.setLimit("max",t,!0,dt.toString(r))}lt(t,r){return this.setLimit("max",t,!1,dt.toString(r))}setLimit(t,r,n,i){return new $o({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:dt.toString(i)}]})}_addCheck(t){return new $o({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:dt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:dt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:dt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:dt.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:dt.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}$o.create=e=>{var t;return new $o({checks:[],typeName:bt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Pt(e)})};class Mf extends Mt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==st.boolean){const n=this._getOrReturnCtx(t);return et(n,{code:je.invalid_type,expected:st.boolean,received:n.parsedType}),xt}return zn(t.data)}}Mf.create=e=>new Mf({typeName:bt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Pt(e)});class Pl extends Mt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==st.date){const s=this._getOrReturnCtx(t);return et(s,{code:je.invalid_type,expected:st.date,received:s.parsedType}),xt}if(isNaN(t.data.getTime())){const s=this._getOrReturnCtx(t);return et(s,{code:je.invalid_date}),xt}const n=new Tn;let i;for(const s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(i=this._getOrReturnCtx(t,i),et(i,{code:je.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(i=this._getOrReturnCtx(t,i),et(i,{code:je.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):Gt.assertNever(s);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Pl({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:dt.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:dt.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Pl.create=e=>new Pl({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:bt.ZodDate,...Pt(e)});class qm extends Mt{_parse(t){if(this._getType(t)!==st.symbol){const n=this._getOrReturnCtx(t);return et(n,{code:je.invalid_type,expected:st.symbol,received:n.parsedType}),xt}return zn(t.data)}}qm.create=e=>new qm({typeName:bt.ZodSymbol,...Pt(e)});class zf extends Mt{_parse(t){if(this._getType(t)!==st.undefined){const n=this._getOrReturnCtx(t);return et(n,{code:je.invalid_type,expected:st.undefined,received:n.parsedType}),xt}return zn(t.data)}}zf.create=e=>new zf({typeName:bt.ZodUndefined,...Pt(e)});class Ff extends Mt{_parse(t){if(this._getType(t)!==st.null){const n=this._getOrReturnCtx(t);return et(n,{code:je.invalid_type,expected:st.null,received:n.parsedType}),xt}return zn(t.data)}}Ff.create=e=>new Ff({typeName:bt.ZodNull,...Pt(e)});class _c extends Mt{constructor(){super(...arguments),this._any=!0}_parse(t){return zn(t.data)}}_c.create=e=>new _c({typeName:bt.ZodAny,...Pt(e)});class vl extends Mt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return zn(t.data)}}vl.create=e=>new vl({typeName:bt.ZodUnknown,...Pt(e)});class ka extends Mt{_parse(t){const r=this._getOrReturnCtx(t);return et(r,{code:je.invalid_type,expected:st.never,received:r.parsedType}),xt}}ka.create=e=>new ka({typeName:bt.ZodNever,...Pt(e)});class Wm extends Mt{_parse(t){if(this._getType(t)!==st.undefined){const n=this._getOrReturnCtx(t);return et(n,{code:je.invalid_type,expected:st.void,received:n.parsedType}),xt}return zn(t.data)}}Wm.create=e=>new Wm({typeName:bt.ZodVoid,...Pt(e)});class cs extends Mt{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),i=this._def;if(r.parsedType!==st.array)return et(r,{code:je.invalid_type,expected:st.array,received:r.parsedType}),xt;if(i.exactLength!==null){const a=r.data.length>i.exactLength.value,o=r.data.length<i.exactLength.value;(a||o)&&(et(r,{code:a?je.too_big:je.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(et(r,{code:je.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(et(r,{code:je.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,o)=>i.type._parseAsync(new Vs(r,a,r.path,o)))).then(a=>Tn.mergeArray(n,a));const s=[...r.data].map((a,o)=>i.type._parseSync(new Vs(r,a,r.path,o)));return Tn.mergeArray(n,s)}get element(){return this._def.type}min(t,r){return new cs({...this._def,minLength:{value:t,message:dt.toString(r)}})}max(t,r){return new cs({...this._def,maxLength:{value:t,message:dt.toString(r)}})}length(t,r){return new cs({...this._def,exactLength:{value:t,message:dt.toString(r)}})}nonempty(t){return this.min(1,t)}}cs.create=(e,t)=>new cs({type:e,minLength:null,maxLength:null,exactLength:null,typeName:bt.ZodArray,...Pt(t)});function vu(e){if(e instanceof Ir){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ls.create(vu(n))}return new Ir({...e._def,shape:()=>t})}else return e instanceof cs?new cs({...e._def,type:vu(e.element)}):e instanceof Ls?Ls.create(vu(e.unwrap())):e instanceof Co?Co.create(vu(e.unwrap())):e instanceof qs?qs.create(e.items.map(t=>vu(t))):e}class Ir extends Mt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Gt.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==st.object){const u=this._getOrReturnCtx(t);return et(u,{code:je.invalid_type,expected:st.object,received:u.parsedType}),xt}const{status:n,ctx:i}=this._processInputParams(t),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof ka&&this._def.unknownKeys==="strip"))for(const u in i.data)a.includes(u)||o.push(u);const l=[];for(const u of a){const c=s[u],f=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Vs(i,f,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof ka){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")o.length>0&&(et(i,{code:je.unrecognized_keys,keys:o}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const f=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Vs(i,f,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const f=await c.key,p=await c.value;u.push({key:f,value:p,alwaysSet:c.alwaysSet})}return u}).then(u=>Tn.mergeObjectSync(n,u)):Tn.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(t){return dt.errToObj,new Ir({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var i,s,a,o;const l=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=dt.errToObj(t).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new Ir({...this._def,unknownKeys:"strip"})}passthrough(){return new Ir({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ir({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ir({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:bt.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Ir({...this._def,catchall:t})}pick(t){const r={};return Gt.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Ir({...this._def,shape:()=>r})}omit(t){const r={};return Gt.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Ir({...this._def,shape:()=>r})}deepPartial(){return vu(this)}partial(t){const r={};return Gt.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];t&&!t[n]?r[n]=i:r[n]=i.optional()}),new Ir({...this._def,shape:()=>r})}required(t){const r={};return Gt.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Ls;)s=s._def.innerType;r[n]=s}}),new Ir({...this._def,shape:()=>r})}keyof(){return _M(Gt.objectKeys(this.shape))}}Ir.create=(e,t)=>new Ir({shape:()=>e,unknownKeys:"strip",catchall:ka.create(),typeName:bt.ZodObject,...Pt(t)});Ir.strictCreate=(e,t)=>new Ir({shape:()=>e,unknownKeys:"strict",catchall:ka.create(),typeName:bt.ZodObject,...Pt(t)});Ir.lazycreate=(e,t)=>new Ir({shape:e,unknownKeys:"strip",catchall:ka.create(),typeName:bt.ZodObject,...Pt(t)});class Lf extends Mt{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new hi(o.ctx.common.issues));return et(r,{code:je.invalid_union,unionErrors:a}),xt}if(r.common.async)return Promise.all(n.map(async s=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of n){const u={...r,common:{...r.common,issues:[]},parent:null},c=l._parseSync({data:r.data,path:r.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!s&&(s={result:c,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new hi(l));return et(r,{code:je.invalid_union,unionErrors:o}),xt}}get options(){return this._def.options}}Lf.create=(e,t)=>new Lf({options:e,typeName:bt.ZodUnion,...Pt(t)});const la=e=>e instanceof Vf?la(e.schema):e instanceof ms?la(e.innerType()):e instanceof qf?[e.value]:e instanceof So?e.options:e instanceof Wf?Gt.objectValues(e.enum):e instanceof Kf?la(e._def.innerType):e instanceof zf?[void 0]:e instanceof Ff?[null]:e instanceof Ls?[void 0,...la(e.unwrap())]:e instanceof Co?[null,...la(e.unwrap())]:e instanceof Rx||e instanceof Gf?la(e.unwrap()):e instanceof Hf?la(e._def.innerType):[];class Mg extends Mt{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==st.object)return et(r,{code:je.invalid_type,expected:st.object,received:r.parsedType}),xt;const n=this.discriminator,i=r.data[n],s=this.optionsMap.get(i);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(et(r,{code:je.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),xt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const i=new Map;for(const s of r){const a=la(s.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);i.set(o,s)}}return new Mg({typeName:bt.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:i,...Pt(n)})}}function $w(e,t){const r=da(e),n=da(t);if(e===t)return{valid:!0,data:e};if(r===st.object&&n===st.object){const i=Gt.objectKeys(t),s=Gt.objectKeys(e).filter(o=>i.indexOf(o)!==-1),a={...e,...t};for(const o of s){const l=$w(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(r===st.array&&n===st.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let s=0;s<e.length;s++){const a=e[s],o=t[s],l=$w(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return r===st.date&&n===st.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Bf extends Mt{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),i=(s,a)=>{if(xw(s)||xw(a))return xt;const o=$w(s.value,a.value);return o.valid?((_w(s)||_w(a))&&r.dirty(),{status:r.value,value:o.data}):(et(n,{code:je.invalid_intersection_types}),xt)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Bf.create=(e,t,r)=>new Bf({left:e,right:t,typeName:bt.ZodIntersection,...Pt(r)});class qs extends Mt{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==st.array)return et(n,{code:je.invalid_type,expected:st.array,received:n.parsedType}),xt;if(n.data.length<this._def.items.length)return et(n,{code:je.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),xt;!this._def.rest&&n.data.length>this._def.items.length&&(et(n,{code:je.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const s=[...n.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Vs(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(s).then(a=>Tn.mergeArray(r,a)):Tn.mergeArray(r,s)}get items(){return this._def.items}rest(t){return new qs({...this._def,rest:t})}}qs.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new qs({items:e,typeName:bt.ZodTuple,rest:null,...Pt(t)})};class Uf extends Mt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==st.object)return et(n,{code:je.invalid_type,expected:st.object,received:n.parsedType}),xt;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in n.data)i.push({key:s._parse(new Vs(n,o,n.path,o)),value:a._parse(new Vs(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?Tn.mergeObjectAsync(r,i):Tn.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Mt?new Uf({keyType:t,valueType:r,typeName:bt.ZodRecord,...Pt(n)}):new Uf({keyType:os.create(),valueType:t,typeName:bt.ZodRecord,...Pt(r)})}}class Km extends Mt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==st.map)return et(n,{code:je.invalid_type,expected:st.map,received:n.parsedType}),xt;const i=this._def.keyType,s=this._def.valueType,a=[...n.data.entries()].map(([o,l],u)=>({key:i._parse(new Vs(n,o,n.path,[u,"key"])),value:s._parse(new Vs(n,l,n.path,[u,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return xt;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(u.value,c.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of a){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return xt;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(u.value,c.value)}return{status:r.value,value:o}}}}Km.create=(e,t,r)=>new Km({valueType:t,keyType:e,typeName:bt.ZodMap,...Pt(r)});class Al extends Mt{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==st.set)return et(n,{code:je.invalid_type,expected:st.set,received:n.parsedType}),xt;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(et(n,{code:je.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(et(n,{code:je.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const s=this._def.valueType;function a(l){const u=new Set;for(const c of l){if(c.status==="aborted")return xt;c.status==="dirty"&&r.dirty(),u.add(c.value)}return{status:r.value,value:u}}const o=[...n.data.values()].map((l,u)=>s._parse(new Vs(n,l,n.path,u)));return n.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,r){return new Al({...this._def,minSize:{value:t,message:dt.toString(r)}})}max(t,r){return new Al({...this._def,maxSize:{value:t,message:dt.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Al.create=(e,t)=>new Al({valueType:e,minSize:null,maxSize:null,typeName:bt.ZodSet,...Pt(t)});class Qu extends Mt{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==st.function)return et(r,{code:je.invalid_type,expected:st.function,received:r.parsedType}),xt;function n(o,l){return Um({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Bm(),xc].filter(u=>!!u),issueData:{code:je.invalid_arguments,argumentsError:l}})}function i(o,l){return Um({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Bm(),xc].filter(u=>!!u),issueData:{code:je.invalid_return_type,returnTypeError:l}})}const s={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof $c){const o=this;return zn(async function(...l){const u=new hi([]),c=await o._def.args.parseAsync(l,s).catch(w=>{throw u.addIssue(n(l,w)),u}),f=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(f,s).catch(w=>{throw u.addIssue(i(f,w)),u})})}else{const o=this;return zn(function(...l){const u=o._def.args.safeParse(l,s);if(!u.success)throw new hi([n(l,u.error)]);const c=Reflect.apply(a,this,u.data),f=o._def.returns.safeParse(c,s);if(!f.success)throw new hi([i(c,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Qu({...this._def,args:qs.create(t).rest(vl.create())})}returns(t){return new Qu({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new Qu({args:t||qs.create([]).rest(vl.create()),returns:r||vl.create(),typeName:bt.ZodFunction,...Pt(n)})}}class Vf extends Mt{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Vf.create=(e,t)=>new Vf({getter:e,typeName:bt.ZodLazy,...Pt(t)});class qf extends Mt{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return et(r,{received:r.data,code:je.invalid_literal,expected:this._def.value}),xt}return{status:"valid",value:t.data}}get value(){return this._def.value}}qf.create=(e,t)=>new qf({value:e,typeName:bt.ZodLiteral,...Pt(t)});function _M(e,t){return new So({values:e,typeName:bt.ZodEnum,...Pt(t)})}class So extends Mt{constructor(){super(...arguments),Fd.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return et(r,{expected:Gt.joinValues(n),received:r.parsedType,code:je.invalid_type}),xt}if(Vm(this,Fd)||vM(this,Fd,new Set(this._def.values)),!Vm(this,Fd).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return et(r,{received:r.data,code:je.invalid_enum_value,options:n}),xt}return zn(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return So.create(t,{...this._def,...r})}exclude(t,r=this._def){return So.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Fd=new WeakMap;So.create=_M;class Wf extends Mt{constructor(){super(...arguments),Ld.set(this,void 0)}_parse(t){const r=Gt.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==st.string&&n.parsedType!==st.number){const i=Gt.objectValues(r);return et(n,{expected:Gt.joinValues(i),received:n.parsedType,code:je.invalid_type}),xt}if(Vm(this,Ld)||vM(this,Ld,new Set(Gt.getValidEnumValues(this._def.values))),!Vm(this,Ld).has(t.data)){const i=Gt.objectValues(r);return et(n,{received:n.data,code:je.invalid_enum_value,options:i}),xt}return zn(t.data)}get enum(){return this._def.values}}Ld=new WeakMap;Wf.create=(e,t)=>new Wf({values:e,typeName:bt.ZodNativeEnum,...Pt(t)});class $c extends Mt{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==st.promise&&r.common.async===!1)return et(r,{code:je.invalid_type,expected:st.promise,received:r.parsedType}),xt;const n=r.parsedType===st.promise?r.data:Promise.resolve(r.data);return zn(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}$c.create=(e,t)=>new $c({type:e,typeName:bt.ZodPromise,...Pt(t)});class ms extends Mt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===bt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),i=this._def.effect||null,s={addIssue:a=>{et(n,a),a.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(n.data,s);if(n.common.async)return Promise.resolve(a).then(async o=>{if(r.value==="aborted")return xt;const l=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return l.status==="aborted"?xt:l.status==="dirty"||r.value==="dirty"?Ru(l.value):l});{if(r.value==="aborted")return xt;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?xt:o.status==="dirty"||r.value==="dirty"?Ru(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?xt:(o.status==="dirty"&&r.dirty(),a(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?xt:(o.status==="dirty"&&r.dirty(),a(o.value).then(()=>({status:r.value,value:o.value}))))}if(i.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Nl(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Nl(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:r.value,value:o})):a);Gt.assertNever(i)}}ms.create=(e,t,r)=>new ms({schema:e,typeName:bt.ZodEffects,effect:t,...Pt(r)});ms.createWithPreprocess=(e,t,r)=>new ms({schema:t,effect:{type:"preprocess",transform:e},typeName:bt.ZodEffects,...Pt(r)});class Ls extends Mt{_parse(t){return this._getType(t)===st.undefined?zn(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ls.create=(e,t)=>new Ls({innerType:e,typeName:bt.ZodOptional,...Pt(t)});class Co extends Mt{_parse(t){return this._getType(t)===st.null?zn(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Co.create=(e,t)=>new Co({innerType:e,typeName:bt.ZodNullable,...Pt(t)});class Kf extends Mt{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===st.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Kf.create=(e,t)=>new Kf({innerType:e,typeName:bt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Pt(t)});class Hf extends Mt{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return jf(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new hi(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new hi(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Hf.create=(e,t)=>new Hf({innerType:e,typeName:bt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Pt(t)});class Hm extends Mt{_parse(t){if(this._getType(t)!==st.nan){const n=this._getOrReturnCtx(t);return et(n,{code:je.invalid_type,expected:st.nan,received:n.parsedType}),xt}return{status:"valid",value:t.data}}}Hm.create=e=>new Hm({typeName:bt.ZodNaN,...Pt(e)});const jG=Symbol("zod_brand");class Rx extends Mt{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class fp extends Mt{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?xt:s.status==="dirty"?(r.dirty(),Ru(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?xt:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(t,r){return new fp({in:t,out:r,typeName:bt.ZodPipeline})}}class Gf extends Mt{_parse(t){const r=this._def.innerType._parse(t),n=i=>(Nl(i)&&(i.value=Object.freeze(i.value)),i);return jf(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}}Gf.create=(e,t)=>new Gf({innerType:e,typeName:bt.ZodReadonly,...Pt(t)});function n2(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function $M(e,t={},r){return e?_c.create().superRefine((n,i)=>{var s,a;const o=e(n);if(o instanceof Promise)return o.then(l=>{var u,c;if(!l){const f=n2(t,n),p=(c=(u=f.fatal)!==null&&u!==void 0?u:r)!==null&&c!==void 0?c:!0;i.addIssue({code:"custom",...f,fatal:p})}});if(!o){const l=n2(t,n),u=(a=(s=l.fatal)!==null&&s!==void 0?s:r)!==null&&a!==void 0?a:!0;i.addIssue({code:"custom",...l,fatal:u})}}):_c.create()}const MG={object:Ir.lazycreate};var bt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(bt||(bt={}));const zG=(e,t={message:`Input not instance of ${e.name}`})=>$M(r=>r instanceof e,t),SM=os.create,CM=_o.create,FG=Hm.create,LG=$o.create,kM=Mf.create,BG=Pl.create,UG=qm.create,VG=zf.create,qG=Ff.create,WG=_c.create,KG=vl.create,HG=ka.create,GG=Wm.create,QG=cs.create,ZG=Ir.create,YG=Ir.strictCreate,XG=Lf.create,JG=Mg.create,e7=Bf.create,t7=qs.create,r7=Uf.create,n7=Km.create,i7=Al.create,s7=Qu.create,a7=Vf.create,o7=qf.create,l7=So.create,u7=Wf.create,c7=$c.create,i2=ms.create,d7=Ls.create,f7=Co.create,p7=ms.createWithPreprocess,h7=fp.create,m7=()=>SM().optional(),g7=()=>CM().optional(),y7=()=>kM().optional(),v7={string:e=>os.create({...e,coerce:!0}),number:e=>_o.create({...e,coerce:!0}),boolean:e=>Mf.create({...e,coerce:!0}),bigint:e=>$o.create({...e,coerce:!0}),date:e=>Pl.create({...e,coerce:!0})},w7=xt;var mn=Object.freeze({__proto__:null,defaultErrorMap:xc,setErrorMap:pG,getErrorMap:Bm,makeIssue:Um,EMPTY_PATH:hG,addIssueToContext:et,ParseStatus:Tn,INVALID:xt,DIRTY:Ru,OK:zn,isAborted:xw,isDirty:_w,isValid:Nl,isAsync:jf,get util(){return Gt},get objectUtil(){return bw},ZodParsedType:st,getParsedType:da,ZodType:Mt,datetimeRegex:xM,ZodString:os,ZodNumber:_o,ZodBigInt:$o,ZodBoolean:Mf,ZodDate:Pl,ZodSymbol:qm,ZodUndefined:zf,ZodNull:Ff,ZodAny:_c,ZodUnknown:vl,ZodNever:ka,ZodVoid:Wm,ZodArray:cs,ZodObject:Ir,ZodUnion:Lf,ZodDiscriminatedUnion:Mg,ZodIntersection:Bf,ZodTuple:qs,ZodRecord:Uf,ZodMap:Km,ZodSet:Al,ZodFunction:Qu,ZodLazy:Vf,ZodLiteral:qf,ZodEnum:So,ZodNativeEnum:Wf,ZodPromise:$c,ZodEffects:ms,ZodTransformer:ms,ZodOptional:Ls,ZodNullable:Co,ZodDefault:Kf,ZodCatch:Hf,ZodNaN:Hm,BRAND:jG,ZodBranded:Rx,ZodPipeline:fp,ZodReadonly:Gf,custom:$M,Schema:Mt,ZodSchema:Mt,late:MG,get ZodFirstPartyTypeKind(){return bt},coerce:v7,any:WG,array:QG,bigint:LG,boolean:kM,date:BG,discriminatedUnion:JG,effect:i2,enum:l7,function:s7,instanceof:zG,intersection:e7,lazy:a7,literal:o7,map:n7,nan:FG,nativeEnum:u7,never:HG,null:qG,nullable:f7,number:CM,object:ZG,oboolean:y7,onumber:g7,optional:d7,ostring:m7,pipeline:h7,preprocess:p7,promise:c7,record:r7,set:i7,strictObject:YG,string:SM,symbol:UG,transformer:i2,tuple:t7,undefined:VG,union:XG,unknown:KG,void:GG,NEVER:w7,ZodIssueCode:je,quotelessJson:fG,ZodError:hi});const Tr={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function zr(e,t){return t.includes(e.columnType)}function b7(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}const x7=mn.union([mn.string(),mn.number(),mn.boolean(),mn.null()]),_7=mn.union([x7,mn.record(mn.any()),mn.array(mn.any())]),$7=mn.custom(e=>e instanceof Buffer);function EM(e,t){const r=(t==null?void 0:t.zodInstance)??mn,n=(t==null?void 0:t.coerce)??{};let i;return b7(e)&&(i=e.enumValues.length?r.enum(e.enumValues):r.string()),i||(zr(e,["PgGeometry","PgPointTuple"])?i=r.tuple([r.number(),r.number()]):zr(e,["PgGeometryObject","PgPointObject"])?i=r.object({x:r.number(),y:r.number()}):zr(e,["PgHalfVector","PgVector"])?(i=r.array(r.number()),i=e.dimensions?i.length(e.dimensions):i):zr(e,["PgLine"])?i=r.tuple([r.number(),r.number(),r.number()]):zr(e,["PgLineABC"])?i=r.object({a:r.number(),b:r.number(),c:r.number()}):zr(e,["PgArray"])?(i=r.array(EM(e.baseColumn,r)),i=e.size?i.length(e.size):i):e.dataType==="array"?i=r.array(r.any()):e.dataType==="number"?i=S7(e,r,n):e.dataType==="bigint"?i=C7(e,r,n):e.dataType==="boolean"?i=n===!0||n.boolean?r.coerce.boolean():r.boolean():e.dataType==="date"?i=n===!0||n.date?r.coerce.date():r.date():e.dataType==="string"?i=k7(e,r,n):e.dataType==="json"?i=_7:e.dataType==="custom"?i=r.any():e.dataType==="buffer"&&(i=$7)),i||(i=r.any()),i}function S7(e,t,r){let n=e.getSQLType().includes("unsigned"),i,s,a=!1;zr(e,["MySqlTinyInt","SingleStoreTinyInt"])?(i=n?0:Tr.INT8_MIN,s=n?Tr.INT8_UNSIGNED_MAX:Tr.INT8_MAX,a=!0):zr(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(i=n?0:Tr.INT16_MIN,s=n?Tr.INT16_UNSIGNED_MAX:Tr.INT16_MAX,a=!0):zr(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(i=n?0:Tr.INT24_MIN,s=n?Tr.INT24_UNSIGNED_MAX:Tr.INT24_MAX,a=zr(e,["MySqlMediumInt","SingleStoreMediumInt"])):zr(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(i=n?0:Tr.INT32_MIN,s=n?Tr.INT32_UNSIGNED_MAX:Tr.INT32_MAX,a=!0):zr(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(i=n?0:Tr.INT48_MIN,s=n?Tr.INT48_UNSIGNED_MAX:Tr.INT48_MAX):zr(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||zr(e,["MySqlSerial","SingleStoreSerial"]),i=n?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):zr(e,["MySqlYear","SingleStoreYear"])?(i=1901,s=2155,a=!0):(i=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let o=r===!0||r!=null&&r.number?t.coerce.number():t.number();return o=o.min(i).max(s),a?o.int():o}function C7(e,t,r){const n=e.getSQLType().includes("unsigned"),i=n?0n:Tr.INT64_MIN,s=n?Tr.INT64_UNSIGNED_MAX:Tr.INT64_MAX;return(r===!0||r!=null&&r.bigint?t.coerce.bigint():t.bigint()).min(i).max(s)}function k7(e,t,r){if(zr(e,["PgUUID"]))return t.string().uuid();let n,i,s=!1;zr(e,["PgVarchar","SQLiteText"])?n=e.length:zr(e,["MySqlVarChar","SingleStoreVarChar"])?n=e.length??Tr.INT16_UNSIGNED_MAX:zr(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?n=Tr.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?n=Tr.INT24_UNSIGNED_MAX:e.textType==="text"?n=Tr.INT16_UNSIGNED_MAX:n=Tr.INT8_UNSIGNED_MAX),zr(e,["PgChar","MySqlChar","SingleStoreChar"])&&(n=e.length,s=!0),zr(e,["PgBinaryVector"])&&(i=/^[01]+$/,n=e.dimensions);let a=r===!0||r!=null&&r.string?t.coerce.string():t.string();return a=i?a.regex(i):a,n&&s?a.length(n):n?a.max(n):a}function TM(e){return BD(e)?AH(e):RH(e)}function IM(e,t,r,n){const i={};for(const[s,a]of Object.entries(e)){if(!hn(a,bc)&&!hn(a,Jr)&&!hn(a,Jr.Aliased)&&typeof a=="object"){const f=BD(a)||PH(a)?TM(a):a;i[s]=IM(f,t[s]??{},r,n);continue}const o=t[s];if(o!==void 0&&typeof o!="function"){i[s]=o;continue}const l=hn(a,bc)?a:void 0,u=l?EM(l,n):mn.any(),c=typeof o=="function"?o(u):u;r.never(l)||(i[s]=c,l&&(r.nullable(l)&&(i[s]=i[s].nullable()),r.optional(l)&&(i[s]=i[s].optional())))}return mn.object(i)}const E7={never:e=>{var t,r;return((t=e==null?void 0:e.generated)==null?void 0:t.type)==="always"||((r=e==null?void 0:e.generatedIdentity)==null?void 0:r.type)==="always"},optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},pp=(e,t)=>{const r=TM(e);return IM(r,{},E7)},NM=["Feed","Distribution"],T7=dp("cables",{id:Fs("id").primaryKey().default(Us`gen_random_uuid()`),name:Ii("name").notNull(),fiberCount:an("fiber_count").notNull(),ribbonSize:an("ribbon_size").notNull().default(12),type:Ii("type").notNull()}),I7=dp("circuits",{id:Fs("id").primaryKey().default(Us`gen_random_uuid()`),cableId:Fs("cable_id").notNull(),circuitId:Ii("circuit_id").notNull(),position:an("position").notNull(),fiberStart:an("fiber_start").notNull(),fiberEnd:an("fiber_end").notNull(),isSpliced:an("is_spliced").notNull().default(0),feedCableId:Fs("feed_cable_id"),feedFiberStart:an("feed_fiber_start"),feedFiberEnd:an("feed_fiber_end")}),N7=dp("splices",{id:Fs("id").primaryKey().default(Us`gen_random_uuid()`),sourceCableId:Fs("source_cable_id").notNull(),destinationCableId:Fs("destination_cable_id").notNull(),sourceRibbon:an("source_ribbon").notNull(),sourceStartFiber:an("source_start_fiber").notNull(),sourceEndFiber:an("source_end_fiber").notNull(),destinationRibbon:an("destination_ribbon").notNull(),destinationStartFiber:an("destination_start_fiber").notNull(),destinationEndFiber:an("destination_end_fiber").notNull(),ponStart:an("pon_start"),ponEnd:an("pon_end"),isCompleted:an("is_completed").notNull().default(0)}),P7=dp("saves",{id:Fs("id").primaryKey().default(Us`gen_random_uuid()`),name:Ii("name").notNull(),createdAt:Ii("created_at").notNull().default(Us`CURRENT_TIMESTAMP`),data:Ii("data").notNull()}),A7=dp("logs",{id:Fs("id").primaryKey().default(Us`gen_random_uuid()`),timestamp:Ii("timestamp").notNull(),level:Ii("level").notNull(),category:Ii("category").notNull(),message:Ii("message").notNull(),data:Ii("data")}),R7=pp(T7).omit({id:!0,ribbonSize:!0}).extend({type:mn.enum(NM),circuitIds:mn.array(mn.string()).optional()});pp(I7).omit({id:!0,position:!0,fiberStart:!0,fiberEnd:!0,isSpliced:!0,feedCableId:!0});pp(N7).omit({id:!0}).refine(e=>e.sourceStartFiber<=e.sourceEndFiber,{message:"Source start fiber must be less than or equal to end fiber",path:["sourceEndFiber"]}).refine(e=>e.destinationStartFiber<=e.destinationEndFiber,{message:"Destination start fiber must be less than or equal to end fiber",path:["destinationEndFiber"]}).refine(e=>{const t=e.sourceEndFiber-e.sourceStartFiber+1,r=e.destinationEndFiber-e.destinationStartFiber+1;return t===r},{message:"Source and destination fiber ranges must be equal in size",path:["destinationEndFiber"]});pp(P7).omit({id:!0,createdAt:!0});pp(A7).omit({id:!0,timestamp:!0});var O7="Label",PM=P.forwardRef((e,t)=>y.jsx(kt.label,{...e,ref:t,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));PM.displayName=O7;var AM=PM;const D7=kg("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fa=P.forwardRef(({className:e,...t},r)=>y.jsx(AM,{ref:r,className:ft(D7(),e),...t}));fa.displayName=AM.displayName;const j7=tH,RM=P.createContext({}),fh=({...e})=>y.jsx(RM.Provider,{value:{name:e.name},children:y.jsx(sH,{...e})}),zg=()=>{const e=P.useContext(RM),t=P.useContext(OM),{getFieldState:r,formState:n}=jg(),i=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:s}=t;return{id:s,name:e.name,formItemId:`${s}-form-item`,formDescriptionId:`${s}-form-item-description`,formMessageId:`${s}-form-item-message`,...i}},OM=P.createContext({}),Bd=P.forwardRef(({className:e,...t},r)=>{const n=P.useId();return y.jsx(OM.Provider,{value:{id:n},children:y.jsx("div",{ref:r,className:ft("space-y-2",e),...t})})});Bd.displayName="FormItem";const Ud=P.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:i}=zg();return y.jsx(fa,{ref:r,className:ft(n&&"text-destructive",e),htmlFor:i,...t})});Ud.displayName="FormLabel";const Vd=P.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:i,formMessageId:s}=zg();return y.jsx(EA,{ref:t,id:n,"aria-describedby":r?`${i} ${s}`:`${i}`,"aria-invalid":!!r,...e})});Vd.displayName="FormControl";const DM=P.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=zg();return y.jsx("p",{ref:r,id:n,className:ft("text-sm text-muted-foreground",e),...t})});DM.displayName="FormDescription";const qd=P.forwardRef(({className:e,children:t,...r},n)=>{const{error:i,formMessageId:s}=zg(),a=i?String((i==null?void 0:i.message)??""):t;return a?y.jsx("p",{ref:n,id:s,className:ft("text-sm font-medium text-destructive",e),...r,children:a}):null});qd.displayName="FormMessage";const Sc=P.forwardRef(({className:e,type:t,...r},n)=>y.jsx("input",{type:t,className:ft("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Sc.displayName="Input";const Ox=P.forwardRef(({className:e,...t},r)=>y.jsx("textarea",{className:ft("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));Ox.displayName="Textarea";function s2(e,[t,r]){return Math.min(r,Math.max(t,e))}function Dx(e){const t=P.useRef({value:e,previous:e});return P.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var M7=[" ","Enter","ArrowUp","ArrowDown"],z7=[" ","Enter"],hp="Select",[Fg,Lg,F7]=Qb(hp),[Dc,VX]=Oi(hp,[F7,Ng]),Bg=Ng(),[L7,Po]=Dc(hp),[B7,U7]=Dc(hp),jM=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:u,name:c,autoComplete:f,disabled:p,required:w,form:x}=e,v=Bg(t),[C,b]=P.useState(null),[g,S]=P.useState(null),[E,A]=P.useState(!1),M=fx(u),[D=!1,I]=vo({prop:n,defaultProp:i,onChange:s}),[U,Z]=vo({prop:a,defaultProp:o,onChange:l}),ue=P.useRef(null),X=C?x||!!C.closest("form"):!0,[ie,j]=P.useState(new Set),le=Array.from(ie).map(ne=>ne.props.value).join(";");return y.jsx(GW,{...v,children:y.jsxs(L7,{required:w,scope:t,trigger:C,onTriggerChange:b,valueNode:g,onValueNodeChange:S,valueNodeHasChildren:E,onValueNodeHasChildrenChange:A,contentId:ho(),value:U,onValueChange:Z,open:D,onOpenChange:I,dir:M,triggerPointerDownPosRef:ue,disabled:p,children:[y.jsx(Fg.Provider,{scope:t,children:y.jsx(B7,{scope:e.__scopeSelect,onNativeOptionAdd:P.useCallback(ne=>{j(ce=>new Set(ce).add(ne))},[]),onNativeOptionRemove:P.useCallback(ne=>{j(ce=>{const W=new Set(ce);return W.delete(ne),W})},[]),children:r})}),X?y.jsxs(oz,{"aria-hidden":!0,required:w,tabIndex:-1,name:c,autoComplete:f,value:U,onChange:ne=>Z(ne.target.value),disabled:p,form:x,children:[U===void 0?y.jsx("option",{value:""}):null,Array.from(ie)]},le):null]})})};jM.displayName=hp;var MM="SelectTrigger",zM=P.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...i}=e,s=Bg(r),a=Po(MM,r),o=a.disabled||n,l=or(t,a.onTriggerChange),u=Lg(r),c=P.useRef("touch"),[f,p,w]=lz(v=>{const C=u().filter(S=>!S.disabled),b=C.find(S=>S.value===a.value),g=uz(C,v,b);g!==void 0&&a.onValueChange(g.value)}),x=v=>{o||(a.onOpenChange(!0),w()),v&&(a.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return y.jsx(zR,{asChild:!0,...s,children:y.jsx(kt.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":az(a.value)?"":void 0,...i,ref:l,onClick:ht(i.onClick,v=>{v.currentTarget.focus(),c.current!=="mouse"&&x(v)}),onPointerDown:ht(i.onPointerDown,v=>{c.current=v.pointerType;const C=v.target;C.hasPointerCapture(v.pointerId)&&C.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(x(v),v.preventDefault())}),onKeyDown:ht(i.onKeyDown,v=>{const C=f.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&p(v.key),!(C&&v.key===" ")&&M7.includes(v.key)&&(x(),v.preventDefault())})})})});zM.displayName=MM;var FM="SelectValue",LM=P.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,children:s,placeholder:a="",...o}=e,l=Po(FM,r),{onValueNodeHasChildrenChange:u}=l,c=s!==void 0,f=or(t,l.onValueNodeChange);return En(()=>{u(c)},[u,c]),y.jsx(kt.span,{...o,ref:f,style:{pointerEvents:"none"},children:az(l.value)?y.jsx(y.Fragment,{children:a}):s})});LM.displayName=FM;var V7="SelectIcon",BM=P.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...i}=e;return y.jsx(kt.span,{"aria-hidden":!0,...i,ref:t,children:n||""})});BM.displayName=V7;var q7="SelectPortal",UM=e=>y.jsx($g,{asChild:!0,...e});UM.displayName=q7;var Rl="SelectContent",VM=P.forwardRef((e,t)=>{const r=Po(Rl,e.__scopeSelect),[n,i]=P.useState();if(En(()=>{i(new DocumentFragment)},[]),!r.open){const s=n;return s?Fl.createPortal(y.jsx(qM,{scope:e.__scopeSelect,children:y.jsx(Fg.Slot,{scope:e.__scopeSelect,children:y.jsx("div",{children:e.children})})}),s):null}return y.jsx(WM,{...e,ref:t})});VM.displayName=Rl;var Xi=10,[qM,Ao]=Dc(Rl),W7="SelectContentImpl",K7=yc("SelectContent.RemoveScroll"),WM=P.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:u,alignOffset:c,arrowPadding:f,collisionBoundary:p,collisionPadding:w,sticky:x,hideWhenDetached:v,avoidCollisions:C,...b}=e,g=Po(Rl,r),[S,E]=P.useState(null),[A,M]=P.useState(null),D=or(t,be=>E(be)),[I,U]=P.useState(null),[Z,ue]=P.useState(null),X=Lg(r),[ie,j]=P.useState(!1),le=P.useRef(!1);P.useEffect(()=>{if(S)return CO(S)},[S]),gO();const ne=P.useCallback(be=>{const[ge,...Te]=X().map(Fe=>Fe.ref.current),[Ee]=Te.slice(-1),We=document.activeElement;for(const Fe of be)if(Fe===We||(Fe==null||Fe.scrollIntoView({block:"nearest"}),Fe===ge&&A&&(A.scrollTop=0),Fe===Ee&&A&&(A.scrollTop=A.scrollHeight),Fe==null||Fe.focus(),document.activeElement!==We))return},[X,A]),ce=P.useCallback(()=>ne([I,S]),[ne,I,S]);P.useEffect(()=>{ie&&ce()},[ie,ce]);const{onOpenChange:W,triggerPointerDownPosRef:F}=g;P.useEffect(()=>{if(S){let be={x:0,y:0};const ge=Ee=>{var We,Fe;be={x:Math.abs(Math.round(Ee.pageX)-(((We=F.current)==null?void 0:We.x)??0)),y:Math.abs(Math.round(Ee.pageY)-(((Fe=F.current)==null?void 0:Fe.y)??0))}},Te=Ee=>{be.x<=10&&be.y<=10?Ee.preventDefault():S.contains(Ee.target)||W(!1),document.removeEventListener("pointermove",ge),F.current=null};return F.current!==null&&(document.addEventListener("pointermove",ge),document.addEventListener("pointerup",Te,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ge),document.removeEventListener("pointerup",Te,{capture:!0})}}},[S,W,F]),P.useEffect(()=>{const be=()=>W(!1);return window.addEventListener("blur",be),window.addEventListener("resize",be),()=>{window.removeEventListener("blur",be),window.removeEventListener("resize",be)}},[W]);const[H,B]=lz(be=>{const ge=X().filter(We=>!We.disabled),Te=ge.find(We=>We.ref.current===document.activeElement),Ee=uz(ge,be,Te);Ee&&setTimeout(()=>Ee.ref.current.focus())}),ee=P.useCallback((be,ge,Te)=>{const Ee=!le.current&&!Te;(g.value!==void 0&&g.value===ge||Ee)&&(U(be),Ee&&(le.current=!0))},[g.value]),me=P.useCallback(()=>S==null?void 0:S.focus(),[S]),K=P.useCallback((be,ge,Te)=>{const Ee=!le.current&&!Te;(g.value!==void 0&&g.value===ge||Ee)&&ue(be)},[g.value]),Ae=n==="popper"?Sw:KM,Ze=Ae===Sw?{side:o,sideOffset:l,align:u,alignOffset:c,arrowPadding:f,collisionBoundary:p,collisionPadding:w,sticky:x,hideWhenDetached:v,avoidCollisions:C}:{};return y.jsx(qM,{scope:r,content:S,viewport:A,onViewportChange:M,itemRefCallback:ee,selectedItem:I,onItemLeave:me,itemTextRefCallback:K,focusSelectedItem:ce,selectedItemText:Z,position:n,isPositioned:ie,searchRef:H,children:y.jsx(yx,{as:K7,allowPinchZoom:!0,children:y.jsx(gx,{asChild:!0,trapped:g.open,onMountAutoFocus:be=>{be.preventDefault()},onUnmountAutoFocus:ht(i,be=>{var ge;(ge=g.trigger)==null||ge.focus({preventScroll:!0}),be.preventDefault()}),children:y.jsx(ap,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:be=>be.preventDefault(),onDismiss:()=>g.onOpenChange(!1),children:y.jsx(Ae,{role:"listbox",id:g.contentId,"data-state":g.open?"open":"closed",dir:g.dir,onContextMenu:be=>be.preventDefault(),...b,...Ze,onPlaced:()=>j(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ht(b.onKeyDown,be=>{const ge=be.ctrlKey||be.altKey||be.metaKey;if(be.key==="Tab"&&be.preventDefault(),!ge&&be.key.length===1&&B(be.key),["ArrowUp","ArrowDown","Home","End"].includes(be.key)){let Ee=X().filter(We=>!We.disabled).map(We=>We.ref.current);if(["ArrowUp","End"].includes(be.key)&&(Ee=Ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(be.key)){const We=be.target,Fe=Ee.indexOf(We);Ee=Ee.slice(Fe+1)}setTimeout(()=>ne(Ee)),be.preventDefault()}})})})})})})});WM.displayName=W7;var H7="SelectItemAlignedPosition",KM=P.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...i}=e,s=Po(Rl,r),a=Ao(Rl,r),[o,l]=P.useState(null),[u,c]=P.useState(null),f=or(t,D=>c(D)),p=Lg(r),w=P.useRef(!1),x=P.useRef(!0),{viewport:v,selectedItem:C,selectedItemText:b,focusSelectedItem:g}=a,S=P.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&u&&v&&C&&b){const D=s.trigger.getBoundingClientRect(),I=u.getBoundingClientRect(),U=s.valueNode.getBoundingClientRect(),Z=b.getBoundingClientRect();if(s.dir!=="rtl"){const We=Z.left-I.left,Fe=U.left-We,He=D.left-Fe,Ve=D.width+He,vt=Math.max(Ve,I.width),gt=window.innerWidth-Xi,ot=s2(Fe,[Xi,Math.max(Xi,gt-vt)]);o.style.minWidth=Ve+"px",o.style.left=ot+"px"}else{const We=I.right-Z.right,Fe=window.innerWidth-U.right-We,He=window.innerWidth-D.right-Fe,Ve=D.width+He,vt=Math.max(Ve,I.width),gt=window.innerWidth-Xi,ot=s2(Fe,[Xi,Math.max(Xi,gt-vt)]);o.style.minWidth=Ve+"px",o.style.right=ot+"px"}const ue=p(),X=window.innerHeight-Xi*2,ie=v.scrollHeight,j=window.getComputedStyle(u),le=parseInt(j.borderTopWidth,10),ne=parseInt(j.paddingTop,10),ce=parseInt(j.borderBottomWidth,10),W=parseInt(j.paddingBottom,10),F=le+ne+ie+W+ce,H=Math.min(C.offsetHeight*5,F),B=window.getComputedStyle(v),ee=parseInt(B.paddingTop,10),me=parseInt(B.paddingBottom,10),K=D.top+D.height/2-Xi,Ae=X-K,Ze=C.offsetHeight/2,be=C.offsetTop+Ze,ge=le+ne+be,Te=F-ge;if(ge<=K){const We=ue.length>0&&C===ue[ue.length-1].ref.current;o.style.bottom="0px";const Fe=u.clientHeight-v.offsetTop-v.offsetHeight,He=Math.max(Ae,Ze+(We?me:0)+Fe+ce),Ve=ge+He;o.style.height=Ve+"px"}else{const We=ue.length>0&&C===ue[0].ref.current;o.style.top="0px";const He=Math.max(K,le+v.offsetTop+(We?ee:0)+Ze)+Te;o.style.height=He+"px",v.scrollTop=ge-K+v.offsetTop}o.style.margin=`${Xi}px 0`,o.style.minHeight=H+"px",o.style.maxHeight=X+"px",n==null||n(),requestAnimationFrame(()=>w.current=!0)}},[p,s.trigger,s.valueNode,o,u,v,C,b,s.dir,n]);En(()=>S(),[S]);const[E,A]=P.useState();En(()=>{u&&A(window.getComputedStyle(u).zIndex)},[u]);const M=P.useCallback(D=>{D&&x.current===!0&&(S(),g==null||g(),x.current=!1)},[S,g]);return y.jsx(Q7,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:w,onScrollButtonChange:M,children:y.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:E},children:y.jsx(kt.div,{...i,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});KM.displayName=H7;var G7="SelectPopperPosition",Sw=P.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=Xi,...s}=e,a=Bg(r);return y.jsx(FR,{...a,...s,ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Sw.displayName=G7;var[Q7,jx]=Dc(Rl,{}),Cw="SelectViewport",HM=P.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...i}=e,s=Ao(Cw,r),a=jx(Cw,r),o=or(t,s.onViewportChange),l=P.useRef(0);return y.jsxs(y.Fragment,{children:[y.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),y.jsx(Fg.Slot,{scope:r,children:y.jsx(kt.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:ht(i.onScroll,u=>{const c=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=a;if(p!=null&&p.current&&f){const w=Math.abs(l.current-c.scrollTop);if(w>0){const x=window.innerHeight-Xi*2,v=parseFloat(f.style.minHeight),C=parseFloat(f.style.height),b=Math.max(v,C);if(b<x){const g=b+w,S=Math.min(x,g),E=g-S;f.style.height=S+"px",f.style.bottom==="0px"&&(c.scrollTop=E>0?E:0,f.style.justifyContent="flex-end")}}}l.current=c.scrollTop})})})]})});HM.displayName=Cw;var GM="SelectGroup",[Z7,Y7]=Dc(GM),X7=P.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=ho();return y.jsx(Z7,{scope:r,id:i,children:y.jsx(kt.div,{role:"group","aria-labelledby":i,...n,ref:t})})});X7.displayName=GM;var QM="SelectLabel",ZM=P.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=Y7(QM,r);return y.jsx(kt.div,{id:i.id,...n,ref:t})});ZM.displayName=QM;var Gm="SelectItem",[J7,YM]=Dc(Gm),XM=P.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:s,...a}=e,o=Po(Gm,r),l=Ao(Gm,r),u=o.value===n,[c,f]=P.useState(s??""),[p,w]=P.useState(!1),x=or(t,g=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,g,n,i)}),v=ho(),C=P.useRef("touch"),b=()=>{i||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return y.jsx(J7,{scope:r,value:n,disabled:i,textId:v,isSelected:u,onItemTextChange:P.useCallback(g=>{f(S=>S||((g==null?void 0:g.textContent)??"").trim())},[]),children:y.jsx(Fg.ItemSlot,{scope:r,value:n,disabled:i,textValue:c,children:y.jsx(kt.div,{role:"option","aria-labelledby":v,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:x,onFocus:ht(a.onFocus,()=>w(!0)),onBlur:ht(a.onBlur,()=>w(!1)),onClick:ht(a.onClick,()=>{C.current!=="mouse"&&b()}),onPointerUp:ht(a.onPointerUp,()=>{C.current==="mouse"&&b()}),onPointerDown:ht(a.onPointerDown,g=>{C.current=g.pointerType}),onPointerMove:ht(a.onPointerMove,g=>{var S;C.current=g.pointerType,i?(S=l.onItemLeave)==null||S.call(l):C.current==="mouse"&&g.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ht(a.onPointerLeave,g=>{var S;g.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:ht(a.onKeyDown,g=>{var E;((E=l.searchRef)==null?void 0:E.current)!==""&&g.key===" "||(z7.includes(g.key)&&b(),g.key===" "&&g.preventDefault())})})})})});XM.displayName=Gm;var Wd="SelectItemText",JM=P.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,...s}=e,a=Po(Wd,r),o=Ao(Wd,r),l=YM(Wd,r),u=U7(Wd,r),[c,f]=P.useState(null),p=or(t,b=>f(b),l.onItemTextChange,b=>{var g;return(g=o.itemTextRefCallback)==null?void 0:g.call(o,b,l.value,l.disabled)}),w=c==null?void 0:c.textContent,x=P.useMemo(()=>y.jsx("option",{value:l.value,disabled:l.disabled,children:w},l.value),[l.disabled,l.value,w]),{onNativeOptionAdd:v,onNativeOptionRemove:C}=u;return En(()=>(v(x),()=>C(x)),[v,C,x]),y.jsxs(y.Fragment,{children:[y.jsx(kt.span,{id:l.textId,...s,ref:p}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Fl.createPortal(s.children,a.valueNode):null]})});JM.displayName=Wd;var ez="SelectItemIndicator",tz=P.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return YM(ez,r).isSelected?y.jsx(kt.span,{"aria-hidden":!0,...n,ref:t}):null});tz.displayName=ez;var kw="SelectScrollUpButton",rz=P.forwardRef((e,t)=>{const r=Ao(kw,e.__scopeSelect),n=jx(kw,e.__scopeSelect),[i,s]=P.useState(!1),a=or(t,n.onScrollButtonChange);return En(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=l.scrollTop>0;s(u)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),i?y.jsx(iz,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});rz.displayName=kw;var Ew="SelectScrollDownButton",nz=P.forwardRef((e,t)=>{const r=Ao(Ew,e.__scopeSelect),n=jx(Ew,e.__scopeSelect),[i,s]=P.useState(!1),a=or(t,n.onScrollButtonChange);return En(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=l.scrollHeight-l.clientHeight,c=Math.ceil(l.scrollTop)<u;s(c)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),i?y.jsx(iz,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});nz.displayName=Ew;var iz=P.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=e,s=Ao("SelectScrollButton",r),a=P.useRef(null),o=Lg(r),l=P.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return P.useEffect(()=>()=>l(),[l]),En(()=>{var c;const u=o().find(f=>f.ref.current===document.activeElement);(c=u==null?void 0:u.ref.current)==null||c.scrollIntoView({block:"nearest"})},[o]),y.jsx(kt.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:ht(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:ht(i.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:ht(i.onPointerLeave,()=>{l()})})}),eQ="SelectSeparator",sz=P.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return y.jsx(kt.div,{"aria-hidden":!0,...n,ref:t})});sz.displayName=eQ;var Tw="SelectArrow",tQ=P.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=Bg(r),s=Po(Tw,r),a=Ao(Tw,r);return s.open&&a.position==="popper"?y.jsx(LR,{...i,...n,ref:t}):null});tQ.displayName=Tw;function az(e){return e===""||e===void 0}var oz=P.forwardRef((e,t)=>{const{value:r,...n}=e,i=P.useRef(null),s=or(t,i),a=Dx(r);return P.useEffect(()=>{const o=i.current,l=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==r&&c){const f=new Event("change",{bubbles:!0});c.call(o,r),o.dispatchEvent(f)}},[a,r]),y.jsx(op,{asChild:!0,children:y.jsx("select",{...n,ref:s,defaultValue:r})})});oz.displayName="BubbleSelect";function lz(e){const t=Xn(e),r=P.useRef(""),n=P.useRef(0),i=P.useCallback(a=>{const o=r.current+a;t(o),function l(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=P.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,s]}function uz(e,t,r){const i=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let a=rQ(e,Math.max(s,0));i.length===1&&(a=a.filter(u=>u!==r));const l=a.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}function rQ(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var nQ=jM,cz=zM,iQ=LM,sQ=BM,aQ=UM,dz=VM,oQ=HM,fz=ZM,pz=XM,lQ=JM,uQ=tz,hz=rz,mz=nz,gz=sz;const cQ=nQ,dQ=iQ,yz=P.forwardRef(({className:e,children:t,...r},n)=>y.jsxs(cz,{ref:n,className:ft("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,y.jsx(sQ,{asChild:!0,children:y.jsx(Jb,{className:"h-4 w-4 opacity-50"})})]}));yz.displayName=cz.displayName;const vz=P.forwardRef(({className:e,...t},r)=>y.jsx(hz,{ref:r,className:ft("flex cursor-default items-center justify-center py-1",e),...t,children:y.jsx(rR,{className:"h-4 w-4"})}));vz.displayName=hz.displayName;const wz=P.forwardRef(({className:e,...t},r)=>y.jsx(mz,{ref:r,className:ft("flex cursor-default items-center justify-center py-1",e),...t,children:y.jsx(Jb,{className:"h-4 w-4"})}));wz.displayName=mz.displayName;const bz=P.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>y.jsx(aQ,{children:y.jsxs(dz,{ref:i,className:ft("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[y.jsx(vz,{}),y.jsx(oQ,{className:ft("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),y.jsx(wz,{})]})}));bz.displayName=dz.displayName;const fQ=P.forwardRef(({className:e,...t},r)=>y.jsx(fz,{ref:r,className:ft("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));fQ.displayName=fz.displayName;const xz=P.forwardRef(({className:e,children:t,...r},n)=>y.jsxs(pz,{ref:n,className:ft("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[y.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:y.jsx(uQ,{children:y.jsx(Af,{className:"h-4 w-4"})})}),y.jsx(lQ,{children:t})]}));xz.displayName=pz.displayName;const pQ=P.forwardRef(({className:e,...t},r)=>y.jsx(gz,{ref:r,className:ft("-mx-1 my-1 h-px bg-muted",e),...t}));pQ.displayName=gz.displayName;var hQ={exports:{}};(function(e){var t=function(r){var n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(F,H,B){F[H]=B.value},a,o=typeof Symbol=="function"?Symbol:{},l=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function f(F,H,B){return Object.defineProperty(F,H,{value:B,enumerable:!0,configurable:!0,writable:!0}),F[H]}try{f({},"")}catch{f=function(H,B,ee){return H[B]=ee}}function p(F,H,B,ee){var me=H&&H.prototype instanceof S?H:S,K=Object.create(me.prototype),Ae=new ne(ee||[]);return s(K,"_invoke",{value:X(F,B,Ae)}),K}r.wrap=p;function w(F,H,B){try{return{type:"normal",arg:F.call(H,B)}}catch(ee){return{type:"throw",arg:ee}}}var x="suspendedStart",v="suspendedYield",C="executing",b="completed",g={};function S(){}function E(){}function A(){}var M={};f(M,l,function(){return this});var D=Object.getPrototypeOf,I=D&&D(D(ce([])));I&&I!==n&&i.call(I,l)&&(M=I);var U=A.prototype=S.prototype=Object.create(M);E.prototype=A,s(U,"constructor",{value:A,configurable:!0}),s(A,"constructor",{value:E,configurable:!0}),E.displayName=f(A,c,"GeneratorFunction");function Z(F){["next","throw","return"].forEach(function(H){f(F,H,function(B){return this._invoke(H,B)})})}r.isGeneratorFunction=function(F){var H=typeof F=="function"&&F.constructor;return H?H===E||(H.displayName||H.name)==="GeneratorFunction":!1},r.mark=function(F){return Object.setPrototypeOf?Object.setPrototypeOf(F,A):(F.__proto__=A,f(F,c,"GeneratorFunction")),F.prototype=Object.create(U),F},r.awrap=function(F){return{__await:F}};function ue(F,H){function B(K,Ae,Ze,be){var ge=w(F[K],F,Ae);if(ge.type==="throw")be(ge.arg);else{var Te=ge.arg,Ee=Te.value;return Ee&&typeof Ee=="object"&&i.call(Ee,"__await")?H.resolve(Ee.__await).then(function(We){B("next",We,Ze,be)},function(We){B("throw",We,Ze,be)}):H.resolve(Ee).then(function(We){Te.value=We,Ze(Te)},function(We){return B("throw",We,Ze,be)})}}var ee;function me(K,Ae){function Ze(){return new H(function(be,ge){B(K,Ae,be,ge)})}return ee=ee?ee.then(Ze,Ze):Ze()}s(this,"_invoke",{value:me})}Z(ue.prototype),f(ue.prototype,u,function(){return this}),r.AsyncIterator=ue,r.async=function(F,H,B,ee,me){me===void 0&&(me=Promise);var K=new ue(p(F,H,B,ee),me);return r.isGeneratorFunction(H)?K:K.next().then(function(Ae){return Ae.done?Ae.value:K.next()})};function X(F,H,B){var ee=x;return function(K,Ae){if(ee===C)throw new Error("Generator is already running");if(ee===b){if(K==="throw")throw Ae;return W()}for(B.method=K,B.arg=Ae;;){var Ze=B.delegate;if(Ze){var be=ie(Ze,B);if(be){if(be===g)continue;return be}}if(B.method==="next")B.sent=B._sent=B.arg;else if(B.method==="throw"){if(ee===x)throw ee=b,B.arg;B.dispatchException(B.arg)}else B.method==="return"&&B.abrupt("return",B.arg);ee=C;var ge=w(F,H,B);if(ge.type==="normal"){if(ee=B.done?b:v,ge.arg===g)continue;return{value:ge.arg,done:B.done}}else ge.type==="throw"&&(ee=b,B.method="throw",B.arg=ge.arg)}}}function ie(F,H){var B=H.method,ee=F.iterator[B];if(ee===a)return H.delegate=null,B==="throw"&&F.iterator.return&&(H.method="return",H.arg=a,ie(F,H),H.method==="throw")||B!=="return"&&(H.method="throw",H.arg=new TypeError("The iterator does not provide a '"+B+"' method")),g;var me=w(ee,F.iterator,H.arg);if(me.type==="throw")return H.method="throw",H.arg=me.arg,H.delegate=null,g;var K=me.arg;if(!K)return H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,g;if(K.done)H[F.resultName]=K.value,H.next=F.nextLoc,H.method!=="return"&&(H.method="next",H.arg=a);else return K;return H.delegate=null,g}Z(U),f(U,c,"Generator"),f(U,l,function(){return this}),f(U,"toString",function(){return"[object Generator]"});function j(F){var H={tryLoc:F[0]};1 in F&&(H.catchLoc=F[1]),2 in F&&(H.finallyLoc=F[2],H.afterLoc=F[3]),this.tryEntries.push(H)}function le(F){var H=F.completion||{};H.type="normal",delete H.arg,F.completion=H}function ne(F){this.tryEntries=[{tryLoc:"root"}],F.forEach(j,this),this.reset(!0)}r.keys=function(F){var H=Object(F),B=[];for(var ee in H)B.push(ee);return B.reverse(),function me(){for(;B.length;){var K=B.pop();if(K in H)return me.value=K,me.done=!1,me}return me.done=!0,me}};function ce(F){if(F){var H=F[l];if(H)return H.call(F);if(typeof F.next=="function")return F;if(!isNaN(F.length)){var B=-1,ee=function me(){for(;++B<F.length;)if(i.call(F,B))return me.value=F[B],me.done=!1,me;return me.value=a,me.done=!0,me};return ee.next=ee}}return{next:W}}r.values=ce;function W(){return{value:a,done:!0}}return ne.prototype={constructor:ne,reset:function(F){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(le),!F)for(var H in this)H.charAt(0)==="t"&&i.call(this,H)&&!isNaN(+H.slice(1))&&(this[H]=a)},stop:function(){this.done=!0;var F=this.tryEntries[0],H=F.completion;if(H.type==="throw")throw H.arg;return this.rval},dispatchException:function(F){if(this.done)throw F;var H=this;function B(be,ge){return K.type="throw",K.arg=F,H.next=be,ge&&(H.method="next",H.arg=a),!!ge}for(var ee=this.tryEntries.length-1;ee>=0;--ee){var me=this.tryEntries[ee],K=me.completion;if(me.tryLoc==="root")return B("end");if(me.tryLoc<=this.prev){var Ae=i.call(me,"catchLoc"),Ze=i.call(me,"finallyLoc");if(Ae&&Ze){if(this.prev<me.catchLoc)return B(me.catchLoc,!0);if(this.prev<me.finallyLoc)return B(me.finallyLoc)}else if(Ae){if(this.prev<me.catchLoc)return B(me.catchLoc,!0)}else if(Ze){if(this.prev<me.finallyLoc)return B(me.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(F,H){for(var B=this.tryEntries.length-1;B>=0;--B){var ee=this.tryEntries[B];if(ee.tryLoc<=this.prev&&i.call(ee,"finallyLoc")&&this.prev<ee.finallyLoc){var me=ee;break}}me&&(F==="break"||F==="continue")&&me.tryLoc<=H&&H<=me.finallyLoc&&(me=null);var K=me?me.completion:{};return K.type=F,K.arg=H,me?(this.method="next",this.next=me.finallyLoc,g):this.complete(K)},complete:function(F,H){if(F.type==="throw")throw F.arg;return F.type==="break"||F.type==="continue"?this.next=F.arg:F.type==="return"?(this.rval=this.arg=F.arg,this.method="return",this.next="end"):F.type==="normal"&&H&&(this.next=H),g},finish:function(F){for(var H=this.tryEntries.length-1;H>=0;--H){var B=this.tryEntries[H];if(B.finallyLoc===F)return this.complete(B.completion,B.afterLoc),le(B),g}},catch:function(F){for(var H=this.tryEntries.length-1;H>=0;--H){var B=this.tryEntries[H];if(B.tryLoc===F){var ee=B.completion;if(ee.type==="throw"){var me=ee.arg;le(B)}return me}}throw new Error("illegal catch attempt")},delegateYield:function(F,H,B){return this.delegate={iterator:ce(F),resultName:H,nextLoc:B},this.method==="next"&&(this.arg=a),g}},r}(e.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(hQ);var Mx=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`;const mQ=Mx;let a2=0;var _z=({id:e,action:t,payload:r={}})=>{let n=e;return typeof n>"u"&&(n=mQ("Job",a2),a2+=1),{id:n,action:t,payload:r}},jc={};let zx=!1;jc.logging=zx;jc.setLogging=e=>{zx=e};jc.log=(...e)=>zx?console.log.apply(void 0,e):null;const gQ=_z,{log:ph}=jc,yQ=Mx;let o2=0;var vQ=()=>{const e=yQ("Scheduler",o2),t={},r={};let n=[];o2+=1;const i=()=>n.length,s=()=>Object.keys(t).length,a=()=>{if(n.length!==0){const f=Object.keys(t);for(let p=0;p<f.length;p+=1)if(typeof r[f[p]]>"u"){n[0](t[f[p]]);break}}},o=(f,p)=>new Promise((w,x)=>{const v=gQ({action:f,payload:p});n.push(async C=>{n.shift(),r[C.id]=v;try{w(await C[f].apply(void 0,[...p,v.id]))}catch(b){x(b)}finally{delete r[C.id],a()}}),ph(`[${e}]: Add ${v.id} to JobQueue`),ph(`[${e}]: JobQueue length=${n.length}`),a()});return{addWorker:f=>(t[f.id]=f,ph(`[${e}]: Add ${f.id}`),ph(`[${e}]: Number of workers=${s()}`),a(),f.id),addJob:async(f,...p)=>{if(s()===0)throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return o(f,p)},terminate:async()=>{Object.keys(t).forEach(async f=>{await t[f].terminate()}),n=[]},getQueueLen:i,getNumWorkers:s}};function wQ(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bQ=e=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof wQ=="function"&&(t.type="node"),typeof e>"u"?t:t[e]};const xQ=bQ("type")==="browser",_Q=xQ?e=>new URL(e,window.location.href).href:e=>e;var $Q=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(r=>{e[r]&&(t[r]=_Q(t[r]))}),t},$z={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const SQ="tesseract.js",CQ="6.0.1",kQ="Pure Javascript Multilingual OCR",EQ="src/index.js",TQ="commonjs",IQ="src/index.d.ts",NQ="dist/tesseract.min.js",PQ="dist/tesseract.min.js",AQ={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},RQ={"./src/worker/node/index.js":"./src/worker/browser/index.js"},OQ="",DQ=["jeromewu"],jQ="Apache-2.0",MQ={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},zQ={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},FQ={"@rollup/pluginutils":"^5.0.2"},LQ={type:"git",url:"https://github.com/naptha/tesseract.js.git"},BQ={url:"https://github.com/naptha/tesseract.js/issues"},UQ="https://github.com/naptha/tesseract.js",VQ={type:"opencollective",url:"https://opencollective.com/tesseractjs"},qQ={name:SQ,version:CQ,description:kQ,main:EQ,type:TQ,types:IQ,unpkg:NQ,jsdelivr:PQ,scripts:AQ,browser:RQ,author:OQ,contributors:DQ,license:jQ,devDependencies:MQ,dependencies:zQ,overrides:FQ,repository:LQ,bugs:BQ,homepage:UQ,collective:VQ};var WQ={workerBlobURL:!0,logger:()=>{}};const KQ=qQ.version,HQ=WQ;var GQ={...HQ,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${KQ}/dist/worker.min.js`},QQ=({workerPath:e,workerBlobURL:t})=>{let r;if(Blob&&URL&&t){const n=new Blob([`importScripts("${e}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(n))}else r=new Worker(e);return r},ZQ=e=>{e.terminate()},YQ=(e,t)=>{e.onmessage=({data:r})=>{t(r)}},XQ=async(e,t)=>{e.postMessage(t)};const Xy=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=({target:{error:{code:i}}})=>{r(Error(`File could not be read! Code=${i}`))},n.readAsArrayBuffer(e)}),Iw=async e=>{let t=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(t=await Iw(e.src)),e.tagName==="VIDEO"&&(t=await Iw(e.poster)),e.tagName==="CANVAS"&&await new Promise(r=>{e.toBlob(async n=>{t=await Xy(n),r()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const r=await e.convertToBlob();t=await Xy(r)}else(e instanceof File||e instanceof Blob)&&(t=await Xy(e));return new Uint8Array(t)};var JQ=Iw;const eZ=GQ,tZ=QQ,rZ=ZQ,nZ=YQ,iZ=XQ,sZ=JQ;var aZ={defaultOptions:eZ,spawnWorker:tZ,terminateWorker:rZ,onMessage:nZ,send:iZ,loadImage:sZ};const oZ=$Q,Ss=_z,{log:l2}=jc,lZ=Mx,Ko=$z,{defaultOptions:uZ,spawnWorker:cZ,terminateWorker:dZ,onMessage:fZ,loadImage:u2,send:pZ}=aZ;let c2=0;var Sz=async(e="eng",t=Ko.LSTM_ONLY,r={},n={})=>{const i=lZ("Worker",c2),{logger:s,errorHandler:a,...o}=oZ({...uZ,...r}),l={},u=typeof e=="string"?e.split("+"):e;let c=t,f=n;const p=[Ko.DEFAULT,Ko.LSTM_ONLY].includes(t)&&!o.legacyCore;let w,x;const v=new Promise((ce,W)=>{x=ce,w=W}),C=ce=>{w(ce.message)};let b=cZ(o);b.onerror=C,c2+=1;const g=({id:ce,action:W,payload:F})=>new Promise((H,B)=>{l2(`[${i}]: Start ${ce}, action=${W}`);const ee=`${W}-${ce}`;l[ee]={resolve:H,reject:B},pZ(b,{workerId:i,jobId:ce,action:W,payload:F})}),S=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),E=ce=>g(Ss({id:ce,action:"load",payload:{options:{lstmOnly:p,corePath:o.corePath,logging:o.logging}}})),A=(ce,W,F)=>g(Ss({id:F,action:"FS",payload:{method:"writeFile",args:[ce,W]}})),M=(ce,W)=>g(Ss({id:W,action:"FS",payload:{method:"readFile",args:[ce,{encoding:"utf8"}]}})),D=(ce,W)=>g(Ss({id:W,action:"FS",payload:{method:"unlink",args:[ce]}})),I=(ce,W,F)=>g(Ss({id:F,action:"FS",payload:{method:ce,args:W}})),U=(ce,W)=>g(Ss({id:W,action:"loadLanguage",payload:{langs:ce,options:{langPath:o.langPath,dataPath:o.dataPath,cachePath:o.cachePath,cacheMethod:o.cacheMethod,gzip:o.gzip,lstmOnly:[Ko.DEFAULT,Ko.LSTM_ONLY].includes(c)&&!o.legacyLang}}})),Z=(ce,W,F,H)=>g(Ss({id:H,action:"initialize",payload:{langs:ce,oem:W,config:F}})),ue=(ce="eng",W,F,H)=>{if(p&&[Ko.TESSERACT_ONLY,Ko.TESSERACT_LSTM_COMBINED].includes(W))throw Error("Legacy model requested but code missing.");const B=W||c;c=B;const ee=F||f;f=ee;const K=(typeof ce=="string"?ce.split("+"):ce).filter(Ae=>!u.includes(Ae));return u.push(...K),K.length>0?U(K,H).then(()=>Z(ce,B,ee,H)):Z(ce,B,ee,H)},X=(ce={},W)=>g(Ss({id:W,action:"setParameters",payload:{params:ce}})),ie=async(ce,W={},F={text:!0},H)=>g(Ss({id:H,action:"recognize",payload:{image:await u2(ce),options:W,output:F}})),j=async(ce,W)=>{if(p)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return g(Ss({id:W,action:"detect",payload:{image:await u2(ce)}}))},le=async()=>(b!==null&&(dZ(b),b=null),Promise.resolve());fZ(b,({workerId:ce,jobId:W,status:F,action:H,data:B})=>{const ee=`${H}-${W}`;if(F==="resolve")l2(`[${ce}]: Complete ${W}`),l[ee].resolve({jobId:W,data:B}),delete l[ee];else if(F==="reject")if(l[ee].reject(B),delete l[ee],H==="load"&&w(B),a)a(B);else throw Error(B);else F==="progress"&&s({...B,userJobId:W})});const ne={id:i,worker:b,load:S,writeText:A,readText:M,removeFile:D,FS:I,reinitialize:ue,setParameters:X,recognize:ie,detect:j,terminate:le};return E().then(()=>U(e)).then(()=>Z(e,t,n)).then(()=>x(ne)).catch(()=>{}),v};const Cz=Sz,hZ=async(e,t,r)=>{const n=await Cz(t,1,r);return n.recognize(e).finally(async()=>{await n.terminate()})},mZ=async(e,t)=>{const r=await Cz("osd",0,t);return r.detect(e).finally(async()=>{await r.terminate()})};var gZ={recognize:hZ,detect:mZ},yZ={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},vZ={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const wZ=vQ,bZ=Sz,xZ=gZ,_Z=yZ,$Z=$z,SZ=vZ,{setLogging:CZ}=jc;var kZ={languages:_Z,OEM:$Z,PSM:SZ,createScheduler:wZ,createWorker:bZ,setLogging:CZ,...xZ},Fx="Progress",Lx=100,[EZ,qX]=Oi(Fx),[TZ,IZ]=EZ(Fx),kz=P.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:i,getValueLabel:s=NZ,...a}=e;(i||i===0)&&!d2(i)&&console.error(PZ(`${i}`,"Progress"));const o=d2(i)?i:Lx;n!==null&&!f2(n,o)&&console.error(AZ(`${n}`,"Progress"));const l=f2(n,o)?n:null,u=Qm(l)?s(l,o):void 0;return y.jsx(TZ,{scope:r,value:l,max:o,children:y.jsx(kt.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Qm(l)?l:void 0,"aria-valuetext":u,role:"progressbar","data-state":Iz(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});kz.displayName=Fx;var Ez="ProgressIndicator",Tz=P.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,i=IZ(Ez,r);return y.jsx(kt.div,{"data-state":Iz(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...n,ref:t})});Tz.displayName=Ez;function NZ(e,t){return`${Math.round(e/t*100)}%`}function Iz(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Qm(e){return typeof e=="number"}function d2(e){return Qm(e)&&!isNaN(e)&&e>0}function f2(e,t){return Qm(e)&&!isNaN(e)&&e<=t&&e>=0}function PZ(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Lx}\`.`}function AZ(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Lx} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Nz=kz,RZ=Tz;const Pz=P.forwardRef(({className:e,value:t,...r},n)=>y.jsx(Nz,{ref:n,className:ft("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:y.jsx(RZ,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Pz.displayName=Nz.displayName;function Nw(e){if(!e||!e.trim())return e;const t=e.trim().split(/\s+/).filter(s=>s.length>0);if(t.length<3)return e;const r=t[t.length-1],n=t[t.length-2];return`${t.slice(0,-2).join("")},${n}-${r}`}function OZ(e){if(!e||!e.trim())return"";const t=e.split(`
`),r=[];for(let n of t){if(!n.trim())continue;n=n.replace(/\([^)]*\)/g,""),n=n.replace(/<[^>]*>/g,""),n=n.replace(/\bNC\b/gi,""),n=n.replace(/@/g,"0");const i=/([A-Za-z0-9]+),(\d+)-(\d+)/,s=n.match(i);if(s){const l=s[1],u=s[2],c=s[3];r.push(`${l},${u}-${c}`);continue}const a=/^([A-Za-z0-9]*)\s+(\d+)\s+(\d+)/,o=n.trim().match(a);if(o){const l=o[1]||"",u=o[2],c=o[3];r.push(`${l} ${u} ${c}`.trim())}}return r.join(`
`)}function DZ(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>t(n),n.onerror=r,n.src=e})}function jZ(e,t,r){const n=document.createElement("canvas");n.width=t,n.height=r;const i=n.getContext("2d");return i.drawImage(e,0,0,t,r),{canvas:n,ctx:i}}function MZ(e){const t=e.data;for(let r=0;r<t.length;r+=4){const n=.2126*t[r]+.7152*t[r+1]+.0722*t[r+2];t[r]=n,t[r+1]=n,t[r+2]=n}}function zZ(e){const t=e.data;let r=255,n=0;for(let s=0;s<t.length;s+=4){const a=t[s];a<r&&(r=a),a>n&&(n=a)}const i=n-r||1;for(let s=0;s<t.length;s+=4){const a=Math.round((t[s]-r)/i*255);t[s]=a,t[s+1]=a,t[s+2]=a}}function FZ(e,t){const r=e.data,n=128*(1-t);for(let i=0;i<r.length;i+=4){const s=Math.max(0,Math.min(255,r[i]*t+n));r[i]=s,r[i+1]=s,r[i+2]=s}}function LZ(e,t=15,r=10){const{width:n,height:i,data:s}=e,a=Math.floor(t/2),o=new Float64Array((n+1)*(i+1)),l=n+1;for(let u=0;u<i;u++){let c=0;for(let f=0;f<n;f++)c+=s[(u*n+f)*4],o[(u+1)*l+(f+1)]=c+o[u*l+(f+1)]}for(let u=0;u<i;u++)for(let c=0;c<n;c++){const f=Math.max(0,c-a),p=Math.max(0,u-a),w=Math.min(n-1,c+a),x=Math.min(i-1,u+a),v=(w-f+1)*(x-p+1),b=(o[(x+1)*l+(w+1)]-o[p*l+(w+1)]-o[(x+1)*l+f]+o[p*l+f])/v,g=(u*n+c)*4,S=s[g]<b-r?0:255;s[g]=S,s[g+1]=S,s[g+2]=S}}function BZ(e){const{width:t,height:r,data:n}=e,i=new Uint8ClampedArray(n),s=[0,-1,0,-1,5,-1,0,-1,0];for(let a=1;a<r-1;a++)for(let o=1;o<t-1;o++){let l=0;for(let f=-1;f<=1;f++)for(let p=-1;p<=1;p++){const w=((a+f)*t+(o+p))*4;l+=i[w]*s[(f+1)*3+(p+1)]}const u=(a*t+o)*4,c=Math.max(0,Math.min(255,l));n[u]=c,n[u+1]=c,n[u+2]=c}}function UZ(e){const t=e.data;let r=0;const n=t.length/4;for(let s=0;s<t.length;s+=4)r+=t[s];if(r/n<128)for(let s=0;s<t.length;s+=4)t[s]=255-t[s],t[s+1]=255-t[s+1],t[s+2]=255-t[s+2]}async function VZ(e,t={}){const{minWidth:r=1500,contrastFactor:n=1.5,thresholdBlockSize:i=15,thresholdConstant:s=10,sharpenEnabled:a=!0,thresholdEnabled:o=!0}=t,l=await DZ(e);let u=l.naturalWidth,c=l.naturalHeight;if(u<r){const x=r/u;u=Math.round(u*x),c=Math.round(c*x)}const{canvas:f,ctx:p}=jZ(l,u,c),w=p.getImageData(0,0,u,c);return MZ(w),UZ(w),zZ(w),n!==1&&FZ(w,n),a&&BZ(w),o&&LZ(w,i,s),p.putImageData(w,0,0),f.toDataURL("image/png")}/*!
 * ONNX Runtime Web v1.24.1
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var Bx=Object.defineProperty,qZ=Object.getOwnPropertyDescriptor,WZ=Object.getOwnPropertyNames,KZ=Object.prototype.hasOwnProperty,HZ=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),Oe=(e,t)=>()=>(e&&(t=e(e=0)),t),Mc=(e,t)=>{for(var r in t)Bx(e,r,{get:t[r],enumerable:!0})},GZ=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of WZ(t))!KZ.call(e,i)&&i!==r&&Bx(e,i,{get:()=>t[i],enumerable:!(n=qZ(t,i))||n.enumerable});return e},Qf=e=>GZ(Bx({},"__esModule",{value:!0}),e),xd,za,Ou,p2,Az,Rz=Oe(()=>{xd=new Map,za=[],Ou=(e,t,r)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let n=xd.get(e);if(n===void 0)xd.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let i=za.indexOf(e);i!==-1&&za.splice(i,1);for(let s=0;s<za.length;s++)if(xd.get(za[s]).priority<=r){za.splice(s,0,e);return}za.push(e)}return}throw new TypeError("not a valid backend")},p2=async e=>{let t=xd.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(n){return r||(t.error=`${n}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},Az=async e=>{let t=e.executionProviders||[],r=t.map(l=>typeof l=="string"?l:l.name),n=r.length===0?za:r,i,s=[],a=new Set;for(let l of n){let u=await p2(l);typeof u=="string"?s.push({name:l,err:u}):(i||(i=u),i===u&&a.add(l))}if(!i)throw new Error(`no available backend found. ERR: ${s.map(l=>`[${l.name}] ${l.err}`).join(", ")}`);for(let{name:l,err:u}of s)r.includes(l)&&console.warn(`removing requested execution provider "${l}" from session options because it is not available: ${u}`);let o=t.filter(l=>a.has(typeof l=="string"?l:l.name));return[i,new Proxy(e,{get:(l,u)=>u==="executionProviders"?o:Reflect.get(l,u)})]}}),QZ=Oe(()=>{Rz()}),Oz,ZZ=Oe(()=>{Oz="1.24.1"}),Jy,nn,Dz=Oe(()=>{ZZ(),Jy="warning",nn={wasm:{},webgl:{},webgpu:{},versions:{common:Oz},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);Jy=e}},get logLevel(){return Jy}},Object.defineProperty(nn,"logLevel",{enumerable:!0})}),mr,YZ=Oe(()=>{Dz(),mr=nn}),jz,Mz,XZ=Oe(()=>{jz=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(n!=null){let i,s;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(i=e.dims[2],s=e.dims[3]):(i=e.dims[3],s=e.dims[2]);let a=(t==null?void 0:t.format)!==void 0?t.format:"RGB",o=t==null?void 0:t.norm,l,u;o===void 0||o.mean===void 0?l=[255,255,255,255]:typeof o.mean=="number"?l=[o.mean,o.mean,o.mean,o.mean]:(l=[o.mean[0],o.mean[1],o.mean[2],0],o.mean[3]!==void 0&&(l[3]=o.mean[3])),o===void 0||o.bias===void 0?u=[0,0,0,0]:typeof o.bias=="number"?u=[o.bias,o.bias,o.bias,o.bias]:(u=[o.bias[0],o.bias[1],o.bias[2],0],o.bias[3]!==void 0&&(u[3]=o.bias[3]));let c=s*i,f=0,p=c,w=c*2,x=-1;a==="RGBA"?(f=0,p=c,w=c*2,x=c*3):a==="RGB"?(f=0,p=c,w=c*2):a==="RBG"&&(f=0,w=c,p=c*2);for(let v=0;v<s;v++)for(let C=0;C<i;C++){let b=(e.data[f++]-u[0])*l[0],g=(e.data[p++]-u[1])*l[1],S=(e.data[w++]-u[2])*l[2],E=x===-1?255:(e.data[x++]-u[3])*l[3];n.fillStyle="rgba("+b+","+g+","+S+","+E+")",n.fillRect(C,v,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Mz=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),n;if(r!=null){let i,s,a;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(i=e.dims[2],s=e.dims[1],a=e.dims[3]):(i=e.dims[3],s=e.dims[2],a=e.dims[1]);let o=t!==void 0&&t.format!==void 0?t.format:"RGB",l=t==null?void 0:t.norm,u,c;l===void 0||l.mean===void 0?u=[255,255,255,255]:typeof l.mean=="number"?u=[l.mean,l.mean,l.mean,l.mean]:(u=[l.mean[0],l.mean[1],l.mean[2],255],l.mean[3]!==void 0&&(u[3]=l.mean[3])),l===void 0||l.bias===void 0?c=[0,0,0,0]:typeof l.bias=="number"?c=[l.bias,l.bias,l.bias,l.bias]:(c=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(c[3]=l.bias[3]));let f=s*i;if(t!==void 0&&(t.format!==void 0&&a===4&&t.format!=="RGBA"||a===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let p=4,w=0,x=1,v=2,C=3,b=0,g=f,S=f*2,E=-1;o==="RGBA"?(b=0,g=f,S=f*2,E=f*3):o==="RGB"?(b=0,g=f,S=f*2):o==="RBG"&&(b=0,S=f,g=f*2),n=r.createImageData(i,s);for(let A=0;A<s*i;w+=p,x+=p,v+=p,C+=p,A++)n.data[w]=(e.data[b++]-c[0])*u[0],n.data[x]=(e.data[g++]-c[1])*u[1],n.data[v]=(e.data[S++]-c[2])*u[2],n.data[C]=E===-1?255:(e.data[E++]-c[3])*u[3]}else throw new Error("Can not access image data");return n}}),hh,zz,Fz,Lz,Bz,Uz,JZ=Oe(()=>{Ux(),hh=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:r,width:n}=t,i=t.norm??{mean:255,bias:0},s,a;typeof i.mean=="number"?s=[i.mean,i.mean,i.mean,i.mean]:s=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?a=[i.bias,i.bias,i.bias,i.bias]:a=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let o=t.format!==void 0?t.format:"RGBA",l=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",u=r*n,c=l==="RGBA"?new Float32Array(u*4):new Float32Array(u*3),f=4,p=0,w=1,x=2,v=3,C=0,b=u,g=u*2,S=-1;o==="RGB"&&(f=3,p=0,w=1,x=2,v=-1),l==="RGBA"?S=u*3:l==="RBG"?(C=0,g=u,b=u*2):l==="BGR"&&(g=0,b=u,C=u*2);for(let E=0;E<u;E++,p+=f,x+=f,w+=f,v+=f)c[C++]=(e[p]+a[0])/s[0],c[b++]=(e[w]+a[1])/s[1],c[g++]=(e[x]+a[2])/s[2],S!==-1&&v!==-1&&(c[S++]=(e[v]+a[3])/s[3]);return l==="RGBA"?new ci("float32",c,[1,4,r,n]):new ci("float32",c,[1,3,r,n])},zz=async(e,t)=>{let r=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,n=typeof ImageData<"u"&&e instanceof ImageData,i=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,s=typeof e=="string",a,o=t??{},l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},u=c=>typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||c instanceof OffscreenCanvas?c.getContext("2d"):null;if(r){let c=l();c.width=e.width,c.height=e.height;let f=u(c);if(f!=null){let p=e.height,w=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(p=t.resizedHeight,w=t.resizedWidth),t!==void 0){if(o=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");o.tensorFormat="RGBA",o.height=p,o.width=w}else o.tensorFormat="RGBA",o.height=p,o.width=w;f.drawImage(e,0,0),a=f.getImageData(0,0,w,p).data}else throw new Error("Can not access image data")}else if(n){let c,f;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(c=t.resizedHeight,f=t.resizedWidth):(c=e.height,f=e.width),t!==void 0&&(o=t),o.format="RGBA",o.height=c,o.width=f,t!==void 0){let p=l();p.width=f,p.height=c;let w=u(p);if(w!=null)w.putImageData(e,0,0),a=w.getImageData(0,0,f,c).data;else throw new Error("Can not access image data")}else a=e.data}else if(i){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let c=l();c.width=e.width,c.height=e.height;let f=u(c);if(f!=null){let p=e.height,w=e.width;return f.drawImage(e,0,0,w,p),a=f.getImageData(0,0,w,p).data,o.height=p,o.width=w,hh(a,o)}else throw new Error("Can not access image data")}else{if(s)return new Promise((c,f)=>{let p=l(),w=u(p);if(!e||!w)return f();let x=new Image;x.crossOrigin="Anonymous",x.src=e,x.onload=()=>{p.width=x.width,p.height=x.height,w.drawImage(x,0,0,p.width,p.height);let v=w.getImageData(0,0,p.width,p.height);o.height=p.height,o.width=p.width,c(hh(v.data,o))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(a!==void 0)return hh(a,o);throw new Error("Input data provided is not supported - aborted tensor creation")},Fz=(e,t)=>{let{width:r,height:n,download:i,dispose:s}=t,a=[1,n,r,4];return new ci({location:"texture",type:"float32",texture:e,dims:a,download:i,dispose:s})},Lz=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:s}=t;return new ci({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:s})},Bz=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:s}=t;return new ci({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:n,download:i,dispose:s})},Uz=(e,t,r)=>new ci({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})}),Jo,Kd,ev,Vz,eY=Oe(()=>{Jo=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Kd=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ev=!1,Vz=()=>{if(!ev){ev=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,r=globalThis.Float16Array,n=typeof r<"u"&&r.from;e&&(Jo.set("int64",BigInt64Array),Kd.set(BigInt64Array,"int64")),t&&(Jo.set("uint64",BigUint64Array),Kd.set(BigUint64Array,"uint64")),n?(Jo.set("float16",r),Kd.set(r,"float16")):Jo.set("float16",Uint16Array)}}}),qz,Wz,tY=Oe(()=>{Ux(),qz=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if(typeof n!="number"||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},Wz=(e,t)=>{switch(e.location){case"cpu":return new ci(e.type,e.data,t);case"cpu-pinned":return new ci({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new ci({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new ci({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new ci({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),ci,Ux=Oe(()=>{XZ(),JZ(),eY(),tY(),ci=class{constructor(e,t,r){Vz();let n,i;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{let a=Jo.get(n);if(!a)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof a))throw new TypeError(`buffer should be of type ${a.name}`);this.cpuData=e.data;break}case"texture":{if(n!=="float32")throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(n!=="float32"&&n!=="float16"&&n!=="int32"&&n!=="int64"&&n!=="uint32"&&n!=="uint8"&&n!=="bool"&&n!=="uint4"&&n!=="int4")throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(n!=="float32"&&n!=="float16"&&n!=="int32"&&n!=="int64"&&n!=="uint32"&&n!=="uint64"&&n!=="int8"&&n!=="uint8"&&n!=="bool"&&n!=="uint4"&&n!=="int4")throw new TypeError(`unsupported type "${n}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,o;if(typeof e=="string")if(n=e,o=r,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");a=t}else{let l=Jo.get(e);if(l===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&l===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${l.name} as data.`);e==="uint64"||e==="int64"?a=l.from(t,BigInt):a=l.from(t)}else if(t instanceof l)a=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")a=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&t instanceof Uint16Array&&l!==Uint16Array)a=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw new TypeError(`A ${n} tensor's data must be type of ${l}`)}else if(o=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let l=typeof e[0];if(l==="string")n="string",a=e;else if(l==="boolean")n="bool",a=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${l}.`)}else if(e instanceof Uint8ClampedArray)n="uint8",a=Uint8Array.from(e);else{let l=Kd.get(e.constructor);if(l===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=l,a=e}if(o===void 0)o=[a.length];else if(!Array.isArray(o))throw new TypeError("A tensor's dims must be a number array");i=o,this.cpuData=a,this.dataLocation="cpu"}let s=qz(i);if(this.cpuData&&s!==this.cpuData.length&&!((n==="uint4"||n==="int4")&&Math.ceil(s/2)===this.cpuData.length))throw new Error(`Tensor's size(${s}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=i,this.size=s}static async fromImage(e,t){return zz(e,t)}static fromTexture(e,t){return Fz(e,t)}static fromGpuBuffer(e,t){return Lz(e,t)}static fromMLTensor(e,t){return Bz(e,t)}static fromPinnedBuffer(e,t,r){return Uz(e,t,r)}toDataURL(e){return jz(this,e)}toImageData(e){return Mz(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Wz(this,e)}}}),Os,Kz=Oe(()=>{Ux(),Os=ci}),Zm,tv,Ws,ds,wl,bl,Hz=Oe(()=>{Dz(),Zm=(e,t)=>{(typeof nn.trace>"u"?!nn.wasm.trace:!nn.trace)||console.timeStamp(`${e}::ORT::${t}`)},tv=(e,t)=>{var i;let r=((i=new Error().stack)==null?void 0:i.split(/\r\n|\r|\n/g))||[],n=!1;for(let s=0;s<r.length;s++){if(n&&!r[s].includes("TRACE_FUNC")){let a=`FUNC_${e}::${r[s].trim().split(" ")[1]}`;t&&(a+=`::${t}`),Zm("CPU",a);return}r[s].includes("TRACE_FUNC")&&(n=!0)}},Ws=e=>{(typeof nn.trace>"u"?!nn.wasm.trace:!nn.trace)||tv("BEGIN",e)},ds=e=>{(typeof nn.trace>"u"?!nn.wasm.trace:!nn.trace)||tv("END",e)},wl=e=>{(typeof nn.trace>"u"?!nn.wasm.trace:!nn.trace)||console.time(`ORT::${e}`)},bl=e=>{(typeof nn.trace>"u"?!nn.wasm.trace:!nn.trace)||console.timeEnd(`ORT::${e}`)}}),Gz,rY=Oe(()=>{Rz(),Kz(),Hz(),Gz=class Qz{constructor(t){this.handler=t}async run(t,r,n){Ws(),wl("InferenceSession.run");let i={},s={};if(typeof t!="object"||t===null||t instanceof Os||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof Os)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(let u of r){if(typeof u!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(u)===-1)throw new RangeError(`'fetches' contains invalid output name: ${u}.`);i[u]=null}if(typeof n=="object"&&n!==null)s=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{let u=!1,c=Object.getOwnPropertyNames(r);for(let f of this.outputNames)if(c.indexOf(f)!==-1){let p=r[f];(p===null||p instanceof Os)&&(u=!0,a=!1,i[f]=p)}if(u){if(typeof n=="object"&&n!==null)s=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else s=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let u of this.inputNames)if(typeof t[u]>"u")throw new Error(`input '${u}' is missing in 'feeds'.`);if(a)for(let u of this.outputNames)i[u]=null;let o=await this.handler.run(t,i,s),l={};for(let u in o)if(Object.hasOwnProperty.call(o,u)){let c=o[u];c instanceof Os?l[u]=c:l[u]=new Os(c.type,c.data,c.dims)}return bl("InferenceSession.run"),ds(),l}async release(){return this.handler.dispose()}static async create(t,r,n,i){Ws(),wl("InferenceSession.create");let s,a={};if(typeof t=="string"){if(s=t,typeof r=="object"&&r!==null)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(s=t,typeof r=="object"&&r!==null)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let c=t,f=0,p=t.byteLength;if(typeof r=="object"&&r!==null)a=r;else if(typeof r=="number"){if(f=r,!Number.isSafeInteger(f))throw new RangeError("'byteOffset' must be an integer.");if(f<0||f>=c.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${c.byteLength}).`);if(p=t.byteLength-f,typeof n=="number"){if(p=n,!Number.isSafeInteger(p))throw new RangeError("'byteLength' must be an integer.");if(p<=0||f+p>c.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${c.byteLength-f}].`);if(typeof i=="object"&&i!==null)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");s=new Uint8Array(c,f,p)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[o,l]=await Az(a),u=await o.createInferenceSessionHandler(s,l);return bl("InferenceSession.create"),ds(),new Qz(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),Zz,nY=Oe(()=>{rY(),Zz=Gz}),iY=Oe(()=>{}),sY=Oe(()=>{}),aY=Oe(()=>{}),oY=Oe(()=>{}),lY={};Mc(lY,{InferenceSession:()=>Zz,TRACE:()=>Zm,TRACE_EVENT_BEGIN:()=>wl,TRACE_EVENT_END:()=>bl,TRACE_FUNC_BEGIN:()=>Ws,TRACE_FUNC_END:()=>ds,Tensor:()=>Os,env:()=>mr,registerBackend:()=>Ou});var Di=Oe(()=>{QZ(),YZ(),nY(),Kz(),iY(),sY(),Hz(),aY(),oY()}),Vx=Oe(()=>{}),Yz={};Mc(Yz,{default:()=>Xz});var rv,nv,Xz,uY=Oe(()=>{var e;nB(),Ll(),qx(),rv="ort-wasm-proxy-worker",nv=((e=globalThis.self)==null?void 0:e.name)===rv,nv&&(self.onmessage=t=>{let{type:r,in:n}=t.data;try{switch(r){case"init-wasm":Wx(n.wasm).then(()=>{l1(n).then(()=>{postMessage({type:r})},i=>{postMessage({type:r,err:i})})},i=>{postMessage({type:r,err:i})});break;case"init-ep":{let{epName:i,env:s}=n;u1(s,i).then(()=>{postMessage({type:r})},a=>{postMessage({type:r,err:a})});break}case"copy-from":{let{buffer:i}=n,s=ng(i);postMessage({type:r,out:s});break}case"create":{let{model:i,options:s}=n;c1(i,s).then(a=>{postMessage({type:r,out:a})},a=>{postMessage({type:r,err:a})});break}case"release":d1(n),postMessage({type:r});break;case"run":{let{sessionId:i,inputIndices:s,inputs:a,outputIndices:o,options:l}=n;f1(i,s,a,o,new Array(o.length).fill(null),l).then(u=>{u.some(c=>c[3]!=="cpu")?postMessage({type:r,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:r,out:u},h1([...a,...u]))},u=>{postMessage({type:r,err:u})});break}case"end-profiling":p1(n),postMessage({type:r});break;default:}}catch(i){postMessage({type:r,err:i})}}),Xz=nv?null:t=>new Worker(t??ii,{type:"module",name:rv})}),Jz={};Mc(Jz,{default:()=>e4});async function h2(e={}){var N1,P1;var t=e,r=!!globalThis.window,n=!!globalThis.WorkerGlobalScope,i=n&&((N1=self.name)==null?void 0:N1.startsWith("em-pthread"));t.mountExternalData=(h,_)=>{h.startsWith("./")&&(h=h.substring(2)),(t.Zc||(t.Zc=new Map)).set(h,_)},t.unmountExternalData=()=>{delete t.Zc},globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,ae:!0}).buffer.constructor;let s=h=>async(..._)=>{var N;try{if(t.$c)throw Error("Session already started");let T=t.$c={Nd:_[0],errors:[]},z=await h(..._);if(t.$c!==T)throw Error("Session mismatch");(N=t.gd)==null||N.flush();let V=T.errors;if(0<V.length){let oe=await Promise.all(V);if(oe=oe.filter($e=>$e),0<oe.length)throw Error(oe.join(`
`))}return z}finally{t.$c=null}};t.jsepInit=(h,_)=>{if(h==="webgpu"){[t.gd,t.Dd,t.Hd,t.jd,t.Gd,t.ac,t.Id,t.Kd,t.Ed,t.Fd,t.Jd]=_;let N=t.gd;t.jsepRegisterBuffer=(T,z,V,oe)=>N.registerBuffer(T,z,V,oe),t.jsepGetBuffer=T=>N.getBuffer(T),t.jsepCreateDownloader=(T,z,V)=>N.createDownloader(T,z,V),t.jsepOnCreateSession=T=>{N.onCreateSession(T)},t.jsepOnReleaseSession=T=>{N.onReleaseSession(T)},t.jsepOnRunStart=T=>N.onRunStart(T),t.Ld=(T,z)=>{N.upload(T,z)}}else if(h==="webnn"){let N=_[0];[t.Zd,t.vd,t.webnnEnsureTensor,t.xd,t.webnnDownloadTensor,t.Yd,t.webnnEnableTraceEvent]=_.slice(1),t.webnnReleaseTensorId=t.vd,t.webnnUploadTensor=t.xd,t.webnnRegisterMLContext=t.Yd,t.webnnOnRunStart=T=>N.onRunStart(T),t.webnnOnRunEnd=N.onRunEnd.bind(N),t.webnnOnReleaseSession=T=>{N.onReleaseSession(T)},t.webnnCreateMLTensorDownloader=(T,z)=>N.createMLTensorDownloader(T,z),t.webnnRegisterMLTensor=(T,z,V,oe)=>N.registerMLTensor(T,z,V,oe),t.webnnCreateMLContext=T=>N.createMLContext(T),t.webnnRegisterMLConstant=(T,z,V,oe,$e,qe)=>N.registerMLConstant(T,z,V,oe,$e,t.Zc,qe),t.webnnRegisterGraphInput=N.registerGraphInput.bind(N),t.webnnIsGraphInput=N.isGraphInput.bind(N),t.webnnRegisterGraphOutput=N.registerGraphOutput.bind(N),t.webnnIsGraphOutput=N.isGraphOutput.bind(N),t.webnnCreateTemporaryTensor=N.createTemporaryTensor.bind(N),t.webnnIsGraphInputOutputTypeSupported=N.isGraphInputOutputTypeSupported.bind(N)}};let a=()=>{let h=_=>(...N)=>{let T=cr;return N=_(...N),cr!=T?new Promise((z,V)=>{Vn={resolve:z,reject:V}}):N};(()=>{for(let _ of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])t[_]=h(t[_])})(),s!==void 0&&(t._OrtRun=s(t._OrtRun),t._OrtRunWithBinding=s(t._OrtRunWithBinding)),a=void 0};t.asyncInit=()=>{a==null||a()};var o,l,u=(h,_)=>{throw _},c=import.meta.url,f="";if(r||n){try{f=new URL(".",c).href}catch{}n&&(l=h=>{var _=new XMLHttpRequest;return _.open("GET",h,!1),_.responseType="arraybuffer",_.send(null),new Uint8Array(_.response)}),o=async h=>{if(D(h))return new Promise((N,T)=>{var z=new XMLHttpRequest;z.open("GET",h,!0),z.responseType="arraybuffer",z.onload=()=>{z.status==200||z.status==0&&z.response?N(z.response):T(z.status)},z.onerror=T,z.send(null)});var _=await fetch(h,{credentials:"same-origin"});if(_.ok)return _.arrayBuffer();throw Error(_.status+" : "+_.url)}}var p,w,x,v,C,b,g=console.log.bind(console),S=console.error.bind(console),E=g,A=S,M=!1,D=h=>h.startsWith("file://");function I(){ke.buffer!=Z.buffer&&ee()}if(i){let h=function(_){try{var N=_.data,T=N.Uc;if(T==="load"){let z=[];self.onmessage=V=>z.push(V),b=()=>{postMessage({Uc:"loaded"});for(let V of z)h(V);self.onmessage=h};for(let V of N.Ad)t[V]&&!t[V].proxy||(t[V]=(...oe)=>{postMessage({Uc:"callHandler",zd:V,args:oe})},V=="print"&&(E=t[V]),V=="printErr"&&(A=t[V]));ke=N.Vd,ee(),w=N.Wd,Ze(),Fp()}else if(T==="run"){(function(z){var V=(I(),le)[z+52>>>2>>>0];z=(I(),le)[z+56>>>2>>>0],$(V,V-z),k(V)})(N.Tc),qo(N.Tc,0,0,1,0,0),ve(),Uc(N.Tc),U||(Sr(),U=!0);try{Pe(N.Pd,N.dd)}catch(z){if(z!="unwind")throw z}}else N.target!=="setimmediate"&&(T==="checkMailbox"?U&&Ft():T&&(A(`worker: received unknown command ${T}`),A(N)))}catch(z){throw od(),z}};var U=!1;self.onunhandledrejection=_=>{throw _.reason||_},self.onmessage=h}var Z,ue,X,ie,j,le,ne,ce,W,F,H,B=!1;function ee(){var h=ke.buffer;t.HEAP8=Z=new Int8Array(h),X=new Int16Array(h),t.HEAPU8=ue=new Uint8Array(h),ie=new Uint16Array(h),t.HEAP32=j=new Int32Array(h),t.HEAPU32=le=new Uint32Array(h),ne=new Float32Array(h),ce=new Float64Array(h),W=new BigInt64Array(h),F=new BigUint64Array(h)}function me(){B=!0,i?b():na.tb()}function K(h){throw A(h="Aborted("+h+")"),M=!0,h=new WebAssembly.RuntimeError(h+". Build with -sASSERTIONS for more info."),C==null||C(h),h}function Ae(){return{a:{ma:NB,hb:IB,g:pt,J:nr,f:Vr,o:jr,h:tn,ha:Be,b:wi,T:ji,Ia:Jn,n:Bn,_:Hs,Ya:Gs,Ea:ur,Ga:Mr,Za:mp,Wa:Oo,Pa:Do,Va:jo,ka:gp,Fa:Mi,Ca:Qs,Xa:zi,Da:Mo,cb:Vg,ea:Ys,xa:Li,va:Vl,da:zt,O:wp,H:bp,wa:xp,Z:Bc,ya:ql,Sa:$p,Aa:Cp,Ja:qg,ta:Nn,fa:Aa,Ra:Uc,$a:Wl,R:Kc,s:Hg,c:Na,ib:Gl,y:Ql,M:Gc,D:Gg,m:Qg,t:Tp,jb:Qc,I:Zc,S:Ip,j:Zl,v:Yl,r:Xl,l:Np,Ma:Zg,Na:Yc,Oa:Xc,Ka:Kr,La:Ra,ua:Bo,eb:Ap,bb:tu,u:Jc,aa:ed,ga:ru,ab:Rp,V:td,_a:Op,Ba:Yg,F:Pp,U:rd,la:su,za:Dp,gb:nd,fb:Xg,Ta:id,Ua:lu,Ha:ot,$:sd,ja:ad,Qa:Mp,ia:zp,lb:pU,na:aU,mb:fU,oa:sU,G:ZB,d:OB,q:AB,w:PB,B:qB,pb:rU,K:HB,x:jB,pa:nU,X:oU,ba:tU,nb:dU,ob:cU,ra:YB,qa:eU,qb:XB,N:GB,Y:iU,e:DB,A:MB,k:RB,kb:hU,p:FB,z:LB,C:zB,E:BB,L:WB,rb:QB,Q:lU,ca:KB,W:uU,sb:VB,sa:UB,P:JB,i:uu,a:ke,db:vt}}}async function Ze(){function h(T,z){var V=na=T.exports;T={};for(let[oe,$e]of Object.entries(V))typeof $e=="function"?(V=kp($e),T[oe]=V):T[oe]=$e;return na=T,na=function(){var oe=na,$e=rt=>Et=>rt(Et)>>>0,qe=rt=>()=>rt()>>>0;return(oe=Object.assign({},oe)).ub=$e(oe.ub),oe.Yb=qe(oe.Yb),oe._b=$e(oe._b),oe.mc=$e(oe.mc),oe.nc=qe(oe.nc),oe.rc=$e(oe.rc),oe}(),cn.push(na.$b),$i=(T=na).ub,Sr=T.vb,t._OrtInit=T.wb,t._OrtGetLastError=T.xb,t._OrtCreateSessionOptions=T.yb,t._OrtAppendExecutionProvider=T.zb,t._OrtAddFreeDimensionOverride=T.Ab,t._OrtAddSessionConfigEntry=T.Bb,t._OrtReleaseSessionOptions=T.Cb,t._OrtCreateSession=T.Db,t._OrtReleaseSession=T.Eb,t._OrtGetInputOutputCount=T.Fb,t._OrtGetInputOutputMetadata=T.Gb,t._OrtFree=T.Hb,t._OrtCreateTensor=T.Ib,t._OrtGetTensorData=T.Jb,t._OrtReleaseTensor=T.Kb,t._OrtCreateRunOptions=T.Lb,t._OrtAddRunConfigEntry=T.Mb,t._OrtReleaseRunOptions=T.Nb,t._OrtCreateBinding=T.Ob,t._OrtBindInput=T.Pb,t._OrtBindOutput=T.Qb,t._OrtClearBoundOutputs=T.Rb,t._OrtReleaseBinding=T.Sb,t._OrtRunWithBinding=T.Tb,t._OrtRun=T.Ub,t._OrtEndProfiling=T.Vb,t._JsepOutput=T.Wb,t._JsepGetNodeName=T.Xb,ra=T.Yb,Er=t._free=T.Zb,Vo=t._malloc=T._b,qo=T.bc,od=T.cc,bs=T.dc,cu=T.ec,xs=T.fc,Wi=T.gc,ld=T.hc,d=T.ic,m=T.jc,$=T.kc,k=T.lc,R=T.mc,O=T.nc,L=T.oc,q=T.pc,Y=T.qc,te=T.rc,de=T.sc,Q=T.tc,he=T.uc,re=T.vc,se=T.wc,ae=T.xc,pe=T.yc,ye=T.zc,we=T.Ac,Se=T.Bc,Ie=T.Cc,Le=T.Dc,Ge=T.Ec,Me=T.Fc,Ue=T.Gc,Qe=T.Hc,Ke=T.Ic,nt=T.Jc,Ct=T.Kc,Tt=T.Lc,Rt=T.Mc,bn=T.Nc,$t=T.Oc,Hr=T.Pc,Gr=T.Rc,Wo=T.Sc,rn=T.bd,_s=T.cd,du=T.hd,y1=T.kd,v1=T.ld,w1=T.md,b1=T.nd,x1=T.od,_1=T.pd,$1=T.qd,S1=T.rd,C1=T.wd,k1=T.Rd,E1=T.Sd,T1=T.Td,I1=T.Ud,w=z,na}var _,N=Ae();return t.instantiateWasm?new Promise(T=>{t.instantiateWasm(N,(z,V)=>{T(h(z,V))})}):i?h(new WebAssembly.Instance(w,Ae()),w):(H??(H=t.locateFile?t.locateFile?t.locateFile("ort-wasm-simd-threaded.jsep.wasm",f):f+"ort-wasm-simd-threaded.jsep.wasm":new URL("/FiberMapConnect/assets/ort-wasm-simd-threaded.jsep-6MnTkKum.wasm",import.meta.url).href),_=await async function(T){var z=H;if(!p&&!D(z))try{var V=fetch(z,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(V,T)}catch(oe){A(`wasm streaming compile failed: ${oe}`),A("falling back to ArrayBuffer instantiation")}return async function(oe,$e){try{var qe=await async function(rt){if(!p)try{var Et=await o(rt);return new Uint8Array(Et)}catch{}if(rt==H&&p)rt=new Uint8Array(p);else{if(!l)throw"both async and sync fetching of the wasm failed";rt=l(rt)}return rt}(oe);return await WebAssembly.instantiate(qe,$e)}catch(rt){A(`failed to asynchronously prepare wasm: ${rt}`),K(rt)}}(z,T)}(N),h(_.instance,_.module))}class be{constructor(_){fe(this,"name","ExitStatus");this.message=`Program terminated with exit(${_})`,this.status=_}}var ge=h=>{h.terminate(),h.onmessage=()=>{}},Te=[],Ee=0,We=null,Fe=h=>{rr.length==0&&(Ne(),_e(rr[0]));var _=rr.pop();if(!_)return 6;Zt.push(_),Ut[h.Tc]=_,_.Tc=h.Tc;var N={Uc:"run",Pd:h.Od,dd:h.dd,Tc:h.Tc};return _.postMessage(N,h.ud),0},He=0,Ve=(h,_,...N)=>{var T,z=16*N.length,V=O(),oe=R(z),$e=oe>>>3;for(T of N)typeof T=="bigint"?((I(),W)[$e++>>>0]=1n,(I(),W)[$e++>>>0]=T):((I(),W)[$e++>>>0]=0n,(I(),ce)[$e++>>>0]=T);return h=bs(h,0,z,oe,_),k(V),h};function vt(h){if(i)return Ve(0,1,h);if(x=h,!(0<He)){for(var _ of Zt)ge(_);for(_ of rr)ge(_);rr=[],Zt=[],Ut={},M=!0}u(0,new be(h))}function gt(h){if(i)return Ve(1,0,h);ot(h)}var ot=h=>{if(x=h,i)throw gt(h),"unwind";vt(h)},rr=[],Zt=[],cn=[],Ut={},G=h=>{var _=h.Tc;delete Ut[_],rr.push(h),Zt.splice(Zt.indexOf(h),1),h.Tc=0,cu(_)};function ve(){cn.forEach(h=>h())}var _e=h=>new Promise(_=>{h.onmessage=z=>{var V=z.data;if(z=V.Uc,V.ad&&V.ad!=ra()){var oe=Ut[V.ad];oe?oe.postMessage(V,V.ud):A(`Internal error! Worker sent a message "${z}" to target pthread ${V.ad}, but that thread no longer exists!`)}else z==="checkMailbox"?Ft():z==="spawnThread"?Fe(V):z==="cleanupThread"?Xs(()=>{G(Ut[V.Qd])}):z==="loaded"?(h.loaded=!0,_(h)):V.target==="setimmediate"?h.postMessage(V):z==="uncaughtException"?h.onerror(V.error):z==="callHandler"?t[V.zd](...V.args):z&&A(`worker sent an unknown command ${z}`)},h.onerror=z=>{throw A(`worker sent an error! ${z.filename}:${z.lineno}: ${z.message}`),z};var N,T=[];for(N of[])t.propertyIsEnumerable(N)&&T.push(N);h.postMessage({Uc:"load",Ad:T,Vd:ke,Wd:w})});function Ne(){var h=new Worker((()=>{let _=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new _("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});rr.push(h)}var ke,Pe=(h,_)=>{He=0,h=Q(h,_),0<He?x=h:xs(h)},De=[],tt=0;function pt(h){var _=new ir(h>>>=0);return(I(),Z)[_.Vc+12>>>0]==0&&(Wt(_,!0),tt--),lr(_,!1),De.push(_),te(h)}var wt=0,nr=()=>{d(0,0);var h=De.pop();L(h.ed),wt=0};function Wt(h,_){_=_?1:0,(I(),Z)[h.Vc+12>>>0]=_}function lr(h,_){_=_?1:0,(I(),Z)[h.Vc+13>>>0]=_}class ir{constructor(_){this.ed=_,this.Vc=_-24}}var Ye=h=>{var _=wt;if(!_)return m(0),0;var N=new ir(_);(I(),le)[N.Vc+16>>>2>>>0]=_;var T=(I(),le)[N.Vc+4>>>2>>>0];if(!T)return m(0),_;for(var z of h){if(z===0||z===T)break;if(Y(z,T,N.Vc+16))return m(z),_}return m(T),_};function Vr(){return Ye([])}function jr(h){return Ye([h>>>0])}function tn(h,_,N,T){return Ye([h>>>0,_>>>0,N>>>0,T>>>0])}var Be=()=>{var h=De.pop();h||K("no exception to throw");var _=h.ed;throw(I(),Z)[h.Vc+13>>>0]==0&&(De.push(h),lr(h,!0),Wt(h,!1),tt++),q(_),wt=_};function wi(h,_,N){var T=new ir(h>>>=0);throw _>>>=0,N>>>=0,(I(),le)[T.Vc+16>>>2>>>0]=0,(I(),le)[T.Vc+4>>>2>>>0]=_,(I(),le)[T.Vc+8>>>2>>>0]=N,q(h),tt++,wt=h}var ji=()=>tt;function dn(h,_,N,T){return i?Ve(2,1,h,_,N,T):Jn(h,_,N,T)}function Jn(h,_,N,T){if(h>>>=0,_>>>=0,N>>>=0,T>>>=0,!globalThis.SharedArrayBuffer)return 6;var z=[];return i&&z.length===0?dn(h,_,N,T):(h={Od:N,Tc:h,dd:T,ud:z},i?(h.Uc="spawnThread",postMessage(h,z),0):Fe(h))}function Bn(h){throw wt||(wt=h>>>0),wt}var bi=globalThis.TextDecoder&&new TextDecoder,xi=(h,_,N,T)=>{if(N=_+N,T)return N;for(;h[_]&&!(_>=N);)++_;return _},vn=(h,_=0,N,T)=>{if(16<(N=xi(h,_>>>=0,N,T))-_&&h.buffer&&bi)return bi.decode(h.buffer instanceof ArrayBuffer?h.subarray(_,N):h.slice(_,N));for(T="";_<N;){var z=h[_++];if(128&z){var V=63&h[_++];if((224&z)==192)T+=String.fromCharCode((31&z)<<6|V);else{var oe=63&h[_++];65536>(z=(240&z)==224?(15&z)<<12|V<<6|oe:(7&z)<<18|V<<12|oe<<6|63&h[_++])?T+=String.fromCharCode(z):(z-=65536,T+=String.fromCharCode(55296|z>>10,56320|1023&z))}}else T+=String.fromCharCode(z)}return T},Yt=(h,_,N)=>(h>>>=0)?vn((I(),ue),h,_,N):"";function Hs(h,_,N){return i?Ve(3,1,h,_,N):0}function Gs(h,_){if(i)return Ve(4,1,h,_)}function ur(h,_){if(i)return Ve(5,1,h,_)}function Mr(h,_,N){if(i)return Ve(6,1,h,_,N)}function mp(h,_,N){return i?Ve(7,1,h,_,N):0}function Oo(h,_){if(i)return Ve(8,1,h,_)}function Do(h,_,N){if(i)return Ve(9,1,h,_,N)}function jo(h,_,N,T){if(i)return Ve(10,1,h,_,N,T)}function gp(h,_,N,T){if(i)return Ve(11,1,h,_,N,T)}function Mi(h,_,N,T){if(i)return Ve(12,1,h,_,N,T)}function Qs(h){if(i)return Ve(13,1,h)}function zi(h,_){if(i)return Ve(14,1,h,_)}function Mo(h,_,N){if(i)return Ve(15,1,h,_,N)}var Vg=()=>K(""),Wr=h=>{h>>>=0;for(var _="";;){var N=(I(),ue)[h++>>>0];if(!N)return _;_+=String.fromCharCode(N)}},Ul={},Fi={},Zs=class extends Error{constructor(h){super(h),this.name="BindingError"}};function ei(h,_,N={}){return function(T,z,V={}){var oe=z.name;if(!T)throw new Zs(`type "${oe}" must have a positive integer typeid pointer`);if(Fi.hasOwnProperty(T)){if(V.Bd)return;throw new Zs(`Cannot register type '${oe}' twice`)}Fi[T]=z,Ul.hasOwnProperty(T)&&(z=Ul[T],delete Ul[T],z.forEach($e=>$e()))}(h,_,N)}var $r=(h,_,N)=>{switch(_){case 1:return N?T=>(I(),Z)[T>>>0]:T=>(I(),ue)[T>>>0];case 2:return N?T=>(I(),X)[T>>>1>>>0]:T=>(I(),ie)[T>>>1>>>0];case 4:return N?T=>(I(),j)[T>>>2>>>0]:T=>(I(),le)[T>>>2>>>0];case 8:return N?T=>(I(),W)[T>>>3>>>0]:T=>(I(),F)[T>>>3>>>0];default:throw new TypeError(`invalid integer width (${_}): ${h}`)}};function Ys(h,_,N,T,z){h>>>=0,N>>>=0,_=Wr(_>>>0);let V=oe=>oe;if(T=T===0n){let oe=8*N;V=$e=>BigInt.asUintN(oe,$e),z=V(z)}ei(h,{name:_,Qc:V,Xc:(oe,$e)=>(typeof $e=="number"&&($e=BigInt($e)),$e),Wc:$r(_,N,!T),Yc:null})}function Li(h,_,N,T){ei(h>>>=0,{name:_=Wr(_>>>0),Qc:function(z){return!!z},Xc:function(z,V){return V?N:T},Wc:function(z){return this.Qc((I(),ue)[z>>>0])},Yc:null})}var zc=[],Un=[0,1,,1,null,1,!0,1,!1,1];function Na(h){9<(h>>>=0)&&--Un[h+1]==0&&(Un[h]=void 0,zc.push(h))}var wn=h=>{if(!h)throw new Zs(`Cannot use deleted val. handle = ${h}`);return Un[h]},In=h=>{switch(h){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let _=zc.pop()||Un.length;return Un[_]=h,Un[_+1]=1,_}};function Bi(h){return this.Qc((I(),le)[h>>>2>>>0])}var yp={name:"emscripten::val",Qc:h=>{var _=wn(h);return Na(h),_},Xc:(h,_)=>In(_),Wc:Bi,Yc:null};function Vl(h){return ei(h>>>0,yp)}var vp=(h,_)=>{switch(_){case 4:return function(N){return this.Qc((I(),ne)[N>>>2>>>0])};case 8:return function(N){return this.Qc((I(),ce)[N>>>3>>>0])};default:throw new TypeError(`invalid float width (${_}): ${h}`)}};function zt(h,_,N){N>>>=0,ei(h>>>=0,{name:_=Wr(_>>>0),Qc:T=>T,Xc:(T,z)=>z,Wc:vp(_,N),Yc:null})}function wp(h,_,N,T,z){h>>>=0,N>>>=0,_=Wr(_>>>0);let V=$e=>$e;if(T===0){var oe=32-8*N;V=$e=>$e<<oe>>>oe,z=V(z)}ei(h,{name:_,Qc:V,Xc:($e,qe)=>qe,Wc:$r(_,N,T!==0),Yc:null})}function bp(h,_,N){function T(V){var oe=(I(),le)[V>>>2>>>0];return V=(I(),le)[V+4>>>2>>>0],new z((I(),Z).buffer,V,oe)}var z=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][_];ei(h>>>=0,{name:N=Wr(N>>>0),Qc:T,Wc:T},{Bd:!0})}var ti=(h,_,N)=>{var T=(I(),ue);if(_>>>=0,0<N){var z=_;N=_+N-1;for(var V=0;V<h.length;++V){var oe=h.codePointAt(V);if(127>=oe){if(_>=N)break;T[_++>>>0]=oe}else if(2047>=oe){if(_+1>=N)break;T[_++>>>0]=192|oe>>6,T[_++>>>0]=128|63&oe}else if(65535>=oe){if(_+2>=N)break;T[_++>>>0]=224|oe>>12,T[_++>>>0]=128|oe>>6&63,T[_++>>>0]=128|63&oe}else{if(_+3>=N)break;T[_++>>>0]=240|oe>>18,T[_++>>>0]=128|oe>>12&63,T[_++>>>0]=128|oe>>6&63,T[_++>>>0]=128|63&oe,V++}}T[_>>>0]=0,h=_-z}else h=0;return h},ys=h=>{for(var _=0,N=0;N<h.length;++N){var T=h.charCodeAt(N);127>=T?_++:2047>=T?_+=2:55296<=T&&57343>=T?(_+=4,++N):_+=3}return _};function xp(h,_){ei(h>>>=0,{name:_=Wr(_>>>0),Qc(N){var T=(I(),le)[N>>>2>>>0];return T=Yt(N+4,T,!0),Er(N),T},Xc(N,T){T instanceof ArrayBuffer&&(T=new Uint8Array(T));var z=typeof T=="string";if(!(z||ArrayBuffer.isView(T)&&T.BYTES_PER_ELEMENT==1))throw new Zs("Cannot pass non-string to std::string");var V=z?ys(T):T.length,oe=Vo(4+V+1),$e=oe+4;return(I(),le)[oe>>>2>>>0]=V,z?ti(T,$e,V+1):(I(),ue).set(T,$e>>>0),N!==null&&N.push(Er,oe),oe},Wc:Bi,Yc(N){Er(N)}})}var Fc=globalThis.TextDecoder?new TextDecoder("utf-16le"):void 0,_p=(h,_,N)=>{if(h>>>=1,16<(_=xi((I(),ie),h,_/2,N))-h&&Fc)return Fc.decode((I(),ie).slice(h,_));for(N="";h<_;++h){var T=(I(),ie)[h>>>0];N+=String.fromCharCode(T)}return N},hr=(h,_,N)=>{if(N??(N=2147483647),2>N)return 0;var T=_;N=(N-=2)<2*h.length?N/2:h.length;for(var z=0;z<N;++z){var V=h.charCodeAt(z);(I(),X)[_>>>1>>>0]=V,_+=2}return(I(),X)[_>>>1>>>0]=0,_-T},zo=h=>2*h.length,Fo=(h,_,N)=>{var T="";h>>>=2;for(var z=0;!(z>=_/4);z++){var V=(I(),le)[h+z>>>0];if(!V&&!N)break;T+=String.fromCodePoint(V)}return T},Pa=(h,_,N)=>{if(_>>>=0,N??(N=2147483647),4>N)return 0;var T=_;N=T+N-4;for(var z=0;z<h.length;++z){var V=h.codePointAt(z);if(65535<V&&z++,(I(),j)[_>>>2>>>0]=V,(_+=4)+4>N)break}return(I(),j)[_>>>2>>>0]=0,_-T},Lc=h=>{for(var _=0,N=0;N<h.length;++N)65535<h.codePointAt(N)&&N++,_+=4;return _};function Bc(h,_,N){if(h>>>=0,_>>>=0,N=Wr(N>>>=0),_===2)var T=_p,z=hr,V=zo;else T=Fo,z=Pa,V=Lc;ei(h,{name:N,Qc:oe=>{var $e=(I(),le)[oe>>>2>>>0];return $e=T(oe+4,$e*_,!0),Er(oe),$e},Xc:(oe,$e)=>{if(typeof $e!="string")throw new Zs(`Cannot pass non-string to C++ string type ${N}`);var qe=V($e),rt=Vo(4+qe+_);return(I(),le)[rt>>>2>>>0]=qe/_,z($e,rt+4,qe+_),oe!==null&&oe.push(Er,rt),rt},Wc:Bi,Yc(oe){Er(oe)}})}function ql(h,_){ei(h>>>=0,{Cd:!0,name:_=Wr(_>>>0),Qc:()=>{},Xc:()=>{}})}function $p(h){qo(h>>>0,!n,1,!r,131072,!1),ve()}var Xs=h=>{if(!M)try{if(h(),!(0<He))try{i?ra()&&xs(x):ot(x)}catch(_){_ instanceof be||_=="unwind"||u(0,_)}}catch(_){_ instanceof be||_=="unwind"||u(0,_)}},Sp=!Atomics.waitAsync||((P1=globalThis.navigator)==null?void 0:P1.userAgent)&&91>Number((navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)||[])[2]);function Uc(h){h>>>=0,Sp||(Atomics.waitAsync((I(),j),h>>>2,h).value.then(Ft),h+=128,Atomics.store((I(),j),h>>>2,1))}var Ft=()=>Xs(()=>{var h=ra();h&&(Uc(h),ld())});function Cp(h,_){(h>>>=0)==_>>>0?setTimeout(Ft):i?postMessage({ad:h,Uc:"checkMailbox"}):(h=Ut[h])&&h.postMessage({Uc:"checkMailbox"})}var Vc=[];function qg(h,_,N,T,z){for(_>>>=0,z>>>=0,Vc.length=0,N=z>>>3,T=z+T>>>3;N<T;){var V;V=(I(),W)[N++>>>0]?(I(),W)[N++>>>0]:(I(),ce)[N++>>>0],Vc.push(V)}return(_?ey[_]:TB[h])(...Vc)}var Nn=()=>{He=0};function Aa(h){h>>>=0,i?postMessage({Uc:"cleanupThread",Qd:h}):G(Ut[h])}function Wl(h){}var ri=h=>{try{h()}catch(_){K(_)}};function kp(h){var _=(...N)=>{vs.push(h);try{return h(...N)}finally{M||(vs.pop(),cr&&Ui===1&&vs.length===0&&(Ui=0,He+=1,ri(E1),typeof Fibers<"u"&&Fibers.ce()))}};return Vi.set(h,_),_}var Ui=0,cr=null,ni=0,vs=[],Js=new Map,Kl=new Map,Vi=new Map,Wg=0,Vn=null,qc=[],Wc=h=>function(_){if(!M){if(Ui===0){var N=!1,T=!1;_((z=0)=>{if(!M&&(ni=z,N=!0,T)){Ui=2,ri(()=>T1(cr)),typeof MainLoop<"u"&&MainLoop.yd&&MainLoop.resume(),z=!1;try{var V=function(){var qe=(I(),j)[cr+8>>>2>>>0];return qe=Kl.get(qe),qe=Vi.get(qe),--He,qe()}()}catch(qe){V=qe,z=!0}var oe=!1;if(!cr){var $e=Vn;$e&&(Vn=null,(z?$e.reject:$e.resolve)(V),oe=!0)}if(z&&!oe)throw V}}),T=!0,N||(Ui=1,cr=function(){var z=Vo(65548),V=z+12;if((I(),le)[z>>>2>>>0]=V,(I(),le)[z+4>>>2>>>0]=V+65536,V=vs[0],!Js.has(V)){var oe=Wg++;Js.set(V,oe),Kl.set(oe,V)}return V=Js.get(V),(I(),j)[z+8>>>2>>>0]=V,z}(),typeof MainLoop<"u"&&MainLoop.yd&&MainLoop.pause(),ri(()=>k1(cr)))}else Ui===2?(Ui=0,ri(I1),Er(cr),cr=null,qc.forEach(Xs)):K(`invalid state: ${Ui}`);return ni}}(_=>{h().then(_)});function Kc(h){return h>>>=0,Wc(async()=>{var _=await wn(h);return In(_)})}var ea=[],Hc=h=>{var _=ea.length;return ea.push(h),_},Ep=(h,_)=>{for(var N=Array(h),T=0;T<h;++T){var z=T,V=(I(),le)[_+4*T>>>2>>>0],oe=Fi[V];if(oe===void 0)throw h=`parameter ${T}`,V=$i(V),_=Wr(V),Er(V),new Zs(`${h} has unknown type ${_}`);N[z]=oe}return N},Kg=(h,_,N)=>{var T=[];return h=h(T,N),T.length&&((I(),le)[_>>>2>>>0]=In(T)),h},Lo={},Hl=h=>{var _=Lo[h];return _===void 0?Wr(h):_};function Hg(h,_,N){var[T,...z]=Ep(h,_>>>0);_=T.Xc.bind(T);var V=z.map(qe=>qe.Wc.bind(qe));h--;var oe={toValue:wn};switch(h=V.map((qe,rt)=>{var Et=`argFromPtr${rt}`;return oe[Et]=qe,`${Et}(args${rt?"+"+8*rt:""})`}),N){case 0:var $e="toValue(handle)";break;case 2:$e="new (toValue(handle))";break;case 3:$e="";break;case 1:oe.getStringOrSymbol=Hl,$e="toValue(handle)[getStringOrSymbol(methodName)]"}return $e+=`(${h})`,T.Cd||(oe.toReturnWire=_,oe.emval_returnValue=Kg,$e=`return emval_returnValue(toReturnWire, destructorsRef, ${$e})`),$e=`return function (handle, methodName, destructorsRef, args) {
  ${$e}
  }`,N=new Function(Object.keys(oe),$e)(...Object.values(oe)),$e=`methodCaller<(${z.map(qe=>qe.name)}) => ${T.name}>`,Hc(Object.defineProperty(N,"name",{value:$e}))}function Gl(h,_){return _>>>=0,(h=wn(h>>>0))==wn(_)}function Ql(h){return(h>>>=0)?(h=Hl(h),In(globalThis[h])):In(globalThis)}function Gc(h){return h=Hl(h>>>0),In(t[h])}function Gg(h,_){return _>>>=0,h=wn(h>>>0),_=wn(_),In(h[_])}function Qg(h){9<(h>>>=0)&&(Un[h+1]+=1)}function Tp(h,_,N,T,z){return ea[h>>>0](_>>>0,N>>>0,T>>>0,z>>>0)}function Qc(h,_,N,T,z){return Tp(h>>>0,_>>>0,N>>>0,T>>>0,z>>>0)}function Zc(){return In([])}function Ip(h){h=wn(h>>>0);for(var _=Array(h.length),N=0;N<h.length;N++)_[N]=h[N];return In(_)}function Zl(h){return In(Hl(h>>>0))}function Yl(){return In({})}function Xl(h){for(var _=wn(h>>>=0);_.length;){var N=_.pop();_.pop()(N)}Na(h)}function Np(h,_,N){_>>>=0,N>>>=0,h=wn(h>>>0),_=wn(_),N=wn(N),h[_]=N}function Zg(h,_){h=-9007199254740992>h||9007199254740992<h?NaN:Number(h),_>>>=0,h=new Date(1e3*h),(I(),j)[_>>>2>>>0]=h.getUTCSeconds(),(I(),j)[_+4>>>2>>>0]=h.getUTCMinutes(),(I(),j)[_+8>>>2>>>0]=h.getUTCHours(),(I(),j)[_+12>>>2>>>0]=h.getUTCDate(),(I(),j)[_+16>>>2>>>0]=h.getUTCMonth(),(I(),j)[_+20>>>2>>>0]=h.getUTCFullYear()-1900,(I(),j)[_+24>>>2>>>0]=h.getUTCDay(),h=(h.getTime()-Date.UTC(h.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,(I(),j)[_+28>>>2>>>0]=h}var ta=h=>h%4==0&&(h%100!=0||h%400==0),Jl=[0,31,60,91,121,152,182,213,244,274,305,335],eu=[0,31,59,90,120,151,181,212,243,273,304,334];function Yc(h,_){h=-9007199254740992>h||9007199254740992<h?NaN:Number(h),_>>>=0,h=new Date(1e3*h),(I(),j)[_>>>2>>>0]=h.getSeconds(),(I(),j)[_+4>>>2>>>0]=h.getMinutes(),(I(),j)[_+8>>>2>>>0]=h.getHours(),(I(),j)[_+12>>>2>>>0]=h.getDate(),(I(),j)[_+16>>>2>>>0]=h.getMonth(),(I(),j)[_+20>>>2>>>0]=h.getFullYear()-1900,(I(),j)[_+24>>>2>>>0]=h.getDay();var N=(ta(h.getFullYear())?Jl:eu)[h.getMonth()]+h.getDate()-1|0;(I(),j)[_+28>>>2>>>0]=N,(I(),j)[_+36>>>2>>>0]=-60*h.getTimezoneOffset(),N=new Date(h.getFullYear(),6,1).getTimezoneOffset();var T=new Date(h.getFullYear(),0,1).getTimezoneOffset();h=0|(N!=T&&h.getTimezoneOffset()==Math.min(T,N)),(I(),j)[_+32>>>2>>>0]=h}function Xc(h){h>>>=0;var _=new Date((I(),j)[h+20>>>2>>>0]+1900,(I(),j)[h+16>>>2>>>0],(I(),j)[h+12>>>2>>>0],(I(),j)[h+8>>>2>>>0],(I(),j)[h+4>>>2>>>0],(I(),j)[h>>>2>>>0],0),N=(I(),j)[h+32>>>2>>>0],T=_.getTimezoneOffset(),z=new Date(_.getFullYear(),6,1).getTimezoneOffset(),V=new Date(_.getFullYear(),0,1).getTimezoneOffset(),oe=Math.min(V,z);return 0>N?(I(),j)[h+32>>>2>>>0]=+(z!=V&&oe==T):0<N!=(oe==T)&&(z=Math.max(V,z),_.setTime(_.getTime()+6e4*((0<N?oe:z)-T))),(I(),j)[h+24>>>2>>>0]=_.getDay(),N=(ta(_.getFullYear())?Jl:eu)[_.getMonth()]+_.getDate()-1|0,(I(),j)[h+28>>>2>>>0]=N,(I(),j)[h>>>2>>>0]=_.getSeconds(),(I(),j)[h+4>>>2>>>0]=_.getMinutes(),(I(),j)[h+8>>>2>>>0]=_.getHours(),(I(),j)[h+12>>>2>>>0]=_.getDate(),(I(),j)[h+16>>>2>>>0]=_.getMonth(),(I(),j)[h+20>>>2>>>0]=_.getYear(),h=_.getTime(),BigInt(isNaN(h)?-1:h/1e3)}function Kr(h,_,N,T,z,V,oe){return i?Ve(16,1,h,_,N,T,z,V,oe):-52}function Ra(h,_,N,T,z,V){if(i)return Ve(17,1,h,_,N,T,z,V)}var qi={},Pp=()=>performance.timeOrigin+performance.now();function Bo(h,_){if(i)return Ve(18,1,h,_);if(qi[h]&&(clearTimeout(qi[h].id),delete qi[h]),!_)return 0;var N=setTimeout(()=>{delete qi[h],Xs(()=>Wi(h,performance.timeOrigin+performance.now()))},_);return qi[h]={id:N,be:_},0}function Ap(h,_,N,T){h>>>=0,_>>>=0,N>>>=0,T>>>=0;var z=new Date().getFullYear(),V=new Date(z,0,1).getTimezoneOffset();z=new Date(z,6,1).getTimezoneOffset();var oe=Math.max(V,z);(I(),le)[h>>>2>>>0]=60*oe,(I(),j)[_>>>2>>>0]=+(V!=z),h=(_=$e=>{var qe=Math.abs($e);return`UTC${0<=$e?"-":"+"}${String(Math.floor(qe/60)).padStart(2,"0")}${String(qe%60).padStart(2,"0")}`})(V),_=_(z),z<V?(ti(h,N,17),ti(_,T,17)):(ti(h,T,17),ti(_,N,17))}var Rp=()=>Date.now();function tu(h,_,N){return N>>>=0,0<=h&&3>=h?(h===0?h=Date.now():h=performance.timeOrigin+performance.now(),h=Math.round(1e6*h),(I(),W)[N>>>3>>>0]=BigInt(h),0):28}var Uo=[],ws=(h,_)=>{Uo.length=0;for(var N;N=(I(),ue)[h++>>>0];){var T=N!=105;_+=(T&=N!=112)&&_%8?4:0,Uo.push(N==112?(I(),le)[_>>>2>>>0]:N==106?(I(),W)[_>>>3>>>0]:N==105?(I(),j)[_>>>2>>>0]:(I(),ce)[_>>>3>>>0]),_+=T?8:4}return Uo};function Jc(h,_,N){return h>>>=0,_=ws(_>>>0,N>>>0),ey[h](..._)}function ed(h,_,N){return h>>>=0,_=ws(_>>>0,N>>>0),ey[h](..._)}var ru=()=>{};function td(h,_){return A(Yt(h>>>0,_>>>0))}var Op=()=>{throw He+=1,"unwind"};function Yg(){return 4294901760}var rd=()=>navigator.hardwareConcurrency,_i={},nu=h=>{var _;return(_=/\bwasm-function\[\d+\]:(0x[0-9a-f]+)/.exec(h))?+_[1]:(_=/:(\d+):\d+(?:\)|$)/.exec(h))?2147483648|+_[1]:0},iu=h=>{for(var _ of h)(h=nu(_))&&(_i[h]=_)};function nd(){var h=Error().stack.toString().split(`
`);return h[0]=="Error"&&h.shift(),iu(h),_i.sd=nu(h[3]),_i.Md=h,_i.sd}function su(h){if(!(h=_i[h>>>0]))return 0;var _;if(_=/^\s+at .*\.wasm\.(.*) \(.*\)$/.exec(h))h=_[1];else if(_=/^\s+at (.*) \(.*\)$/.exec(h))h=_[1];else{if(!(_=/^(.+?)@/.exec(h)))return 0;h=_[1]}Er(su.td??0),_=ys(h)+1;var N=Vo(_);return N&&ti(h,N,_),su.td=N,su.td}function Dp(h){h>>>=0;var _=(I(),ue).length;if(h<=_||4294901760<h)return!1;for(var N=1;4>=N;N*=2){var T=_*(1+.2/N);T=Math.min(T,h+100663296);e:{T=(Math.min(4294901760,65536*Math.ceil(Math.max(h,T)/65536))-ke.buffer.byteLength+65535)/65536|0;try{ke.grow(T),ee();var z=1;break e}catch{}z=void 0}if(z)return!0}return!1}function Xg(h,_,N){if(h>>>=0,_>>>=0,_i.sd==h)var T=_i.Md;else(T=Error().stack.toString().split(`
`))[0]=="Error"&&T.shift(),iu(T);for(var z=3;T[z]&&nu(T[z])!=h;)++z;for(h=0;h<N&&T[h+z];++h)(I(),j)[_+4*h>>>2>>>0]=nu(T[h+z]);return h}var au,ou={},jp=()=>{var T;if(!au){var h,_={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(((T=globalThis.navigator)==null?void 0:T.language)??"C").replace("-","_")+".UTF-8",_:"./this.program"};for(h in ou)ou[h]===void 0?delete _[h]:_[h]=ou[h];var N=[];for(h in _)N.push(`${h}=${_[h]}`);au=N}return au};function id(h,_){if(i)return Ve(19,1,h,_);h>>>=0,_>>>=0;var N,T=0,z=0;for(N of jp()){var V=_+T;(I(),le)[h+z>>>2>>>0]=V,T+=ti(N,V,1/0)+1,z+=4}return 0}function lu(h,_){if(i)return Ve(20,1,h,_);h>>>=0,_>>>=0;var N=jp();for(var T of((I(),le)[h>>>2>>>0]=N.length,h=0,N))h+=ys(T)+1;return(I(),le)[_>>>2>>>0]=h,0}function sd(h){return i?Ve(21,1,h):52}function ad(h,_,N,T){return i?Ve(22,1,h,_,N,T):52}function Mp(h,_,N,T){return i?Ve(23,1,h,_,N,T):70}var Jg=[null,[],[]];function zp(h,_,N,T){if(i)return Ve(24,1,h,_,N,T);_>>>=0,N>>>=0,T>>>=0;for(var z=0,V=0;V<N;V++){var oe=(I(),le)[_>>>2>>>0],$e=(I(),le)[_+4>>>2>>>0];_+=8;for(var qe=0;qe<$e;qe++){var rt=h,Et=(I(),ue)[oe+qe>>>0],Vt=Jg[rt];Et===0||Et===10?((rt===1?E:A)(vn(Vt)),Vt.length=0):Vt.push(Et)}z+=$e}return(I(),le)[T>>>2>>>0]=z,0}function uu(h){return h>>>0}i||function(){for(var h=t.numThreads-1;h--;)Ne();Te.push(async()=>{var _=async function(){if(!i)return Promise.all(rr.map(_e))}();Ee++,await _,--Ee==0&&We&&(_=We,We=null,_())})}(),i||(ke=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),ee()),t.wasmBinary&&(p=t.wasmBinary),t.stackSave=()=>O(),t.stackRestore=h=>k(h),t.stackAlloc=h=>R(h),t.setValue=function(h,_,N="i8"){switch(N.endsWith("*")&&(N="*"),N){case"i1":case"i8":(I(),Z)[h>>>0]=_;break;case"i16":(I(),X)[h>>>1>>>0]=_;break;case"i32":(I(),j)[h>>>2>>>0]=_;break;case"i64":(I(),W)[h>>>3>>>0]=BigInt(_);break;case"float":(I(),ne)[h>>>2>>>0]=_;break;case"double":(I(),ce)[h>>>3>>>0]=_;break;case"*":(I(),le)[h>>>2>>>0]=_;break;default:K(`invalid type for setValue: ${N}`)}},t.getValue=function(h,_="i8"){switch(_.endsWith("*")&&(_="*"),_){case"i1":case"i8":return(I(),Z)[h>>>0];case"i16":return(I(),X)[h>>>1>>>0];case"i32":return(I(),j)[h>>>2>>>0];case"i64":return(I(),W)[h>>>3>>>0];case"float":return(I(),ne)[h>>>2>>>0];case"double":return(I(),ce)[h>>>3>>>0];case"*":return(I(),le)[h>>>2>>>0];default:K(`invalid type for getValue: ${_}`)}},t.UTF8ToString=Yt,t.stringToUTF8=ti,t.lengthBytesUTF8=ys;var $i,Sr,ra,Er,Vo,qo,od,bs,cu,xs,Wi,ld,d,m,$,k,R,O,L,q,Y,te,de,Q,he,re,se,ae,pe,ye,we,Se,Ie,Le,Ge,Me,Ue,Qe,Ke,nt,Ct,Tt,Rt,bn,$t,Hr,Gr,Wo,rn,_s,du,y1,v1,w1,b1,x1,_1,$1,S1,C1,k1,E1,T1,I1,na,TB=[vt,gt,dn,Hs,Gs,ur,Mr,mp,Oo,Do,jo,gp,Mi,Qs,zi,Mo,Kr,Ra,Bo,id,lu,sd,ad,Mp,zp],ey={927244:(h,_,N,T,z)=>{if(t===void 0||!t.Zc)return 1;if((h=Yt(Number(h>>>0))).startsWith("./")&&(h=h.substring(2)),!(h=t.Zc.get(h)))return 2;if(_=Number(_>>>0),N=Number(N>>>0),T=Number(T>>>0),_+N>h.byteLength)return 3;try{let V=h.subarray(_,_+N);switch(z){case 0:(I(),ue).set(V,T>>>0);break;case 1:t.Xd?t.Xd(T,V):t.Ld(T,V);break;default:return 4}return 0}catch{return 4}},928068:(h,_,N)=>{t.xd(h,(I(),ue).subarray(_>>>0,_+N>>>0))},928132:()=>t.Zd(),928174:h=>{t.vd(h)},928211:()=>{t.Ed()},928242:()=>{t.Fd()},928271:()=>{t.Jd()},928296:h=>t.Dd(h),928329:h=>t.Hd(h),928361:(h,_,N)=>{t.jd(Number(h),Number(_),Number(N),!0)},928424:(h,_,N)=>{t.jd(Number(h),Number(_),Number(N))},928481:()=>typeof wasmOffsetConverter<"u",928538:h=>{t.ac("Abs",h,void 0)},928589:h=>{t.ac("Neg",h,void 0)},928640:h=>{t.ac("Floor",h,void 0)},928693:h=>{t.ac("Ceil",h,void 0)},928745:h=>{t.ac("Reciprocal",h,void 0)},928803:h=>{t.ac("Sqrt",h,void 0)},928855:h=>{t.ac("Exp",h,void 0)},928906:h=>{t.ac("Erf",h,void 0)},928957:h=>{t.ac("Sigmoid",h,void 0)},929012:(h,_,N)=>{t.ac("HardSigmoid",h,{alpha:_,beta:N})},929091:h=>{t.ac("Log",h,void 0)},929142:h=>{t.ac("Sin",h,void 0)},929193:h=>{t.ac("Cos",h,void 0)},929244:h=>{t.ac("Tan",h,void 0)},929295:h=>{t.ac("Asin",h,void 0)},929347:h=>{t.ac("Acos",h,void 0)},929399:h=>{t.ac("Atan",h,void 0)},929451:h=>{t.ac("Sinh",h,void 0)},929503:h=>{t.ac("Cosh",h,void 0)},929555:h=>{t.ac("Asinh",h,void 0)},929608:h=>{t.ac("Acosh",h,void 0)},929661:h=>{t.ac("Atanh",h,void 0)},929714:h=>{t.ac("Tanh",h,void 0)},929766:h=>{t.ac("Not",h,void 0)},929817:(h,_,N)=>{t.ac("Clip",h,{min:_,max:N})},929886:h=>{t.ac("Clip",h,void 0)},929938:(h,_)=>{t.ac("Elu",h,{alpha:_})},929996:h=>{t.ac("Gelu",h,void 0)},930048:h=>{t.ac("Relu",h,void 0)},930100:(h,_)=>{t.ac("LeakyRelu",h,{alpha:_})},930164:(h,_)=>{t.ac("ThresholdedRelu",h,{alpha:_})},930234:(h,_)=>{t.ac("Cast",h,{to:_})},930292:h=>{t.ac("Add",h,void 0)},930343:h=>{t.ac("Sub",h,void 0)},930394:h=>{t.ac("Mul",h,void 0)},930445:h=>{t.ac("Div",h,void 0)},930496:h=>{t.ac("Pow",h,void 0)},930547:h=>{t.ac("Equal",h,void 0)},930600:h=>{t.ac("Greater",h,void 0)},930655:h=>{t.ac("GreaterOrEqual",h,void 0)},930717:h=>{t.ac("Less",h,void 0)},930769:h=>{t.ac("LessOrEqual",h,void 0)},930828:(h,_,N,T,z)=>{t.ac("ReduceMean",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},931003:(h,_,N,T,z)=>{t.ac("ReduceMax",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},931177:(h,_,N,T,z)=>{t.ac("ReduceMin",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},931351:(h,_,N,T,z)=>{t.ac("ReduceProd",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},931526:(h,_,N,T,z)=>{t.ac("ReduceSum",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},931700:(h,_,N,T,z)=>{t.ac("ReduceL1",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},931873:(h,_,N,T,z)=>{t.ac("ReduceL2",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},932046:(h,_,N,T,z)=>{t.ac("ReduceLogSum",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},932223:(h,_,N,T,z)=>{t.ac("ReduceSumSquare",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},932403:(h,_,N,T,z)=>{t.ac("ReduceLogSumExp",h,{keepDims:!!_,noopWithEmptyAxes:!!N,axes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},932583:h=>{t.ac("Where",h,void 0)},932636:(h,_,N)=>{t.ac("Transpose",h,{perm:_?Array.from((I(),j).subarray(Number(_)>>>0,Number(N)>>>0)):[]})},932760:(h,_,N,T)=>{t.ac("DepthToSpace",h,{blocksize:_,mode:Yt(N),format:T?"NHWC":"NCHW"})},932893:(h,_,N,T)=>{t.ac("DepthToSpace",h,{blocksize:_,mode:Yt(N),format:T?"NHWC":"NCHW"})},933026:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr,Oa)=>{t.ac("ConvTranspose",h,{format:qe?"NHWC":"NCHW",autoPad:_,dilations:[N],group:T,kernelShape:[z],pads:[V,oe],strides:[$e],wIsConst:()=>!!(I(),Z)[rt>>>0],outputPadding:Et?Array.from((I(),j).subarray(Number(Et)>>>0,Number(Vt)>>>0)):[],outputShape:dr?Array.from((I(),j).subarray(Number(dr)>>>0,Number(yr)>>>0)):[],activation:Yt(Oa)})},933459:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr)=>{t.ac("ConvTranspose",h,{format:$e?"NHWC":"NCHW",autoPad:_,dilations:Array.from((I(),j).subarray(Number(N)>>>0,2+(Number(N)>>>0)>>>0)),group:T,kernelShape:Array.from((I(),j).subarray(Number(z)>>>0,2+(Number(z)>>>0)>>>0)),pads:Array.from((I(),j).subarray(Number(V)>>>0,4+(Number(V)>>>0)>>>0)),strides:Array.from((I(),j).subarray(Number(oe)>>>0,2+(Number(oe)>>>0)>>>0)),wIsConst:()=>!!(I(),Z)[qe>>>0],outputPadding:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],outputShape:Vt?Array.from((I(),j).subarray(Number(Vt)>>>0,Number(dr)>>>0)):[],activation:Yt(yr)})},934120:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr,Oa)=>{t.ac("ConvTranspose",h,{format:qe?"NHWC":"NCHW",autoPad:_,dilations:[N],group:T,kernelShape:[z],pads:[V,oe],strides:[$e],wIsConst:()=>!!(I(),Z)[rt>>>0],outputPadding:Et?Array.from((I(),j).subarray(Number(Et)>>>0,Number(Vt)>>>0)):[],outputShape:dr?Array.from((I(),j).subarray(Number(dr)>>>0,Number(yr)>>>0)):[],activation:Yt(Oa)})},934553:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr)=>{t.ac("ConvTranspose",h,{format:$e?"NHWC":"NCHW",autoPad:_,dilations:Array.from((I(),j).subarray(Number(N)>>>0,2+(Number(N)>>>0)>>>0)),group:T,kernelShape:Array.from((I(),j).subarray(Number(z)>>>0,2+(Number(z)>>>0)>>>0)),pads:Array.from((I(),j).subarray(Number(V)>>>0,4+(Number(V)>>>0)>>>0)),strides:Array.from((I(),j).subarray(Number(oe)>>>0,2+(Number(oe)>>>0)>>>0)),wIsConst:()=>!!(I(),Z)[qe>>>0],outputPadding:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],outputShape:Vt?Array.from((I(),j).subarray(Number(Vt)>>>0,Number(dr)>>>0)):[],activation:Yt(yr)})},935214:(h,_)=>{t.ac("GlobalAveragePool",h,{format:_?"NHWC":"NCHW"})},935305:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr)=>{t.ac("AveragePool",h,{format:yr?"NHWC":"NCHW",auto_pad:_,ceil_mode:N,count_include_pad:T,storage_order:z,dilations:V?Array.from((I(),j).subarray(Number(V)>>>0,Number(oe)>>>0)):[],kernel_shape:$e?Array.from((I(),j).subarray(Number($e)>>>0,Number(qe)>>>0)):[],pads:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],strides:Vt?Array.from((I(),j).subarray(Number(Vt)>>>0,Number(dr)>>>0)):[]})},935784:(h,_)=>{t.ac("GlobalAveragePool",h,{format:_?"NHWC":"NCHW"})},935875:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr)=>{t.ac("AveragePool",h,{format:yr?"NHWC":"NCHW",auto_pad:_,ceil_mode:N,count_include_pad:T,storage_order:z,dilations:V?Array.from((I(),j).subarray(Number(V)>>>0,Number(oe)>>>0)):[],kernel_shape:$e?Array.from((I(),j).subarray(Number($e)>>>0,Number(qe)>>>0)):[],pads:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],strides:Vt?Array.from((I(),j).subarray(Number(Vt)>>>0,Number(dr)>>>0)):[]})},936354:(h,_)=>{t.ac("GlobalMaxPool",h,{format:_?"NHWC":"NCHW"})},936441:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr)=>{t.ac("MaxPool",h,{format:yr?"NHWC":"NCHW",auto_pad:_,ceil_mode:N,count_include_pad:T,storage_order:z,dilations:V?Array.from((I(),j).subarray(Number(V)>>>0,Number(oe)>>>0)):[],kernel_shape:$e?Array.from((I(),j).subarray(Number($e)>>>0,Number(qe)>>>0)):[],pads:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],strides:Vt?Array.from((I(),j).subarray(Number(Vt)>>>0,Number(dr)>>>0)):[]})},936916:(h,_)=>{t.ac("GlobalMaxPool",h,{format:_?"NHWC":"NCHW"})},937003:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr)=>{t.ac("MaxPool",h,{format:yr?"NHWC":"NCHW",auto_pad:_,ceil_mode:N,count_include_pad:T,storage_order:z,dilations:V?Array.from((I(),j).subarray(Number(V)>>>0,Number(oe)>>>0)):[],kernel_shape:$e?Array.from((I(),j).subarray(Number($e)>>>0,Number(qe)>>>0)):[],pads:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],strides:Vt?Array.from((I(),j).subarray(Number(Vt)>>>0,Number(dr)>>>0)):[]})},937478:(h,_,N,T,z)=>{t.ac("Gemm",h,{alpha:_,beta:N,transA:T,transB:z})},937582:h=>{t.ac("MatMul",h,void 0)},937636:(h,_,N,T)=>{t.ac("ArgMax",h,{keepDims:!!_,selectLastIndex:!!N,axis:T})},937744:(h,_,N,T)=>{t.ac("ArgMin",h,{keepDims:!!_,selectLastIndex:!!N,axis:T})},937852:(h,_)=>{t.ac("Softmax",h,{axis:_})},937915:(h,_)=>{t.ac("Concat",h,{axis:_})},937975:(h,_,N,T,z)=>{t.ac("Split",h,{axis:_,numOutputs:N,splitSizes:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},938131:h=>{t.ac("Expand",h,void 0)},938185:(h,_)=>{t.ac("Gather",h,{axis:Number(_)})},938256:(h,_)=>{t.ac("GatherElements",h,{axis:Number(_)})},938335:(h,_)=>{t.ac("GatherND",h,{batch_dims:Number(_)})},938414:(h,_,N,T,z,V,oe,$e,qe,rt,Et)=>{t.ac("Resize",h,{antialias:_,axes:N?Array.from((I(),j).subarray(Number(N)>>>0,Number(T)>>>0)):[],coordinateTransformMode:Yt(z),cubicCoeffA:V,excludeOutside:oe,extrapolationValue:$e,keepAspectRatioPolicy:Yt(qe),mode:Yt(rt),nearestMode:Yt(Et)})},938776:(h,_,N,T,z,V,oe)=>{t.ac("Slice",h,{starts:_?Array.from((I(),j).subarray(Number(_)>>>0,Number(N)>>>0)):[],ends:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[],axes:V?Array.from((I(),j).subarray(Number(V)>>>0,Number(oe)>>>0)):[]})},939040:h=>{t.ac("Tile",h,void 0)},939092:(h,_,N)=>{t.ac("InstanceNormalization",h,{epsilon:_,format:N?"NHWC":"NCHW"})},939206:(h,_,N)=>{t.ac("InstanceNormalization",h,{epsilon:_,format:N?"NHWC":"NCHW"})},939320:h=>{t.ac("Range",h,void 0)},939373:(h,_)=>{t.ac("Einsum",h,{equation:Yt(_)})},939454:(h,_,N,T,z)=>{t.ac("Pad",h,{mode:_,value:N,pads:T?Array.from((I(),j).subarray(Number(T)>>>0,Number(z)>>>0)):[]})},939597:(h,_,N,T,z,V)=>{t.ac("BatchNormalization",h,{epsilon:_,momentum:N,spatial:!!z,trainingMode:!!T,format:V?"NHWC":"NCHW"})},939766:(h,_,N,T,z,V)=>{t.ac("BatchNormalization",h,{epsilon:_,momentum:N,spatial:!!z,trainingMode:!!T,format:V?"NHWC":"NCHW"})},939935:(h,_,N)=>{t.ac("CumSum",h,{exclusive:Number(_),reverse:Number(N)})},940032:(h,_,N)=>{t.ac("DequantizeLinear",h,{axis:_,blockSize:N})},940122:(h,_,N,T,z)=>{t.ac("GridSample",h,{align_corners:_,mode:Yt(N),padding_mode:Yt(T),format:z?"NHWC":"NCHW"})},940292:(h,_,N,T,z)=>{t.ac("GridSample",h,{align_corners:_,mode:Yt(N),padding_mode:Yt(T),format:z?"NHWC":"NCHW"})},940462:(h,_)=>{t.ac("ScatterND",h,{reduction:Yt(_)})},940547:(h,_,N,T,z,V,oe,$e,qe)=>{t.ac("Attention",h,{numHeads:_,isUnidirectional:N,maskFilterValue:T,scale:z,doRotary:V,qkvHiddenSizes:oe?Array.from((I(),j).subarray(Number($e)>>>0,Number($e)+oe>>>0)):[],pastPresentShareBuffer:!!qe})},940819:h=>{t.ac("BiasAdd",h,void 0)},940874:h=>{t.ac("BiasSplitGelu",h,void 0)},940935:h=>{t.ac("FastGelu",h,void 0)},940991:(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr,Oa,ty)=>{t.ac("Conv",h,{format:Vt?"NHWC":"NCHW",auto_pad:_,dilations:N?Array.from((I(),j).subarray(Number(N)>>>0,Number(T)>>>0)):[],group:z,kernel_shape:V?Array.from((I(),j).subarray(Number(V)>>>0,Number(oe)>>>0)):[],pads:$e?Array.from((I(),j).subarray(Number($e)>>>0,Number(qe)>>>0)):[],strides:rt?Array.from((I(),j).subarray(Number(rt)>>>0,Number(Et)>>>0)):[],w_is_const:()=>!!(I(),Z)[Number(dr)>>>0],activation:Yt(yr),activation_params:Oa?Array.from((I(),ne).subarray(Number(Oa)>>>0,Number(ty)>>>0)):[]})},941575:h=>{t.ac("Gelu",h,void 0)},941627:(h,_,N,T,z,V,oe,$e,qe)=>{t.ac("GroupQueryAttention",h,{numHeads:_,kvNumHeads:N,scale:T,softcap:z,doRotary:V,rotaryInterleaved:oe,smoothSoftmax:$e,localWindowSize:qe})},941844:(h,_,N,T)=>{t.ac("LayerNormalization",h,{axis:_,epsilon:N,simplified:!!T})},941955:(h,_,N,T)=>{t.ac("LayerNormalization",h,{axis:_,epsilon:N,simplified:!!T})},942066:(h,_,N,T,z,V)=>{t.ac("MatMulNBits",h,{k:_,n:N,accuracyLevel:T,bits:z,blockSize:V})},942193:(h,_,N,T,z,V)=>{t.ac("MultiHeadAttention",h,{numHeads:_,isUnidirectional:N,maskFilterValue:T,scale:z,doRotary:V})},942352:(h,_)=>{t.ac("QuickGelu",h,{alpha:_})},942416:(h,_,N,T,z)=>{t.ac("RotaryEmbedding",h,{interleaved:!!_,numHeads:N,rotaryEmbeddingDim:T,scale:z})},942555:(h,_,N)=>{t.ac("SkipLayerNormalization",h,{epsilon:_,simplified:!!N})},942657:(h,_,N)=>{t.ac("SkipLayerNormalization",h,{epsilon:_,simplified:!!N})},942759:(h,_,N,T)=>{t.ac("GatherBlockQuantized",h,{gatherAxis:_,quantizeAxis:N,blockSize:T})},942880:h=>{t.Id(h)},942914:(h,_)=>t.Kd(Number(h),Number(_),t.$c.Nd,t.$c.errors)};function IB(h,_,N){return Wc(async()=>{await t.Gd(Number(h),Number(_),Number(N))})}function NB(){return typeof wasmOffsetConverter<"u"}function PB(h,_,N,T){var z=O();try{return Se(h,_,N,T)}catch(V){if(k(z),V!==V+0)throw V;d(1,0)}}function AB(h,_,N){var T=O();try{return ae(h,_,N)}catch(z){if(k(T),z!==z+0)throw z;d(1,0)}}function RB(h,_,N){var T=O();try{de(h,_,N)}catch(z){if(k(T),z!==z+0)throw z;d(1,0)}}function OB(h,_){var N=O();try{return Q(h,_)}catch(T){if(k(N),T!==T+0)throw T;d(1,0)}}function DB(h){var _=O();try{he(h)}catch(N){if(k(_),N!==N+0)throw N;d(1,0)}}function jB(h,_,N,T,z,V,oe){var $e=O();try{return ye(h,_,N,T,z,V,oe)}catch(qe){if(k($e),qe!==qe+0)throw qe;d(1,0)}}function MB(h,_){var N=O();try{Ie(h,_)}catch(T){if(k(N),T!==T+0)throw T;d(1,0)}}function zB(h,_,N,T,z,V){var oe=O();try{re(h,_,N,T,z,V)}catch($e){if(k(oe),$e!==$e+0)throw $e;d(1,0)}}function FB(h,_,N,T){var z=O();try{we(h,_,N,T)}catch(V){if(k(z),V!==V+0)throw V;d(1,0)}}function LB(h,_,N,T,z){var V=O();try{se(h,_,N,T,z)}catch(oe){if(k(V),oe!==oe+0)throw oe;d(1,0)}}function BB(h,_,N,T,z,V,oe){var $e=O();try{Ge(h,_,N,T,z,V,oe)}catch(qe){if(k($e),qe!==qe+0)throw qe;d(1,0)}}function UB(h,_,N,T,z,V,oe){var $e=O();try{Me(h,_,N,T,z,V,oe)}catch(qe){if(k($e),qe!==qe+0)throw qe;d(1,0)}}function VB(h,_,N,T,z,V,oe,$e){var qe=O();try{nt(h,_,N,T,z,V,oe,$e)}catch(rt){if(k(qe),rt!==rt+0)throw rt;d(1,0)}}function qB(h,_,N,T,z){var V=O();try{return Le(h,_,N,T,z)}catch(oe){if(k(V),oe!==oe+0)throw oe;d(1,0)}}function WB(h,_,N,T,z,V,oe,$e){var qe=O();try{Ct(h,_,N,T,z,V,oe,$e)}catch(rt){if(k(qe),rt!==rt+0)throw rt;d(1,0)}}function KB(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt){var dr=O();try{Ue(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt)}catch(yr){if(k(dr),yr!==yr+0)throw yr;d(1,0)}}function HB(h,_,N,T,z,V){var oe=O();try{return Qe(h,_,N,T,z,V)}catch($e){if(k(oe),$e!==$e+0)throw $e;d(1,0)}}function GB(h,_,N){var T=O();try{return Tt(h,_,N)}catch(z){if(k(T),z!==z+0)throw z;return d(1,0),0n}}function QB(h,_,N,T,z,V,oe,$e,qe){var rt=O();try{pe(h,_,N,T,z,V,oe,$e,qe)}catch(Et){if(k(rt),Et!==Et+0)throw Et;d(1,0)}}function ZB(h){var _=O();try{return Rt(h)}catch(N){if(k(_),N!==N+0)throw N;d(1,0)}}function YB(h,_,N){var T=O();try{return bn(h,_,N)}catch(z){if(k(T),z!==z+0)throw z;d(1,0)}}function XB(h,_){var N=O();try{return C1(h,_)}catch(T){if(k(N),T!==T+0)throw T;return d(1,0),0n}}function JB(h,_,N,T,z){var V=O();try{$t(h,_,N,T,z)}catch(oe){if(k(V),oe!==oe+0)throw oe;d(1,0)}}function eU(h){var _=O();try{return Hr(h)}catch(N){if(k(_),N!==N+0)throw N;return d(1,0),0n}}function tU(h,_,N,T,z,V){var oe=O();try{return y1(h,_,N,T,z,V)}catch($e){if(k(oe),$e!==$e+0)throw $e;d(1,0)}}function rU(h,_,N,T,z,V){var oe=O();try{return v1(h,_,N,T,z,V)}catch($e){if(k(oe),$e!==$e+0)throw $e;d(1,0)}}function nU(h,_,N,T,z,V,oe,$e){var qe=O();try{return Ke(h,_,N,T,z,V,oe,$e)}catch(rt){if(k(qe),rt!==rt+0)throw rt;d(1,0)}}function iU(h,_,N,T,z){var V=O();try{return w1(h,_,N,T,z)}catch(oe){if(k(V),oe!==oe+0)throw oe;return d(1,0),0n}}function sU(h,_,N,T){var z=O();try{return b1(h,_,N,T)}catch(V){if(k(z),V!==V+0)throw V;d(1,0)}}function aU(h,_,N,T){var z=O();try{return x1(h,_,N,T)}catch(V){if(k(z),V!==V+0)throw V;d(1,0)}}function oU(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt){var dr=O();try{return _1(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt)}catch(yr){if(k(dr),yr!==yr+0)throw yr;d(1,0)}}function lU(h,_,N,T,z,V,oe,$e,qe,rt,Et){var Vt=O();try{_s(h,_,N,T,z,V,oe,$e,qe,rt,Et)}catch(dr){if(k(Vt),dr!==dr+0)throw dr;d(1,0)}}function uU(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr,Oa,ty){var mU=O();try{du(h,_,N,T,z,V,oe,$e,qe,rt,Et,Vt,dr,yr,Oa,ty)}catch(ry){if(k(mU),ry!==ry+0)throw ry;d(1,0)}}function cU(h,_,N,T){var z=O();try{return $1(h,_,N,T)}catch(V){if(k(z),V!==V+0)throw V;d(1,0)}}function dU(h,_,N,T,z){var V=O();try{return S1(h,_,N,T,z)}catch(oe){if(k(V),oe!==oe+0)throw oe;d(1,0)}}function fU(h,_,N){var T=O();try{return Gr(h,_,N)}catch(z){if(k(T),z!==z+0)throw z;d(1,0)}}function pU(h,_,N){var T=O();try{return Wo(h,_,N)}catch(z){if(k(T),z!==z+0)throw z;d(1,0)}}function hU(h,_,N,T){var z=O();try{rn(h,_,N,T)}catch(V){if(k(z),V!==V+0)throw V;d(1,0)}}function Fp(){if(0<Ee)We=Fp;else if(i)v==null||v(t),me();else{for(var h=Te;0<h.length;)h.shift()(t);0<Ee?We=Fp:(t.calledRun=!0,M||(me(),v==null||v(t)))}}return i||(na=await Ze(),Fp()),t.PTR_SIZE=4,B?t:new Promise((h,_)=>{v=h,C=_})}var e4,m2,cY=Oe(()=>{var e,t;e4=h2,m2=(t=(e=globalThis.self)==null?void 0:e.name)==null?void 0:t.startsWith("em-pthread"),m2&&h2()}),iv,Pw,g2,ii,t4,mh,y2,v2,sv,w2,av,r4,ov,n4,qx=Oe(()=>{Vx(),iv=typeof location>"u"?void 0:location.origin,Pw=import.meta.url>"file:"&&import.meta.url<"file;",g2=()=>{{if(Pw){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,iv).href}return import.meta.url}},ii=g2(),t4=()=>{if(ii&&!ii.startsWith("blob:"))return ii.substring(0,ii.lastIndexOf("/")+1)},mh=(e,t)=>{try{let r=t??ii;return(r?new URL(e,r):new URL(e)).origin===iv}catch{return!1}},y2=(e,t)=>{let r=t??ii;try{return(r?new URL(e,r):new URL(e)).href}catch{return}},v2=(e,t)=>`${t??"./"}${e}`,sv=async e=>{let t=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},w2=async e=>(await import(e)).default,av=(uY(),Qf(Yz)).default,r4=async()=>{if(!ii)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(mh(ii))return[void 0,av()];let e=await sv(ii);return[e,av(e)]},ov=(cY(),Qf(Jz)).default,n4=async(e,t,r,n)=>{let i=ov&&!(e||t);if(i)if(ii)i=mh(ii);else if(n&&!r)i=!0;else throw new Error("cannot determine the script source URL.");if(i)return[void 0,ov];{let s="ort-wasm-simd-threaded.jsep.mjs",a=e??y2(s,t),o=r&&a&&!mh(a,t),l=o?await sv(a):a??v2(s,t);return[o?l:void 0,await w2(l)]}}}),lv,gh,_d,uv,b2,x2,_2,Wx,gr,Ll=Oe(()=>{qx(),gh=!1,_d=!1,uv=!1,b2=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},x2=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},_2=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},Wx=async e=>{if(gh)return Promise.resolve();if(_d)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(uv)throw new Error("previous call to 'initializeWebAssembly()' failed.");_d=!0;let t=e.initTimeout,r=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!_2())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!x2())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let n=b2();r>1&&!n&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+r+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=r=1);let i=e.wasmPaths,s=typeof i=="string"?i:void 0,a=i==null?void 0:i.mjs,o=(a==null?void 0:a.href)??a,l=i==null?void 0:i.wasm,u=(l==null?void 0:l.href)??l,c=e.wasmBinary,[f,p]=await n4(o,s,r>1,!!c||!!u),w=!1,x=[];if(t>0&&x.push(new Promise(v=>{setTimeout(()=>{w=!0,v()},t)})),x.push(new Promise((v,C)=>{let b={numThreads:r};if(c)b.wasmBinary=c;else if(u||s)b.locateFile=g=>u??s+g;else if(o&&o.indexOf("blob:")!==0)b.locateFile=g=>new URL(g,o).href;else if(f){let g=t4();g&&(b.locateFile=S=>g+S)}p(b).then(g=>{_d=!1,gh=!0,lv=g,v(),f&&URL.revokeObjectURL(f)},g=>{_d=!1,uv=!0,C(g)})})),await Promise.race(x),w)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},gr=()=>{if(gh&&lv)return lv;throw new Error("WebAssembly is not initialized yet.")}}),is,Ym,tr,Kx=Oe(()=>{Ll(),is=(e,t)=>{let r=gr(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i},Ym=(e,t,r,n)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([i,s])=>{let a=t?t+i:i;if(typeof s=="object")Ym(s,a+".",r,n);else if(typeof s=="string"||typeof s=="number")n(a,s.toString());else if(typeof s=="boolean")n(a,s?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof s}`)})},tr=e=>{let t=gr(),r=t.stackSave();try{let n=t.PTR_SIZE,i=t.stackAlloc(2*n);t._OrtGetLastError(i,i+n);let s=Number(t.getValue(i,n===4?"i32":"i64")),a=t.getValue(i+n,"*"),o=a?t.UTF8ToString(a):"";throw new Error(`${e} ERROR_CODE: ${s}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}}),i4,dY=Oe(()=>{Ll(),Kx(),i4=e=>{let t=gr(),r=0,n=[],i=e||{};try{if((e==null?void 0:e.logSeverityLevel)===void 0)i.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log severity level is not valid: ${e.logSeverityLevel}`);if((e==null?void 0:e.logVerbosityLevel)===void 0)i.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);(e==null?void 0:e.terminate)===void 0&&(i.terminate=!1);let s=0;return(e==null?void 0:e.tag)!==void 0&&(s=is(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,s),r===0&&tr("Can't create run options."),(e==null?void 0:e.extra)!==void 0&&Ym(e.extra,"",new WeakSet,(a,o)=>{let l=is(a,n),u=is(o,n);t._OrtAddRunConfigEntry(r,l,u)!==0&&tr(`Can't set a run config entry: ${a} - ${o}.`)}),[r,n]}catch(s){throw r!==0&&t._OrtReleaseRunOptions(r),n.forEach(a=>t._free(a)),s}}}),$2,S2,C2,$d,k2,s4,fY=Oe(()=>{Ll(),Kx(),$2=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"layout":return 3;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},S2=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},C2=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},$d=(e,t,r,n)=>{let i=is(t,n),s=is(r,n);gr()._OrtAddSessionConfigEntry(e,i,s)!==0&&tr(`Can't set a session config entry: ${t} - ${r}.`)},k2=async(e,t,r)=>{let n=t.executionProviders;for(let i of n){let s=typeof i=="string"?i:i.name,a=[];switch(s){case"webnn":if(s="WEBNN",typeof i!="string"){let f=i==null?void 0:i.deviceType;f&&$d(e,"deviceType",f,r)}break;case"webgpu":if(s="JS",typeof i!="string"){let f=i;if(f!=null&&f.preferredLayout){if(f.preferredLayout!=="NCHW"&&f.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${f.preferredLayout}`);$d(e,"preferredLayout",f.preferredLayout,r)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${s}`)}let o=is(s,r),l=a.length,u=0,c=0;if(l>0){u=gr()._malloc(l*gr().PTR_SIZE),r.push(u),c=gr()._malloc(l*gr().PTR_SIZE),r.push(c);for(let f=0;f<l;f++)gr().setValue(u+f*gr().PTR_SIZE,a[f][0],"*"),gr().setValue(c+f*gr().PTR_SIZE,a[f][1],"*")}await gr()._OrtAppendExecutionProvider(e,o,u,c,l)!==0&&tr(`Can't append execution provider: ${s}.`)}},s4=async e=>{let t=gr(),r=0,n=[],i=e||{};C2(i);try{let s=$2(i.graphOptimizationLevel??"all"),a=S2(i.executionMode??"sequential"),o=typeof i.logId=="string"?is(i.logId,n):0,l=i.logSeverityLevel??2;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log severity level is not valid: ${l}`);let u=i.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let c=typeof i.optimizedModelFilePath=="string"?is(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(s,!!i.enableCpuMemArena,!!i.enableMemPattern,a,!!i.enableProfiling,0,o,l,u,c),r===0&&tr("Can't create session options."),i.executionProviders&&await k2(r,i,n),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);$d(r,"enableGraphCapture",i.enableGraphCapture.toString(),n)}if(i.freeDimensionOverrides)for(let[f,p]of Object.entries(i.freeDimensionOverrides)){if(typeof f!="string")throw new Error(`free dimension override name must be a string: ${f}`);if(typeof p!="number"||!Number.isInteger(p)||p<0)throw new Error(`free dimension override value must be a non-negative integer: ${p}`);let w=is(f,n);t._OrtAddFreeDimensionOverride(r,w,p)!==0&&tr(`Can't set a free dimension override: ${f} - ${p}.`)}return i.extra!==void 0&&Ym(i.extra,"",new WeakSet,(f,p)=>{$d(r,f,p,n)}),[r,n]}catch(s){throw r!==0&&t._OrtReleaseSessionOptions(r)!==0&&tr("Can't release session options."),n.forEach(a=>t._free(a)),s}}}),el,ma,tl,Ug,Xm,Hx,Gx,Aw,mt=Oe(()=>{el=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},ma=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},tl=(e,t)=>{let r=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],n=typeof t=="number"?t:t.reduce((i,s)=>i*s,1);return r>0?Math.ceil(n*r):void 0},Ug=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Xm=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Hx=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",Gx=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",Aw=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),Qx,a4=Oe(()=>{Vx(),Qx=async e=>{if(typeof e=="string"){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let i=t.body.getReader(),s;try{s=new ArrayBuffer(n)}catch(o){if(o instanceof RangeError){let l=Math.ceil(n/65536);s=new WebAssembly.Memory({initial:l,maximum:l}).buffer}else throw o}let a=0;for(;;){let{done:o,value:l}=await i.read();if(o)break;let u=l.byteLength;new Uint8Array(s,a,u).set(l),a+=u}return new Uint8Array(s,0,n)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),E2,T2,I2,N2,Zx,P2,Lt,Ia=Oe(()=>{mt(),E2=["V","I","W","E","F"],T2=(e,t)=>{console.log(`[${E2[e]},${new Date().toISOString()}]${t}`)},Zx=(e,t)=>{I2=e,N2=t},P2=(e,t)=>{let r=Xm(e),n=Xm(I2);r>=n&&T2(r,typeof t=="function"?t():t)},Lt=(...e)=>{N2&&P2(...e)}}),A2,Cc,xe,Jm,o4,l4,u4,_t=Oe(()=>{A2=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Cc=class{static calcShape(e,t,r=!1){let n=e.length,i=t.length;if(n===0)return t;if(i===0)return e;let s=Math.max(e.length,t.length),a=new Array(s);if(r){if(n<2||i<2)return;let o=A2.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(o===void 0)return;[a[s-2],a[s-1]]=o}for(let o=r?3:1;o<=s;o++){let l=n-o<0?1:e[n-o],u=i-o<0?1:t[i-o];if(l!==u&&l>1&&u>1)return;let c=Math.max(l,u);if(l&&u)a[s-o]=Math.max(l,u);else{if(c>1)return;a[s-o]=0}}return a}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(e[r-i]!==1&&e[r-i]!==t[n-i])return!1;return!0}},xe=class Qh{static size(t){return Qh.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,r=4){let n=t.length;if(n===0)return[];let i=new Array(n),s=n-1;for(;s>=0;){if(t[s]%r===0){i[s]=t[s]/r;break}if(r%t[s]!==0)throw new Error("cannot convert shape");i[s]=1,r/=t[s],s--}for(s--;s>=0;s--)i[s]=t[s];return i}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return Qh.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return Qh.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,n){let i=1;for(let s=r;s<n;s++){if(t[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=Number(t[s])}return i}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let n=new Array(r);n[r-1]=1,n[r-2]=t[r-1];for(let i=r-3;i>=0;--i)n[i]=n[i+1]*t[i+1];return n}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(n=>this.normalizeAxis(n,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(n=>t[n]):t.slice().reverse()}static padShape(t,r){let n=t.length;return t.map((i,s)=>i+r[s]+r[s+n])}static areEqual(t,r){return t.length!==r.length?!1:t.every((n,i)=>n===r[i])}},Jm=class Hd{static adjustPoolAttributes(t,r,n,i,s,a){if(!t&&n.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let o=0;o<r.length-2;o++)o>=n.length?n.push(r[o+2]):n[o]=r[o+2];for(let o=0;o<n.length;o++)if(o<i.length){if(i[o]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let o=0;o<n.length;o++)if(o<s.length){if(s[o]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let o=0;o<n.length*2;o++)if(o<a.length){if(a[o]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let o=0;o<n.length;o++){if(n[o]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[o]>=n[o]||a[o+n.length]>=n[o])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,i,s,a,o){if(o){if(s.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<t.length-2;l++)Hd.adjustPadAndReturnShape(t[l+(a?1:2)],r[l],n[l],i[l],s,l,l+t.length-2,o)}}static computePoolOutputShape(t,r,n,i,s,a,o){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let l=[r[0],r[1]];return Hd.computeShapeHelper(t,r,l,n,i,s,a,o),l}static computeConvOutputShape(t,r,n,i,s,a,o){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let l=[t[0],r[0]];return Hd.computeShapeHelper(!1,t,l,n,i,s,a,o),l}static computeShapeHelper(t,r,n,i,s,a,o,l){if(t)for(let u=0;u<r.length-2;u++)n.push(1);else for(let u=0;u<r.length-2;u++)n.push(Hd.adjustPadAndReturnShape(r[u+2],i[u],s[u],a[u],o,u,u+r.length-2,l))}static adjustPadAndReturnShape(t,r,n,i,s,a,o,l){let u=n*(i-1)+1;if(l&&l!=="NOTSET")switch(l){case"VALID":return s[a]=0,s[o]=0,Math.floor((t-u)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(n!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let c=((t+r-1)/r-1)*r+i-t;return s[a]=Math.floor(l==="SAME_LOWER"?(c+1)/2:c/2),s[o]=c-s[a],Math.floor((t+c-i)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+s[a]+s[o]-u)/r+1)}},o4=class{static getShapeOfGemmResult(e,t,r,n,i){if(e.length!==2||r.length!==2)throw new Error("shape need to be of size 2");let s,a,o;t?(s=e[1],a=e[0]):(s=e[0],a=e[1]);let l=-1;if(n?(o=r[0],l=1):(o=r[1],l=0),r[l]!==a)throw new Error("dimension mismatch");if(s<=0||o<=0||a<=0)throw new Error("invalid shape specified");if(i&&!Cc.isValidBroadcast(i,[s,o]))throw new Error("gemm: invalid bias shape for broadcast");return[s,o,a]}},l4=-34028234663852886e22,u4=34028234663852886e22}),Yx,c4=Oe(()=>{mt(),Yx=(e,t)=>new(Ug(t))(e)}),cv,Rw,dv,R2,fv,O2,pv,hv,mv,D2,d4,pY=Oe(()=>{mt(),Ia(),cv=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),Rw=(e,t)=>{if(t==="int32")return e;let r=cv.get(t);if(!r)throw new Error(`WebNN backend does not support data type: ${t}`);let n=r/8;if(e.byteLength%n!==0)throw new Error(`Invalid Uint8Array length - must be a multiple of ${n}.`);let i=e.byteLength/n,s=new(Ug(t))(e.buffer,e.byteOffset,i);switch(t){case"int64":case"uint64":{let a=new Int32Array(i);for(let o=0;o<i;o++){let l=s[o];if(l>2147483647n||l<-2147483648n)throw new Error("Can not convert int64 data to int32 - value out of range.");a[o]=Number(l)}return new Uint8Array(a.buffer)}case"int8":case"uint8":case"uint32":{if(t==="uint32"&&s.some(o=>o>2147483647))throw new Error("Can not convert uint32 data to int32 - value out of range.");let a=Int32Array.from(s,Number);return new Uint8Array(a.buffer)}default:throw new Error(`Unsupported data conversion from ${t} to 'int32'`)}},dv=(e,t)=>{if(t==="int32")return e;if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (int32).");let r=e.byteLength/4,n=new Int32Array(e.buffer,e.byteOffset,r);switch(t){case"int64":{let i=BigInt64Array.from(n,BigInt);return new Uint8Array(i.buffer)}case"uint64":{if(n.some(s=>s<0))throw new Error("Can not convert int32 data to uin64 - negative value found.");let i=BigUint64Array.from(n,BigInt);return new Uint8Array(i.buffer)}case"int8":{if(n.some(s=>s<-128||s>127))throw new Error("Can not convert int32 data to int8 - value out of range.");let i=Int8Array.from(n,Number);return new Uint8Array(i.buffer)}case"uint8":{if(n.some(i=>i<0||i>255))throw new Error("Can not convert int32 data to uint8 - value out of range.");return Uint8Array.from(n,Number)}case"uint32":{if(n.some(s=>s<0))throw new Error("Can not convert int32 data to uint32 - negative value found.");let i=Uint32Array.from(n,Number);return new Uint8Array(i.buffer)}default:throw new Error(`Unsupported data conversion from 'int32' to ${t}`)}},R2=1,fv=()=>R2++,O2=new Map([["int8","int32"],["uint8","int32"],["uint32","int32"],["int64","int32"]]),pv=(e,t)=>{let r=cv.get(e);if(!r)throw new Error(`WebNN backend does not support data type: ${e}`);return t.length>0?Math.ceil(t.reduce((n,i)=>n*i)*r/8):0},hv=class{constructor(e){this.isDataConverted=!1;let{sessionId:t,context:r,tensor:n,dataType:i,shape:s,fallbackDataType:a}=e;this.sessionId=t,this.mlContext=r,this.mlTensor=n,this.dataType=i,this.tensorShape=s,this.fallbackDataType=a}get tensor(){return this.mlTensor}get type(){return this.dataType}get fallbackType(){return this.fallbackDataType}get shape(){return this.tensorShape}get byteLength(){return pv(this.dataType,this.tensorShape)}destroy(){Lt("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e){if(this.fallbackDataType){let t=await this.mlContext.readTensor(this.mlTensor),r=dv(new Uint8Array(t),this.dataType);if(e){(e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).set(r);return}else return r.buffer}else return e?this.mlContext.readTensor(this.mlTensor,e):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,t,r){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===r.length&&this.tensorShape.every((n,i)=>n===r[i])}setIsDataConverted(e){this.isDataConverted=e}},mv=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,r,n){let i=this.tensorManager.getMLContext(e),s=this.tensorManager.getMLOpSupportLimits(e),a;if(!(s!=null&&s.input.dataTypes.includes(t))){if(a=O2.get(t),!a||(s==null?void 0:s.input.dataTypes.includes(a)))throw new Error(`WebNN backend does not support data type: ${t}`);Lt("verbose",()=>`[WebNN] TensorIdTracker.ensureTensor: fallback dataType from ${t} to ${a}`)}if(this.wrapper){if(this.wrapper.canReuseTensor(i,t,r))return this.wrapper.tensor;if(n){if(this.wrapper.byteLength!==pv(t,r))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let o=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,t,r,o,!0,!0,a),n&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper){if(this.wrapper.fallbackType)if(this.wrapper.fallbackType==="int32")t=Rw(e,this.wrapper.type),this.wrapper.setIsDataConverted(!0);else throw new Error(`Unsupported fallback data type: ${this.wrapper.fallbackType}`);if(e.byteLength===this.wrapper.byteLength){this.wrapper.write(t);return}else Lt("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor()}this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){var t,r;if(this.activeUpload){let n=(t=this.wrapper)!=null&&t.isDataConverted?dv(this.activeUpload,(r=this.wrapper)==null?void 0:r.type):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(n):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(n);return}else return n.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read(e):this.wrapper.read()}},D2=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw new Error("MLContext not found for session.");return t}getMLOpSupportLimits(e){return this.backend.getMLOpSupportLimits(e)}reserveTensorId(){let e=fv();return this.tensorTrackersById.set(e,new mv(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,r,n,i){Lt("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${t}, dataType: ${r}, shape: ${n}, copyOld: ${i}}`);let s=this.tensorTrackersById.get(t);if(!s)throw new Error("Tensor not found.");return s.ensureTensor(e,r,n,i)}upload(e,t){let r=this.tensorTrackersById.get(e);if(!r)throw new Error("Tensor not found.");r.upload(t)}async download(e,t){Lt("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${t==null?void 0:t.byteLength}}`);let r=this.tensorTrackersById.get(e);if(!r)throw new Error("Tensor not found.");return r.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter(t=>t.sessionId!==e)}registerTensor(e,t,r,n){let i=this.getMLContext(e),s=fv(),a=new hv({sessionId:e,context:i,tensor:t,dataType:r,shape:n});return this.tensorTrackersById.set(s,new mv(this,a)),this.externalTensors.add(a),s}async getCachedTensor(e,t,r,n,i,s,a){let o=this.getMLContext(e);for(let[u,c]of this.freeTensors.entries())if(c.canReuseTensor(o,t,r)){Lt("verbose",()=>`[WebNN] Reusing tensor {dataType: ${t}, ${a?`fallbackDataType: ${a},`:""} shape: ${r}`);let f=this.freeTensors.splice(u,1)[0];return f.sessionId=e,f}Lt("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${t}, ${a?`fallbackDataType: ${a},`:""} shape: ${r}}`);let l=await o.createTensor({dataType:a??t,shape:r,dimensions:r,usage:n,writable:i,readable:s});return new hv({sessionId:e,context:o,tensor:l,dataType:t,shape:r,fallbackDataType:a})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},d4=(...e)=>new D2(...e)}),Sd,j2,f4,hY=Oe(()=>{mt(),Ll(),c4(),pY(),Ia(),Sd=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),j2=(e,t)=>{if(e===t)return!0;if(e===void 0||t===void 0)return!1;let r=Object.keys(e).sort(),n=Object.keys(t).sort();return r.length===n.length&&r.every((i,s)=>i===n[s]&&e[i]===t[i])},f4=class{constructor(e){this.tensorManager=d4(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.sessionGraphOutputs=new Map,this.temporaryGraphInputs=[],this.temporaryGraphOutputs=[],this.temporarySessionTensorIds=new Map,this.mlOpSupportLimitsBySessionId=new Map,Zx(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){Lt("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){Lt("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let t=this.temporarySessionTensorIds.get(e);if(t){for(let r of t)Lt("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${r}}`),this.tensorManager.releaseTensorId(r);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let r=this.mlContextCache.findIndex(n=>n.gpuDevice===e);if(r!==-1)return this.mlContextCache[r].mlContext;{let n=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:n}),n}}else if(e===void 0){let r=this.mlContextCache.findIndex(n=>n.options===void 0&&n.gpuDevice===void 0);if(r!==-1)return this.mlContextCache[r].mlContext;{let n=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:n}),n}}let t=this.mlContextCache.findIndex(r=>j2(r.options,e));if(t!==-1)return this.mlContextCache[t].mlContext;{let r=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:r}),r}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let r=this.sessionIdsByMLContext.get(t);r||(r=new Set,this.sessionIdsByMLContext.set(t,r)),r.add(e),this.mlOpSupportLimitsBySessionId.has(e)||this.mlOpSupportLimitsBySessionId.set(e,t.opSupportLimits()),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[]),this.temporaryGraphOutputs.length>0&&(this.sessionGraphOutputs.set(e,this.temporaryGraphOutputs),this.temporaryGraphOutputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e),this.sessionGraphOutputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e),this.mlOpSupportLimitsBySessionId.delete(e);let r=this.sessionIdsByMLContext.get(t);if(r.delete(e),r.size===0){this.sessionIdsByMLContext.delete(t);let n=this.mlContextCache.findIndex(i=>i.mlContext===t);n!==-1&&this.mlContextCache.splice(n,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}getMLOpSupportLimits(e){return this.mlOpSupportLimitsBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){Lt("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,r,n,i){let s=Sd.get(r);if(!s)throw new Error(`Unsupported ONNX data type: ${r}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,t,s,n,i)}async createTemporaryTensor(e,t,r){Lt("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${t}, shape: ${r}}`);let n=Sd.get(t);if(!n)throw new Error(`Unsupported ONNX data type: ${t}`);let i=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,i,n,r,!1);let s=this.temporarySessionTensorIds.get(e);return s?s.push(i):this.temporarySessionTensorIds.set(e,[i]),i}uploadTensor(e,t){if(!gr().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");Lt("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${t.byteLength}}`),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let r=await this.tensorManager.download(e);return Yx(r,t)}}registerMLTensor(e,t,r,n){let i=Sd.get(r);if(!i)throw new Error(`Unsupported ONNX data type: ${r}`);let s=this.tensorManager.registerTensor(e,t,i,n);return Lt("verbose",()=>`[WebNN] registerMLTensor {tensor: ${t}, dataType: ${i}, dimensions: ${n}} -> {tensorId: ${s}}`),s}registerMLConstant(e,t,r,n,i,s,a=!1){if(!s)throw new Error("External mounted files are not available.");let o=e;e.startsWith("./")&&(o=e.substring(2));let l=s.get(o);if(!l)throw new Error(`File with name ${o} not found in preloaded files.`);if(t+r>l.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let u=l.slice(t,t+r).buffer,c;switch(i.dataType){case"float32":c=new Float32Array(u);break;case"float16":c=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(u):new Uint16Array(u);break;case"int32":c=new Int32Array(u);break;case"uint32":c=new Uint32Array(u);break;case"int64":if(a){let f=Rw(new Uint8Array(u),"int64");c=new Int32Array(f.buffer),i.dataType="int32"}else c=new BigInt64Array(u);break;case"uint64":c=new BigUint64Array(u);break;case"int8":c=new Int8Array(u);break;case"int4":case"uint4":case"uint8":c=new Uint8Array(u);break;default:throw new Error(`Unsupported data type: ${i.dataType} in creating WebNN Constant from external data.`)}return Lt("verbose",()=>`[WebNN] registerMLConstant {dataType: ${i.dataType}, shape: ${i.shape}}} ${a?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),n.constant(i,c)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}registerGraphOutput(e){this.temporaryGraphOutputs.push(e)}isGraphInput(e,t){let r=this.sessionGraphInputs.get(e);return r?r.includes(t):!1}isGraphOutput(e,t){let r=this.sessionGraphOutputs.get(e);return r?r.includes(t):!1}isGraphInputOutputTypeSupported(e,t,r=!0){let n=Sd.get(el(t)),i=this.mlOpSupportLimitsBySessionId.get(e);return typeof n>"u"?!1:r?!!(i!=null&&i.input.dataTypes.includes(n)):!!(i!=null&&i.output.dataTypes.includes(n))}flush(){}}}),Xx=Oe(()=>{}),gv,yh,vh,M2,z2,yv,Ow,F2,p4,mY=Oe(()=>{Ia(),Xx(),gv=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),yh=[],vh=e=>Math.ceil(Number(e)/16)*16,M2=e=>{for(let t=0;t<yh.length;t++){let r=yh[t];if(e<=r)return r}return Math.ceil(e/16)*16},z2=1,yv=()=>z2++,Ow=async(e,t,r,n)=>{let i=vh(r),s=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=e.getCommandEncoder();e.endComputePass(),a.copyBufferToBuffer(t,0,s,0,i),e.flush(),await s.mapAsync(GPUMapMode.READ);let o=s.getMappedRange();if(n){let l=n();return l.set(new Uint8Array(o,0,r)),l}else return new Uint8Array(o.slice(0,r))}finally{s.destroy()}},F2=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[t]of gv)yh.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let r=t.buffer,n=t.byteOffset,i=t.byteLength,s=vh(i),a=this.storageCache.get(e);if(!a)throw new Error("gpu data for uploading does not exist");if(Number(a.originalSize)!==i)throw new Error(`inconsistent data size. gpu data size=${a.originalSize}, data size=${i}`);let o=this.backend.device.createBuffer({mappedAtCreation:!0,size:s,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),l=o.getMappedRange();new Uint8Array(l).set(new Uint8Array(r,n,i)),o.unmap();let u=this.backend.device.createCommandEncoder();u.copyBufferToBuffer(o,0,a.gpuData.buffer,0,s),this.backend.device.queue.submit([u.finish()]),o.destroy(),Lt("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let i=vh(r.originalSize),s=this.backend.getCommandEncoder();this.backend.endComputePass(),s.copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,i)}registerExternalBuffer(e,t,r){let n;if(r){if(n=r[0],e===r[1])return Lt("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, buffer is the same, skip.`),n;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else n=yv();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:e},originalSize:t}),Lt("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, registered.`),n}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),Lt("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let r=M2(e),n,i=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,s=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||s){let o=(i?this.freeBuffers:this.freeUniformBuffers).get(r);o?o.length>0?n=o.pop():n=this.backend.device.createBuffer({size:r,usage:t}):n=this.backend.device.createBuffer({size:r,usage:t})}else n=this.backend.device.createBuffer({size:r,usage:t});let a={id:yv(),type:0,buffer:n};return this.storageCache.set(a.id,{gpuData:a,originalSize:Number(e)}),Lt("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${a.id}`),a}get(e){var t;return(t=this.storageCache.get(e))==null?void 0:t.gpuData}release(e){let t=typeof e=="bigint"?Number(e):e,r=this.storageCache.get(t);if(!r){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return Lt("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(e,t){let r=this.storageCache.get(Number(e));if(!r)throw new Error("data does not exist");await Ow(this.backend,r.gpuData.buffer,r.originalSize,t)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let t=gv.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let r=this.freeBuffers.get(e.size)||[];t===void 0||r.length>=t?e.destroy():r.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let r=this.freeUniformBuffers.get(e.size)||[];t===void 0||r.length>=t?e.destroy():r.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach(r=>{r.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(Lt("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(r=>{r.gpuData.buffer.destroy()}),this.storageCache=new Map)}},p4=(...e)=>new F2(...e)}),L2,Jt,Rr=Oe(()=>{L2=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},Jt=e=>new L2(e)}),kc,wh,en,Sn,ct,kr,Dw,Du,ko,ut,Cd,Ce,at,h4,Jx,B2,m4,St=Oe(()=>{mt(),_t(),kc=64,wh=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},en=(e,t=1)=>{let r=wh(e,t);return typeof r=="string"?r:r[0]},Sn=(e,t=1)=>{let r=wh(e,t);return typeof r=="string"?r:r[1]},ct=(...e)=>{let t=[];return e.forEach(r=>{r.length!==0&&t.push({type:12,data:r},{type:12,data:xe.computeStrides(r)})}),t},kr=e=>e%4===0?4:e%2===0?2:1,Dw=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,Du=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}<f32>(${r})`,ko=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,ut=(e,t,r,n)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?n==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:n==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Cd=(e,t,r,n,i)=>{let s=typeof r=="number",a=s?r:r.length,o=[...new Array(a).keys()],l=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,u=wh(t,i),c=typeof u=="string"?u:u[1],f=typeof u=="string"?u:u[0],p={indices:l,value:c,storage:f,tensor:t},w=B=>typeof B=="string"?B:`${B}u`,x={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},v=s?"uniforms.":"",C=`${v}${e}_shape`,b=`${v}${e}_strides`,g="";for(let B=0;B<a-1;B++)g+=`
    let dim${B} = current / ${ut(b,B,a)};
    let rest${B} = current % ${ut(b,B,a)};
    indices[${B}] = dim${B};
    current = rest${B};
    `;g+=`indices[${a-1}] = current;`;let S=a<2?"":`
  fn o2i_${e}(offset: u32) -> ${p.indices} {
    var indices: ${p.indices};
    var current = offset;
    ${g}
    return indices;
  }`,E=B=>(x.offsetToIndices=!0,a<2?B:`o2i_${e}(${B})`),A=[];if(a>=2)for(let B=a-1;B>=0;B--)A.push(`${ut(b,B,a)} * (indices[${B}])`);let M=a<2?"":`
  fn i2o_${e}(indices: ${p.indices}) -> u32 {
    return ${A.join("+")};
  }`,D=B=>(x.indicesToOffset=!0,a<2?B:`i2o_${e}(${B})`),I=(...B)=>a===0?"0u":`${p.indices}(${B.map(w).join(",")})`,U=(B,ee)=>a<2?`${B}`:`${ut(B,ee,a)}`,Z=(B,ee,me)=>a<2?`${B}=${me};`:`${ut(B,ee,a)}=${me};`,ue={},X=(B,ee)=>{x.broadcastedIndicesToOffset=!0;let me=`${ee.name}broadcastedIndicesTo${e}Offset`;if(me in ue)return`${me}(${B})`;let K=[];for(let Ae=a-1;Ae>=0;Ae--){let Ze=ee.indicesGet("outputIndices",Ae+ee.rank-a);K.push(`${U(b,Ae)} * (${Ze} % ${U(C,Ae)})`)}return ue[me]=`fn ${me}(outputIndices: ${ee.type.indices}) -> u32 {
             return ${K.length>0?K.join("+"):"0u"};
           }`,`${me}(${B})`},ie=(B,ee)=>(()=>{if(p.storage===p.value)return`${e}[${B}]=${ee};`;if(p.storage==="vec2<u32>"&&p.value==="i32")return`${e}[${B}]=vec2<u32>(u32(${ee}), select(0u, 0xFFFFFFFFu, ${ee} < 0));`;if(p.storage==="vec2<u32>"&&p.value==="u32")return`${e}[${B}]=vec2<u32>(u32(${ee}), 0u);`;if(p.storage==="u32"&&p.value==="vec4<bool>")return`${e}[${B}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${ee}));`;throw new Error(`not supported combination of storage type ${p.storage} and value type ${p.value} yet`)})(),j=B=>(()=>{if(p.storage===p.value)return`${e}[${B}]`;if(p.storage==="vec2<u32>"&&p.value==="i32")return`i32(${e}[${B}].x)`;if(p.storage==="vec2<u32>"&&p.value==="u32")return`u32(${e}[${B}].x)`;if(p.storage==="u32"&&p.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${B}] & 0xFFu), bool(${e}[${B}] & 0xFF00u), bool(${e}[${B}] & 0xFF0000u), bool(${e}[${B}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${p.storage} and value type ${p.value} yet`)})(),le=a<2?"":`
  fn get_${e}ByIndices(indices: ${p.indices}) -> ${c} {
    return ${j(`i2o_${e}(indices)`)};
  }`,ne=a<2?"":(()=>{let B=o.map(me=>`d${me}: u32`).join(", "),ee=o.map(me=>`d${me}`).join(", ");return`
  fn get_${e}(${B}) -> ${c} {
    return get_${e}ByIndices(${I(ee)});
  }`})(),ce=(...B)=>{if(B.length!==a)throw new Error(`indices length must be ${a}`);let ee=B.map(w).join(",");return a===0?j("0u"):a===1?j(ee[0]):(x.get=!0,x.getByIndices=!0,x.indicesToOffset=!0,`get_${e}(${ee})`)},W=B=>a<2?j(B):(x.getByIndices=!0,x.indicesToOffset=!0,`get_${e}ByIndices(${B})`),F=a<2?"":`
  fn set_${e}ByIndices(indices: ${p.indices}, value: ${c}) {
    ${ie(`i2o_${e}(indices)`,"value")}
  }`,H=a<2?"":(()=>{let B=o.map(me=>`d${me}: u32`).join(", "),ee=o.map(me=>`d${me}`).join(", ");return`
  fn set_${e}(${B}, value: ${c}) {
    set_${e}ByIndices(${I(ee)}, value);
  }`})();return{impl:()=>{let B=[],ee=!1;return x.offsetToIndices&&(B.push(S),ee=!0),x.indicesToOffset&&(B.push(M),ee=!0),x.broadcastedIndicesToOffset&&(Object.values(ue).forEach(me=>B.push(me)),ee=!0),x.set&&(B.push(H),ee=!0),x.setByIndices&&(B.push(F),ee=!0),x.get&&(B.push(ne),ee=!0),x.getByIndices&&(B.push(le),ee=!0),!s&&ee&&B.unshift(`const ${C} = ${p.indices}(${r.join(",")});`,`const ${b} = ${p.indices}(${xe.computeStrides(r).join(",")});`),B.join(`
`)},type:p,offsetToIndices:E,indicesToOffset:D,broadcastedIndicesToOffset:X,indices:I,indicesGet:U,indicesSet:Z,set:(...B)=>{if(B.length!==a+1)throw new Error(`indices length must be ${a}`);let ee=B[a];if(typeof ee!="string")throw new Error("value must be string");let me=B.slice(0,a).map(w).join(",");return a===0?ie("0u",ee):a===1?ie(me[0],ee):(x.set=!0,x.setByIndices=!0,x.indicesToOffset=!0,`set_${e}(${me}, ${ee})`)},setByOffset:ie,setByIndices:(B,ee)=>a<2?ie(B,ee):(x.setByIndices=!0,x.indicesToOffset=!0,`set_${e}ByIndices(${B}, ${ee});`),get:ce,getByOffset:j,getByIndices:W,usage:n,name:e,strides:b,shape:C,rank:a}},Ce=(e,t,r,n=1)=>Cd(e,t,r,"input",n),at=(e,t,r,n=1)=>Cd(e,t,r,"output",n),h4=(e,t,r)=>Cd(e,t,r,"atomicOutput",1),Jx=(e,t,r,n=1)=>Cd(e,t,r,"internal",n),B2=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=kc){let t=typeof e=="number"?e:e[0],r=typeof e=="number"?1:e[1],n=typeof e=="number"?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||r>this.limits.maxComputeWorkgroupSizeY||n>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${t}, ${r}, ${n}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(t*r*n>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${t}, ${r}, ${n}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let i=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,s=i?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,a=i?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${t*r*n}u + local_idx;`;return`@compute @workgroup_size(${t}, ${r}, ${n})
  fn main(${s}) {
    ${a}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let r=e.usage==="input"?"read":"read_write",n=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${t}) var<storage, ${r}> ${e.name}: array<${n}>;`}declareVariables(...e){return e.map(t=>this.declareVariable(t,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(t=>this.registerInternalVariable(t)),this}registerUniform(e,t,r=1){return this.uniforms.push({name:e,type:t,length:r}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:t,type:r,length:n}of this.uniforms)if(n&&n>4)r==="f16"?e.push(`@align(16) ${t}:array<mat2x4<${r}>, ${Math.ceil(n/8)}>`):e.push(`${t}:array<vec4<${r}>, ${Math.ceil(n/4)}>`);else{let i=n==null||n===1?r:`vec${n}<${r}>`;e.push(`${t}:${i}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=t=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(t)];return this.uniforms.map(t=>[e(t.type),t.length??1])}},m4=(e,t)=>new B2(e,t)}),U2,vv,V2,q2,W2,K2,mi,g4,y4,Ro=Oe(()=>{mt(),_t(),Rr(),St(),U2=(e,t)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(t.length!==0&&t.length!==e[0].dims.length)throw new Error(`perm size ${t.length} does not match input rank ${e[0].dims.length}`)},vv=(e,t)=>t.length!==0?t:[...new Array(e).keys()].reverse(),V2=(e,t)=>xe.sortBasedOnPerm(e,vv(e.length,t)),q2=(e,t,r,n)=>{let i=`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {
    var a: ${r.type.indices};`;for(let s=0;s<t;++s)i+=`a[${e[s]}]=i[${s}];`;return i+="return a;}"},W2=(e,t)=>{let r=[],n=[];for(let i=0;i<e.length;++i)e[i]!==1&&r.push(e[i]),e[t[i]]!==1&&n.push(t[i]);return{newShape:r,newPerm:n}},K2=(e,t)=>{let r=0;for(let n=0;n<e.length;++n)if(t[e[n]]!==1){if(e[n]<r)return!1;r=e[n]}return!0},mi=(e,t)=>{let r=e.dataType,n=e.dims.length,i=vv(n,t),s=V2(e.dims,i),a=e.dims,o=s,l=n<2||K2(i,e.dims),u;if(l)return u=x=>{let v=Ce("input",r,a,4),C=at("output",r,o,4);return`
  ${x.registerUniform("output_size","u32").declareVariables(v,C)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let x=xe.size(s);return{outputs:[{dims:s,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(x/64/4)},programUniforms:[{type:12,data:Math.ceil(x/4)}]}},getShaderSource:u};let{newShape:c,newPerm:f}=W2(e.dims,i),p=xe.areEqual(f,[2,3,1]),w=xe.areEqual(f,[3,1,2]);if(c.length===2||p||w){a=p?[c[0],c[1]*c[2]]:w?[c[0]*c[1],c[2]]:c,o=[a[1],a[0]];let x=16;return u=v=>{let C=Ce("a",r,a.length),b=at("output",r,o.length);return`
  ${v.registerUniform("output_size","u32").declareVariables(C,b)}
  var<workgroup> tile : array<array<${b.type.value}, ${x+1}>, ${x}>;
  ${v.mainStart([x,x,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${x} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${x}u + local_id.x;
    let input_row = workgroup_id_x * ${x}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${C.getByIndices(`${C.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${x}u + local_id.x;
    let output_row = workgroup_id_y * ${x}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${b.setByIndices(`${b.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let v=xe.size(s);return{outputs:[{dims:s,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(o[1]/x),y:Math.ceil(o[0]/x)},programUniforms:[{type:12,data:v},...ct(a,o)]}},getShaderSource:u}}return u=x=>{let v=Ce("a",r,a.length),C=at("output",r,o.length);return`
  ${x.registerUniform("output_size","u32").declareVariables(v,C)}

  ${q2(i,n,v,C)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${C.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${C.setByOffset("global_idx",v.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:()=>{let x=xe.size(s);return{outputs:[{dims:s,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:[{type:12,data:x},...ct(a,o)]}},getShaderSource:u}},g4=(e,t)=>{U2(e.inputs,t.perm),e.compute(mi(e.inputs[0],t.perm))},y4=e=>Jt({perm:e.perm})}),H2,G2,Q2,Z2,Y2,X2,J2,eS,tS,rS,Hi,v4,w4,b4,x4,_4,$4,S4,C4,k4,E4,gY=Oe(()=>{mt(),_t(),St(),e1(),Ro(),H2={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},G2={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Q2={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Z2={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Y2=(e,t)=>{let r=[];for(let n=t-e;n<t;++n)r.push(n);return r},X2=(e,t)=>{let r=[],n=e.length;for(let s=0;s<n;s++)t.indexOf(s)===-1&&r.push(e[s]);let i=t.map(s=>e[s]);return[r,i]},J2=(e,t)=>{let r=e.length+t.length,n=[],i=0;for(let s=0;s<r;s++)t.indexOf(s)===-1?n.push(e[i++]):n.push(1);return n},eS=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},tS=(e,t)=>{let r=[];if(!eS(e,t)){for(let n=0;n<t;++n)e.indexOf(n)===-1&&r.push(n);e.forEach(n=>r.push(n))}return r},rS=(e,t,r,n,i,s,a)=>{let o=r[0].dims,l=xe.size(s),u=xe.size(a),c=Ce("_A",r[0].dataType,o),f=at("output",i,s),p=64;l===1&&(p=256);let w=`
          var<workgroup> aBestValues : array<f32, ${p}>;
       `,x=v=>`
        ${v.registerUniform("reduceSize","u32").declareVariables(c,f)}
        ${w}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${v.mainStart(p)}

          let outputIndex = global_idx / ${p};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${Q2[n]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${p}) {
           let candidate = f32(${c.getByOffset("offset + k")});
           bestValue = ${H2[n]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${p}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${G2[n]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${f.setByOffset("outputIndex",`${n==="mean"?`${f.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${f.type.storage}(${Z2[n]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${t};${p}`,inputDependencies:["type"]},getShaderSource:x,getRunData:()=>({outputs:[{dims:s,dataType:i}],dispatchGroup:{x:l},programUniforms:[{type:12,data:u}]})}},Hi=(e,t,r,n)=>{let i=e.inputs.length===1?r:jw(e.inputs,r),s=i.axes;s.length===0&&!i.noopWithEmptyAxes&&(s=e.inputs[0].dims.map((w,x)=>x));let a=xe.normalizeAxes(s,e.inputs[0].dims.length),o=a,l=e.inputs[0],u=tS(o,e.inputs[0].dims.length);u.length>0&&(l=e.compute(mi(e.inputs[0],u),{inputs:[0],outputs:[-1]})[0],o=Y2(o.length,l.dims.length));let[c,f]=X2(l.dims,o),p=c;i.keepDims&&(p=J2(c,a)),e.compute(rS(t,i.cacheKey,[l],n,e.inputs[0].dataType,p,f),{inputs:[l]})},v4=(e,t)=>{Hi(e,"ReduceMeanShared",t,"mean")},w4=(e,t)=>{Hi(e,"ReduceL1Shared",t,"l1")},b4=(e,t)=>{Hi(e,"ReduceL2Shared",t,"l2")},x4=(e,t)=>{Hi(e,"ReduceLogSumExpShared",t,"logSumExp")},_4=(e,t)=>{Hi(e,"ReduceMaxShared",t,"max")},$4=(e,t)=>{Hi(e,"ReduceMinShared",t,"min")},S4=(e,t)=>{Hi(e,"ReduceProdShared",t,"prod")},C4=(e,t)=>{Hi(e,"ReduceSumShared",t,"sum")},k4=(e,t)=>{Hi(e,"ReduceSumSquareShared",t,"sumSquare")},E4=(e,t)=>{Hi(e,"ReduceLogSumShared",t,"logSum")}}),Gi,nS,eg,jw,Qi,iS,sS,aS,oS,lS,uS,cS,dS,fS,pS,Zi,T4,I4,N4,P4,A4,R4,O4,D4,j4,M4,e1=Oe(()=>{mt(),_t(),Rr(),St(),gY(),Gi=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},nS=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],eg=(e,t,r,n,i,s,a=!1,o=!1)=>{let l=[],u=r[0].dims,c=u.length,f=xe.normalizeAxes(i,c),p=!o&&f.length===0;u.forEach((v,C)=>{p||f.indexOf(C)>=0?a&&l.push(1):l.push(v)});let w=l.length,x=xe.size(l);return{name:e,shaderCache:t,getShaderSource:v=>{let C=[],b=Ce("_A",r[0].dataType,c),g=at("output",s,w),S=n(b,g,f),E=S[2];for(let A=0,M=0;A<c;A++)p||f.indexOf(A)>=0?(a&&M++,E=`for(var j${A}: u32 = 0; j${A} < ${u[A]}; j${A}++) {
                  ${S[2].includes("last_index")?`let last_index = j${A};`:""}
                  ${b.indicesSet("input_indices",A,`j${A}`)}
                  ${E}
                }`):(C.push(`${b.indicesSet("input_indices",A,g.indicesGet("output_indices",M))};`),M++);return`

        ${v.registerUniform("output_size","u32").declareVariables(b,g)}

        ${v.mainStart()}
          ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${b.type.indices};
          let output_indices = ${g.offsetToIndices("global_idx")};

          ${C.join(`
`)}
          ${S[0]}       // init ops for reduce max/min
          ${S[1]}
          ${E}
          ${S[3]}
          ${S.length===4?g.setByOffset("global_idx","value"):S.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:l,dataType:s}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:[{type:12,data:x},...ct(u,l)]})}},jw=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),Jt({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},Qi=(e,t,r,n)=>{let i=e.inputs,s=i.length===1?r:jw(i,r);e.compute(eg(t,{hint:s.cacheKey,inputDependencies:["rank"]},[i[0]],s.noopWithEmptyAxes&&s.axes.length===0?nS:n,s.axes,i[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},iS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceLogSum",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${r.getByIndices("input_indices")};`,"value = log(value);"])},sS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceL1",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${r.getByIndices("input_indices")});`,""])},aS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceL2",t,(r,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${r.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},oS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceLogSumExp",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${r.getByIndices("input_indices")});`,"value = log(value);"])},lS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceMax",t,(r,n,i)=>{let s=[];for(let a=0;a<r.rank;a++)(i.indexOf(a)>=0||i.length===0)&&s.push(r.indicesSet("input_indices",a,0));return[`${s.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};`,`value = max(value, ${r.getByIndices("input_indices")});`,""]})},uS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceMean",t,(r,n,i)=>{let s=1;for(let a=0;a<r.rank;a++)(i.indexOf(a)>=0||i.length===0)&&(s*=e.inputs[0].dims[a]);return["var sum = f32(0);","",`sum += f32(${r.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${s});`]})},cS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceMin",t,(r,n,i)=>{let s=[];for(let a=0;a<r.rank;a++)(i.indexOf(a)>=0||i.length===0)&&s.push(`input_indices[${a}] = 0;`);return[`${s.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};`,`value = min(value, ${r.getByIndices("input_indices")});`,""]})},dS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceProd",t,(r,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${r.getByIndices("input_indices")};`,""])},fS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceSum",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${r.getByIndices("input_indices")};`,""])},pS=(e,t)=>{Gi(e.inputs),Qi(e,"ReduceSumSquare",t,(r,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${r.getByIndices("input_indices")}; value += t * t;`,""])},Zi=(e,t,r)=>{if(t.length===0)return r;let n=1,i=1;for(let s=0;s<t.length;s++)t.indexOf(s)===-1?n*=e[s]:i*=e[s];return i<32&&n>1024},T4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?uS(e,t):v4(e,t)},I4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?sS(e,t):w4(e,t)},N4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?aS(e,t):b4(e,t)},P4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?oS(e,t):x4(e,t)},A4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?lS(e,t):_4(e,t)},R4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?cS(e,t):$4(e,t)},O4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?dS(e,t):S4(e,t)},D4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?fS(e,t):C4(e,t)},j4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?pS(e,t):k4(e,t)},M4=(e,t)=>{Zi(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?iS(e,t):E4(e,t)}}),wv,z4,F4,Mw,yY=Oe(()=>{mt(),Rr(),e1(),wv=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},z4=(e,t)=>{wv(e.inputs);let r=(n,i,s)=>{let a=[];for(let o=0;o<n.rank;o++)(s.indexOf(o)>=0||s.length===0)&&a.push(`input_indices[${o}] = 0;`);return[`${a.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${n.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {
         value = ${n.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(eg("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},F4=(e,t)=>{wv(e.inputs);let r=(n,i,s)=>{let a=[];for(let o=0;o<n.rank;o++)(s.indexOf(o)>=0||s.length===0)&&a.push(`input_indices[${o}] = 0;`);return[`${a.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${n.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {
         value = ${n.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(eg("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Mw=e=>Jt(e)}),hS,bh,mS,gS,yS,Zf,vS,L4,t1=Oe(()=>{mt(),_t(),Xx(),St(),hS=(e,t)=>{let r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5];if(a&&o)throw new Error("Attention cannot have both past and attention_bias");if(r.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let l=r.dims[0],u=r.dims[1],c=r.dims[2];if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(n.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(n.dims[0]!==c)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==n.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let f=i.dims[0]/3,p=f,w=p;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let S of t.qkvHiddenSizes)if(S%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");f=t.qkvHiddenSizes[0],p=t.qkvHiddenSizes[1],w=t.qkvHiddenSizes[2]}let x=u;if(f!==p)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==f+p+w)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let v=0;if(a){if(p!==w)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(a.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(a.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==l)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==p/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(v=a.dims[3])}let C=x+v,b=-1,g=0;if(s)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(o){if(o.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(o.dims[0]!==l||o.dims[1]!==t.numHeads||o.dims[2]!==u||o.dims[3]!==C)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:l,sequenceLength:u,pastSequenceLength:v,kvSequenceLength:x,totalSequenceLength:C,maxSequenceLength:b,inputHiddenSize:c,hiddenSize:f,vHiddenSize:w,headSize:Math.floor(f/t.numHeads),vHeadSize:Math.floor(w/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:g,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},bh=(e,t,r)=>t&&e?`
      let total_sequence_length_input = u32(${t.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e==null?void 0:e.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${r?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,mS=(e,t,r,n,i,s,a,o)=>{let l=kr(a?1:s),u=64,c=s/l;c<u&&(u=32);let f=Math.ceil(s/l/u),p=[{type:12,data:t},{type:12,data:r},{type:12,data:n},{type:12,data:i},{type:12,data:c},{type:12,data:f}],w=en(e.dataType,l),x=Sn(1,l),v=["type"];a&&v.push("type"),o&&v.push("type");let C=b=>{let g=at("x",e.dataType,e.dims,l),S=[g],E=a?Ce("seq_lens",a.dataType,a.dims):void 0;E&&S.push(E);let A=o?Ce("total_sequence_length_input",o.dataType,o.dims):void 0;A&&S.push(A);let M=Sn(e.dataType),D=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${u}>;
  var<workgroup> thread_sum: array<f32, ${u}>;
  ${b.registerUniforms(D).declareVariables(...S)}
  ${b.mainStart([u,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${bh(E,A,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${u}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${a?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${x}(-3.4028234663852886e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${x}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(l){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.4028234663852886e+38f);
    for (var i = 0u; i < ${u}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${x}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${x}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(l){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${u}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${g.type.value}(${M}(1.0) / ${M}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${x}(x[offset + i]);
        x[offset + i] = ${g.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${a?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${g.type.value}(${M}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${u};${w};${l}`,inputDependencies:v},getShaderSource:C,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:i,z:t*r},programUniforms:p})}},gS=(e,t,r,n,i,s,a,o,l)=>{let u=a+s.kvSequenceLength,c=[s.batchSize,s.numHeads,s.sequenceLength,u],f=e>1&&n,p=s.kvNumHeads?s.kvNumHeads:s.numHeads,w=f?[s.batchSize,p,u,s.headSize]:void 0,x=s.nReps?s.nReps:1,v=s.scale===0?1/Math.sqrt(s.headSize):s.scale,C=kr(s.headSize),b=s.headSize/C,g=12,S={x:Math.ceil(u/g),y:Math.ceil(s.sequenceLength/g),z:s.batchSize*s.numHeads},E=[{type:12,data:s.sequenceLength},{type:12,data:b},{type:12,data:u},{type:12,data:s.numHeads},{type:12,data:s.headSize},{type:1,data:v},{type:12,data:a},{type:12,data:s.kvSequenceLength},{type:12,data:x}],A=f&&n&&xe.size(n.dims)>0,M=["type","type"];A&&M.push("type"),i&&M.push("type"),o&&M.push("type"),l&&M.push("type");let D=[{dims:c,dataType:t.dataType,gpuDataType:0}];f&&D.push({dims:w,dataType:t.dataType,gpuDataType:0});let I=U=>{let Z=Ce("q",t.dataType,t.dims,C),ue=Ce("key",r.dataType,r.dims,C),X=[Z,ue];if(A){let F=Ce("past_key",n.dataType,n.dims,C);X.push(F)}i&&X.push(Ce("attention_bias",i.dataType,i.dims));let ie=o?Ce("seq_lens",o.dataType,o.dims):void 0;ie&&X.push(ie);let j=l?Ce("total_sequence_length_input",l.dataType,l.dims):void 0;j&&X.push(j);let le=at("output",t.dataType,c),ne=[le];f&&ne.push(at("present_key",t.dataType,w,C));let ce=Sn(1,C),W=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${g}u;

  var<workgroup> tileQ: array<${Z.type.storage}, ${g*g}>;
  var<workgroup> tileK: array<${Z.type.storage}, ${g*g}>;
  ${U.registerUniforms(W).declareVariables(...X,...ne)}
  ${U.mainStart([g,g,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${x===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${x===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${bh(ie,j,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${A&&f?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${f?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${ce}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${A&&f?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${f?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${ce}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(C){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${C}`)}})()};
        output[outputIdx] = ${le.type.value} (sum * uniforms.alpha) + ${i?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${C};${i!==void 0};${n!==void 0};${e}`,inputDependencies:M},getRunData:()=>({outputs:D,dispatchGroup:S,programUniforms:E}),getShaderSource:I}},yS=(e,t,r,n,i,s,a=void 0,o=void 0)=>{let l=s+i.kvSequenceLength,u=i.nReps?i.nReps:1,c=i.vHiddenSize*u,f=e>1&&n,p=i.kvNumHeads?i.kvNumHeads:i.numHeads,w=f?[i.batchSize,p,l,i.headSize]:void 0,x=[i.batchSize,i.sequenceLength,c],v=12,C={x:Math.ceil(i.vHeadSize/v),y:Math.ceil(i.sequenceLength/v),z:i.batchSize*i.numHeads},b=[{type:12,data:i.sequenceLength},{type:12,data:l},{type:12,data:i.vHeadSize},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:12,data:c},{type:12,data:s},{type:12,data:i.kvSequenceLength},{type:12,data:u}],g=f&&n&&xe.size(n.dims)>0,S=["type","type"];g&&S.push("type"),a&&S.push("type"),o&&S.push("type");let E=[{dims:x,dataType:t.dataType,gpuDataType:0}];f&&E.push({dims:w,dataType:t.dataType,gpuDataType:0});let A=M=>{let D=Ce("probs",t.dataType,t.dims),I=Ce("v",r.dataType,r.dims),U=[D,I];g&&U.push(Ce("past_value",n.dataType,n.dims));let Z=a?Ce("seq_lens",a.dataType,a.dims):void 0;a&&U.push(Z);let ue=o?Ce("total_sequence_length_input",o.dataType,o.dims):void 0;o&&U.push(ue);let X=[at("output",t.dataType,x)];f&&X.push(at("present_value",t.dataType,w));let ie=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${v}u;
  var<workgroup> tileQ: array<${D.type.value}, ${v*v}>;
  var<workgroup> tileV: array<${D.type.value}, ${v*v}>;
  ${M.registerUniforms(ie).declareVariables(...U,...X)}
  ${M.mainStart([v,v,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${u===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${u===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${bh(Z,ue,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${g&&f?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${f?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${D.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${g&&f?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${f?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${n!==void 0};${e}`,inputDependencies:S},getRunData:()=>({outputs:E,dispatchGroup:C,programUniforms:b}),getShaderSource:A}},Zf=(e,t,r,n,i,s,a,o,l,u,c=void 0,f=void 0)=>{let p=Math.min(e.outputCount,1+(a?1:0)+(o?1:0)),w=p>1?u.pastSequenceLength:0,x=w+u.kvSequenceLength,v=l&&xe.size(l.dims)>0?l:void 0,C=[t,r];p>1&&a&&xe.size(a.dims)>0&&C.push(a),v&&C.push(v),c&&C.push(c),f&&C.push(f);let b=e.compute(gS(p,t,r,a,v,u,w,c,f),{inputs:C,outputs:p>1?[-1,1]:[-1]})[0];e.compute(mS(b,u.batchSize,u.numHeads,w,u.sequenceLength,x,c,f),{inputs:c&&f?[b,c,f]:[b],outputs:[]});let g=[b,n];p>1&&o&&xe.size(o.dims)>0&&g.push(o),c&&g.push(c),f&&g.push(f),e.compute(yS(p,b,n,o,u,w,c,f),{inputs:g,outputs:p>1?[0,2]:[0]})},vS=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],n=t.sequenceLength,i=t.inputHiddenSize,s=t.headSize,a=12,o={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},l=[e.inputs[0],e.inputs[1],e.inputs[2]],u=[{type:12,data:n},{type:12,data:i},{type:12,data:s},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],c=f=>{let p=at("output_q",l[0].dataType,r),w=at("output_k",l[0].dataType,r),x=at("output_v",l[0].dataType,r),v=Ce("input",l[0].dataType,l[0].dims),C=Ce("weight",l[1].dataType,l[1].dims),b=Ce("bias",l[2].dataType,l[2].dims),g=v.type.storage,S=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${a}u;
  var<workgroup> tileInput: array<${g}, ${a*a}>;
  var<workgroup> tileWeightQ: array<${g}, ${a*a}>;
  var<workgroup> tileWeightK: array<${g}, ${a*a}>;
  var<workgroup> tileWeightV: array<${g}, ${a*a}>;
  ${f.registerUniforms(S).declareVariables(v,C,b,p,w,x)}
  ${f.mainStart([a,a,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${g}(0);
    var valueK = ${g}(0);
    var valueV = ${g}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:o,programUniforms:u}),getShaderSource:c},{inputs:l,outputs:[-1,-1,-1]})},L4=(e,t)=>{let r=hS(e.inputs,t),[n,i,s]=vS(e,r);return Zf(e,n,i,s,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r)}}),wS,bS,xS,B4,vY=Oe(()=>{Di(),mt(),_t(),Rr(),St(),wS=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(n,i,s)=>{let a=i.length;if(a!==n.length)throw new Error(`${s}: num dimensions != ${a}`);i.forEach((o,l)=>{if(o!==n[l])throw new Error(`${s}: dim[${l}] do not match`)})};if(e[0].dims.length>1){let n=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,n,"Invalid input scale"),r(e[2].dims,n,"Invalid input B"),r(e[3].dims,n,"Invalid input mean"),r(e[4].dims,n,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},bS=(e,t)=>{let{epsilon:r,spatial:n,format:i}=t,s=e[0].dims,a=n?kr(s[s.length-1]):1,o=i==="NHWC"&&s.length>1?a:1,l=xe.size(s)/a,u=n,c=u?s.length:s,f=Ce("x",e[0].dataType,e[0].dims,a),p=Ce("scale",e[1].dataType,e[1].dims,o),w=Ce("bias",e[2].dataType,e[2].dims,o),x=Ce("inputMean",e[3].dataType,e[3].dims,o),v=Ce("inputVar",e[4].dataType,e[4].dims,o),C=at("y",e[0].dataType,c,a),b=()=>{let S="";if(n)S=`let cOffset = ${s.length===1?"0u":i==="NHWC"?`outputIndices[${s.length-1}] / ${a}`:"outputIndices[1]"};`;else if(i==="NCHW")S=`
            ${C.indicesSet("outputIndices","0","0")}
            let cOffset = ${C.indicesToOffset("outputIndices")};`;else{S=`var cIndices = ${p.type.indices}(0);
                       cIndices[0] = outputIndices[${s.length-1}];`;for(let E=1;E<p.rank;E++)S+=`cIndices[${E}] = outputIndices[${E}];`;S+=`let cOffset = ${p.indicesToOffset("cIndices")};`}return S},g=S=>`
  const epsilon = ${r};
  ${S.registerUniform("outputSize","u32").declareVariables(f,p,w,x,v,C)}
  ${S.mainStart()}
  ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${C.offsetToIndices(`global_idx * ${a}`)};
    ${b()}
    let scale = ${p.getByOffset("cOffset")};
    let bias = ${w.getByOffset("cOffset")};
    let inputMean = ${x.getByOffset("cOffset")};
    let inputVar = ${v.getByOffset("cOffset")};
    let x = ${f.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${C.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${n}_${a}`,inputDependencies:u?["rank","type","type","type","type"]:void 0},getShaderSource:g,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:u?[{type:12,data:l},...ct(s)]:[{type:12,data:l}]})}},xS=e=>Jt(e),B4=(e,t)=>{let{inputs:r,outputCount:n}=e,i=xS({...t,outputCount:n});if(mr.webgpu.validateInputContent&&wS(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(bS(r,i))}}),_S,$S,U4,wY=Oe(()=>{_t(),St(),_S=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},$S=e=>{let t=e[0].dims,r=e[0].dims[2],n=xe.size(t)/4,i=e[0].dataType,s=Ce("input",i,t,4),a=Ce("bias",i,[r],4),o=Ce("residual",i,t,4),l=at("output",i,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)}}),getShaderSource:u=>`
  const channels = ${r}u / 4;
  ${u.declareVariables(s,a,o,l)}

  ${u.mainStart()}
    ${u.guardAgainstOutOfBoundsWorkgroupSizes(n)}
    let value = ${s.getByOffset("global_idx")}
      + ${a.getByOffset("global_idx % channels")} + ${o.getByOffset("global_idx")};
    ${l.setByOffset("global_idx","value")}
  }`}},U4=e=>{_S(e.inputs),e.compute($S(e.inputs))}}),SS,Kt,V4,q4,W4,K4,H4,G4,Q4,Z4,Y4,CS,X4,J4,eF,tF,Gd,rF,Zh,nF,iF,sF,aF,oF,lF,uF,cF,dF,fF,pF,hF,mF,gF,yF,vF,bv,wF,zw,Fw,bF,xF,_F,kS,ES,$F,r1=Oe(()=>{mt(),_t(),Rr(),St(),SS=(e,t,r,n,i,s,a)=>{let o=Math.ceil(t/4),l="";typeof i=="string"?l=`${i}(a)`:l=i("a");let u=Ce("inputData",r,[o],4),c=at("outputData",n,[o],4),f=[{name:"vec_size",type:"u32"}];return a&&f.push(...a),`
      ${e.registerUniforms(f).declareVariables(u,c)}

  ${s??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${u.getByOffset("global_idx")};
    ${c.setByOffset("global_idx",l)}
  }`},Kt=(e,t,r,n,i,s=e.dataType,a,o)=>{let l=[{type:12,data:Math.ceil(xe.size(e.dims)/4)}];return a&&l.push(...a),{name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:u=>SS(u,xe.size(e.dims),e.dataType,s,r,n,o),getRunData:u=>({outputs:[{dims:e.dims,dataType:s}],dispatchGroup:{x:Math.ceil(xe.size(u[0].dims)/64/4)},programUniforms:l})}},V4=e=>{e.compute(Kt(e.inputs[0],"Abs","abs"))},q4=e=>{e.compute(Kt(e.inputs[0],"Acos","acos"))},W4=e=>{e.compute(Kt(e.inputs[0],"Acosh","acosh"))},K4=e=>{e.compute(Kt(e.inputs[0],"Asin","asin"))},H4=e=>{e.compute(Kt(e.inputs[0],"Asinh","asinh"))},G4=e=>{e.compute(Kt(e.inputs[0],"Atan","atan"))},Q4=e=>{e.compute(Kt(e.inputs[0],"Atanh","atanh"))},Z4=e=>Jt(e),Y4=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(Kt(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},CS=e=>{let t,r,n=e.length>=2&&e[1].data!==0,i=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:t=n?e[1].getFloat32Array()[0]:-34028234663852886e22,r=i?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=n?e[1].getUint16Array()[0]:64511,r=i?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return Jt({min:t,max:r})},X4=(e,t)=>{let r=t||CS(e.inputs),n=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"Clip",i=>`clamp(${i}, vec4<${n}>(uniforms.min), vec4<${n}>(uniforms.max))`,void 0,r.cacheKey,void 0,[{type:e.inputs[0].dataType,data:r.min},{type:e.inputs[0].dataType,data:r.max}],[{name:"min",type:n},{name:"max",type:n}]),{inputs:[0]})},J4=e=>{e.compute(Kt(e.inputs[0],"Ceil","ceil"))},eF=e=>{e.compute(Kt(e.inputs[0],"Cos","cos"))},tF=e=>{e.compute(Kt(e.inputs[0],"Cosh","cosh"))},Gd=e=>Jt(e),rF=(e,t)=>{let r=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"Elu",n=>`elu_vf32(${n})`,`
  const elu_alpha_ = ${r}(${t.alpha});

  fn elu_f32(a: ${r}) -> ${r} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,t.cacheKey))},Zh=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,nF=e=>{let t=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,Zh(t)))},iF=e=>{e.compute(Kt(e.inputs[0],"Exp","exp"))},sF=e=>{e.compute(Kt(e.inputs[0],"Floor","floor"))},aF=e=>{let t=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,Zh(t)))},oF=(e,t)=>{let r=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"LeakyRelu",n=>`select(leaky_relu_alpha_ * ${n}, ${n}, ${n} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},lF=e=>{e.compute(Kt(e.inputs[0],"Not",t=>`!${t}`))},uF=e=>{e.compute(Kt(e.inputs[0],"Neg",t=>`-${t}`))},cF=e=>{e.compute(Kt(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},dF=e=>{let t=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},fF=e=>{e.compute(Kt(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},pF=e=>Jt(e),hF=(e,t)=>{let r=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"HardSigmoid",n=>`max(vec4<${r}>(0.0), min(vec4<${r}>(1.0), ${t.alpha} * ${n} + vec4<${r}>(${t.beta})))`,void 0,t.cacheKey))},mF=e=>{e.compute(Kt(e.inputs[0],"Sin","sin"))},gF=e=>{e.compute(Kt(e.inputs[0],"Sinh","sinh"))},yF=e=>{e.compute(Kt(e.inputs[0],"Sqrt","sqrt"))},vF=e=>{e.compute(Kt(e.inputs[0],"Tan","tan"))},bv=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,wF=e=>{e.compute(Kt(e.inputs[0],"Tanh",bv))},zw=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${bv("v")};
}
`,Fw=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,bF=e=>{let t=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"FastGelu",Fw,zw(t),void 0,e.inputs[0].dataType))},xF=(e,t)=>{let r=Sn(e.inputs[0].dataType);return e.compute(Kt(e.inputs[0],"ThresholdedRelu",n=>`select(vec4<${r}>(0.0), ${n}, ${n} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},_F=e=>{e.compute(Kt(e.inputs[0],"Log","log"))},kS=(e,t)=>`
const alpha = vec4<${e}>(${t});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,ES=e=>`quick_gelu_impl(${e})`,$F=(e,t)=>{let r=Sn(e.inputs[0].dataType);e.compute(Kt(e.inputs[0],"QuickGelu",ES,kS(r,t.alpha),t.cacheKey,e.inputs[0].dataType))}}),TS,IS,SF,bY=Oe(()=>{_t(),St(),r1(),TS=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},IS=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=Ce("input",e[0].dataType,e[0].dims,4),n=Ce("bias",e[0].dataType,[e[0].dims[2]],4),i=at("output",e[0].dataType,t,4),s=xe.size(t)/4,a=en(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:o=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${o.declareVariables(r,n,i)}

  ${Zh(a)}

  ${o.mainStart()}
    ${o.guardAgainstOutOfBoundsWorkgroupSizes(s)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${i.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},SF=e=>{TS(e.inputs),e.compute(IS(e.inputs))}}),NS,PS,Yi,CF,kF,EF,TF,IF,NF,PF,AF,RF,OF,xY=Oe(()=>{mt(),_t(),St(),NS=(e,t,r,n,i,s,a,o,l,u,c,f)=>{let p,w;typeof o=="string"?p=w=(g,S)=>`${o}((${g}),(${S}))`:typeof o=="function"?p=w=o:(p=o.scalar,w=o.vector);let x=at("outputData",c,n.length,4),v=Ce("aData",l,t.length,4),C=Ce("bData",u,r.length,4),b;if(i)if(s){let g=xe.size(t)===1,S=xe.size(r)===1,E=t.length>0&&t[t.length-1]%4===0,A=r.length>0&&r[r.length-1]%4===0;g||S?b=x.setByOffset("global_idx",w(g?`${v.type.value}(${v.getByOffset("0")}.x)`:v.getByOffset("global_idx"),S?`${C.type.value}(${C.getByOffset("0")}.x)`:C.getByOffset("global_idx"))):b=`
            let outputIndices = ${x.offsetToIndices("global_idx * 4u")};
            let offsetA = ${v.broadcastedIndicesToOffset("outputIndices",x)};
            let offsetB = ${C.broadcastedIndicesToOffset("outputIndices",x)};
            ${x.setByOffset("global_idx",w(a||E?v.getByOffset("offsetA / 4u"):`${v.type.value}(${v.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||A?C.getByOffset("offsetB / 4u"):`${C.type.value}(${C.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else b=x.setByOffset("global_idx",w(v.getByOffset("global_idx"),C.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let g=(S,E,A="")=>{let M=`aData[indexA${E}][componentA${E}]`,D=`bData[indexB${E}][componentB${E}]`;return`
            let outputIndices${E} = ${x.offsetToIndices(`global_idx * 4u + ${E}u`)};
            let offsetA${E} = ${v.broadcastedIndicesToOffset(`outputIndices${E}`,x)};
            let offsetB${E} = ${C.broadcastedIndicesToOffset(`outputIndices${E}`,x)};
            let indexA${E} = offsetA${E} / 4u;
            let indexB${E} = offsetB${E} / 4u;
            let componentA${E} = offsetA${E} % 4u;
            let componentB${E} = offsetB${E} % 4u;
            ${S}[${E}] = ${A}(${p(M,D)});
          `};c===9?b=`
            var data = vec4<u32>(0);
            ${g("data",0,"u32")}
            ${g("data",1,"u32")}
            ${g("data",2,"u32")}
            ${g("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:b=`
            ${g("outputData[global_idx]",0)}
            ${g("outputData[global_idx]",1)}
            ${g("outputData[global_idx]",2)}
            ${g("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(v,C,x)}

        ${f??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${b}
      }`},PS=(e,t,r,n,i,s,a=r.dataType)=>{let o=r.dims.map(Number),l=n.dims.map(Number),u=!xe.areEqual(o,l),c=o,f=xe.size(o),p=!1,w=!1,x=[u];if(u){let v=Cc.calcShape(o,l,!1);if(!v)throw new Error("Can't perform binary op on the given tensors");c=v.slice(),f=xe.size(c);let C=xe.size(o)===1,b=xe.size(l)===1,g=o.length>0&&o[o.length-1]%4===0,S=l.length>0&&l[l.length-1]%4===0;x.push(C),x.push(b),x.push(g),x.push(S);let E=1;for(let A=1;A<c.length;A++){let M=o[o.length-A],D=l[l.length-A];if(M===D)E*=M;else break}E%4===0?(w=!0,p=!0):(C||b||g||S)&&(p=!0)}else p=!0;return x.push(p),{name:e,shaderCache:{hint:t+x.map(v=>v.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:v=>NS(v,o,l,c,p,u,w,i,r.dataType,n.dataType,a,s),getRunData:()=>({outputs:[{dims:c,dataType:a}],dispatchGroup:{x:Math.ceil(f/64/4)},programUniforms:[{type:12,data:Math.ceil(xe.size(c)/4)},...ct(o,l,c)]})}},Yi=(e,t,r,n,i,s)=>{e.compute(PS(t,i??"",e.inputs[0],e.inputs[1],r,n,s))},CF=e=>{Yi(e,"Add",(t,r)=>`${t}+${r}`)},kF=e=>{Yi(e,"Div",(t,r)=>`${t}/${r}`)},EF=e=>{Yi(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},TF=e=>{Yi(e,"Mul",(t,r)=>`${t}*${r}`)},IF=e=>{let t=Ce("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Yi(e,"Pow",{scalar:(r,n)=>`pow_custom(${r},${n})`,vector:(r,n)=>`pow_vector_custom(${r},${n})`},`
    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {
      if (b == ${t}(0.0)) {
        return ${t}(1.0);
      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {
        return ${t}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {
      // TODO: implement vectorized pow
      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},NF=e=>{Yi(e,"Sub",(t,r)=>`${t}-${r}`)},PF=e=>{Yi(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},AF=e=>{Yi(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},RF=e=>{Yi(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},OF=e=>{Yi(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}}),AS,RS,OS,DS,DF,jF,_Y=Oe(()=>{mt(),_t(),Rr(),St(),AS=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let r=0,n=e[r],i=n.dataType,s=n.dims.length;e.forEach((a,o)=>{if(o!==r){if(a.dataType!==i)throw new Error("input tensors should be one type");if(a.dims.length!==s)throw new Error("input tensors should have the same shape");a.dims.forEach((l,u)=>{if(u!==t&&l!==n.dims[u])throw new Error("non concat dimensions must match")})}})},RS=(e,t)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${t});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,OS=(e,t)=>{let r=e.length,n=[];for(let i=0;i<r;++i){let s=t.setByOffset("global_idx",e[i].getByIndices("indices"));r===1?n.push(s):i===0?n.push(`if (inputIndex == ${i}u) { ${s} }`):i===r-1?n.push(`else { ${s} }`):n.push(`else if (inputIndex == ${i}) { ${s} }`)}return n.join(`
`)},DS=(e,t,r,n)=>{let i=xe.size(r),s=new Array(e.length),a=new Array(e.length),o=0,l=[],u=[],c=[{type:12,data:i}];for(let v=0;v<e.length;++v)o+=e[v].dims[t],s[v]=o,u.push(e[v].dims.length),a[v]=Ce(`input${v}`,n,u[v]),l.push("rank"),c.push({type:12,data:s[v]});for(let v=0;v<e.length;++v)c.push(...ct(e[v].dims));c.push(...ct(r));let f=at("output",n,r.length),p=f.indicesGet("indices",t),w=Array.from(Array(s.length).keys()).map(v=>`uniforms.sizeInConcatAxis${v}`).join(","),x=v=>`

  ${(()=>{v.registerUniform("outputSize","u32");for(let C=0;C<e.length;C++)v.registerUniform(`sizeInConcatAxis${C}`,"u32");return v.declareVariables(...a,f)})()}

  ${RS(s.length,w)}

  ${v.mainStart()}
    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${f.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${p});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${s.length}u>(${w});
      ${p} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${OS(a,f)}
  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:l},getRunData:()=>({outputs:[{dims:r,dataType:n}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:c}),getShaderSource:x}},DF=(e,t)=>{let r=e.inputs,n=r[0].dims,i=xe.normalizeAxis(t.axis,n.length);AS(r,i);let s=n.slice();s[i]=r.reduce((o,l)=>o+(l.dims.length>i?l.dims[i]:0),0);let a=r.filter(o=>xe.size(o.dims)>0);e.compute(DS(a,i,s,r[0].dataType),{inputs:a})},jF=e=>Jt({axis:e.axis})}),Ol,Dl,jl,n1,Bl=Oe(()=>{mt(),_t(),Ol=(e,t,r="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${r}(uniforms.clip_min)), ${t}(${r}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${r}(uniforms.alpha) * value + ${r}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${r}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},Dl=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},jl=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},n1=e=>{let t=(e==null?void 0:e.activation)||"";if(t==="HardSigmoid"){let[r,n]=(e==null?void 0:e.activation_params)||[.2,.5];return{activation:t,alpha:r,beta:n}}else if(t==="Clip"){let[r,n]=(e==null?void 0:e.activation_params)||[l4,u4];return{activation:t,clipMax:n,clipMin:r}}else if(t==="LeakyRelu"){let[r]=(e==null?void 0:e.activation_params)||[.01];return{activation:t,alpha:r}}return{activation:t}}}),sn,MF,i1=Oe(()=>{sn=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},MF=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),zF,$Y=Oe(()=>{zF=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),cf,s1,a1=Oe(()=>{mt(),_t(),St(),Bl(),cf=(e,t,r,n,i)=>{let s=n-r;return`
      ${Array.from({length:r}).map((a,o)=>`
      if (${ut(t.shape,o,t.rank)} != 1) {
        ${t.indicesSet(e,o,ut(i,o+s,n))}
      } else {
        ${t.indicesSet(e,o,0)}
      }`).join("")}
`},s1=(e,t,r,n,i=!1,s)=>{let a=e[0].dims,o=e[1].dims,l=a[a.length-2],u=o[o.length-1],c=a[a.length-1],f=kr(u),p=kr(c),w=kr(l),x=xe.size(r)/f/w,v=e.length>2,C=n?n.slice(0,-2):r.slice(0,-2),b=[xe.size(C),l,u],g=[{type:12,data:x},{type:12,data:l},{type:12,data:u},{type:12,data:c}];Dl(t,g),g.push(...ct(C,a,o)),v&&g.push(...ct(e[2].dims)),g.push(...ct(b));let S=E=>{let A=Jx("batch_dims",e[0].dataType,C.length),M=Ce("a",e[0].dataType,a.length,p),D=Ce("b",e[1].dataType,o.length,f),I=at("output",e[0].dataType,b.length,f),U=en(I.type.tensor),Z=Ol(t,I.type.value,U),ue=[M,D],X="";if(v){let le=i?f:1;ue.push(Ce("bias",e[2].dataType,e[2].dims.length,le)),X=`${i?`value += bias[col / ${le}];`:`value += ${I.type.value}(bias[row + i]);`}`}let ie=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];jl(t,ie);let j=()=>{let le=`var a_data: ${M.type.value};`;for(let ne=0;ne<p;ne++)le+=`
              let b_data${ne} = b[(b_offset + (k + ${ne}) * uniforms.N + col) / ${f}];`;for(let ne=0;ne<w;ne++){le+=`a_data = a[(a_offset + (row + ${ne}) * uniforms.K + k) / ${p}];`;for(let ce=0;ce<p;ce++)le+=`
            values[${ne}] = fma(${D.type.value}(a_data${p===1?"":`[${ce}]`}), b_data${ce}, values[${ne}]);
`}return le};return`
  ${E.registerUniforms(ie).registerInternalVariables(A).declareVariables(...ue,I)}
  ${E.mainStart()}
    ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${f})) * ${f};
    var index1 = global_idx / (uniforms.N / ${f});
    let stride1 = uniforms.M / ${w};
    let row = (index1 % stride1) * ${w};
    let batch = index1 / stride1;

    ${r.length===2?"":`let batch_indices = ${A.offsetToIndices("batch")};`}

    var a_indices: ${M.type.indices};
    ${cf("a_indices",M,M.rank-2,A.rank,"batch_indices")}
    ${M.indicesSet("a_indices",M.rank-2,0)}
    ${M.indicesSet("a_indices",M.rank-1,0)}
    let a_offset = ${M.indicesToOffset("a_indices")};

    var b_indices: ${D.type.indices};
    ${cf("b_indices",D,D.rank-2,A.rank,"batch_indices")}
    ${D.indicesSet("b_indices",D.rank-2,0)}
    ${D.indicesSet("b_indices",D.rank-1,0)}
    let b_offset = ${D.indicesToOffset("b_indices")};
    var values: array<${I.type.value}, ${w}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${p}) {
      ${j()}
    }
    for (var i = 0u; i < ${w}u; i++) {
      var value = values[i];
      ${X}
      ${Z}
      let cur_indices = ${I.type.indices}(batch, row + i, col);
      let offset = ${I.indicesToOffset("cur_indices")};
      ${I.setByOffset(`offset / ${f}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${f};${p};${w};${i}`,inputDependencies:v?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:s?s(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:g}),getShaderSource:S}}}),jS,MS,Lw,xv,zS,Bw,FS,tg,o1=Oe(()=>{mt(),_t(),St(),Bl(),a1(),i1(),jS=(e,t)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${t?", batchIndices":""});
        `,MS=(e,t)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,Lw=(e,t,r="f32",n,i=!1,s=32,a=!1,o=32)=>{let l=t[1]*e[1],u=t[0]*e[0],c=i?l:s,f=i?s:l,p=c/t[0],w=s/t[1];if(!((i&&p===4&&e[1]===4||!i&&(p===3||p===4))&&c%t[0]===0&&s%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${i} is true, innerElementSize ${p} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${p} must be 3 or 4.
  tileAWidth ${c} must be divisible by workgroupSize[0]${t[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${p}<${r}>, ${c/p}>, ${f}>;
var<workgroup> mm_Bsub: array<array<vec4<${r}>, ${u/e[0]}>, ${s}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${p};
const tileInner = ${s};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${a?"0":"i32(globalId.z)"};
  ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${l};

  let num_tiles = ${a?`${Math.ceil(o/s)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${a?`i32(globalId.z) * ${o}`:"0"};

  var acc: array<vec4<${r}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${w};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${jS(i,n)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${w}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${n?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${p===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${MS(i,p)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},xv=(e,t)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${t?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${t?", batchIndices":""});
            `,zS=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Bw=(e,t,r="f32",n,i=!1,s=32,a=!1,o=32,l=!1)=>{let u=e[1]*t[1],c=e[0]*t[0],f=i?u:s,p=i?s:u;if(!(p%t[1]===0&&f%t[0]===0&&s%t[1]===0))throw new Error(`tileAHight ${p} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${f} must be divisible by workgroupSize[0]${t[0]}, tileInner ${s} must be divisible by workgroupSize[1]${t[1]}`);let w=p/t[1],x=f/t[0],v=s/t[1],C=l?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${u};
    let globalColStart = i32(workgroupId.x) * ${c};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${p}; inputRow = inputRow + ${t[1]}) {
        for (var inputCol = localCol; inputCol < ${f}; inputCol = inputCol + ${t[0]}) {
          ${xv(i,n)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${t[1]}) {
            for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${t[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${n?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${r}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${t[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${t[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${u};

let tileRowA = i32(localId.y) * ${w};
let tileColA = i32(localId.x) * ${x};
let tileRowB = i32(localId.y) * ${v};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${w}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${x}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${xv(i,n)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${n?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${r}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${zS(i)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${r}, ${f}>, ${p}>;
  var<workgroup> mm_Bsub : array<array<${r}, ${c}>, ${s}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${s};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${a?"0":"i32(globalId.z)"};
    ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${a?`${Math.ceil(o/s)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${a?`i32(globalId.z) * ${o}`:"0"};

    var acc : array<array<${r}, colPerThread>, rowPerThread>;
    ${C}
  }
`},FS=(e,t,r,n,i=!1)=>{let[s,a,o,l]=n,u=en(n[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${s.type.indices}) -> ${sn(e,u)} {
      var value = ${sn(e,u)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${a.type.indices};
        ${cf("aIndices",a,a.rank-2,s.rank,"batchIndices")}
        ${a.indicesSet("aIndices",a.rank-2,"u32(row)")}
        ${a.indicesSet("aIndices",a.rank-1,"u32(colIn)")}
        value = ${a.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${s.type.indices}) -> ${sn(e,u)} {
      var value = ${sn(e,u)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${o.type.indices};
        ${cf("bIndices",o,o.rank-2,s.rank,"batchIndices")}
        ${o.indicesSet("bIndices",o.rank-2,"u32(row)")}
        ${o.indicesSet("bIndices",o.rank-1,"u32(colIn)")}
        value = ${o.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${sn(e,u)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${t?`value = value + ${i?"bias[colIn]":`${sn(e,u)}(bias[row])`};`:""}
        ${r}
        ${l.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},tg=(e,t,r,n,i=!1,s)=>{let a=e[0].dims,o=e[1].dims,l=a.slice(0,-2),u=o.slice(0,-2),c=n?n.slice(0,-2):r.slice(0,-2),f=xe.size(c),p=a[a.length-2],w=a[a.length-1],x=o[o.length-1],v=w%4===0&&x%4===0,C=p<=8?[4,1,1]:[4,4,1],b=[8,8,1],g=[Math.ceil(x/b[0]/C[0]),Math.ceil(p/b[1]/C[1]),Math.ceil(f/b[2]/C[2])],S=v?4:1,E=[...l,p,w/S],A=E.length,M=[...u,w,x/S],D=M.length,I=[f,p,x/S],U=[{type:6,data:p},{type:6,data:x},{type:6,data:w}];Dl(t,U),U.push(...ct(c,E,M));let Z=["rank","rank"],ue=e.length>2;ue&&(U.push(...ct(e[2].dims)),Z.push("rank")),U.push(...ct(I));let X=ie=>{let j=c.length,le=Jx("batchDims",e[0].dataType,j,1),ne=en(e[0].dataType),ce=Ce("a",e[0].dataType,A,S),W=Ce("b",e[1].dataType,D,S),F=at("result",e[0].dataType,I.length,S),H=[ce,W];if(ue){let Ae=i?S:1;H.push(Ce("bias",e[2].dataType,e[2].dims.length,Ae))}let B=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];jl(t,B);let ee=en(F.type.tensor),me=Ol(t,F.type.value,ee),K=FS(S,ue,me,[le,ce,W,F],i);return`
  ${ie.registerUniforms(B).registerInternalVariables(le).declareVariables(...H,F)}
  ${K}
  ${v?Lw(C,b,ne,le):Bw(C,b,ne,le)}
                   `};return{name:"MatMul",shaderCache:{hint:`${C};${t.activation};${v};${i}`,inputDependencies:Z},getRunData:()=>({outputs:[{dims:s?s(r):r,dataType:e[0].dataType}],dispatchGroup:{x:g[0],y:g[1],z:g[2]},programUniforms:U}),getShaderSource:X}}}),LS,FF,SY=Oe(()=>{mt(),Ia(),St(),Bl(),i1(),$Y(),o1(),LS=(e,t,r,n,i=!1,s,a=4,o=4,l=4,u="f32")=>{let c=U=>{switch(U){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${u}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${U} is not supported.`)}},f=U=>{switch(U){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${U} is not supported.`)}},p=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,w=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,x=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",v=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",C=e?"row":"col",b=e?"col":"row",g=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${C} / outWidth;
    let outCol = ${C} % outWidth;

    let WRow = ${b} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${b} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${b} % inChannels;
    var resData = ${sn(a,u)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${x} && xCol >= 0 && xCol < ${v}) {
      ${p}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${c(a)}
    }
    return resData;`,S=e?t&&n?`
    let col = colIn * ${a};
    ${g}`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${g}
    }
    return ${sn(a,u)}(0.0);`:n&&r?`
    let col = colIn * ${a};
    ${g}`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${g}
    }
    return ${sn(a,u)}(0.0);`,E=e?n&&r?f(o):`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${f(o)}
    }
    return ${sn(o,u)}(0.0);`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${f(o)}
    }
    return ${sn(o,u)}(0.0);`,A=sn(l,u),M=sn(e?a:o,u),D=sn(e?o:a,u),I=Ol(s,A,u);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${M} {
      ${e?S:E}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${D} {
      ${e?E:S}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${A}) {
      let col = colIn * ${l};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${w}
      ${MF(i)}
      ${I}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},FF=(e,t,r,n,i,s,a,o,l)=>{let u=t.format==="NHWC",c=u?e[0].dims[3]:e[0].dims[1],f=r[0],p=u?r[2]:r[3],w=u?r[1]:r[2],x=u?r[3]:r[1],v=u&&(c%4===0||c%3===0)&&x%4===0,C=u?x:p*w,b=u?p*w:x,g=[8,8,1],S=n<=8?[4,1,1]:[4,4,1],E=[Math.ceil(C/g[0]/S[0]),Math.ceil(b/g[1]/S[1]),Math.ceil(f/g[2]/S[2])];Lt("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${E}`);let A=v?u&&c%4!==0?3:4:1,M=g[1]*S[1],D=g[0]*S[0],I=Math.max(g[0]*A,g[1]),U=n%M===0,Z=i%D===0,ue=s%I===0,X=v?[A,4,4]:[1,1,1],ie=[{type:6,data:n},{type:6,data:i},{type:6,data:s},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];Dl(t,ie),ie.push(...ct(e[0].dims,e[1].dims));let j=["rank","rank"];a&&(ie.push(...ct(e[2].dims)),j.push("rank")),ie.push(...ct(r));let le=ne=>{let ce=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];jl(t,ce);let W=v?4:1,F=en(e[0].dataType),H=`
      fn setOutputAtIndex(flatIndex : i32, value : ${v?`vec4<${F}>`:F}) {
        result[flatIndex] = ${v?`vec4<${F}>`:F}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${v?`vec4<${F}>`:F}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${v?"/ 4":""}, value);
      }`,B=Ce("x",e[0].dataType,e[0].dims.length,A===3?1:A),ee=Ce("w",e[1].dataType,e[1].dims.length,W),me=[B,ee],K=at("result",e[0].dataType,r.length,W);if(a){let Ae=Ce("bias",e[2].dataType,e[2].dims.length,W);me.push(Ae),H+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${v?`vec4<${F}>`:F} {
          return bias[coords.${u?"w":"y"}${v?"/ 4":""}];
        }`}return`
        ${zF("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${ne.registerUniforms(ce).declareVariables(...me,K)}
        ${H}
        ${LS(u,U,Z,ue,a,t,X[0],X[1],X[2],F)}
        ${v?Lw(S,g,F,void 0,!u,I):Bw(S,g,F,void 0,!u,I,!1,void 0,o)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${A};${v};${U};${Z};${ue};${M};${D};${I}`,inputDependencies:j},getRunData:()=>({outputs:[{dims:l?l(r):r,dataType:e[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:ie}),getShaderSource:le}}}),BS,_v,kd,US,$v,VS,LF,BF,CY=Oe(()=>{mt(),Ia(),_t(),St(),Bl(),i1(),BS=e=>{let t=1;for(let r=0;r<e.length;r++)t*=e[r];return t},_v=e=>typeof e=="number"?[e,e,e]:e,kd=(e,t)=>t<=1?e:e+(e-1)*(t-1),US=(e,t,r,n=1)=>{let i=kd(t,n);return Math.floor((e[0]*(r-1)-r+i)/2)},$v=(e,t,r,n,i)=>{i==null&&(i=US(e,t[0],n[0]));let s=[0,0,0,r];for(let a=0;a<3;a++)e[a]+2*i>=t[a]&&(s[a]=Math.trunc((e[a]-t[a]+2*i)/n[a]+1));return s},VS=(e,t,r,n,i,s,a,o,l,u)=>{let c,f,p,w;if(e==="VALID"&&(e=0),typeof e=="number"){c={top:e,bottom:e,left:e,right:e,front:e,back:e};let x=$v([t,r,n,1],[o,l,u],1,[i,s,a],e);f=x[0],p=x[1],w=x[2]}else if(Array.isArray(e)){if(!e.every((v,C,b)=>v===b[0]))throw Error(`Unsupported padding parameter: ${e}`);c={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let x=$v([t,r,n,1],[o,l,u],1,[i,s,a],e[0]);f=x[0],p=x[1],w=x[2]}else if(e==="SAME_UPPER"){f=Math.ceil(t/i),p=Math.ceil(r/s),w=Math.ceil(n/a);let x=(f-1)*i+o-t,v=(p-1)*s+l-r,C=(w-1)*a+u-n,b=Math.floor(x/2),g=x-b,S=Math.floor(v/2),E=v-S,A=Math.floor(C/2),M=C-A;c={top:S,bottom:E,left:A,right:M,front:b,back:g}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outDepth:f,outHeight:p,outWidth:w}},LF=(e,t,r,n,i,s=!1,a="channelsLast")=>{let o,l,u,c,f;if(a==="channelsLast")[o,l,u,c,f]=e;else if(a==="channelsFirst")[o,f,l,u,c]=e;else throw new Error(`Unknown dataFormat ${a}`);let[p,,w,x,v]=t,[C,b,g]=_v(r),[S,E,A]=_v(n),M=kd(w,S),D=kd(x,E),I=kd(v,A),{padInfo:U,outDepth:Z,outHeight:ue,outWidth:X}=VS(i,l,u,c,C,b,g,M,D,I),ie=s?p*f:p,j=[0,0,0,0,0];return a==="channelsFirst"?j=[o,ie,Z,ue,X]:a==="channelsLast"&&(j=[o,Z,ue,X,ie]),{batchSize:o,dataFormat:a,inDepth:l,inHeight:u,inWidth:c,inChannels:f,outDepth:Z,outHeight:ue,outWidth:X,outChannels:ie,padInfo:U,strideDepth:C,strideHeight:b,strideWidth:g,filterDepth:w,filterHeight:x,filterWidth:v,effectiveFilterDepth:M,effectiveFilterHeight:D,effectiveFilterWidth:I,dilationDepth:S,dilationHeight:E,dilationWidth:A,inShape:e,outShape:j,filterShape:t}},BF=(e,t,r,n,i,s)=>{let a=s==="channelsLast";a?e[0].dims[3]:e[0].dims[1];let o=[64,1,1],l={x:r.map((C,b)=>b)},u=[Math.ceil(BS(l.x.map(C=>r[C]))/o[0]),1,1];Lt("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${u}`);let c=1,f=xe.size(r),p=[{type:12,data:f},{type:12,data:n},{type:12,data:i},{type:12,data:t.strides},{type:12,data:t.dilations}];Dl(t,p),p.push(...ct(e[0].dims,e[1].dims));let w=["rank","rank"],x=e.length===3;x&&(p.push(...ct(e[2].dims)),w.push("rank")),p.push(...ct(r));let v=C=>{let b=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:n.length},{name:"pads",type:"u32",length:i.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];jl(t,b);let g=1,S=en(e[0].dataType),E=Ce("x",e[0].dataType,e[0].dims.length,c),A=Ce("W",e[1].dataType,e[1].dims.length,g),M=[E,A],D=at("result",e[0].dataType,r.length,g),I="";if(x){let ue=Ce("bias",e[2].dataType,e[2].dims.length,g);M.push(ue),I+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${S} {
          return bias[${a?ut("coords",4,5):ut("coords",1,5)}];
        }`}let U=sn(c,S),Z=Ol(t,U,S);return`
            ${I}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${E.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${A.getByIndices("aIndices")};
            }
          ${C.registerUniforms(b).declareVariables(...M,D)}
          ${C.mainStart()}
          ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${D.offsetToIndices("global_idx")};
              let batch = ${ut("coords",0,E.rank)};
              let d2 = ${a?ut("coords",E.rank-1,E.rank):ut("coords",1,E.rank)};
              let xFRCCorner = vec3<u32>(${a?ut("coords",1,E.rank):ut("coords",2,E.rank)},
              ${a?ut("coords",2,E.rank):ut("coords",3,E.rank)},
              ${a?ut("coords",3,E.rank):ut("coords",4,E.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${a?ut("uniforms.x_shape",1,E.rank):ut("uniforms.x_shape",2,E.rank)};
              let xShapeZ = ${a?ut("uniforms.x_shape",2,E.rank):ut("uniforms.x_shape",3,E.rank)};
              let xShapeW = ${a?ut("uniforms.x_shape",3,E.rank):ut("uniforms.x_shape",4,E.rank)};
              let xShapeU = ${a?ut("uniforms.x_shape",4,E.rank):ut("uniforms.x_shape",1,E.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${a?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${a?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${a?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${a?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${x?"value = value + getBiasByOutputCoords(coords)":""};
              ${Z}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${t.cacheKey};${a};${c};${x}`,inputDependencies:w},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:u[0],y:u[1],z:u[2]},programUniforms:p}),getShaderSource:v}}}),UF,VF,kY=Oe(()=>{mt(),_t(),St(),Bl(),UF=(e,t,r,n)=>{let i=e.length>2,s=i?"value += b[output_channel];":"",a=e[0].dims,o=e[1].dims,l=t.format==="NHWC",u=l?r[3]:r[1],c=u/t.group,f=l&&c>=4?kr(u):1,p=xe.size(r)/f,w=[{type:12,data:p},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:c}];Dl(t,w),w.push(...ct(a,[o[0],o[1],o[2],o[3]/f]));let x=i?["rank","rank","rank"]:["rank","rank"];w.push(...ct([r[0],r[1],r[2],r[3]/f]));let v=C=>{let b=at("output",e[0].dataType,r.length,f),g=en(b.type.tensor),S=Ol(t,b.type.value,g),E=Ce("x",e[0].dataType,a.length),A=Ce("w",e[1].dataType,o.length,f),M=[E,A];i&&M.push(Ce("b",e[2].dataType,e[2].dims,f));let D=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];jl(t,D);let I=l?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${E.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${A.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${E.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${A.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${C.registerUniforms(D).declareVariables(...M,b)}

  ${C.mainStart()}
    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${b.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${l?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${l?1:2}], outputIndices[${l?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${f} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${l?2:1}];

    var value: ${b.type.value} = ${b.type.value}(0);
    ${I}
    ${s}
    ${S}
    ${b.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${t.cacheKey}_${f}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:n?n(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:w}),getShaderSource:v}},VF=(e,t,r,n)=>{let i=e.length>2,s=kr(r[3]),a=kr(r[2]),o=xe.size(r)/s/a,l=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/s],u=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/s],c=[r[0],r[1],r[2],r[3]/s],f=[{type:12,data:o},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];Dl(t,f),f.push(...ct(l,u,c));let p=(a-1)*t.strides[1]+u[1],w=x=>{let v=at("output",e[0].dataType,c.length,s),C=en(v.type.tensor),b=Ol(t,v.type.value,C),g=Ce("x",e[0].dataType,l.length,s),S=Ce("w",e[1].dataType,u.length,s),E=[g,S];i&&E.push(Ce("b",e[2].dataType,e[2].dims,s));let A=i?"value += b[output_channel];":"",M=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return jl(t,M),`
  ${x.registerUniforms(M).declareVariables(...E,v)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${a}u;
    let col = (index1 % width1) * ${a}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${g.type.value}, ${p}>;
    var values: array<${v.type.value}, ${a}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${u[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${p}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${g.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${g.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${u[1]}; w_width++) {
          let w_val = ${S.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${a}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${a}u; i++) {
      var value = values[i];
      ${A}
      ${b}
      ${v.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${s};${a};${p};${u[0]};${u[1]}`,inputDependencies:i?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:n?n(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:f}),getShaderSource:w}}}),qS,xh,WS,_h,Uw,Sv,KS,HS,Vw,EY=Oe(()=>{_t(),SY(),CY(),o1(),kY(),Bl(),a1(),Ro(),qS=(e,t,r,n,i,s)=>{let a=e[0],o=e.slice(s?1:2,s?3:4),l=o.length,u=t[0],c=t.slice(2).map((p,w)=>p+(p-1)*(r[w]-1)),f=o.map((p,w)=>p+n[w]+n[w+l]).map((p,w)=>Math.floor((p-c[w]+i[w])/i[w]));return f.splice(0,0,a),f.splice(s?3:1,0,u),f},xh=[2,3,1,0],WS=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],n=e[1].dims[1]*t.group;if(r!==n)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},_h=(e,t)=>{let r=e.kernelShape.slice();r.length<t[1].dims.length-2&&r.push(...Array(t[1].dims.length-2-r.length).fill(0));for(let s=2;s<t[1].dims.length;++s)r[s-2]===0&&(r[s-2]=t[1].dims[s]);let n=e.pads.slice();Jm.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.format==="NHWC",e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n}),i},Uw=e=>{let t=n1(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,s=e.group,a=e.kernel_shape,o=e.pads,l=e.strides,u=e.w_is_const();return{autoPad:n,format:r,dilations:i,group:s,kernelShape:a,pads:o,strides:l,wIsConst:u,...t,cacheKey:`${e.format};${t.activation};`}},Sv=(e,t,r,n)=>{let i=r.format==="NHWC",s=qS(t[0].dims,t[1].dims,r.dilations,r.pads,r.strides,i);if(r.group!==1){let M=[t[0]];if(i){let D=e.kernelCustomData.wT??e.compute(mi(t[1],xh),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=D),M.push(D)}else M.push(t[1]);t.length===3&&M.push(t[2]),!e.adapterInfo.isArchitecture("ampere")&&i&&t[1].dims[0]===r.group&&t[1].dims[1]===1&&r.dilations[0]===1&&r.dilations[1]===1?e.compute(VF(M,r,s,n),{inputs:M}):e.compute(UF(M,r,s,n),{inputs:M});return}let a=t.length===3,o=t[0].dims[i?1:2],l=t[0].dims[i?2:3],u=t[0].dims[i?3:1],c=t[1].dims[2],f=t[1].dims[3],p=s[i?1:2],w=s[i?2:3],x=s[i?3:1],v=i&&c===o&&f===l&&r.pads[0]===0&&r.pads[1]===0;if(v||c===1&&f===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let M=s[0],D,I,U,Z=[];if(i){let ie=e.kernelCustomData.wT??e.compute(mi(t[1],xh),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=ie),v){let j=o*l*u;D=t[0].reshape([1,M,j]),I=ie.reshape([1,j,x]),U=[1,M,x]}else D=t[0].reshape([M,o*l,u]),I=ie.reshape([1,u,x]),U=[M,p*w,x];Z.push(D),Z.push(I)}else D=t[0].reshape([M,u,o*l]),I=t[1].reshape([1,x,u]),U=[M,x,p*w],Z.push(I),Z.push(D);a&&Z.push(t[2]);let ue=U[2],X=Z[0].dims[Z[0].dims.length-1];ue<8&&X<8?e.compute(s1(Z,r,s,U,i,n),{inputs:Z}):e.compute(tg(Z,r,s,U,i,n),{inputs:Z});return}let C=!0,b=e.kernelCustomData.wT??e.compute(mi(t[1],xh),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=b);let g=[t[0],b];a&&g.push(t[2]);let S=i?p*w:x,E=i?x:p*w,A=c*f*u;e.compute(FF(g,r,s,S,E,A,a,C,n),{inputs:g})},KS=(e,t)=>{let r=t.format==="NHWC",n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&n.push(e.inputs[2]);let i=[0,t.pads[0],0,t.pads[1]],s=[1].concat(t.strides),a=[1].concat(t.dilations),o=[1].concat(t.kernelShape),l=_h({...t,pads:i,strides:s,dilations:a,kernelShape:o},n);Sv(e,n,l,u=>r?[u[0],u[2],u[3]]:[u[0],u[1],u[3]])},HS=(e,t,r)=>{let n=r.format==="NHWC"?"channelsLast":"channelsFirst",i=_h(r,t),s=r.autoPad==="NOTSET"?r.pads:r.autoPad,a=LF(t[0].dims,t[1].dims,r.strides,r.dilations,s,!1,n);e.compute(BF(t,i,a.outShape,[a.filterDepth,a.filterHeight,a.filterWidth],[a.padInfo.front,a.padInfo.top,a.padInfo.left],n))},Vw=(e,t)=>{if(WS(e.inputs,t),e.inputs[0].dims.length===3)KS(e,t);else if(e.inputs[0].dims.length===5)HS(e,e.inputs,t);else{let r=_h(t,e.inputs);Sv(e,e.inputs,r)}}}),qF,TY=Oe(()=>{mt(),Ia(),_t(),St(),qF=(e,t,r)=>{let n=e.length>2,i=t.outputShape,s=t.format==="NHWC",a=t.group,o=e[1].dims,l=o[2]/a,u=o[3],c=s?kr(l):1,f=s&&u===1&&l>=4,p=f?Math.floor(l/4)*4:Math.floor(l/c)*c,w=l-p,x=s?kr(u):1,v=s?u===1?c:x:1,C=xe.size(i)/x,b=[Math.ceil(C/64),1,1];Lt("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${b}`);let g=["rank","rank"],S=[t.strides[0],t.strides[1]],E=[t.kernelShape[s?1:2],t.kernelShape[s?2:3]],A=[t.dilations[0],t.dilations[1]],M=[E[0]+(t.dilations[0]<=1?0:(t.kernelShape[s?1:2]-1)*(t.dilations[0]-1)),E[1]+(t.dilations[1]<=1?0:(t.kernelShape[s?2:3]-1)*(t.dilations[1]-1))],D=[M[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),M[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],I=[{type:12,data:C},{type:12,data:S},{type:12,data:E},{type:12,data:A},{type:12,data:M},{type:6,data:D},{type:12,data:p},{type:12,data:l},{type:12,data:u},...ct(e[0].dims,e[1].dims)];n&&(I.push(...ct(e[2].dims)),g.push("rank")),I.push(...ct(i));let U=Z=>{let ue=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:S.length},{name:"filter_dims",type:"u32",length:E.length},{name:"dilations",type:"u32",length:E.length},{name:"effective_filter_dims",type:"u32",length:M.length},{name:"pads",type:"i32",length:D.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],X=en(e[0].dataType),ie=s?1:2,j=s?2:3,le=s?3:1,ne=Ce("W",e[1].dataType,e[1].dims.length,v),ce=Ce("Dy",e[0].dataType,e[0].dims.length,c),W=[ce,ne];n&&W.push(Ce("bias",e[2].dataType,[i[le]].length,x));let F=at("result",e[0].dataType,i.length,x),H=()=>{let me="";if(f)c===4?me+=`
        let xValue = ${ce.getByOffset("x_offset")};
        let wValue = ${ne.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:c===2?me+=`
          dotProd = dotProd + dot(vec4<${X}>(${ce.getByOffset("x_offset")}, ${ce.getByOffset("x_offset + 1u")}), vec4<${X}>(${ne.getByOffset("w_offset")}, ${ne.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:c===1&&(me+=`
          dotProd = dotProd + dot(vec4<${X}>(${ce.getByOffset("x_offset")}, ${ce.getByOffset("x_offset + 1u")}, ${ce.getByOffset("x_offset + 2u")}, ${ce.getByOffset("x_offset + 3u")}), vec4<${X}>(${ne.getByOffset("w_offset")}, ${ne.getByOffset("w_offset + 1u")}, ${ne.getByOffset("w_offset + 2u")}, ${ne.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(me+=`
                  let xValue = ${s?ce.getByOffset(`${ce.indicesToOffset(`${ce.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${c}`):ce.get("batch","inputChannel","idyR","idyC")};
        `,c===1)me+=`
          let w_offset = ${ne.indicesToOffset(`${ne.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${ne.getByOffset(`w_offset / ${v}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let K=0;K<c;K++)me+=`
            let wValue${K} = ${ne.getByOffset(`${ne.indicesToOffset(`${ne.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${K}, wOutChannel)`)} / ${v}`)};
            dotProd = dotProd + xValue[${K}] * wValue${K};`;return me},B=()=>{if(w===0)return"";if(!f)throw new Error(`packInputAs4 ${f} is not true.`);let me="";if(c===1){me+="dotProd = dotProd";for(let K=0;K<w;K++)me+=`
            + ${ce.getByOffset(`x_offset + ${K}`)} * ${ne.getByOffset(`w_offset + ${K}`)}`;me+=";"}else if(c===2){if(w!==2)throw new Error(`Invalid inputChannelsRemainder ${w}.`);me+=`
          let xValue = ${ce.getByOffset("x_offset")};
          let wValue = ${ne.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return me},ee=`
            let outputIndices = ${F.offsetToIndices(`global_idx * ${x}`)};
            let batch = ${F.indicesGet("outputIndices",0)};
            let d1 = ${F.indicesGet("outputIndices",le)};
            let r = ${F.indicesGet("outputIndices",ie)};
            let c = ${F.indicesGet("outputIndices",j)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${F.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${X}(dyRCorner) + ${X}(wR)) / ${X}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${X}(uniforms.Dy_shape[${ie}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${X}(dyCCorner) + ${X}(wC)) / ${X}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${X}(uniforms.Dy_shape[${j}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${f?`
                var x_offset = ${ce.indicesToOffset(`${ce.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${c};
                var w_offset = ${ne.indicesToOffset(`${ne.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${v};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${f?4:c}) {
                  ${H()}
                  inputChannel = inputChannel + ${f?4:c};
                }
                ${B()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${n?` + bias[d1 / ${x}]`:""};
            ${F.setByOffset("global_idx","value")};
          `;return`
    ${Z.registerUniforms(ue).declareVariables(...W,F)}
      ${Z.mainStart()}
      ${Z.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${ee}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};${c}${v}${x}${f}${w}`,inputDependencies:g},getRunData:()=>({dispatchGroup:{x:b[0],y:b[1],z:b[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}],programUniforms:I}),getShaderSource:U}}}),GS,QS,ZS,Cv,WF,YS,kv,XS,KF,IY=Oe(()=>{TY(),Bl(),Ro(),GS=(e,t,r,n,i,s)=>(e-1)*t+r+(n-1)*i+1-s,QS=(e,t,r,n,i)=>{let s=Math.floor(e/2);t==="SAME_UPPER"?(r[n]=s,r[i]=e-s):t==="SAME_LOWER"&&(r[n]=e-s,r[i]=s)},ZS=(e,t,r,n,i,s,a,o,l,u)=>{let c=e.length-2,f=u.length===0;l.length<c&&l.push(...Array(c-l.length).fill(0));let p=e[0],w=t[o?3:1]*i;for(let x=0,v=e.length-c-(o?1:0);x<c;++x,++v){let C=e[v],b=f?C*a[x]:u[x],g=GS(C,a[x],s[x],t[v],r[x],b);QS(g,n,s,x,x+c),f&&u.push(a[x]*(C-1)+l[x]+(t[v]-1)*r[x]+1-s[x]-s[x+c])}u.splice(0,0,p),u.splice(o?3:1,0,w)},Cv=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((f,p)=>f*p,1)===0){r.length=0;for(let f=2;f<t[1].dims.length;++f)r.push(t[1].dims[f])}let n=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(n?3:1,0,t[1].dims[1]);let i=e.pads.slice(),s=e.outputShape.slice(),a=e.outputPadding.slice(),o=t[0].dims,l=e.dilations.slice();if(l.reduce((f,p)=>f+p,0)===0){let f=t[0].dims.length-2;l=new Array(f).fill(1)}let u=e.strides.slice();if(u.reduce((f,p)=>f+p,0)===0){let f=t[0].dims.length-2;u=new Array(f).fill(1)}ZS(o,r,l,e.autoPad,e.group,i,u,n,a,s);let c=Object.assign({},e);return Object.assign(c,{kernelShape:r,pads:i,outputPadding:a,outputShape:s,dilations:l,strides:u}),c},WF=e=>{let t=n1(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],i=e.dilations,s=e.group,a=e.kernelShape,o=e.pads,l=e.strides,u=e.wIsConst(),c=e.outputPadding,f=e.outputShape;return{autoPad:n,format:r,dilations:i,group:s,kernelShape:a,outputPadding:c,outputShape:f,pads:o,strides:l,wIsConst:u,...t,cacheKey:`${e.format};${t.activation};`}},YS=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],n=e[1].dims[0];if(r!==n)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==i))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.reduce((a,o)=>a+o,0)>0&&t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.reduce((a,o)=>a+o,0)>0&&t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.reduce((a,o)=>a+o,0)>0&&t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.outputPadding.length!==s&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(t.kernelShape.reduce((a,o)=>a+o,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},kv=(e,t,r,n)=>{let i=e.kernelCustomData.wT??e.compute(mi(t[1],[2,3,0,1]),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=i);let s=[t[0],i];t.length===3&&s.push(t[2]),e.compute(qF(s,r,n),{inputs:s})},XS=(e,t)=>{let r=t.format==="NHWC",n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&n.push(e.inputs[2]);let i=t.kernelShape;(i.length===0||i[0]===0)&&(i=[e.inputs[1].dims[2]]);let s=t.dilations;(s.length===0||s[0]===0)&&(s=[1]);let a=t.strides;(a.length===0||a[0]===0)&&(a=[1]);let o=t.pads;o.length===0&&(o=[0,0]),o=[0,o[0],0,o[1]],a=[1].concat(a),s=[1].concat(s),i=[1].concat(i);let l=t.outputPadding;l=[0].concat(l);let u=Cv({...t,pads:o,strides:a,dilations:s,kernelShape:i,outputPadding:l},n);kv(e,n,u,c=>r?[c[0],c[2],c[3]]:[c[0],c[1],c[3]])},KF=(e,t)=>{if(YS(e.inputs,t),e.inputs[0].dims.length===3)XS(e,t);else{let r=Cv(t,e.inputs);kv(e,e.inputs,r)}}}),JS,HF,GF,NY=Oe(()=>{mt(),_t(),Rr(),St(),JS=(e,t,r,n)=>{let i=xe.size(t),s=t.length,a=Ce("input",e,s),o=at("output",e,s),l=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),u=xe.normalizeAxis(l,s),c=f=>{let p=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,w=ut("uniforms.input_shape","uniforms.axis",s),x=n.reverse?p+(n.exclusive?" + 1":""):"0",v=n.reverse?w:p+(n.exclusive?"":" + 1");return`
                ${f.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,o)}
                ${f.mainStart()}
                  ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${o.offsetToIndices("global_idx")};
                  var sum = ${o.type.value}(0);
                  let first : i32 = ${x};
                  let last : i32 = ${v};
                  for (var i : i32 = first; i < last; i++) {
                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${a.getByIndices("inputIndices")};
                  }
                  ${o.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:n.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},{type:12,data:u},...ct(t,t)]}),getShaderSource:c}},HF=(e,t)=>{let r=e.inputs[0].dims,n=e.inputs[0].dataType,i=e.inputs[1];e.compute(JS(n,r,i,t),{inputs:[0]})},GF=e=>{let t=e.exclusive===1,r=e.reverse===1;return Jt({exclusive:t,reverse:r})}}),eC,tC,rC,QF,ZF,PY=Oe(()=>{mt(),_t(),Rr(),St(),eC=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},tC=(e,t,r,n)=>{let i=[];i.push(`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {
    var a: ${r.type.indices};`);for(let s=0;s<t;++s)i.push(r.indicesSet("a",e[s],`i[${s}]`));return i.push("return a;}"),i.join(`
`)},rC=(e,t)=>{let r,n,i,s,a,o,l=t.format==="NHWC",u=t.blocksize,c=t.mode==="DCR";l?([r,n,i,s]=e.dims,a=c?[r,n,i,u,u,s/u**2]:[r,n,i,s/u**2,u,u],o=c?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([r,n,i,s]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],a=c?[r,u,u,s/u**2,n,i]:[r,s/u**2,u,u,n,i],o=c?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let f=e.reshape(a),p=f.dims.length,w=e.dataType,x=Ce("a",w,p),v=at("output",w,p),C=b=>`
  ${b.registerUniform("output_size","u32").declareVariables(x,v)}

  ${tC(o,p,x,v)}

  ${b.mainStart()}
    ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${v.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${v.setByOffset("global_idx",x.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:b=>{let g=l?[r,n*u,i*u,s/u**2]:[r,s/u**2,n*u,i*u],S=xe.size(g),E=f.dims,A=xe.sortBasedOnPerm(E,o);return{outputs:[{dims:g,dataType:b[0].dataType}],dispatchGroup:{x:Math.ceil(S/64)},programUniforms:[{type:12,data:S},...ct(E,A)]}},getShaderSource:C}},QF=(e,t)=>{eC(e.inputs),e.compute(rC(e.inputs[0],t))},ZF=e=>Jt({blocksize:e.blocksize,mode:e.mode,format:e.format})}),$h,Ed,Ev,nC,iC,sC,aC,Tv,oC,YF,XF,AY=Oe(()=>{mt(),_t(),Rr(),St(),$h="[a-zA-Z]|\\.\\.\\.",Ed="("+$h+")+",Ev="^"+Ed+"$",nC="("+Ed+",)*"+Ed,iC="^"+nC+"$",sC=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let r=this.symbolToIndices.get(e);r===void 0?r=[t]:r.push(t),this.symbolToIndices.set(e,r)}},aC=class{constructor(e,t){var i;this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[r,n]=t.includes("->")?t.split("->",2):[t,""];if(!r.match(RegExp(iC)))throw new Error("Invalid LHS term");if(r.split(",").forEach((s,a)=>{let o=e[a].dims.slice();if(!s.match(RegExp(Ev)))throw new Error("Invalid LHS term");let l=this.processTerm(s,!0,o,a);this.lhs.push(l)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([s,a])=>a.count===1||s==="...").map(([s])=>s).join("");else if(!n.match(RegExp(Ed)))throw new Error("Invalid RHS");(i=n.match(RegExp($h,"g")))==null||i.forEach(s=>{if(s==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let a=this.symbolToInfo.get(s);if(a===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(a.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(e,t,r){let n=this.symbolToInfo.get(e);if(n!==void 0){if(n.dimValue!==t&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(r)}else n={count:1,dimValue:t,inputIndices:[r]};this.symbolToInfo.set(e,n)}processTerm(e,t,r,n=-1){let i=r.length,s=!1,a=[],o=0;if(!e.match(RegExp(Ev))&&!t&&e!=="")throw new Error("Invalid LHS term");let l=e.match(RegExp($h,"g")),u=new sC(n);return l==null||l.forEach((c,f)=>{if(c==="..."){if(s)throw new Error("Only one ellipsis is allowed per input term");s=!0;let p=i-l.length+1;if(p<0)throw new Error("Ellipsis out of bounds");if(a=r.slice(o,o+p),this.hasEllipsis){if(this.ellipsisDims.length!==a.length||this.ellipsisDims.toString()!==a.toString())throw new Error("Ellipsis dimensions mismatch")}else if(t)this.hasEllipsis=!0,this.ellipsisDims=a;else throw new Error("Ellipsis must be specified in the LHS");for(let w=0;w<a.length;w++){let x=String.fromCharCode(48+w);u.addSymbol(x,f+w),this.addSymbol(x,r[o++],n)}}else u.addSymbol(c,f+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(c,r[o++],n)}),u}},Tv=e=>e+"_max",oC=(e,t,r,n)=>{let i=e.map(u=>u.length).map((u,c)=>Ce(`input${c}`,t,u)),s=xe.size(n),a=at("output",t,n.length),o=[...r.symbolToInfo.keys()].filter(u=>!r.rhs.symbolToIndices.has(u)),l=u=>{let c=[],f="var prod = 1.0;",p="var sum = 0.0;",w="sum += prod;",x=[],v=[],C=[],b=[],g=r.symbolToInfo.size===r.rhs.symbolToIndices.size;r.symbolToInfo.forEach((E,A)=>{var M;if(r.rhs.symbolToIndices.has(A)){let D=(M=r.rhs.symbolToIndices.get(A))==null?void 0:M[0];D!==void 0&&r.lhs.forEach((I,U)=>{if(E.inputIndices.includes(U)){let Z=I.symbolToIndices.get(A);if(Z===void 0)throw new Error("Invalid symbol error");Z.forEach(ue=>{c.push(`${i[U].indicesSet(`input${U}Indices`,ue,a.indicesGet("outputIndices",D))}`)})}})}else r.lhs.forEach((D,I)=>{if(E.inputIndices.includes(I)){let U=D.symbolToIndices.get(A);if(U===void 0)throw new Error("Invalid symbol error");U.forEach(Z=>{x.push(`${i[I].indicesSet(`input${I}Indices`,Z,`${A}`)}`)}),b.push(`prod *= ${i[I].getByIndices(`input${I}Indices`)};`)}}),v.push(`for(var ${A}: u32 = 0; ${A} < uniforms.${Tv(A)}; ${A}++) {`),C.push("}")});let S=g?[...c,`let sum = ${i.map((E,A)=>E.getByIndices(`input${A}Indices`)).join(" * ")};`]:[...c,p,...v,...x,f,...b,w,...C];return`
            ${u.registerUniforms(o.map(E=>({name:`${Tv(E)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...i,a)}

            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${a.offsetToIndices("global_idx")};
            ${i.map((E,A)=>`var input${A}Indices: ${i[A].type.indices};`).join(`
`)}
            ${S.join(`
`)};
            ${a.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:r.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let u=o.filter(f=>r.symbolToInfo.has(f)).map(f=>{var p;return{type:12,data:((p=r.symbolToInfo.get(f))==null?void 0:p.dimValue)||0}});u.push({type:12,data:s});let c=e.map((f,p)=>[...ct(f)]).reduce((f,p)=>f.concat(p),u);return c.push(...ct(n)),{outputs:[{dims:n,dataType:t}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:c}},getShaderSource:l}},YF=(e,t)=>{let r=new aC(e.inputs,t.equation),n=r.outputDims,i=e.inputs.map((s,a)=>s.dims);e.compute(oC(i,e.inputs[0].dataType,r,n))},XF=e=>{let t=e.equation.replace(/\s+/g,"");return Jt({equation:t})}}),lC,Iv,uC,cC,JF,RY=Oe(()=>{mt(),_t(),St(),lC=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;n<r.length&&i<t.length;++n,++i)if(r[n]!==t[i]&&r[n]!==1&&t[i]!==1)throw new Error("Expand requires shape to be broadcastable to input")},Iv=(e,t)=>{let r=e.length-t.length,n=[];for(let i=0;i<r;++i)n.push(e[i]);for(let i=0;i<t.length;++i)n.push(t[i]===1?e[i+r]:t[i]);return n},uC=(e,t)=>e.length>t.length?Iv(e,t):Iv(t,e),cC=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=uC(t,r),i=e[0].dataType,s=i===9||xe.size(t)===1,a=i===9||t.length>0&&t[t.length-1]%4===0?4:1,o=s||n.length>0&&n[n.length-1]%4===0?4:1,l=Math.ceil(xe.size(n)/o),u=f=>{let p=Ce("input",i,t.length,a),w=at("output",i,n.length,o),x;if(i===9){let v=(C,b,g="")=>`
          let outputIndices${b} = ${w.offsetToIndices(`outputOffset + ${b}u`)};
          let offset${b} = ${p.broadcastedIndicesToOffset(`outputIndices${b}`,w)};
          let index${b} = offset${b} / 4u;
          let component${b} = offset${b} % 4u;
          ${C}[${b}] = ${g}(${p.getByOffset(`index${b}`)}[component${b}]);
        `;x=`
        let outputOffset = global_idx * ${o};
        var data = vec4<u32>(0);
        ${v("data",0,"u32")}
        ${v("data",1,"u32")}
        ${v("data",2,"u32")}
        ${v("data",3,"u32")}
        ${w.setByOffset("global_idx","data")}
      }`}else x=`
        let outputIndices = ${w.offsetToIndices(`global_idx * ${o}`)};
        let inputOffset = ${p.broadcastedIndicesToOffset("outputIndices",w)};
        let data = ${w.type.value}(${p.getByOffset(`inputOffset / ${a}`)});
        ${w.setByOffset("global_idx","data")}
      }`;return`
    ${f.registerUniform("vec_size","u32").declareVariables(p,w)}
    ${f.mainStart()}
    ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${x}`},c=[{type:12,data:l},...ct(t,n)];return{name:"Expand",shaderCache:{hint:`${n.length};${a}${o}`,inputDependencies:["rank"]},getShaderSource:u,getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c})}},JF=e=>{lC(e.inputs),e.compute(cC(e.inputs),{inputs:[0]})}}),dC,eL,OY=Oe(()=>{mt(),_t(),St(),r1(),dC=e=>{let t=e[0].dataType,r=xe.size(e[0].dims),n=xe.size(e[1].dims),i=n%4===0,s=a=>{let o=Ce("x",t,[1],4),l=Ce("bias",t,[1],4),u=at("y",t,[1],4),c=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],f=w=>`
      let bias${w}_offset: u32 = (global_idx * 4 + ${w}) % uniforms.bias_size;
      let bias${w} = ${l.getByOffset(`bias${w}_offset / 4`)}[bias${w}_offset % 4];`,p=i?`
      let bias = ${l.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${f(0)}${f(1)}${f(2)}${f(3)}
      let bias = ${o.type.value}(bias0, bias1, bias2, bias3);`;return`${a.registerUniforms(c).declareVariables(o,l,u)}

    ${zw(Sn(t))}

    ${a.mainStart(kc)}
      ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${o.getByOffset("global_idx")};
      ${p}
      let x_in = x + bias;
      ${u.setByOffset("global_idx",Fw("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${i}`,inputDependencies:["type","type"]},getShaderSource:s,getRunData:a=>({outputs:[{dims:a[0].dims,dataType:a[0].dataType}],programUniforms:[{type:12,data:Math.ceil(r/4)},{type:12,data:n}],dispatchGroup:{x:Math.ceil(r/kc/4)}})}},eL=e=>{e.inputs.length<2||xe.size(e.inputs[1].dims)===0?bF(e):e.compute(dC(e.inputs))}}),fC,pC,tL,rL,DY=Oe(()=>{mt(),_t(),Rr(),St(),fC=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},pC=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r.length,s=xe.normalizeAxis(t.axis,i),a=r.slice(0);a.splice(s,1,...n);let o=r[s],l=e[0].dataType===9?4:1,u=Math.ceil(xe.size(a)/l),c=[{type:12,data:u},{type:6,data:o},{type:12,data:s},...ct(e[0].dims,e[1].dims,a)],f=p=>{let w=Ce("data",e[0].dataType,e[0].dims.length,l),x=Ce("inputIndices",e[1].dataType,e[1].dims.length),v=at("output",e[0].dataType,a.length,l),C=g=>{let S=n.length,E=`var indicesIndices${g}  = ${x.type.indices}(0);`;for(let A=0;A<S;A++)E+=`${S>1?`indicesIndices${g}[${A}]`:`indicesIndices${g}`} = ${a.length>1?`outputIndices${g}[uniforms.axis + ${A}]`:`outputIndices${g}`};`;E+=`
          var idx${g} = ${x.getByIndices(`indicesIndices${g}`)};
          if (idx${g} < 0) {
            idx${g} = idx${g} + uniforms.axisDimLimit;
          }
          var dataIndices${g} : ${w.type.indices};
        `;for(let A=0,M=0;A<i;A++)A===s?(E+=`${i>1?`dataIndices${g}[${A}]`:`dataIndices${g}`} = u32(idx${g});`,M+=S):(E+=`${i>1?`dataIndices${g}[${A}]`:`dataIndices${g}`} = ${a.length>1?`outputIndices${g}[${M}]`:`outputIndices${g}`};`,M++);return E},b;if(e[0].dataType===9){let g=(S,E,A="")=>`
          let outputIndices${E} = ${v.offsetToIndices(`outputOffset + ${E}u`)};
          ${C(E)};
          let offset${E} = ${w.indicesToOffset(`dataIndices${E}`)};
          let index${E} = offset${E} / 4u;
          let component${E} = offset${E} % 4u;
          ${S}[${E}] = ${A}(${w.getByOffset(`index${E}`)}[component${E}]);
        `;b=`
        let outputOffset = global_idx * ${l};
        var value = vec4<u32>(0);
        ${g("value",0,"u32")}
        ${g("value",1,"u32")}
        ${g("value",2,"u32")}
        ${g("value",3,"u32")}
        ${v.setByOffset("global_idx","value")}
      `}else b=`
      let outputIndices = ${v.offsetToIndices("global_idx")};
      ${C("")};
      let value = ${w.getByIndices("dataIndices")};
      ${v.setByOffset("global_idx","value")};
      `;return`
      ${p.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(w,x,v)}
      ${p.mainStart()}
        ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${b}
      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c}),getShaderSource:f}},tL=e=>Jt({axis:e.axis}),rL=(e,t)=>{let r=e.inputs;fC(r),e.compute(pC(e.inputs,t))}}),hC,nL,iL,jY=Oe(()=>{mt(),_t(),St(),hC=(e,t,r,n,i,s,a,o,l)=>{let u=[{type:12,data:s},{type:12,data:n},{type:12,data:i},{type:12,data:r},{type:12,data:a},{type:12,data:o},{type:12,data:l}],c=[s];u.push(...ct(t.dims,c));let f=p=>{let w=Ce("indices_data",t.dataType,t.dims.length),x=at("input_slice_offsets_data",12,1,1),v=[w,x],C=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:i.length},{name:"sizes_from_slice_dims_data",type:"u32",length:r.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${p.registerUniforms(C).declareVariables(...v)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${i.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${r.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${i.length}_${r.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:c,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:u}),getShaderSource:f},{inputs:[t],outputs:[-1]})[0]},nL=(e,t)=>{let r=e.inputs,n=r[0].dims,i=r[0].dataType,s=r[1].dims,a=s[s.length-1],o=xe.sizeToDimension(s,s.length-1),l=xe.sizeFromDimension(n,t.batchDims+a),u=xe.sizeToDimension(n,t.batchDims),c=xe.sizeFromDimension(n,t.batchDims),f=o/u,p=new Array(a),w=l;for(let E=0;E<a;++E)p[a-1-E]=w,w*=n[t.batchDims+a-1-E];let x=hC(e,r[1],p,t.batchDims,n,o,f,c,a),v=t.batchDims+a;if(v>n.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let C=s.slice(0,-1).concat(n.slice(v)),b=xe.size(C),g=[{type:12,data:b},{type:12,data:l},...ct(r[0].dims,x.dims,C)],S=E=>{let A=Ce("data",r[0].dataType,r[0].dims.length),M=Ce("slice_offsets",12,x.dims.length),D=at("output",r[0].dataType,C.length);return`
          ${E.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(A,M,D)}
            ${E.mainStart()}
            ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:C,dataType:i}],dispatchGroup:{x:Math.ceil(b/64)},programUniforms:g}),getShaderSource:S},{inputs:[r[0],x]})},iL=e=>({batchDims:e.batch_dims,cacheKey:""})}),mC,gC,sL,aL,MY=Oe(()=>{mt(),_t(),Rr(),St(),mC=(e,t)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let r=xe.normalizeAxis(t.quantizeAxis,e[0].dims.length),n=t.blockSize,i=e[0],s=e[2],a=e.length===4?e[3]:void 0;if(s.dims.length!==i.dims.length||!i.dims.map((o,l)=>l===r?Math.ceil(o/n)===s.dims[l]:o===s.dims[l]).reduce((o,l)=>o&&l,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(a){if(a.dataType!==i.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(a.dims.length!==s.dims.length||!a.dims.map((o,l)=>o===s.dims[l]).reduce((o,l)=>o&&l,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},gC=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r.length,s=xe.normalizeAxis(t.gatherAxis,i),a=xe.normalizeAxis(t.quantizeAxis,i),o=r.slice(0);o.splice(s,1,...n);let l=xe.size(o),u=e[2].dataType,c=e[0].dataType===22,f=[{type:12,data:l},{type:12,data:a},{type:12,data:s},{type:12,data:t.blockSize},...ct(...e.map((w,x)=>w.dims),o)],p=w=>{let x=Ce("data",e[0].dataType,e[0].dims.length),v=Ce("inputIndices",e[1].dataType,e[1].dims.length),C=Ce("scales",e[2].dataType,e[2].dims.length),b=e.length>3?Ce("zeroPoint",e[3].dataType,e[3].dims.length):void 0,g=at("output",u,o.length),S=[x,v,C];b&&S.push(b);let E=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${w.registerUniforms(E).declareVariables(...S,g)}
        ${w.mainStart()}
        let output_indices = ${g.offsetToIndices("global_idx")};
        var indices_indices = ${v.type.indices}(0);
        ${n.length>1?`
          for (var i: u32 = 0; i < ${n.length}; i++) {
            let index = ${g.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${v.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${g.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${x.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${g.indicesGet("output_indices","i")};
          ${x.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${v.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${r[s]};
        }
        ${x.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${o.length}; i++) {
          let index = ${g.indicesGet("output_indices",`i + ${n.length} - 1`)};
          ${x.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${x.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${x.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${c?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${C.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${C.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${C.getByIndices("scale_indices")};
        ${b?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${b.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${b.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${c?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${Sn(u)}(quantized_data - zero_point) * scale;
        ${g.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${t.cacheKey};${e.filter((w,x)=>x!==1).map(w=>w.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(w,x)=>"rank")},getRunData:()=>({outputs:[{dims:o,dataType:u}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:f}),getShaderSource:p}},sL=(e,t)=>{let r=e.inputs;mC(r,t),e.compute(gC(e.inputs,t))},aL=e=>Jt({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),yC,vC,oL,lL,zY=Oe(()=>{mt(),_t(),Rr(),St(),yC=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},vC=(e,t)=>{let r=e[0].dims,n=e[0].dataType,i=r.length,s=e[1].dims,a=e[1].dataType,o=xe.normalizeAxis(t.axis,i),l=r[o],u=s.slice(0),c=xe.size(u),f=Ce("input",n,i),p=Ce("indicesInput",a,s.length),w=at("output",n,u.length),x=[{type:12,data:c},{type:6,data:l},{type:12,data:o}];return x.push(...ct(r,s,u)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:x}),getShaderSource:v=>`
      ${v.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(f,p,w)}
      ${v.mainStart()}
      ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${w.offsetToIndices("global_idx")};

      var idx = ${p.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${f.type.indices}(outputIndices);
      ${f.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${f.getByIndices("inputIndices")};

      ${w.setByOffset("global_idx","value")};
  }`}},oL=e=>Jt({axis:e.axis}),lL=(e,t)=>{let r=e.inputs;yC(r),e.compute(vC(e.inputs,t))}}),wC,bC,uL,cL,FY=Oe(()=>{mt(),_t(),St(),wC=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},bC=(e,t)=>{let r=e[0].dims.slice(),n=e[1].dims.slice(),[i,s,a]=o4.getShapeOfGemmResult(r,t.transA,n,t.transB,e.length===3?e[2].dims:void 0),o=[i,s];if(!o)throw new Error("Can't use gemm on the given tensors");let l=16,u=Math.ceil(s/l),c=Math.ceil(i/l),f=!0,p=xe.size(o),w=[{type:12,data:f?u:p},{type:12,data:i},{type:12,data:s},{type:12,data:a},{type:1,data:t.alpha},{type:1,data:t.beta}],x=["type","type"];e.length===3&&(w.push(...ct(e[2].dims)),x.push("rank")),w.push(...ct(o));let v=b=>{let g="";t.transA&&t.transB?g="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?g="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?g="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(g="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let S=t.alpha===1?"":"value *= uniforms.alpha;",E=Ce("a",e[0].dataType,e[0].dims),A=Ce("b",e[1].dataType,e[1].dims),M=E.type.value,D=null,I=[E,A];e.length===3&&(D=Ce("c",e[2].dataType,e[2].dims.length),I.push(D));let U=at("output",e[0].dataType,o.length);I.push(U);let Z=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${b.registerUniforms(Z).declareVariables(...I)}

  ${b.mainStart()}
    ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${M}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${g}
    }

    ${S}
    ${D!=null?`let cOffset = ${D.broadcastedIndicesToOffset("vec2(m, n)",U)}; value += ${M}(uniforms.beta) * ${D.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},C=b=>{let g=Ce("a",e[0].dataType,e[0].dims),S=Ce("b",e[1].dataType,e[1].dims),E=null,A=[g,S];e.length===3&&(E=Ce("c",e[2].dataType,e[2].dims.length),A.push(E));let M=at("output",e[0].dataType,o.length);A.push(M);let D=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],I="",U="";t.transA&&t.transB?(U=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(U=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(U=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!t.transA&&!t.transB&&(U=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let Z=t.alpha===1?"":"value *= uniforms.alpha;";return`
  ${b.registerUniforms(D).declareVariables(...A)}
  var<workgroup> tile_a: array<array<${g.type.storage}, ${l}>, ${l}>;
  var<workgroup> tile_b: array<array<${S.type.storage}, ${l}>, ${l}>;
  ${b.mainStart([l,l,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${l};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${l};
    let num_tiles = (uniforms.K - 1) / ${l} + 1;
    var k_start = 0u;
    var value = ${M.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${U}
      k_start = k_start + ${l};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${l}; k++) {
        ${I}
      }
      workgroupBarrier();
    }

    ${Z}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${E!=null?`let cOffset = ${E.broadcastedIndicesToOffset("vec2(m, n)",M)}; value += ${M.type.value}(uniforms.beta) * ${E.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return f?{name:"GemmShared",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:u*c},programUniforms:w}),getShaderSource:C}:{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:w}),getShaderSource:v}},uL=e=>{let t=e.transA,r=e.transB,n=e.alpha,i=e.beta;return{transA:t,transB:r,alpha:n,beta:i,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},cL=(e,t)=>{wC(e.inputs),e.compute(bC(e.inputs,t))}}),Cs,aa,Ho,Go,xC,_C,$C,SC,CC,kC,EC,TC,dL,fL,LY=Oe(()=>{mt(),_t(),Rr(),St(),[Cs,aa,Ho,Go]=[0,1,2,3],xC=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},_C=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,$C=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,SC=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,CC=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,kC=(e,t,r)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${t} {
     var pixel = ${t}(0);
     var indices = vec4<u32>(0);
     indices[${Cs}] = batch;
     indices[${aa}] = channel;`+(()=>{switch(r.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Ho}] = u32(r);
            indices[${Go}] = u32(c);
          } else {
            return ${t}(0);
          }
        `;case"border":return`
          indices[${Ho}] = u32(clamp(r, 0, H - 1));
          indices[${Go}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Ho}] = gs_reflect(r, border[1], border[3]);
          indices[${Go}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${r.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,EC=(e,t,r)=>(()=>{switch(r.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${Cs}], indices[${aa}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${Cs}], indices[${aa}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${Cs}], indices[${aa}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${Cs}], indices[${aa}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${Cs}], indices[${aa}], border);

          let dx2 = ${t}(f32(x2) - x);
          let dx1 = ${t}(x - f32(x1));
          let dy2 = ${t}(f32(y2) - y);
          let dy1 = ${t}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${t}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${Cs}], indices[${aa}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${r.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,TC=(e,t)=>{let r=Ce("x",e[0].dataType,e[0].dims.length),n=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],i=Ce("grid",e[1].dataType,n.length,2),s=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];t.format==="NHWC"&&(s=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[Cs,aa,Ho,Go]=[0,3,1,2]);let a=at("output",e[0].dataType,s.length),o=r.type.value,l=xe.size(s),u=[{type:12,data:l},...ct(e[0].dims,n,s)],c=f=>`
  ${f.registerUniform("output_size","u32").declareVariables(r,i,a)}
  ${_C}
  ${$C(o)}
  ${SC(t)}
  ${CC(t)}
  ${kC(r,o,t)}

  ${f.mainStart()}
    ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Ho}]);
      let W_in = i32(uniforms.x_shape[${Go}]);

      ${t.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${a.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${Cs}], indices[${Ho}], indices[${Go}]);
      let nxy = ${i.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${EC(a,o,t)}
  }`;return{name:"GridSample",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:["type","type"]},getRunData:f=>{let p=xe.size(s);return{outputs:[{dims:s,dataType:f[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:u}},getShaderSource:c}},dL=(e,t)=>{xC(e.inputs),e.compute(TC(e.inputs,t))},fL=e=>Jt({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Pn,IC,pL,Nv,NC,Qd,hL,mL=Oe(()=>{mt(),_t(),Rr(),Xx(),t1(),St(),Ro(),Pn=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,IC=(e,t)=>{let r=e[0],n=Pn(e,1),i=Pn(e,2),s=Pn(e,3),a=Pn(e,4),o=Pn(e,5),l=Pn(e,6),u=Pn(e,7);if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let c=r.dims[0],f=r.dims[1],p=r.dims.length===3?r.dims[2]:t.numHeads*r.dims[4],w=f,x=0,v=0,C=Math.floor(p/t.numHeads);if(l&&u&&xe.size(l.dims)&&xe.size(u.dims)){if(l.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(l.dims[0]!==c||l.dims[1]!==t.numHeads||l.dims[3]!==C)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(u.dims[0]!==c||u.dims[1]!==t.numHeads||u.dims[3]!==C)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(l.dims[2]!==u.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(u.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');x=l.dims[2],v=l.dims[2]}else if(l&&xe.size(l.dims)||u&&xe.size(u.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let b;if(n&&xe.size(n.dims)>0){if(r.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(n.dims.length===3){if(n.dims[2]!==r.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');b=2,w=n.dims[1]}else if(n.dims.length===5){if(n.dims[2]!==t.numHeads||n.dims[3]!==2||n.dims[4]!==C)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');b=5,w=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==C)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');b=0,w=n.dims[2]}}else{if(r.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(r.dims[2]!==t.numHeads||r.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');b=3}if(s&&xe.size(s.dims)>0){if(s.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(n&&n.dims.length===5&&n.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let g=x+w,S=0;if(a&&xe.size(a.dims)>0){S=8;let D=a.dims;throw D.length===1?D[0]===c?S=1:D[0]===3*c+2&&(S=3):D.length===2&&D[0]===c&&D[1]===g&&(S=5),S===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let E=!1,A=p;if(i&&xe.size(i.dims)>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(w!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');A=i.dims[2]}else{if(w!==i.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');A=i.dims[1]*i.dims[3],E=!0}}let M=!1;if(a&&xe.size(a.dims)>0)throw new Error("Key padding mask is not supported");if(o&&xe.size(o.dims)>0){if(o.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(o.dims[0]!==c||o.dims[1]!==t.numHeads||o.dims[2]!==f||o.dims[3]!==g)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:c,sequenceLength:f,pastSequenceLength:x,kvSequenceLength:w,totalSequenceLength:g,maxSequenceLength:v,inputHiddenSize:0,hiddenSize:p,vHiddenSize:A,headSize:C,vHeadSize:Math.floor(A/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:S,scale:t.scale,broadcastResPosBias:M,passPastInKv:E,qkvFormat:b}},pL=e=>Jt({...e}),Nv=Jt({perm:[0,2,1,3]}),NC=(e,t,r,n,i,s,a)=>{let o=[n,i,s],l=xe.size(o),u=[{type:12,data:l},{type:12,data:a},{type:12,data:s}],c=f=>{let p=at("qkv_with_bias",t.dataType,o),w=Ce("qkv",t.dataType,o),x=Ce("bias",r.dataType,o),v=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${f.registerUniforms(v).declareVariables(w,x,p)}
  ${f.mainStart()}
    ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:u}),getShaderSource:c},{inputs:[t,r],outputs:[-1]})[0]},Qd=(e,t,r,n,i,s,a,o)=>{let l=s;if(a&&xe.size(a.dims)>0){if(n===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return l=NC(e,s,a,t,n,r*i,o),l=l.reshape([t,n,r,i]),r===1||n===1?l:e.compute(mi(l,Nv.perm),{inputs:[l],outputs:[-1]})[0]}else return s.dims.length===3&&(l=s.reshape([t,n,r,i])),r===1||n===1?l:e.compute(mi(l,Nv.perm),{inputs:[l],outputs:[-1]})[0]},hL=(e,t)=>{let r=IC(e.inputs,t),n=e.inputs[0],i=Pn(e.inputs,1),s=Pn(e.inputs,2),a=Pn(e.inputs,3),o=Pn(e.inputs,4),l=Pn(e.inputs,5),u=Pn(e.inputs,6),c=Pn(e.inputs,7);if(n.dims.length===5)throw new Error("Packed QKV is not implemented");if((i==null?void 0:i.dims.length)===5)throw new Error("Packed KV is not implemented");let f=i&&s&&i.dims.length===4&&s.dims.length===4,p=Qd(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,n,a,0);if(f)return Zf(e,p,i,s,o,void 0,u,c,l,r);if(!i||!s)throw new Error("key and value must be provided");let w=Qd(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,i,a,r.hiddenSize),x=Qd(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,s,a,2*r.hiddenSize);Zf(e,p,w,x,o,void 0,u,c,l,r)}}),PC,AC,RC,OC,qw,gL,yL,vL=Oe(()=>{mt(),_t(),Rr(),St(),PC=e=>{if(!e||e.length<1)throw new Error("too few inputs")},AC=(e,t)=>{let r=[],n=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(i=>r.push(Number(i))),n=r.length),Jt({numOutputs:n,axis:t.axis,splitSizes:r})},RC=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${ut("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,OC=e=>{let t=e.length,r=[];for(let n=0;n<t;++n){let i=e[n].setByIndices("indices","input[global_idx]");t===1?r.push(i):n===0?r.push(`if (output_number == ${n}u) { ${i} }`):n===t-1?r.push(`else { ${i} }`):r.push(`else if (output_number == ${n}) { ${i} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${r.join(`
`)}
      }`},qw=(e,t)=>{let r=e[0].dims,n=xe.size(r),i=e[0].dataType,s=xe.normalizeAxis(t.axis,r.length),a=new Array(t.numOutputs),o=Ce("input",i,r.length),l=new Array(t.numOutputs),u=[],c=[],f=0,p=[{type:12,data:n}];for(let x=0;x<t.numOutputs;x++){f+=t.splitSizes[x],l[x]=f;let v=r.slice();v[s]=t.splitSizes[x],c.push(v),a[x]=at(`output${x}`,i,v.length),u.push({dims:c[x],dataType:e[0].dataType})}p.push({type:12,data:l},...ct(r,...c));let w=x=>`
  ${x.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",l.length).declareVariables(o,...a)}
  ${RC(l.length)}
  ${OC(a)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${o.offsetToIndices("global_idx")};
    var index = ${o.indicesGet("indices",s)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${ut("uniforms.size_in_split_axis","output_number - 1u",l.length)};
      ${o.indicesSet("indices",s,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:w,getRunData:()=>({outputs:u,dispatchGroup:{x:Math.ceil(n/64)},programUniforms:p})}},gL=(e,t)=>{PC(e.inputs);let r=e.inputs.length===1?t:AC(e.inputs,t);e.compute(qw(e.inputs,r),{inputs:[0]})},yL=e=>{let t=e.axis,r=e.splitSizes,n=e.numOutputs<0?r.length:e.numOutputs;if(n!==r.length)throw new Error("numOutputs and splitSizes length must be equal");return Jt({axis:t,numOutputs:n,splitSizes:r})}}),DC,rg,wL,bL=Oe(()=>{mt(),_t(),Rr(),St(),DC=(e,t)=>{let[r,n,i,s]=e,{numHeads:a,rotaryEmbeddingDim:o}=t;if(r.dims.length!==3&&r.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${r.dims.length}`);if(!xe.areEqual(n.dims,[])&&!xe.areEqual(n.dims,[1])&&n.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${n.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(s.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${s.dims.length}`);if(!xe.areEqual(i.dims,s.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(o>0&&a===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let l=r.dims[0],u=r.dims[r.dims.length-2],c=i.dims[0],f=xe.sizeFromDimension(r.dims,1)/u,p=o===0?i.dims[1]*2:f/a;if(o>p)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(n.dims.length===2){if(l!==n.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${n.dims[0]}`);if(u!==n.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${n.dims[1]}`)}if(p/2!==i.dims[1]&&o/2!==i.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${i.dims[1]}`);if(u>c)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},rg=(e,t)=>{let{interleaved:r,numHeads:n,rotaryEmbeddingDim:i,scale:s}=t,a=e[0].dims[0],o=xe.sizeFromDimension(e[0].dims,1),l=e[0].dims[e[0].dims.length-2],u=o/l,c=e[2].dims[1],f=i===0?c*2:u/n,p=new Array(a,l,u/f,f-c),w=xe.computeStrides(p),x=[{type:1,data:s},{type:12,data:p},{type:12,data:w},...e[0].dims.length===3?new Array({type:12,data:[o,u,f,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[o,f,l*f,1]}):[],...ct(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],v=C=>{let b=Ce("input",e[0].dataType,e[0].dims.length),g=Ce("position_ids",e[1].dataType,e[1].dims.length),S=Ce("cos_cache",e[2].dataType,e[2].dims.length),E=Ce("sin_cache",e[3].dataType,e[3].dims.length),A=at("output",e[0].dataType,e[0].dims.length);return C.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:p.length},{name:"global_strides",type:"u32",length:w.length},{name:"input_output_strides",type:"u32",length:w.length}]),`
        ${C.declareVariables(b,g,S,E,A)}

        ${C.mainStart(kc)}
          let half_rotary_emb_dim = uniforms.${S.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${C.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${g.broadcastedIndicesToOffset("bsnh.xy",at("",g.type.tensor,2))};
            let position_id =
                u32(${g.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${r});
            let j = i + select(half_rotary_emb_dim, 1, ${r});
            let re = ${b.getByOffset("i")} * ${S.get("position_id","bsnh[3]")} -
                ${b.getByOffset("j")} * ${E.get("position_id","bsnh[3]")};
            ${A.setByOffset("i","re")}
            let im = ${b.getByOffset("i")} * ${E.get("position_id","bsnh[3]")} +
                ${b.getByOffset("j")} * ${S.get("position_id","bsnh[3]")};
            ${A.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${A.setByOffset("k",b.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:Jt({interleaved:r}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:v,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(xe.size(p)/kc)},programUniforms:x})}},wL=(e,t)=>{DC(e.inputs,t),e.compute(rg(e.inputs,t))}}),jC,MC,Pv,zC,xL,BY=Oe(()=>{Rr(),mt(),t1(),mL(),vL(),Ro(),bL(),St(),jC=(e,t)=>{if(t.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let r=e[0],n=e[1],i=e[2],s=e[3],a=e[4];if(t.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(t.localWindowSize!==-1)throw new Error("Local attention is not supported");if(t.softcap!==0)throw new Error("Softcap is not supported");if(t.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let o=!1,l=r.dims[0],u=r.dims[1],c=r.dims.length===3?o?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],f=u,p=0,w=!n||n.dims.length===0,x=Math.floor(w?c/(t.numHeads+2*t.kvNumHeads):c/t.numHeads);w&&(c=x*t.numHeads);let v=s&&s.dims.length!==0,C=a&&a.dims.length!==0;if(v&&s.dims.length===4&&s.dims[0]===l&&s.dims[1]!==t.kvNumHeads&&s.dims[2]===t.kvNumHeads&&s.dims[3]===x)throw new Error("BSNH pastKey/pastValue is not supported");if(v&&C){if(s.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(a.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');p=s.dims[2]}else if(v||C)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let b=1;if(n&&n.dims.length>0){if(r.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(n.dims.length===3){if(r.dims[2]%n.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');f=n.dims[1]}else if(n.dims.length===5){if(n.dims[2]!==t.numHeads||n.dims[3]!==2||n.dims[4]!==x)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');f=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==x)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');f=n.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');b=3}let g=0,S=!1,E=t.kvNumHeads?x*t.kvNumHeads:c;if(i&&i.dims.length>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(f!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');E=i.dims[2]}else{if(f!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');E=i.dims[1]*i.dims[3],S=!0}}let A=e.length>4?e[5]:void 0;if(A&&A.dims.length!==1&&A.dims[0]!==l)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:l,sequenceLength:u,pastSequenceLength:p,kvSequenceLength:f,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:c,vHiddenSize:E,headSize:x,vHeadSize:Math.floor(E/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:g,scale:t.scale,broadcastResPosBias:!1,passPastInKv:S,qkvFormat:b}},MC=Jt({perm:[0,2,1,3]}),Pv=(e,t,r)=>{let n=t,i=r.kvNumHeads;return t.dims.length===3&&r.kvSequenceLength!==0&&(n=t.reshape([r.batchSize,r.kvSequenceLength,i,r.headSize]),n=e.compute(mi(n,MC.perm),{inputs:[n],outputs:[-1]})[0]),n},zC=(e,t,r,n)=>{let i=7,s=["type","type"],a=[e*t],o=e*t,l=[{type:12,data:o},{type:12,data:t},{type:12,data:e}],u=c=>{let f=Ce("seq_lens",r.dataType,r.dims),p=Ce("total_seq_lens",n.dataType,n.dims),w=at("pos_ids",i,a),x=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${c.registerUniforms(x).declareVariables(f,p,w)}
  ${c.mainStart()}
    ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${p.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${f.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${w.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${w.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${w.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${t}`,inputDependencies:s},getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:l}),getShaderSource:u}},xL=(e,t)=>{var E;let r=jC(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(((E=e.inputs[1])==null?void 0:E.dims.length)===5)throw new Error("Packed KV is not implemented");let n=e.inputs[0],i=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,s=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,a=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,o=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,l=e.inputs.length>4?e.inputs[5]:void 0,u=e.inputs.length>5?e.inputs[6]:void 0,c=r.kvNumHeads?r.kvNumHeads:r.numHeads,f=Jt({axis:2,numOutputs:3,splitSizes:[r.numHeads*r.headSize,c*r.headSize,c*r.headSize]}),[p,w,x]=!i&&!s?e.compute(qw([n],f),{inputs:[n],outputs:[-1,-1,-1]}):[n,i,s],v,C;if(t.doRotary){let A=e.compute(zC(r.batchSize,r.sequenceLength,l,u),{inputs:[l,u],outputs:[-1]})[0],M=e.inputs[7],D=e.inputs[8],I=Jt({interleaved:t.rotaryInterleaved!==0,numHeads:r.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),U=[p,A,M,D],Z=[-1];v=e.compute(rg(U,I),{inputs:U,outputs:Z})[0],U.splice(0,1,w);let ue=Jt({interleaved:t.rotaryInterleaved!==0,numHeads:r.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});C=e.compute(rg(U,ue),{inputs:U,outputs:Z})[0]}let b=Qd(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,t.doRotary?v:p,void 0,0),g=Pv(e,t.doRotary?C:w,r),S=Pv(e,x,r);Zf(e,b,g,S,void 0,void 0,a,o,void 0,r,l,u)}}),Av,FC,LC,_L,UY=Oe(()=>{mt(),_t(),Ro(),St(),Av=(e,t,r,n,i,s,a,o)=>{let l=kr(s),u=l===1?"f32":`vec${l}f`,c=l===1?"vec2f":`mat2x${l}f`,f=i*a,p=64;f===1&&(p=256);let w=[i,a,s/l],x=[i,a,2],v=["rank","type","type"],C=[];C.push(...ct(w,x));let b=g=>{let S=Ce("x",t.dataType,3,l),E=Ce("scale",r.dataType,r.dims),A=Ce("bias",n.dataType,n.dims),M=at("output",1,3,2),D=[S,E,A,M];return`
  var<workgroup> workgroup_shared : array<${c}, ${p}>;
  const workgroup_size = ${p}u;
  ${g.declareVariables(...D)}
  ${g.mainStart(p)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${u}(0);
    var squared_sum = ${u}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${u}(${S.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${c}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${ko("workgroup_shared[0][0]",l)} / f32(hight * ${l});
      let squared_sum_final = ${ko("workgroup_shared[0][1]",l)} / f32(hight * ${l});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${o}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${l};${o};${p}`,inputDependencies:v},getRunData:()=>({outputs:[{dims:x,dataType:1}],dispatchGroup:{x:f},programUniforms:C}),getShaderSource:b},{inputs:[t,r,n],outputs:[-1]})[0]},FC=(e,t,r)=>{let n=t[0].dims,i=n,s=2,a=n[0],o=n[1],l=xe.sizeFromDimension(n,s),u=kr(l),c=xe.size(i)/u,f=Av(e,t[0],t[1],t[2],a,l,o,r.epsilon),p=[a,o,l/u],w=[a,o],x=["type","none"],v=C=>{let b=Ce("x",t[0].dataType,p.length,u),g=Ce("scale_shift",1,w.length,2),S=at("output",t[0].dataType,p.length,u),E=[b,g,S];return`
  ${C.registerUniform("output_size","u32").declareVariables(...E)}
  ${C.mainStart()}
  ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${S.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${g.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${b.getByOffset("global_idx")} * ${S.type.value}(scale_shift.x) + ${S.type.value}(scale_shift.y);
      ${S.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${u}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:[{type:12,data:c},...ct(p,w,p)]}),getShaderSource:v},{inputs:[t[0],f]})},LC=(e,t,r)=>{let n=t[0].dims,i=n,s=n[0],a=n[n.length-1],o=xe.sizeFromDimension(n,1)/a,l=kr(a),u=xe.size(i)/l,c=[{type:12,data:o},{type:12,data:Math.floor(a/l)}],f=["type","type"],p=!1,w=[0,n.length-1];for(let b=0;b<n.length-2;b++)p=p||n[b+1]!==1,w.push(b+1);p=p&&n[n.length-1]!==1;let x=p?e.compute(mi(e.inputs[0],w),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:n.length},(b,g)=>n[w[g]])),v=Av(e,x,t[1],t[2],s,o,a,r.epsilon),C=b=>{let g=en(t[0].dataType),S=l===1?"vec2f":`mat${l}x2f`,E=D=>{let I=D===0?"x":"y",U=l===1?"f32":`vec${l}f`;switch(l){case 1:return`${g}(${U}(scale.${I}))`;case 2:return`vec2<${g}>(${U}(scale[0].${I}, scale[1].${I}))`;case 4:return`vec4<${g}>(${U}(scale[0].${I}, scale[1].${I}, scale[2].${I}, scale[3].${I}))`;default:throw new Error(`Not supported compoents ${l}`)}},A=Ce("input",t[0].dataType,t[0].dims,l),M=at("output",t[0].dataType,i,l);return`
  @group(0) @binding(0) var<storage, read> input : array<${A.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${S}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${M.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${b.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${E(0)}, ${E(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${l}`,inputDependencies:f},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c}),getShaderSource:C},{inputs:[t[0],v]})},_L=(e,t)=>{t.format==="NHWC"?LC(e,e.inputs,t):FC(e,e.inputs,t)}}),BC,UC,$L,VY=Oe(()=>{mt(),_t(),St(),BC=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},UC=(e,t,r)=>{let n=t.simplified,i=e[0].dims,s=e[1],a=!n&&e[2],o=i,l=xe.normalizeAxis(t.axis,i.length),u=xe.sizeToDimension(i,l),c=xe.sizeFromDimension(i,l),f=xe.size(s.dims),p=a?xe.size(a.dims):0;if(f!==c||a&&p!==c)throw new Error(`Size of X.shape()[axis:] == ${c}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${f} and bias size of ${p}`);let w=[];for(let A=0;A<i.length;++A)A<l?w.push(i[A]):w.push(1);let x=kr(c),v=["type","type"],C=[{type:12,data:u},{type:1,data:c},{type:12,data:Math.floor(c/x)},{type:1,data:t.epsilon}];a&&v.push("type");let b=r>1,g=r>2,S=A=>{let M=en(e[0].dataType),D=[Ce("x",e[0].dataType,e[0].dims,x),Ce("scale",s.dataType,s.dims,x)];a&&D.push(Ce("bias",a.dataType,a.dims,x)),D.push(at("output",e[0].dataType,o,x)),b&&D.push(at("mean_data_output",1,w)),g&&D.push(at("inv_std_output",1,w));let I=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${A.registerUniforms(I).declareVariables(...D)}
  ${A.mainStart()}
    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${Dw("f32",x)};
    var mean_square_vector = ${Dw("f32",x)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Du(M,x,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${ko("mean_vector",x)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${ko("mean_square_vector",x)} / uniforms.norm_size ${n?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Du(M,x,"x[j + offset]")};
      let f32scale = ${Du(M,x,"scale[j]")};
      output[j + offset] = ${D[0].type.value}((f32input ${n?"":"- mean"}) * inv_std_dev * f32scale
        ${a?`+ ${Du(M,x,"bias[j]")}`:""}
      );
    }

    ${b?"mean_data_output[global_idx] = mean":""};
    ${g?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},E=[{dims:o,dataType:e[0].dataType}];return b&&E.push({dims:w,dataType:1}),g&&E.push({dims:w,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${x};${r};${n}`,inputDependencies:v},getRunData:()=>({outputs:E,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:C}),getShaderSource:S}},$L=(e,t)=>{BC(e.inputs),e.compute(UC(e.inputs,t,e.outputCount))}}),VC,SL,qY=Oe(()=>{_t(),a1(),o1(),VC=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},SL=e=>{VC(e.inputs);let t=Cc.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let r=t[t.length-1],n=e.inputs[0].dims[e.inputs[0].dims.length-1];if(r<8&&n<8)e.compute(s1(e.inputs,{activation:""},t));else{let i=t[t.length-2],s=xe.size(e.inputs[0].dims.slice(0,-2)),a=xe.size(e.inputs[1].dims.slice(0,-2));if(s!==1&&i===1&&a===1){let o=e.inputs[0].reshape([1,s,n]),l=e.inputs[1].reshape([1,n,r]),u=[1,s,r],c=[o,l];e.compute(tg(c,{activation:""},t,u),{inputs:c})}else e.compute(tg(e.inputs,{activation:""},t))}}}),qC,WC,KC,CL,kL,WY=Oe(()=>{mt(),_t(),Rr(),St(),qC=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let r=e[0],n=r.dims.length;if(r.dims[n-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let i=Math.floor((t.k+t.blockSize-1)/t.blockSize),s=t.blockSize/8*t.bits,a=e[1];if(!xe.areEqual(a.dims,[t.n,i,s]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let o=e[2].dims;if(xe.size(o)!==t.n*i)throw new Error("scales input size error.");if(e.length===4){let l=e[3].dims,u=t.n*(t.bits===8?i:Math.floor((i*t.bits+7)/8));if(xe.size(l)!==u)throw new Error("zeroPoints input size error.")}},WC=(e,t)=>{let r=e[0].dims,n=r.length,i=r[n-2],s=t.k,a=t.n,o=r.slice(0,n-2),l=xe.size(o),u=e[1].dims[2]/4,c=e[0].dataType,f=kr(t.k),p=kr(u),w=kr(a),x=o.concat([i,a]),v=i>1&&a/w%2===0?2:1,C=xe.size(x)/w/v,b=64,g=[],S=[l,i,s/f],E=xe.convertShape(e[1].dims).slice();E.splice(-1,1,u/p),g.push(...ct(S)),g.push(...ct(E)),g.push(...ct(e[2].dims)),e.length===4&&g.push(...ct(xe.convertShape(e[3].dims)));let A=[l,i,a/w];g.push(...ct(A));let M=D=>{let I=S.length,U=Ce("a",e[0].dataType,I,f),Z=Ce("b",12,E.length,p),ue=Ce("scales",e[2].dataType,e[2].dims.length),X=[U,Z,ue],ie=e.length===4?Ce("zero_points",12,e[3].dims.length):void 0;ie&&X.push(ie);let j=A.length,le=at("output",e[0].dataType,j,w),ne=en(e[0].dataType),ce=(()=>{switch(f){case 1:return`array<${ne}, 8>`;case 2:return`mat4x2<${ne}>`;case 4:return`mat2x4<${ne}>`;default:throw new Error(`${f}-component is not supported.`)}})(),W=()=>{let B=`
          // reuse a data
            var input_offset = ${U.indicesToOffset(`${U.type.indices}(batch, row, word_offset)`)};
            var a_data: ${ce};
            for (var j: u32 = 0; j < ${8/f}; j++) {
              a_data[j] = ${U.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let ee=0;ee<w*v;ee++)B+=`
            b_value = ${p===1?`b${ee}_data`:`b${ee}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${ce}(${Array.from({length:4},(me,K)=>`${ne}(b_value_lower[${K}]), ${ne}(b_value_upper[${K}])`).join(", ")});
            b_dequantized_values = ${f===1?`${ce}(${Array.from({length:8},(me,K)=>`(b_quantized_values[${K}] - ${ie?`zero_point${ee}`:"zero_point"}) * scale${ee}`).join(", ")});`:`(b_quantized_values - ${ce}(${Array(8).fill(`${ie?`zero_point${ee}`:"zero_point"}`).join(",")})) * scale${ee};`};
            workgroup_shared[local_id.x * ${v} + ${Math.floor(ee/w)}]${w>1?`[${ee%w}]`:""} += ${Array.from({length:8/f},(me,K)=>`${f===1?`a_data[${K}] * b_dequantized_values[${K}]`:`dot(a_data[${K}], b_dequantized_values[${K}])`}`).join(" + ")};
          `;return B},F=()=>{let B=`
            var col_index = col * ${w};
            ${ie?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${ne}(8);`}
            `;for(let ee=0;ee<w*v;ee++)B+=`
            let scale${ee} = ${ue.getByOffset("col_index * nBlocksPerCol + block")};
            ${ie?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${ie.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${ee} = ${ne}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return B},H=()=>{let B=`col_index = col * ${w};`;for(let ee=0;ee<w*v;ee++)B+=`
            let b${ee}_data = ${Z.getByIndices(`${Z.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return B+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${ce};
            var b_dequantized_values: ${ce};`,B};return`
        var<workgroup> workgroup_shared: array<${le.type.value}, ${v*b}>;
        ${D.declareVariables(...X,le)}
        ${D.mainStart([b,1,1])}
          let output_indices = ${le.offsetToIndices(`(global_idx / ${b}) * ${v}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${b}) {
            //process one block
            var word_offset: u32 = block * ${t.blockSize/f};
            ${F()}
            for (var word: u32 = 0; word < ${u}; word += ${p}) {
              ${H()}
              for (var i: u32 = 0; i < ${p}; i++) {
                ${W()}
                word_offset += ${8/f};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${v}) {
            var output_value: ${le.type.value} = ${le.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${b}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${v};
            }
            ${le.setByIndices(`${le.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${t.blockSize};${t.bits};${f};${p};${w};${v};${b}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:x,dataType:c}],dispatchGroup:{x:C},programUniforms:g}),getShaderSource:M}},KC=(e,t)=>{let r=e[0].dims,n=r.length,i=r[n-2],s=t.k,a=t.n,o=r.slice(0,n-2),l=xe.size(o),u=e[1].dims[2]/4,c=e[0].dataType,f=kr(t.k),p=kr(u),w=o.concat([i,a]),x=128,v=a%8===0?8:a%4===0?4:1,C=x/v,b=C*p*8,g=b/f,S=b/t.blockSize,E=xe.size(w)/v,A=[],M=[l,i,s/f],D=xe.convertShape(e[1].dims).slice();D.splice(-1,1,u/p),A.push(...ct(M)),A.push(...ct(D)),A.push(...ct(e[2].dims)),e.length===4&&A.push(...ct(xe.convertShape(e[3].dims)));let I=[l,i,a];A.push(...ct(I));let U=Z=>{let ue=M.length,X=Ce("a",e[0].dataType,ue,f),ie=Ce("b",12,D.length,p),j=Ce("scales",e[2].dataType,e[2].dims.length),le=[X,ie,j],ne=e.length===4?Ce("zero_points",12,e[3].dims.length):void 0;ne&&le.push(ne);let ce=I.length,W=at("output",e[0].dataType,ce),F=en(e[0].dataType),H=()=>{switch(f){case 1:return`
          let a_data0 = vec4<${F}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${F}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${F}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${F}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${f}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${X.type.value}, ${g}>;
        var<workgroup> inter_results: array<array<${W.type.value}, ${C}>, ${v}>;
        ${Z.declareVariables(...le,W)}
        ${Z.mainStart([C,v,1])}
          let output_indices = ${W.offsetToIndices(`workgroup_index * ${v}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${S} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${g};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${g}; a_offset += ${x})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${X.getByIndices(`${X.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${X.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${S} + local_id.x;
            ${ne?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${ne.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${F}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${F}(8);`}
            let scale = ${j.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${ie.getByIndices(`${ie.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${t.blockSize/f};
            for (var i: u32 = 0; i < ${p}; i++) {
              ${H()}
              let b_value = ${p===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${F}>(${Array.from({length:4},(B,ee)=>`${F}(b_value_lower[${ee}]), ${F}(b_value_upper[${ee}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${F}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(B,ee)=>`${`dot(a_data${ee}, b_dequantized_values[${ee}])`}`).join(" + ")};
              word_offset += ${8/f};
            }
            workgroupBarrier();
          }

          if (local_idx < ${v}) {
            var output_value: ${W.type.value} = ${W.type.value}(0);
            for (var b = 0u; b < ${C}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${W.setByIndices(`${W.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${t.blockSize};${f};${p};${C};${v}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:w,dataType:c}],dispatchGroup:{x:E},programUniforms:A}),getShaderSource:U}},CL=(e,t)=>{qC(e.inputs,t),t.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(KC(e.inputs,t)):e.compute(WC(e.inputs,t))},kL=e=>Jt(e)}),HC,GC,QC,ZC,YC,XC,JC,ek,EL,KY=Oe(()=>{mt(),_t(),St(),HC=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},GC=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
            k = i32(${e.indicesGet("indices",i)}) - ${ut("uniforms.pads",i,r)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${ut("uniforms.x_shape",i,t)})) {
              break;
            }
            offset += k * i32(${ut("uniforms.x_strides",i,t)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${n}
            value = x[offset];
          }
      `},QC=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
                k = i32(${e.indicesGet("indices",i)}) - ${ut("uniforms.pads",i,r)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${ut("uniforms.x_shape",i,t)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${ut("uniforms.x_shape",i,t)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${ut("uniforms.x_strides",i,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},ZC=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
                k = i32(${e.indicesGet("indices",i)}) - ${ut("uniforms.pads",i,r)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${ut("uniforms.x_shape",i,t)})) {
                  k = i32(${ut("uniforms.x_shape",i,t)}) - 1;
                }
                offset += k * i32(${ut("uniforms.x_strides",i,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},YC=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
                k = i32(${e.indicesGet("indices",i)}) - ${ut("uniforms.pads",i,r)};
                if (k < 0)  {
                  k += i32(${ut("uniforms.x_shape",i,t)}]);
                }
                if (k >= i32(${ut("uniforms.x_shape",i,t)})) {
                  k -= i32(${ut("uniforms.x_shape",i,t)});
                }
                offset += k * i32(${ut("uniforms.x_strides",i,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},XC=(e,t,r)=>{switch(r.mode){case 0:return GC(e,t,r.pads.length);case 1:return QC(e,t,r.pads.length);case 2:return ZC(e,t,r.pads.length);case 3:return YC(e,t,r.pads.length);default:throw new Error("Invalid mode")}},JC=(e,t)=>{let r=xe.padShape(e[0].dims.slice(),t.pads),n=e[0].dims,i=xe.size(r),s=[{type:12,data:i},{type:6,data:t.pads}],a=e.length>=3&&e[2].data;t.mode===0&&s.push({type:a?e[2].dataType:1,data:t.value}),s.push(...ct(e[0].dims,r));let o=["rank"],l=u=>{let c=at("output",e[0].dataType,r.length),f=Ce("x",e[0].dataType,n.length),p=f.type.value,w=XC(c,n.length,t),x=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&x.push({name:"constant_value",type:a?p:"f32"}),`
            ${u.registerUniforms(x).declareVariables(f,c)}
            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${c.offsetToIndices("global_idx")};

            var value = ${p}(0);
            ${w}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}${a}`,inputDependencies:o},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(xe.size(r)/64)},programUniforms:s}),getShaderSource:l}},ek=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),n=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,i=e[0].dims.length,s=new Int32Array(2*i).fill(0);if(e.length>=4){let o=e[3].getBigInt64Array();for(let l=0;l<o.length;l++)s[Number(o[l])]=Number(r[l]),s[Number(o[l])+i]=Number(r[l+o.length])}else r.forEach((o,l)=>s[Number(l)]=Number(o));let a=[];return s.forEach(o=>a.push(o)),{mode:t.mode,value:n,pads:a}}else return t},EL=(e,t)=>{HC(e.inputs);let r=ek(e.inputs,t);e.compute(JC(e.inputs,r),{inputs:[0]})}}),Td,Rv,Ov,Dv,jv,tk,rk,Mv,zv,TL,IL,Fv,NL,PL,Lv,AL,RL,OL,DL,HY=Oe(()=>{Di(),mt(),_t(),St(),Td=e=>{if(mr.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Rv=(e,t,r)=>{let n=t.format==="NHWC",i=e.dims.slice();n&&i.splice(1,0,i.pop());let s=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),o=t.strides.slice(),l=s?t.dilations.slice():[],u=t.pads.slice();Jm.adjustPoolAttributes(r,i,a,o,l,u);let c=Jm.computePoolOutputShape(r,i,o,l,a,u,t.autoPad),f=Object.assign({},t);s?Object.assign(f,{kernelShape:a,strides:o,pads:u,dilations:l,cacheKey:t.cacheKey}):Object.assign(f,{kernelShape:a,strides:o,pads:u,cacheKey:t.cacheKey});let p=c.slice();return p.push(p.splice(1,1)[0]),[f,n?p:c]},Ov=(e,t)=>{let r=t.format==="NHWC",n=xe.size(e),i=xe.size(t.kernelShape),s=[{type:12,data:n},{type:12,data:i}],a=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let o=t.kernelShape[t.kernelShape.length-1],l=t.strides[t.strides.length-1],u=t.pads[t.pads.length/2-1],c=t.pads[t.pads.length-1],f=!!(u+c);s.push({type:12,data:o},{type:12,data:l},{type:12,data:u},{type:12,data:c}),a.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let p=!1;if(t.kernelShape.length===2){let w=t.kernelShape[t.kernelShape.length-2],x=t.strides[t.strides.length-2],v=t.pads[t.pads.length/2-2],C=t.pads[t.pads.length-2];p=!!(v+C),s.push({type:12,data:w},{type:12,data:x},{type:12,data:v},{type:12,data:C}),a.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,a,!0,f,p]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let o=xe.computeStrides(t.kernelShape);s.push({type:12,data:o},{type:12,data:t.pads},{type:12,data:t.strides}),a.push({name:"kernelStrides",type:"u32",length:o.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let l=t.pads.reduce((u,c)=>u+c);return[s,a,!!l,!1,!1]}},Dv=(e,t,r,n,i,s,a,o,l,u,c,f)=>{let p=i.format==="NHWC",w=t.type.value,x=at("output",t.type.tensor,n);if(i.kernelShape.length<=2){let v="",C="",b="",g=r-(p?2:1);if(c?v=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${g}] = indices[${g}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${g}] < 0 || xIndices[${g}]
                      >= uniforms.x_shape[${g}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${s}
                }`:v=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${g}] = indices[${g}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${s}
                }`,i.kernelShape.length===2){let S=r-(p?3:2);f?C=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${S}] = indices[${S}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${S}] < 0 || xIndices[${S}] >= uniforms.x_shape[${S}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:C=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${S}] = indices[${S}] * uniforms.sh - uniforms.phStart + j;
                `,b=`
              }
            `}return`
            ${e.registerUniforms(l).declareVariables(t,x)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${x.offsetToIndices("global_idx")};
              var xIndices = ${x.offsetToIndices("global_idx")};

              var value = ${w}(${o});
              var pad = 0;
              ${C}
              ${v}
              ${b}
              ${a}

              output[global_idx] = value;
            }`}else{if(p)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let v=i.kernelShape.length,C=i.pads.length,b="";return u?b=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${t.indicesToOffset("xIndices")}];
                ${s}
              }`:b=`
              }
              let x_val = x[${t.indicesToOffset("xIndices")}];
              ${s}
            `,`
            ${e.registerUniforms(l).declareVariables(t,x)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${x.offsetToIndices("global_idx")};
              var xIndices = ${x.offsetToIndices("global_idx")};

              var offsets: array<u32, ${v}>;

              var value = ${w}(${o});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${v-1}u; j++) {
                  offsets[j] = offset / ${ut("uniforms.kernelStrides","j",v)};
                  offset -= offsets[j] * ${ut("uniforms.kernelStrides","j",v)};
                }
                offsets[${v-1}] = offset;

                isPad = false;
                for (var j = ${r-v}u; j < ${r}u; j++) {
                  xIndices[j] = indices[j] * ${ut("uniforms.strides",`j - ${r-v}u`,v)}
                    + offsets[j - ${r-v}u] - ${ut("uniforms.pads","j - 2u",C)};
                  ${b}
              }
              ${a}

              output[global_idx] = value;
            }`}},jv=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,tk=e=>`${jv(e)};${e.countIncludePad}`,rk=e=>`${jv(e)};${e.storageOrder};${e.dilations}`,Mv=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),zv=(e,t,r,n)=>{let[i,s]=Rv(t,n,r),a=Ce("x",t.dataType,t.dims.length),o=a.type.value,l="value += x_val;",u="";i.countIncludePad?u+=`value /= ${o}(uniforms.kernelSize);`:u+=`value /= ${o}(i32(uniforms.kernelSize) - pad);`;let[c,f,p,w,x]=Ov(s,i);c.push(...ct(t.dims,s));let v=["rank"];return{name:e,shaderCache:{hint:`${n.cacheKey};${p};${w};${x}`,inputDependencies:v},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(xe.size(s)/64)},programUniforms:c}),getShaderSource:C=>Dv(C,a,t.dims.length,s.length,i,l,u,0,f,p,w,x)}},TL=e=>{let t=e.count_include_pad!==0,r=Mv(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let n={countIncludePad:t,...r,cacheKey:""};return{...n,cacheKey:tk(n)}},IL=(e,t)=>{Td(e.inputs),e.compute(zv("AveragePool",e.inputs[0],!1,t))},Fv={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},NL=e=>{let t=e.format;return{format:t,...Fv,cacheKey:t}},PL=(e,t)=>{Td(e.inputs),e.compute(zv("GlobalAveragePool",e.inputs[0],!0,t))},Lv=(e,t,r,n)=>{let[i,s]=Rv(t,n,r),a=`
      value = max(x_val, value);
    `,o="",l=Ce("x",t.dataType,t.dims.length),u=["rank"],[c,f,p,w,x]=Ov(s,i);return c.push(...ct(t.dims,s)),{name:e,shaderCache:{hint:`${n.cacheKey};${p};${w};${x}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(xe.size(s)/64)},programUniforms:c}),getShaderSource:v=>Dv(v,l,t.dims.length,s.length,i,a,o,t.dataType===10?-65504:-1e5,f,p,w,x)}},AL=(e,t)=>{Td(e.inputs),e.compute(Lv("MaxPool",e.inputs[0],!1,t))},RL=e=>{let t=e.storage_order,r=e.dilations,n=Mv(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(n.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:t,dilations:r,...n,cacheKey:""};return{...i,cacheKey:rk(i)}},OL=e=>{let t=e.format;return{format:t,...Fv,cacheKey:t}},DL=(e,t)=>{Td(e.inputs),e.compute(Lv("GlobalMaxPool",e.inputs[0],!0,t))}}),nk,ik,jL,ML,GY=Oe(()=>{mt(),_t(),Rr(),St(),nk=(e,t)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((r,n)=>r===e[2].dims[n]).reduce((r,n)=>r&&n,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((i,s)=>s===t.axis||i===e[0].dims[s]).reduce((i,s)=>i&&s,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let r=e[0].dims[t.axis],n=e[1].dims[t.axis];if(t.blockSize<Math.ceil(r/n)||t.blockSize>Math.ceil(r/(n-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},ik=(e,t)=>{let r=xe.normalizeAxis(t.axis,e[0].dims.length),n=e[0].dataType,i=n===3,s=e[0].dims,a=e[1].dataType,o=xe.size(s),l=n===3||n===2,u=l?[Math.ceil(xe.size(e[0].dims)/4)]:e[0].dims,c=e[1].dims,f=e.length>2?e[2]:void 0,p=f?l?[Math.ceil(xe.size(f.dims)/4)]:f.dims:void 0,w=c.length===0||c.length===1&&c[0]===1,x=w===!1&&c.length===1,v=kr(o),C=w&&(!l||v===4),b=C?v:1,g=C&&!l?v:1,S=Ce("input",l?12:n,u.length,g),E=Ce("scale",a,c.length),A=f?Ce("zero_point",l?12:n,p.length):void 0,M=at("output",a,s.length,b),D=[S,E];A&&D.push(A);let I=[u,c];f&&I.push(p);let U=[{type:12,data:o/b},{type:12,data:r},{type:12,data:t.blockSize},...ct(...I,s)],Z=ue=>{let X=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${ue.registerUniforms(X).declareVariables(...D,M)}
      ${ue.mainStart()}
          ${ue.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${M.offsetToIndices("global_idx")};

          // Set input x
          ${l?`
            let input = ${S.getByOffset("global_idx / 4")};
            let x_vec = ${i?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${b===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${S.getByOffset("global_idx")};`};

          // Set scale input
          ${w?`let scale_value= ${E.getByOffset("0")}`:x?`
            let scale_index = ${M.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${E.getByOffset("scale_index")};`:`
            var scale_indices: ${E.type.indices} = output_indices;
            let index = ${E.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${E.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${E.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${A?w?l?`
                let zero_point_input = ${A.getByOffset("0")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${A.getByOffset("0")}`:x?l?`
                let zero_point_index = ${M.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${A.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${M.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${A.getByOffset("zero_point_index")};`:l?`
                let zero_point_offset = ${E.indicesToOffset("scale_indices")};
                let zero_point_input = ${A.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${A.getByIndices("scale_indices")};`:`let zero_point_value = ${l?i?"i32":"u32":S.type.value}(0);`};
      // Compute and write output
      ${M.setByOffset("global_idx",`${M.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:A?["rank","rank","rank"]:["rank","rank"]},getShaderSource:Z,getRunData:()=>({outputs:[{dims:s,dataType:a}],dispatchGroup:{x:Math.ceil(o/b/64),y:1,z:1},programUniforms:U})}},jL=(e,t)=>{nk(e.inputs,t),e.compute(ik(e.inputs,t))},ML=e=>Jt({axis:e.axis,blockSize:e.blockSize})}),sk,ak,zL,QY=Oe(()=>{Di(),mt(),St(),sk=(e,t,r)=>{let n=e===t,i=e<t&&r<0,s=e>t&&r>0;if(n||i||s)throw new Error("Range these inputs' contents are invalid.")},ak=(e,t,r,n)=>{let i=Math.abs(Math.ceil((t-e)/r)),s=[i],a=i,o=[{type:12,data:a},{type:n,data:e},{type:n,data:r},...ct(s)],l=u=>{let c=at("output",n,s.length),f=c.type.value,p=[{name:"outputSize",type:"u32"},{name:"start",type:f},{name:"delta",type:f}];return`
        ${u.registerUniforms(p).declareVariables(c)}
        ${u.mainStart()}
        ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${f}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${n}`},getShaderSource:l,getRunData:()=>({outputs:[{dims:s,dataType:n}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:o})}},zL=e=>{let t=0,r=0,n=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],n=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],n=e.inputs[2].getFloat32Array()[0]),mr.webgpu.validateInputContent&&sk(t,r,n),e.compute(ak(t,r,n,e.inputs[0].dataType),{inputs:[]})}}),ok,lk,FL,LL,ZY=Oe(()=>{mt(),_t(),Rr(),St(),ok=(e,t,r,n)=>{if(e!=="none"&&n!=="i32"&&n!=="u32"&&n!=="f32")throw new Error(`Input ${n} is not supported with reduction ${e}.`);let i=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,s=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${t}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${t}=${r};`;case"add":return n==="i32"||n==="u32"?`atomicAdd(&${t}, bitcast<${n}>(${r}));`:`
              ${i}bitcast<${n}>(oldValue) + (${r})${s}`;case"max":return n==="i32"||n==="u32"?`atomicMax(&${t}, bitcast<${n}>(${r}));`:`
                ${i}max(bitcast<f32>(oldValue), (${r}))${s}`;case"min":return n==="i32"||n==="u32"?`atomicMin(&${t}, bitcast<${n}>(${r}));`:`${i}min(bitcast<${n}>(oldValue), (${r}))${s}`;case"mul":return`${i}(bitcast<${n}>(oldValue) * (${r}))${s}`;default:throw new Error(`Reduction ${e} is not supported.`)}},lk=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r,s=1,a=Math.ceil(xe.sizeToDimension(n,n.length-1)/s),o=n[n.length-1],l=xe.sizeFromDimension(r,o),u=[{type:12,data:a},{type:12,data:o},{type:12,data:l},...ct(e[1].dims,e[2].dims,i)],c=f=>{let p=Ce("indices",e[1].dataType,e[1].dims.length),w=Ce("updates",e[2].dataType,e[2].dims.length,s),x=t.reduction!=="none"&&t.reduction!==""?h4("output",e[0].dataType,i.length):at("output",e[0].dataType,i.length,s);return`
      ${f.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(p,w,x)}
      ${f.mainStart()}
        ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var data_offset = 0u;
  let indices_start = uniforms.last_index_dimension * global_idx;
  let indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${e[0].dims.length===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[i - indices_start];
    let dim_value = uniforms.output_shape[i - indices_start];`}
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));
  }

  for (var i = 0u; i < uniforms.num_updates_elements; i++) {
    let value = updates[uniforms.num_updates_elements * global_idx + i];
    ${ok(t.reduction,"output[data_offset + i]","value",x.type.value)}
  }

      }`};return{name:"ScatterND",shaderCache:{hint:`${t.cacheKey}_${t.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}),getShaderSource:c}},FL=e=>Jt({reduction:e.reduction}),LL=(e,t)=>{e.compute(lk(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),uk,ck,dk,Bv,fk,pk,hk,mk,gk,yk,vk,wk,Uv,bk,xk,_k,$k,Sk,BL,UL,YY=Oe(()=>{mt(),_t(),Rr(),St(),uk=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},ck=(e,t,r)=>{t.every(i=>i>=0&&i<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let n=new Array(r).fill(1);return t.forEach((i,s)=>n[i]=e[s]),n},dk=(e,t,r,n,i,s)=>{let[a,o,l]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],u=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach(c=>s.push(c));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(o>0&&e.length>o&&e[o].dims.length===1&&e[o].dims[0]>0){if(e[o].getFloat32Array().forEach(c=>n.push(c)),n.length!==0&&n.length!==u&&r>=18&&n.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");uk(n,t),t.axes.length>0&&ck(n,t.axes,u).forEach((c,f)=>n[f]=c)}if(l>0&&e.length>l&&e[l].dims.length===1&&e[l].dims[0]>0&&(e[l].getBigInt64Array().forEach(c=>i.push(Number(c))),i.length!==0&&i.length!==u&&r>=18&&i.length!==t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(n.length!==0&&n.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==0&&i.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof n<"u"&&typeof i<"u"&&n.length>0&&i.length>u)throw new Error("Resize requires only of scales or sizes to be specified")},Bv=(e,t,r,n)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${t});
  let whole = ${n}(big / (${r}));
  let fract = ${n}(big % (${r})) / ${n}(${r});
  return whole + fract;
`,fk=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${t}(xResized) / ${t}(xScale);
          } else {
            ${Bv("xResized","lengthOriginal","lengthResized",t)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${Bv("xResized","lengthOriginal - 1","lengthResized - 1",t)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +
                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /
                        ${t}(lengthResized - 1);
                  } else {
                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);
                  const adjustment = ${t}(lengthResized) / outputWidth;
                  const center = ${t}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",pk=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",hk=(e,t,r)=>{let n=new Array(r).fill(0).concat(new Array(r).fill(1)),i=e.length===0?n:e.slice();return t.length>0?(t.forEach((s,a)=>{n[s]=i[a],n[a+r]=i[t.length+a]}),n):i},mk=(e,t,r,n)=>{let i=[];if(r.length>0)if(n.length>0){if(e.forEach(s=>i.push(s)),Math.max(...n)>e.length)throw new Error("axes is out of bound");n.forEach((s,a)=>i[s]=r[a])}else r.forEach(s=>i.push(s));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");i=e.map((s,a)=>Math.round(s*t[a]))}return i},gk=(e,t,r)=>{let n=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(s=>t[s]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(s=>t[s]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let i=e.slice();return r.axes.length>0?(r.axes.forEach(s=>t[s]=n),r.axes.forEach(s=>i[s]=Math.round(e[s]*t[s]))):(t.fill(n,0,t.length),i.forEach((s,a)=>i[a]=Math.round(s*t[a]))),i},yk=(e,t,r,n,i)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {
      var original_indices: array<${e.type.value}, ${r.length}>;
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${ut("uniforms.scales","i",n)};
        var roi_low = ${ut("uniforms.roi","i",i)};
        var roi_hi = ${ut("uniforms.roi",`i + ${t.length}`,i)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${ut("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${ut("uniforms.output_shape","i",r.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,vk=(e,t,r,n,i,s,a)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${ut("uniforms.scales","i",i)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${ut("uniforms.roi","i",s)};
          var roi_hi = ${ut("uniforms.roi",`i + ${r.length}`,s)};
          var input_shape_i = ${ut("uniforms.input_shape","i",r.length)};
          var output_shape_i = ${ut("uniforms.output_shape","i",n.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${a} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,wk=(e,t)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${ut("uniforms.input_shape","i",t.length)}) {
          return false;
        }
      }
      return true;
    }`,Uv=(e,t,r,n)=>e.rank>n?`
    ${e.indicesSet("input_indices",t,"channel")};
    ${e.indicesSet("input_indices",r,"batch")};
`:"",bk=(e,t,r,n,i)=>{let[s,a,o,l]=r.length===2?[-1,0,1,-1]:[0,2,3,1],u=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${u} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",a,`max(0, min(row, ${r[a]} - 1))`)};
      ${e.indicesSet("input_indices",o,`max(0, min(col, ${r[o]} - 1))`)};
      ${Uv(e,l,s,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${u} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${u} = originalIndices[${a}];
      var col:${u} = originalIndices[${o}];
      ${n?`if (row < 0 || row > (${r[a]} - 1) || col < 0 || col > (${r[o]} - 1)) {
        return ${i};
      }`:""};
      row = max(0, min(row, ${r[a]} - 1));
      col = max(0, min(col, ${r[o]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${r.length>2?`u32(originalIndices[${l}])`:"0"};
      var batch: u32 =  ${r.length>2?`u32(originalIndices[${s}])`:"0"};
      var x11: ${u} = getInputValue(batch, channel, row1, col1);
      var x12: ${u} = getInputValue(batch, channel, row1, col2);
      var x21: ${u} = getInputValue(batch, channel, row2, col1);
      var x22: ${u} = getInputValue(batch, channel, row2, col2);
      var dx1: ${u} = abs(row - ${u}(row1));
      var dx2: ${u} = abs(${u}(row2) - row);
      var dy1: ${u} = abs(col - ${u}(col1));
      var dy2: ${u} = abs(${u}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},xk=(e,t,r,n,i,s,a,o,l,u)=>{let c=r.length===2,[f,p]=c?[0,1]:[2,3],w=e.type.value,x=v=>{let C=v===f?"row":"col";return`
      fn ${C}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${w} {
        var output_index = ${t.indicesGet("output_indices",v)};
        var originalIdx: ${w} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[v]},
        ${n[v]}, ${r[v]}, ${s[v]}, ${s[v]} + ${r.length});
        var fractOriginalIdx: ${w} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${o} && (originalIdx < 0 || originalIdx > (${r[v]} - 1))) {
          return ${l};
        }
        var data: array<${w}, 4> = array<${w}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${C}: ${w} = originalIdx + ${w}(i);
          if (${C} < 0 || ${C} >= ${r[v]}) {
            ${u?`coefs[i + 1] = 0.0;
                        continue;`:o?`return ${l};`:`${C} = max(0, min(${C}, ${r[v]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",v,`u32(${C})`)};
          data[i + 1] = ${v===f?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${x(f)};
    ${x(p)};
  fn getCubicInterpolationCoefs(s: ${w}) -> array<${w}, 4> {
    var absS = abs(s);
    var coeffs: array<${w}, 4> = array<${w}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${w} = 1.0 - absS;
    var twoMinusAbsS: ${w} = 2.0 - absS;
    var onePlusAbsS: ${w} = 1.0 + absS;
    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};
    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;
    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${w}, 4>, coefs: array<${w}, 4>) -> ${w} {
    var coefsSum: ${w} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${w} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},_k=(e,t,r,n,i)=>{let[s,a,o,l,u]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],c=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${c} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",a,`max(0, min(depth, ${r[a]} - 1))`)};
      ${e.indicesSet("input_indices",o,`max(0, min(height, ${r[o]} - 1))`)};
      ${e.indicesSet("input_indices",l,`max(0, min(width, ${r[l]} - 1))`)};
      ${Uv(e,u,s,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${c} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${c} = originalIndices[${a}];
      var height:${c} = originalIndices[${o}];
      var width:${c} = originalIndices[${l}];
      ${n?`if (depth < 0 || depth > (${r[a]} - 1) || height < 0 || height > (${r[o]} - 1) || width < 0 || (width > ${r[l]} - 1)) {
      return ${i};
        }`:""};

    depth = max(0, min(depth, ${r[a]} - 1));
      height = max(0, min(height, ${r[o]} - 1));
      width = max(0, min(width, ${r[l]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${r.length>3?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${r.length>3?`u32(originalIndices[${s}])`:"0"};

      var x111: ${c} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${c} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${c} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${c} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${c} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${c} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${c} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${c} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${c} = abs(depth - ${c}(depth1));
      var dx2: ${c} = abs(${c}(depth2) - depth);
      var dy1: ${c} = abs(height - ${c}(height1));
      var dy2: ${c} = abs(${c}(height2) - height);
      var dz1: ${c} = abs(width - ${c}(width1));
      var dz2: ${c} = abs(${c}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},$k=(e,t,r,n,i,s)=>{let a=e.dims,o=hk(s,t.axes,a.length),l=mk(a,n,i,t.axes),u=n.slice();n.length===0&&(u=a.map((g,S)=>g===0?1:l[S]/g),t.keepAspectRatioPolicy!=="stretch"&&(l=gk(a,u,t)));let c=at("output",e.dataType,l.length),f=Ce("input",e.dataType,a.length),p=xe.size(l),w=a.length===l.length&&a.every((g,S)=>g===l[S]),x=t.coordinateTransformMode==="tf_crop_and_resize",v=t.extrapolationValue,C=f.type.value,b=g=>`
      ${w?"":`
      ${fk(t.coordinateTransformMode,C)};
      ${(()=>{switch(t.mode){case"nearest":return`
              ${wk(f,a)};
              ${pk(t.nearestMode,r,C)};
              ${vk(f,c,a,l,u.length,o.length,x)};
              `;case"linear":return`
              ${yk(c,a,l,u.length,o.length)};
              ${(()=>{if(a.length===2||a.length===4)return`${bk(f,c,a,x,v)}`;if(a.length===3||a.length===5)return`${_k(f,c,a,x,v)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(a.length===2||a.length===4)return`${xk(f,c,a,l,u,o,t.cubicCoeffA,x,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${g.registerUniform("output_size","u32").registerUniform("scales","f32",u.length).registerUniform("roi","f32",o.length).declareVariables(f,c)}
      ${g.mainStart()}
        ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${w?"output[global_idx] = input[global_idx];":`
        let output_indices = ${c.offsetToIndices("global_idx")};
        var input_indices: ${f.type.indices};
        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${f.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${t.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${a.length===2||a.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${u.length>0?t.mode==="cubic"?u:u.length:""}|${i.length>0?i:""}|${o.length>0?o:""}|${w}|${t.mode==="nearest"?a.length:a}`,inputDependencies:["rank"]},getShaderSource:b,getRunData:()=>({outputs:[{dims:l,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},{type:1,data:u},{type:1,data:o},...ct(a,l)]})}},Sk=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},BL=(e,t)=>{let r=[],n=[],i=[],s=Sk(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");dk(e.inputs,t,s,r,n,i),e.compute($k(e.inputs[0],t,s,r,n,i),{inputs:[0]})},UL=e=>{let t=e.antialias,r=e.axes,n=e.coordinateTransformMode,i=e.cubicCoeffA,s=e.excludeOutside!==0,a=e.extrapolationValue,o=e.keepAspectRatioPolicy,l=e.mode,u=e.nearestMode===""?"simple":e.nearestMode;return Jt({antialias:t,axes:r,coordinateTransformMode:n,cubicCoeffA:i,excludeOutside:s,extrapolationValue:a,keepAspectRatioPolicy:o,mode:l,nearestMode:u})}}),Ck,kk,VL,XY=Oe(()=>{mt(),_t(),St(),Ck=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dataType!==r.dataType||t.dataType!==n.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let i=t.dims[t.dims.length-1],s=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(n.dims.length!==1)throw new Error("Gamma must be 1D");if(n.dims[n.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let a=e[3];if(a.dims.length!==1)throw new Error("Beta must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let a=e[4];if(a.dims.length!==1)throw new Error("Bias must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},kk=(e,t,r,n)=>{let i=t.simplified,s=e[0].dims,a=xe.size(s),o=s,l=a,u=s.slice(-1)[0],c=n?s.slice(0,-1).concat(1):[],f=!i&&e.length>3,p=e.length>4,w=n&&r>1,x=n&&r>2,v=r>3,C=64,b=kr(u),g=[{type:12,data:l},{type:12,data:b},{type:12,data:u},{type:1,data:t.epsilon}],S=A=>{let M=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],D=[Ce("x",e[0].dataType,e[0].dims,b),Ce("skip",e[1].dataType,e[1].dims,b),Ce("gamma",e[2].dataType,e[2].dims,b)];f&&D.push(Ce("beta",e[3].dataType,e[3].dims,b)),p&&D.push(Ce("bias",e[4].dataType,e[4].dims,b)),D.push(at("output",e[0].dataType,o,b)),w&&D.push(at("mean_output",1,c)),x&&D.push(at("inv_std_output",1,c)),v&&D.push(at("input_skip_bias_sum",e[0].dataType,o,b));let I=en(e[0].dataType),U=en(1,b);return`

      ${A.registerUniforms(M).declareVariables(...D)}
      var<workgroup> sum_shared : array<${U}, ${C}>;
      var<workgroup> sum_squared_shared : array<${U}, ${C}>;

      ${A.mainStart([C,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${C};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${C};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${C-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${p?"bias[offset1d + i]":I+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${v?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Du(I,b,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${C};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${ko("sum",b)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${ko("square_sum",b)} / f32(uniforms.hidden_size) ${i?"":"- mean * mean"} + uniforms.epsilon);
        ${w?"mean_output[global_idx] = mean;":""}
        ${x?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${i?"":`- ${I}(mean)`}) *
            ${I}(inv_std_dev) * gamma[offset1d + i]
            ${f?"+ beta[offset1d + i]":""};
        }
      }`},E=[{dims:o,dataType:e[0].dataType}];return r>1&&E.push({dims:c,dataType:1}),r>2&&E.push({dims:c,dataType:1}),r>3&&E.push({dims:s,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${b};${w};${x};${v}`,inputDependencies:e.map((A,M)=>"type")},getShaderSource:S,getRunData:()=>({outputs:E,dispatchGroup:{x:Math.ceil(l/u)},programUniforms:g})}},VL=(e,t)=>{Ck(e.inputs);let r=[0];e.outputCount>1&&r.push(-3),e.outputCount>2&&r.push(-3),e.outputCount>3&&r.push(3),e.compute(kk(e.inputs,t,e.outputCount,!1),{outputs:r})}}),Ek,Id,Tk,Vv,Ik,Nk,qL,WL,JY=Oe(()=>{mt(),_t(),Rr(),St(),Ek=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,n)=>{if(e[n+1].dataType!==6&&e[n+1].dataType!==7)throw new Error(`Input ${n} must be an array of int32 or int64`)})},Id=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(n=>r.push(Number(n)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(n=>r.push(Number(n)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},Tk=(e,t)=>{if(e.length>1){let r=Id(e,1),n=Id(e,2),i=Id(e,3);return i.length===0&&(i=[...Array(e[0].dims.length).keys()]),Jt({starts:r,ends:n,axes:i})}else return t},Vv=(e,t,r,n,i)=>{let s=e;return e<0&&(s+=r[n[t]]),i[t]<0?Math.max(0,Math.min(s,r[n[t]]-1)):Math.max(0,Math.min(s,r[n[t]]))},Ik=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${r.length-1}; i >= 0; i--) {
            let input_shape_i = ${ut("uniforms.input_shape","i",r.length)};
            let steps_i = ${ut("uniforms.steps","i",r.length)};
            let signs_i = ${ut("uniforms.signs","i",r.length)};
            let starts_i = ${ut("uniforms.starts","i",r.length)};
            var output_index = ${t.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,Nk=(e,t)=>{let r=e[0].dims,n=xe.size(r),i=t.axes.length>0?xe.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],s=Id(e,4);s.forEach(b=>b!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(i.length).fill(1));let a=t.starts.map((b,g)=>Vv(b,g,r,i,s)),o=t.ends.map((b,g)=>Vv(b,g,r,i,s));if(i.length!==a.length||i.length!==o.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(let b=0;b<r.length;++b)i.includes(b)||(a.splice(b,0,0),o.splice(b,0,r[b]),s.splice(b,0,1));let l=s.map(b=>Math.sign(b));s.forEach((b,g,S)=>{if(b<0){let E=(o[g]-a[g])/b,A=a[g],M=A+E*s[g];a[g]=M,o[g]=A,S[g]=-b}});let u=r.slice(0);i.forEach((b,g)=>{u[b]=Math.ceil((o[b]-a[b])/s[b])});let c={dims:u,dataType:e[0].dataType},f=at("output",e[0].dataType,u.length),p=Ce("input",e[0].dataType,e[0].dims.length),w=xe.size(u),x=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:l.length},{name:"steps",type:"u32",length:s.length}],v=[{type:12,data:w},{type:12,data:a},{type:6,data:l},{type:12,data:s},...ct(e[0].dims,u)],C=b=>`
      ${b.registerUniforms(x).declareVariables(p,f)}
        ${Ik(p,f,r)}
        ${b.mainStart()}
          ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${f.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${f.setByOffset("global_idx",p.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${l.length}_${a.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:C,getRunData:()=>({outputs:[c],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:v})}},qL=(e,t)=>{Ek(e.inputs,t);let r=Tk(e.inputs,t);e.compute(Nk(e.inputs,r),{inputs:[0]})},WL=e=>{let t=e.starts,r=e.ends,n=e.axes;return Jt({starts:t,ends:r,axes:n})}}),Pk,Ak,KL,HL,eX=Oe(()=>{mt(),_t(),Rr(),Ro(),St(),Pk=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Ak=(e,t)=>{let r=e.inputs[0],n=r.dims,i=xe.size(n),s=n.length,a=xe.normalizeAxis(t.axis,s),o=a<n.length-1,l,u=[];o?(u=Array.from({length:s},(D,I)=>I),u[a]=s-1,u[s-1]=a,l=e.compute(mi(r,u),{inputs:[r],outputs:[-1]})[0]):l=r;let c=l.dims,f=c[s-1],p=i/f,w=kr(f),x=f/w,v=64;p===1&&(v=256);let C=(D,I)=>I===4?`max(max(${D}.x, ${D}.y), max(${D}.z, ${D}.w))`:I===2?`max(${D}.x, ${D}.y)`:I===3?`max(max(${D}.x, ${D}.y), ${D}.z)`:D,b=Ce("x",l.dataType,l.dims,w),g=at("result",l.dataType,l.dims,w),S=b.type.value,E=en(l.dataType)==="f32"?`var threadMax = ${S}(-3.4028234663852886e+38f);`:`var threadMax = ${S}(-65504.0h);`,A=D=>`
      var<workgroup> rowMaxShared : ${S};
      var<workgroup> rowSumShared : ${S};
      var<workgroup> threadShared : array<${S}, ${v}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${S} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${S}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${D.registerUniform("packedCols","i32").declareVariables(b,g)}
      ${D.mainStart(v)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${v};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${E}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${S}(${C("threadShared[0]",w)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${S}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${S}(${ko("threadShared[0]",w)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          var value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          // max operation protects against NaN since all values should be >=0
          value = max(value, ${S}(0.0));
          setValue(row, col, row_stride, value);
        }
      }`,M=e.compute({name:"Softmax",shaderCache:{hint:`${w};${v}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:c,dataType:l.dataType}],dispatchGroup:{x:p},programUniforms:[{type:6,data:x}]}),getShaderSource:A},{inputs:[l],outputs:[o?-1:0]})[0];o&&e.compute(mi(M,u),{inputs:[M]})},KL=(e,t)=>{Pk(e.inputs),Ak(e,t)},HL=e=>Jt({axis:e.axis})}),qv,Rk,Ok,Dk,GL,tX=Oe(()=>{mt(),_t(),St(),qv=e=>Array.from(e.getBigInt64Array(),Number),Rk=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(qv(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Ok=(e,t)=>{let r=[];for(let n=0;n<e.length;++n)r.push(e[n]*t[n]);return r},Dk=(e,t)=>{let r=e[0].dims,n=t??qv(e[1]),i=Ok(r,n),s=xe.size(i),a=e[0].dataType,o=Ce("input",a,r.length),l=at("output",a,i.length),u=c=>`
      const inputShape = ${o.indices(...r)};
      ${c.registerUniform("output_size","u32").declareVariables(o,l)}
      ${c.mainStart()}
      ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${l.offsetToIndices("global_idx")};
      var input_indices: ${o.type.indices};
      for (var i = 0; i < ${r.length}; i++) {
        let input_dim_i = ${o.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${l.indicesGet("output_indices","i")}  % input_dim_i;

        ${o.indicesSet("input_indices","i","input_dim_value")}
      }
      ${l.setByOffset("global_idx",o.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${n}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:[{type:12,data:s},...ct(e[0].dims,i)]}),getShaderSource:u}},GL=e=>{Rk(e.inputs),e.compute(Dk(e.inputs),{inputs:[0]})}}),jk,Mk,QL,rX=Oe(()=>{mt(),_t(),St(),jk=(e,t,r,n,i)=>{let s=at("output_data",i,r.length,4),a=Ce("a_data",t[1].dataType,t[1].dims.length,4),o=Ce("b_data",t[2].dataType,t[2].dims.length,4),l=Ce("c_data",t[0].dataType,t[0].dims.length,4),u,c=(f,p,w)=>`select(${p}, ${f}, ${w})`;if(!n)u=s.setByOffset("global_idx",c(a.getByOffset("global_idx"),o.getByOffset("global_idx"),l.getByOffset("global_idx")));else{let f=(p,w,x="")=>{let v=`a_data[index_a${w}][component_a${w}]`,C=`b_data[index_b${w}][component_b${w}]`,b=`bool(c_data[index_c${w}] & (0xffu << (component_c${w} * 8)))`;return`
            let output_indices${w} = ${s.offsetToIndices(`global_idx * 4u + ${w}u`)};
            let offset_a${w} = ${a.broadcastedIndicesToOffset(`output_indices${w}`,s)};
            let offset_b${w} = ${o.broadcastedIndicesToOffset(`output_indices${w}`,s)};
            let offset_c${w} = ${l.broadcastedIndicesToOffset(`output_indices${w}`,s)};
            let index_a${w} = offset_a${w} / 4u;
            let index_b${w} = offset_b${w} / 4u;
            let index_c${w} = offset_c${w} / 4u;
            let component_a${w} = offset_a${w} % 4u;
            let component_b${w} = offset_b${w} % 4u;
            let component_c${w} = offset_c${w} % 4u;
            ${p}[${w}] = ${x}(${c(v,C,b)});
          `};i===9?u=`
            var data = vec4<u32>(0);
            ${f("data",0,"u32")}
            ${f("data",1,"u32")}
            ${f("data",2,"u32")}
            ${f("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:u=`
            ${f("output_data[global_idx]",0)}
            ${f("output_data[global_idx]",1)}
            ${f("output_data[global_idx]",2)}
            ${f("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(l,a,o,s)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${u}
      }`},Mk=e=>{let t=e[1].dims,r=e[2].dims,n=e[0].dims,i=e[1].dataType,s=!(xe.areEqual(t,r)&&xe.areEqual(r,n)),a=t,o=xe.size(t);if(s){let u=Cc.calcShape(Cc.calcShape(t,r,!1),n,!1);if(!u)throw new Error("Can't perform where op on the given tensors");a=u,o=xe.size(a)}let l=Math.ceil(o/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:u=>jk(u,e,a,s,i),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(o/64/4)},programUniforms:[{type:12,data:l},...ct(n,t,r,a)]})}},QL=e=>{e.compute(Mk(e.inputs))}}),ZL,nX=Oe(()=>{yY(),t1(),vY(),wY(),bY(),xY(),_Y(),EY(),IY(),NY(),PY(),AY(),RY(),OY(),DY(),jY(),MY(),zY(),FY(),LY(),BY(),UY(),VY(),qY(),WY(),mL(),KY(),HY(),GY(),QY(),ZY(),e1(),YY(),bL(),XY(),JY(),eX(),vL(),tX(),Ro(),r1(),rX(),ZL=new Map([["Abs",[V4]],["Acos",[q4]],["Acosh",[W4]],["Add",[CF]],["ArgMax",[F4,Mw]],["ArgMin",[z4,Mw]],["Asin",[K4]],["Asinh",[H4]],["Atan",[G4]],["Atanh",[Q4]],["Attention",[L4]],["AveragePool",[IL,TL]],["BatchNormalization",[B4]],["BiasAdd",[U4]],["BiasSplitGelu",[SF]],["Cast",[Y4,Z4]],["Ceil",[J4]],["Clip",[X4]],["Concat",[DF,jF]],["Conv",[Vw,Uw]],["ConvTranspose",[KF,WF]],["Cos",[eF]],["Cosh",[tF]],["CumSum",[HF,GF]],["DepthToSpace",[QF,ZF]],["DequantizeLinear",[jL,ML]],["Div",[kF]],["Einsum",[YF,XF]],["Elu",[rF,Gd]],["Equal",[EF]],["Erf",[nF]],["Exp",[iF]],["Expand",[JF]],["FastGelu",[eL]],["Floor",[sF]],["FusedConv",[Vw,Uw]],["Gather",[rL,tL]],["GatherElements",[lL,oL]],["GatherBlockQuantized",[sL,aL]],["GatherND",[nL,iL]],["Gelu",[aF]],["Gemm",[cL,uL]],["GlobalAveragePool",[PL,NL]],["GlobalMaxPool",[DL,OL]],["Greater",[PF]],["GreaterOrEqual",[RF]],["GridSample",[dL,fL]],["GroupQueryAttention",[xL]],["HardSigmoid",[hF,pF]],["InstanceNormalization",[_L]],["LayerNormalization",[$L]],["LeakyRelu",[oF,Gd]],["Less",[AF]],["LessOrEqual",[OF]],["Log",[_F]],["MatMul",[SL]],["MatMulNBits",[CL,kL]],["MaxPool",[AL,RL]],["Mul",[TF]],["MultiHeadAttention",[hL,pL]],["Neg",[uF]],["Not",[lF]],["Pad",[EL]],["Pow",[IF]],["QuickGelu",[$F,Gd]],["Range",[zL]],["Reciprocal",[cF]],["ReduceMin",[R4]],["ReduceMean",[T4]],["ReduceMax",[A4]],["ReduceSum",[D4]],["ReduceProd",[O4]],["ReduceL1",[I4]],["ReduceL2",[N4]],["ReduceLogSum",[M4]],["ReduceLogSumExp",[P4]],["ReduceSumSquare",[j4]],["Relu",[dF]],["Resize",[BL,UL]],["RotaryEmbedding",[wL]],["ScatterND",[LL,FL]],["Sigmoid",[fF]],["Sin",[mF]],["Sinh",[gF]],["Slice",[qL,WL]],["SkipLayerNormalization",[VL]],["Split",[gL,yL]],["Sqrt",[yF]],["Softmax",[KL,HL]],["Sub",[NF]],["Tan",[vF]],["Tanh",[wF]],["ThresholdedRelu",[xF,Gd]],["Tile",[GL]],["Transpose",[g4,y4]],["Where",[QL]]])}),YL,iX=Oe(()=>{Di(),Ia(),St(),YL=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r,n,i){Ws(e.programInfo.name);let s=this.backend.device,a=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let o=[];for(let u of t)o.push({binding:o.length,resource:{buffer:u.buffer}});for(let u of r)o.push({binding:o.length,resource:{buffer:u.buffer}});i&&o.push({binding:o.length,resource:i});let l=s.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:o,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let u={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:l,dispatchGroup:n};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(u)}a.setPipeline(e.computePipeline),a.setBindGroup(0,l),a.dispatchWorkgroups(...n),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),ds(e.programInfo.name)}dispose(){}build(e,t){Ws(e.name);let r=this.backend.device,n=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(u=>{r.features.has(u.feature)&&n.push(`enable ${u.extension};`)});let i=m4(t,this.backend.device.limits),s=e.getShaderSource(i),a=`${n.join(`
`)}
${i.additionalImplementations}
${s}`,o=r.createShaderModule({code:a,label:e.name});Lt("verbose",()=>`[WebGPU] ${e.name} shader code: ${a}`);let l=r.createComputePipeline({compute:{module:o,entryPoint:"main"},layout:"auto",label:e.name});return ds(e.name),{programInfo:e,computePipeline:l,uniformVariablesInfo:i.variablesInfo}}normalizeDispatchGroupSize(e){let t=typeof e=="number"?e:e.x,r=typeof e=="number"?1:e.y||1,n=typeof e=="number"?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&r<=i&&n<=i)return[t,r,n];let s=t*r*n,a=Math.ceil(Math.sqrt(s));if(a>i){if(a=Math.ceil(Math.cbrt(s)),a>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a]}else return[a,a,1]}}}),XL={};Mc(XL,{WebGpuBackend:()=>JL});var zk,Fk,Lk,JL,sX=Oe(()=>{Di(),mt(),Ia(),c4(),mY(),nX(),iX(),zk=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let n=0;n<e.length;++n){let i=e[n].dataType;switch(t[n]){case"none":{r.push("");break}case"type":{r.push(`${i}`);break}case"rank":{let s=e[n].dims.length;r.push(`${i};${s}`);break}case"dims":{let s=e[n].dims.join(",");r.push(`${i};${s}`);break}default:throw new Error(`unsupported input dependency: ${t[n]}`)}}return r.join("|")},Fk=(e,t,r)=>{var i,s;let n=e.name;return(i=e.shaderCache)!=null&&i.hint&&(n+="["+e.shaderCache.hint+"]"),n+=":"+r+`:${zk(t,((s=e.shaderCache)==null?void 0:s.inputDependencies)??new Array(t.length).fill("dims"))}`,n},Lk=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},JL=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let r=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r},i=s=>t.features.has(s)&&r.push(s)&&!0;i("chromium-experimental-timestamp-query-inside-passes")||i("timestamp-query"),i("shader-f16"),i("subgroups"),this.device=await t.requestDevice(n),this.adapterInfo=new Lk(t.info||await t.requestAdapterInfo()),this.gpuDataManager=p4(this),this.programManager=new YL(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Zx(e.logLevel,!!e.debug),this.device.onuncapturederror=s=>{s.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${s.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Ws(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{var n;let t=new BigUint64Array(e.getMappedRange()),r=this.pendingQueries.get(e);for(let i=0;i<t.length/2;i++){let s=r[i],a=s.kernelId,o=this.kernels.get(a),l=o.kernelType,u=o.kernelName,c=s.programName,f=s.inputTensorViews,p=s.outputTensorViews,w=t[i*2],x=t[i*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=w);let v=Number(w-this.queryTimeBase),C=Number(x-this.queryTimeBase);if(!Number.isSafeInteger(v)||!Number.isSafeInteger(C))throw new RangeError("incorrect timestamp range");if((n=this.env.webgpu.profiling)!=null&&n.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:f.map(b=>({dims:b.dims,dataType:ma(b.dataType)})),outputsMetadata:p.map(b=>({dims:b.dims,dataType:ma(b.dataType)})),kernelId:a,kernelType:l,kernelName:u,programName:c,startTime:v,endTime:C});else{let b="";f.forEach((S,E)=>{b+=`input[${E}]: [${S.dims}] | ${ma(S.dataType)}, `});let g="";p.forEach((S,E)=>{g+=`output[${E}]: [${S.dims}] | ${ma(S.dataType)}, `}),console.log(`[profiling] kernel "${a}|${l}|${u}|${c}" ${b}${g}start time: ${v} ns, execution time: ${C-v} ns`)}Zm("GPU",`${c}::${w}::${x}`)}e.unmap(),this.pendingQueries.delete(e)}),ds()}run(e,t,r,n,i,s){Ws(e.name);let a=[];for(let g=0;g<t.length;++g){let S=t[g].data;if(S===0)continue;let E=this.gpuDataManager.get(S);if(!E)throw new Error(`no GPU data for input: ${S}`);a.push(E)}let{outputs:o,dispatchGroup:l,programUniforms:u}=e.getRunData(t),c=r.length===0?o.map((g,S)=>S):r;if(c.length!==o.length)throw new Error(`Output size ${c.length} must be equal to ${o.length}.`);let f=[],p=[];for(let g=0;g<o.length;++g){if(!Number.isInteger(c[g])||c[g]<-3||c[g]>=s)throw new Error(`Invalid output index: ${c[g]}`);if(c[g]===-3)continue;let S=c[g]===-1,E=c[g]===-2,A=S||E?i(o[g].dataType,o[g].dims):n(c[g],o[g].dataType,o[g].dims);if(f.push(A),A.data===0)continue;let M=this.gpuDataManager.get(A.data);if(!M)throw new Error(`no GPU data for output: ${A.data}`);if(S&&this.temporaryData.push(M),E){let D=this.kernelPersistentData.get(this.currentKernelId);D||(D=[],this.kernelPersistentData.set(this.currentKernelId,D)),D.push(M)}p.push(M)}if(a.length!==t.length||p.length!==f.length){if(p.length===0)return ds(e.name),f;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let w;if(u){let g=0,S=[];u.forEach(D=>{let I=typeof D.data=="number"?[D.data]:D.data;if(I.length===0)return;let U=D.type===10?2:4,Z,ue;D.type===10?(ue=I.length>4?16:I.length>2?8:I.length*U,Z=I.length>4?16:U*I.length):(ue=I.length<=2?I.length*U:16,Z=16),g=Math.ceil(g/ue)*ue,S.push(g);let X=D.type===10?8:4;g+=I.length>4?Math.ceil(I.length/X)*Z:I.length*U});let E=16;g=Math.ceil(g/E)*E;let A=new ArrayBuffer(g);u.forEach((D,I)=>{let U=S[I],Z=typeof D.data=="number"?[D.data]:D.data;if(D.type===6)new Int32Array(A,U,Z.length).set(Z);else if(D.type===12)new Uint32Array(A,U,Z.length).set(Z);else if(D.type===10)new Uint16Array(A,U,Z.length).set(Z);else if(D.type===1)new Float32Array(A,U,Z.length).set(Z);else throw new Error(`Unsupported uniform type: ${ma(D.type)}`)});let M=this.gpuDataManager.create(g,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(M.buffer,0,A,0,g),this.gpuDataManager.release(M.id),w={offset:0,size:g,buffer:M.buffer}}let x=this.programManager.normalizeDispatchGroupSize(l),v=x[1]===1&&x[2]===1,C=Fk(e,t,v),b=this.programManager.getArtifact(C);if(b||(b=this.programManager.build(e,x),this.programManager.setArtifact(C,b),Lt("info",()=>`[artifact] key: ${C}, programName: ${e.name}`)),u&&b.uniformVariablesInfo){if(u.length!==b.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${b.uniformVariablesInfo.length}, got ${u.length} in program "${b.programInfo.name}".`);for(let g=0;g<u.length;g++){let S=u[g],E=S.type,A=typeof S.data=="number"?1:S.data.length,[M,D]=b.uniformVariablesInfo[g];if(E!==M||A!==D)throw new Error(`Uniform variable ${g} mismatch: expect type ${M} with size ${D}, got type ${E} with size ${A} in program "${b.programInfo.name}".`)}}if(Lt("info",()=>`[ProgramManager] run "${e.name}" (key=${C}) with ${x[0]}x${x[1]}x${x[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let g={kernelId:this.currentKernelId,programName:b.programInfo.name,inputTensorViews:t,outputTensorViews:f};this.pendingKernels.push(g),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(g)}return this.programManager.run(b,a,p,x,w),ds(e.name),f}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,r,n){let i=ZL.get(e);if(!i)throw new Error(`kernel not implemented: ${e}`);let s={kernelType:e,kernelName:n,kernelEntry:i[0],attributes:[i[1],r]};this.kernels.set(t,s)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let r of t)this.gpuDataManager.release(r.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,r){let n=this.kernels.get(e);if(!n)throw new Error(`kernel not created: ${e}`);let i=n.kernelType,s=n.kernelName,a=n.kernelEntry,o=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${i}] ${s}" is not allowed to be called recursively`);this.currentKernelId=e,o[0]&&(o[1]=o[0](o[1]),o[0]=void 0),Lt("info",()=>`[WebGPU] Start to run kernel "[${i}] ${s}"...`);let l=this.env.debug;this.temporaryData=[];try{return l&&this.device.pushErrorScope("validation"),a(t,o[1]),0}catch(u){return r.push(Promise.resolve(`[WebGPU] Kernel "[${i}] ${s}" failed. ${u}`)),1}finally{l&&r.push(this.device.popErrorScope().then(u=>u?`GPU validation error for kernel "[${i}] ${s}": ${u.message}`:null));for(let u of this.temporaryData)this.gpuDataManager.release(u.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,r,n){let i=this.sessionExternalDataMapping.get(e);i||(i=new Map,this.sessionExternalDataMapping.set(e,i));let s=i.get(t),a=this.gpuDataManager.registerExternalBuffer(r,n,s);return i.set(t,[a,r]),a}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(r=>this.gpuDataManager.unregisterExternalBuffer(r[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,r){return async()=>{let n=await Ow(this,e,t);return Yx(n.buffer,r)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){var e;this.queryType="none",(((e=this.env.webgpu.profiling)==null?void 0:e.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Lt("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Lt("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Lt("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),r=e.length;this.pendingKernels=[];for(let n=0;n<r;n++){let i=this.getComputePassEncoder(),s=e[n];this.writeTimestamp(this.pendingDispatchNumber*2),i.setPipeline(s.computePipeline),i.setBindGroup(0,s.bindGroup),i.dispatchWorkgroups(...s.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(t[n]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),eB={};Mc(eB,{init:()=>tB});var Sh,Bk,tB,aX=Oe(()=>{mt(),Ia(),_t(),hY(),Sh=class rB{constructor(t,r,n,i){this.module=t,this.dataType=r,this.data=n,this.dims=i}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=xe.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=xe.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=xe.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let t=xe.size(this.dims);return t===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(xe.size(t)!==xe.size(this.dims))throw new Error("Invalid new shape");return new rB(this.module,this.dataType,this.data,t)}},Bk=class{constructor(e,t,r){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let n=e.PTR_SIZE,i=r/e.PTR_SIZE,s=n===4?"i32":"i64";this.opKernelContext=Number(e.getValue(n*i++,s));let a=Number(e.getValue(n*i++,s));this.outputCount=Number(e.getValue(n*i++,s)),this.customDataOffset=Number(e.getValue(n*i++,"*")),this.customDataSize=Number(e.getValue(n*i++,s));let o=[];for(let l=0;l<a;l++){let u=Number(e.getValue(n*i++,s)),c=Number(e.getValue(n*i++,"*")),f=Number(e.getValue(n*i++,s)),p=[];for(let w=0;w<f;w++)p.push(Number(e.getValue(n*i++,s)));o.push(new Sh(e,u,c,p))}this.inputs=o}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){var a;let r=((a=t==null?void 0:t.inputs)==null?void 0:a.map(o=>typeof o=="number"?this.inputs[o]:o))??this.inputs,n=(t==null?void 0:t.outputs)??[],i=(o,l,u)=>new Sh(this.module,l,this.output(o,u),u),s=(o,l)=>{let u=tl(o,l);if(!u)throw new Error(`Unsupported data type: ${o}`);let c=u>0?this.backend.gpuDataManager.create(u).id:0;return new Sh(this.module,o,c,l)};return this.backend.run(e,r,n,i,s,this.outputCount)}output(e,t){let r=this.module.stackSave();try{let n=this.module.PTR_SIZE,i=n===4?"i32":"i64",s=this.module.stackAlloc((1+t.length)*n);this.module.setValue(s,t.length,i);for(let a=0;a<t.length;a++)this.module.setValue(s+n*(a+1),t[a],i);return this.module._JsepOutput(this.opKernelContext,e,s)}catch(n){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(r)}}},tB=async(e,t,r,n)=>{let i=t.jsepInit;if(!i)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let s=(sX(),Qf(XL)).WebGpuBackend,a=new s;await a.initialize(r,n),i("webgpu",[a,o=>a.alloc(Number(o)),o=>a.free(o),(o,l,u,c=!1)=>{if(c)Lt("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(o)}, dst=${Number(l)}, size=${Number(u)}`),a.memcpy(Number(o),Number(l));else{Lt("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(o)}, gpuDataId=${Number(l)}, size=${Number(u)}`);let f=t.HEAPU8.subarray(Number(o>>>0),Number(o>>>0)+Number(u));a.upload(Number(l),f)}},async(o,l,u)=>{Lt("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${o}, dataOffset=${l}, size=${u}`),await a.download(Number(o),()=>t.HEAPU8.subarray(Number(l)>>>0,Number(l+u)>>>0))},(o,l,u)=>a.createKernel(o,Number(l),u,t.UTF8ToString(t._JsepGetNodeName(Number(l)))),o=>a.releaseKernel(o),(o,l,u,c)=>{Lt("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${u}, kernel=${o}, contextDataOffset=${l}`);let f=new Bk(t,a,Number(l));return a.computeKernel(Number(o),f,c)},()=>a.captureBegin(),()=>a.captureEnd(),()=>a.replay()])}else{let s=new f4(r);i("webnn",[s,()=>s.reserveTensorId(),a=>s.releaseTensorId(a),async(a,o,l,u,c)=>s.ensureTensor(a,o,l,u,c),(a,o)=>{s.uploadTensor(a,o)},async(a,o)=>s.downloadTensor(a,o),(a,o)=>s.registerMLContext(a,o),!!r.trace])}}}),Uk,l1,u1,Fa,Vk,Wv,ng,c1,d1,Kv,f1,p1,h1,nB=Oe(()=>{Di(),dY(),fY(),mt(),Ll(),Kx(),a4(),Uk=(e,t)=>{gr()._OrtInit(e,t)!==0&&tr("Can't initialize onnxruntime.")},l1=async e=>{Uk(e.wasm.numThreads,Xm(e.logLevel))},u1=async(e,t)=>{var n,i;(i=(n=gr()).asyncInit)==null||i.call(n);let r=e.webgpu.adapter;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");if(r){if(typeof r.limits!="object"||typeof r.features!="object"||typeof r.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let s=e.webgpu.powerPreference;if(s!==void 0&&s!=="low-power"&&s!=="high-performance")throw new Error(`Invalid powerPreference setting: "${s}"`);let a=e.webgpu.forceFallbackAdapter;if(a!==void 0&&typeof a!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${a}"`);if(r=await navigator.gpu.requestAdapter({powerPreference:s,forceFallbackAdapter:a}),!r)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}}if(t==="webnn"&&(typeof navigator>"u"||!navigator.ml))throw new Error("WebNN is not supported in current environment");{let s=(aX(),Qf(eB)).init;t==="webgpu"&&await s("webgpu",gr(),e,r),t==="webnn"&&await s("webnn",gr(),e)}},Fa=new Map,Vk=e=>{let t=gr(),r=t.stackSave();try{let n=t.PTR_SIZE,i=t.stackAlloc(2*n);t._OrtGetInputOutputCount(e,i,i+n)!==0&&tr("Can't get session input/output count.");let s=n===4?"i32":"i64";return[Number(t.getValue(i,s)),Number(t.getValue(i+n,s))]}finally{t.stackRestore(r)}},Wv=(e,t)=>{let r=gr(),n=r.stackSave(),i=0;try{let s=r.PTR_SIZE,a=r.stackAlloc(2*s);r._OrtGetInputOutputMetadata(e,t,a,a+s)!==0&&tr("Can't get session input/output metadata.");let o=Number(r.getValue(a,"*"));i=Number(r.getValue(a+s,"*"));let l=r.HEAP32[i/4];if(l===0)return[o,0];let u=r.HEAPU32[i/4+1],c=[];for(let f=0;f<u;f++){let p=Number(r.getValue(i+8+f*s,"*"));c.push(p!==0?r.UTF8ToString(p):Number(r.getValue(i+8+(f+u)*s,"*")))}return[o,l,c]}finally{r.stackRestore(n),i!==0&&r._OrtFree(i)}},ng=e=>{let t=gr(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},c1=async(e,t)=>{var f,p,w,x;let r,n,i=gr();Array.isArray(e)?[r,n]=e:e.buffer===i.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=ng(e);let s=0,a=0,o=0,l=[],u=[],c=[];try{if([a,l]=await s4(t),(t==null?void 0:t.externalData)&&i.mountExternalData){let I=[];for(let U of t.externalData){let Z=typeof U=="string"?U:U.path;I.push(Qx(typeof U=="string"?U:U.data).then(ue=>{i.mountExternalData(Z,ue)}))}await Promise.all(I)}for(let I of(t==null?void 0:t.executionProviders)??[])if((typeof I=="string"?I:I.name)==="webnn"){if(i.shouldTransferToMLTensor=!1,typeof I!="string"){let U=I,Z=U==null?void 0:U.context,ue=U==null?void 0:U.gpuDevice,X=U==null?void 0:U.deviceType,ie=U==null?void 0:U.powerPreference;Z?i.currentContext=Z:ue?i.currentContext=await i.webnnCreateMLContext(ue):i.currentContext=await i.webnnCreateMLContext({deviceType:X,powerPreference:ie})}else i.currentContext=await i.webnnCreateMLContext();break}s=await i._OrtCreateSession(r,n,a),(f=i.webgpuOnCreateSession)==null||f.call(i,s),s===0&&tr("Can't create a session."),(p=i.jsepOnCreateSession)==null||p.call(i),i.currentContext&&(i.webnnRegisterMLContext(s,i.currentContext),i.currentContext=void 0,i.shouldTransferToMLTensor=!0);let[v,C]=Vk(s),b=!!(t!=null&&t.enableGraphCapture),g=[],S=[],E=[],A=[],M=[];for(let I=0;I<v;I++){let[U,Z,ue]=Wv(s,I);U===0&&tr("Can't get an input name."),u.push(U);let X=i.UTF8ToString(U);g.push(X),E.push(Z===0?{name:X,isTensor:!1}:{name:X,isTensor:!0,type:ma(Z),shape:ue})}for(let I=0;I<C;I++){let[U,Z,ue]=Wv(s,I+v);U===0&&tr("Can't get an output name."),c.push(U);let X=i.UTF8ToString(U);S.push(X),A.push(Z===0?{name:X,isTensor:!1}:{name:X,isTensor:!0,type:ma(Z),shape:ue});{if(b&&(t==null?void 0:t.preferredOutputLocation)===void 0){M.push("gpu-buffer");continue}let ie=typeof(t==null?void 0:t.preferredOutputLocation)=="string"?t.preferredOutputLocation:((w=t==null?void 0:t.preferredOutputLocation)==null?void 0:w[X])??"cpu",j=i.webnnIsGraphOutput;if(ie==="cpu"&&j&&j(s,X)){M.push("ml-tensor-cpu-output");continue}if(ie!=="cpu"&&ie!=="cpu-pinned"&&ie!=="gpu-buffer"&&ie!=="ml-tensor")throw new Error(`Not supported preferred output location: ${ie}.`);if(b&&ie!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${ie}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);M.push(ie)}}let D=null;return M.some(I=>I==="gpu-buffer"||I==="ml-tensor"||I==="ml-tensor-cpu-output")&&(o=i._OrtCreateBinding(s),o===0&&tr("Can't create IO binding."),D={handle:o,outputPreferredLocations:M,outputPreferredLocationsEncoded:M.map(I=>I==="ml-tensor-cpu-output"?"ml-tensor":I).map(I=>Aw(I))}),Fa.set(s,[s,u,c,D,b,!1]),[s,g,S,E,A]}catch(v){throw u.forEach(C=>i._OrtFree(C)),c.forEach(C=>i._OrtFree(C)),o!==0&&i._OrtReleaseBinding(o)!==0&&tr("Can't release IO binding."),s!==0&&i._OrtReleaseSession(s)!==0&&tr("Can't release session."),v}finally{i._free(r),a!==0&&i._OrtReleaseSessionOptions(a)!==0&&tr("Can't release session options."),l.forEach(v=>i._free(v)),(x=i.unmountExternalData)==null||x.call(i)}},d1=e=>{var l,u,c;let t=gr(),r=Fa.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,i,s,a,o]=r;a&&(o&&t._OrtClearBoundOutputs(a.handle)!==0&&tr("Can't clear bound outputs."),t._OrtReleaseBinding(a.handle)!==0&&tr("Can't release IO binding.")),(l=t.jsepOnReleaseSession)==null||l.call(t,e),(u=t.webnnOnReleaseSession)==null||u.call(t,e),(c=t.webgpuOnReleaseSession)==null||c.call(t,e),i.forEach(f=>t._OrtFree(f)),s.forEach(f=>t._OrtFree(f)),t._OrtReleaseSession(n)!==0&&tr("Can't release session."),Fa.delete(e)},Kv=async(e,t,r,n,i,s,a=!1)=>{if(!e){t.push(0);return}let o=gr(),l=o.PTR_SIZE,u=e[0],c=e[1],f=e[3],p=f,w,x;if(u==="string"&&(f==="gpu-buffer"||f==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(a&&f!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${s} when enableGraphCapture is true.`);if(f==="gpu-buffer"){let b=e[2].gpuBuffer;x=tl(el(u),c);{let g=o.jsepRegisterBuffer;if(!g)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');w=g(n,s,b,x)}}else if(f==="ml-tensor"){let b=e[2].mlTensor;x=tl(el(u),c);let g=o.webnnRegisterMLTensor;if(!g)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');w=g(n,b,el(u),c)}else{let b=e[2];if(Array.isArray(b)){x=l*b.length,w=o._malloc(x),r.push(w);for(let g=0;g<b.length;g++){if(typeof b[g]!="string")throw new TypeError(`tensor data at index ${g} is not a string`);o.setValue(w+g*l,is(b[g],r),"*")}}else{let g=o.webnnIsGraphInput,S=o.webnnIsGraphOutput;if(u!=="string"&&g&&S){let E=o.UTF8ToString(i);if(g(n,E)||S(n,E)){let A=el(u);x=tl(A,c),p="ml-tensor";let M=o.webnnCreateTemporaryTensor,D=o.webnnUploadTensor;if(!M||!D)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let I=await M(n,A,c);D(I,new Uint8Array(b.buffer,b.byteOffset,b.byteLength)),w=I}else x=b.byteLength,w=o._malloc(x),r.push(w),o.HEAPU8.set(new Uint8Array(b.buffer,b.byteOffset,x),w)}else x=b.byteLength,w=o._malloc(x),r.push(w),o.HEAPU8.set(new Uint8Array(b.buffer,b.byteOffset,x),w)}}let v=o.stackSave(),C=o.stackAlloc(4*c.length);try{c.forEach((g,S)=>o.setValue(C+S*l,g,l===4?"i32":"i64"));let b=o._OrtCreateTensor(el(u),w,x,C,c.length,Aw(p));b===0&&tr(`Can't create tensor for input/output. session=${n}, index=${s}.`),t.push(b)}finally{o.stackRestore(v)}},f1=async(e,t,r,n,i,s)=>{var X,ie,j,le;let a=gr(),o=a.PTR_SIZE,l=Fa.get(e);if(!l)throw new Error(`cannot run inference. invalid session id: ${e}`);let u=l[0],c=l[1],f=l[2],p=l[3],w=l[4],x=l[5],v=t.length,C=n.length,b=0,g=[],S=[],E=[],A=[],M=[],D=a.stackSave(),I=a.stackAlloc(v*o),U=a.stackAlloc(v*o),Z=a.stackAlloc(C*o),ue=a.stackAlloc(C*o);try{[b,g]=i4(s),wl("wasm prepareInputOutputTensor");for(let F=0;F<v;F++)await Kv(r[F],S,A,e,c[t[F]],t[F],w);for(let F=0;F<C;F++)await Kv(i[F],E,A,e,f[n[F]],v+n[F],w);bl("wasm prepareInputOutputTensor");for(let F=0;F<v;F++)a.setValue(I+F*o,S[F],"*"),a.setValue(U+F*o,c[t[F]],"*");for(let F=0;F<C;F++)a.setValue(Z+F*o,E[F],"*"),a.setValue(ue+F*o,f[n[F]],"*");if(p&&!x){let{handle:F,outputPreferredLocations:H,outputPreferredLocationsEncoded:B}=p;if(c.length!==v)throw new Error(`input count from feeds (${v}) is expected to be always equal to model's input count (${c.length}).`);wl("wasm bindInputsOutputs");for(let ee=0;ee<v;ee++){let me=t[ee];await a._OrtBindInput(F,c[me],S[ee])!==0&&tr(`Can't bind input[${ee}] for session=${e}.`)}for(let ee=0;ee<C;ee++){let me=n[ee];(X=i[ee])!=null&&X[3]?(M.push(E[ee]),a._OrtBindOutput(F,f[me],E[ee],0)!==0&&tr(`Can't bind pre-allocated output[${ee}] for session=${e}.`)):a._OrtBindOutput(F,f[me],0,B[me])!==0&&tr(`Can't bind output[${ee}] to ${H[ee]} for session=${e}.`)}bl("wasm bindInputsOutputs"),Fa.set(e,[u,c,f,p,w,!0])}(ie=a.jsepOnRunStart)==null||ie.call(a,u),(j=a.webnnOnRunStart)==null||j.call(a,u);let ne;p?ne=await a._OrtRunWithBinding(u,p.handle,C,Z,b):ne=await a._OrtRun(u,U,I,v,ue,C,Z,b),ne!==0&&tr("failed to call OrtRun().");let ce=[],W=[];wl("wasm ProcessOutputTensor");for(let F=0;F<C;F++){let H=Number(a.getValue(Z+F*o,"*"));if(H===E[F]||M.includes(E[F])){ce.push(i[F]),H!==E[F]&&a._OrtReleaseTensor(H)!==0&&tr("Can't release tensor.");continue}let B=a.stackSave(),ee=a.stackAlloc(4*o),me=!1,K,Ae=0;try{a._OrtGetTensorData(H,ee,ee+o,ee+2*o,ee+3*o)!==0&&tr(`Can't access output tensor data on index ${F}.`);let Ze=o===4?"i32":"i64",be=Number(a.getValue(ee,Ze));Ae=a.getValue(ee+o,"*");let ge=a.getValue(ee+o*2,"*"),Te=Number(a.getValue(ee+o*3,Ze)),Ee=[];for(let He=0;He<Te;He++)Ee.push(Number(a.getValue(ge+He*o,Ze)));a._OrtFree(ge)!==0&&tr("Can't free memory for tensor dims.");let We=Ee.reduce((He,Ve)=>He*Ve,1);K=ma(be);let Fe=p==null?void 0:p.outputPreferredLocations[n[F]];if(K==="string"){if(Fe==="gpu-buffer"||Fe==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let He=[];for(let Ve=0;Ve<We;Ve++){let vt=a.getValue(Ae+Ve*o,"*"),gt=a.getValue(Ae+(Ve+1)*o,"*"),ot=Ve===We-1?void 0:gt-vt;He.push(a.UTF8ToString(vt,ot))}ce.push([K,Ee,He,"cpu"])}else if(Fe==="gpu-buffer"&&We>0){let He=a.jsepGetBuffer;if(!He)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let Ve=He(Ae),vt=tl(be,We);if(vt===void 0||!Hx(K))throw new Error(`Unsupported data type: ${K}`);me=!0,ce.push([K,Ee,{gpuBuffer:Ve,download:a.jsepCreateDownloader(Ve,vt,K),dispose:()=>{a._OrtReleaseTensor(H)!==0&&tr("Can't release tensor.")}},"gpu-buffer"])}else if(Fe==="ml-tensor"&&We>0){let He=a.webnnEnsureTensor,Ve=a.webnnIsGraphInputOutputTypeSupported;if(!He||!Ve)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(tl(be,We)===void 0||!Gx(K))throw new Error(`Unsupported data type: ${K}`);if(!Ve(e,K,!1))throw new Error(`preferredLocation "ml-tensor" for ${K} output is not supported by current WebNN Context.`);let vt=await He(e,Ae,be,Ee,!1);me=!0,ce.push([K,Ee,{mlTensor:vt,download:a.webnnCreateMLTensorDownloader(Ae,K),dispose:()=>{a.webnnReleaseTensorId(Ae),a._OrtReleaseTensor(H)}},"ml-tensor"])}else if(Fe==="ml-tensor-cpu-output"&&We>0){let He=a.webnnCreateMLTensorDownloader(Ae,K)(),Ve=ce.length;me=!0,W.push((async()=>{let vt=[Ve,await He];return a.webnnReleaseTensorId(Ae),a._OrtReleaseTensor(H),vt})()),ce.push([K,Ee,[],"cpu"])}else{let He=Ug(K),Ve=new He(We);new Uint8Array(Ve.buffer,Ve.byteOffset,Ve.byteLength).set(a.HEAPU8.subarray(Ae,Ae+Ve.byteLength)),ce.push([K,Ee,Ve,"cpu"])}}finally{a.stackRestore(B),K==="string"&&Ae&&a._free(Ae),me||a._OrtReleaseTensor(H)}}p&&!w&&(a._OrtClearBoundOutputs(p.handle)!==0&&tr("Can't clear bound outputs."),Fa.set(e,[u,c,f,p,w,!1]));for(let[F,H]of await Promise.all(W))ce[F][2]=H;return bl("wasm ProcessOutputTensor"),ce}finally{(le=a.webnnOnRunEnd)==null||le.call(a,u),a.stackRestore(D),S.forEach(ne=>a._OrtReleaseTensor(ne)),E.forEach(ne=>a._OrtReleaseTensor(ne)),A.forEach(ne=>a._free(ne)),b!==0&&a._OrtReleaseRunOptions(b),g.forEach(ne=>a._free(ne))}},p1=e=>{let t=gr(),r=Fa.get(e);if(!r)throw new Error("invalid session id");let n=r[0],i=t._OrtEndProfiling(n);i===0&&tr("Can't get an profile file name."),t._OrtFree(i)},h1=e=>{let t=[];for(let r of e){let n=r[2];!Array.isArray(n)&&"buffer"in n&&t.push(n.buffer)}return t}}),La,qn,yu,Nd,Pd,Ch,Hv,kh,Qo,Zo,qk,iB,sB,aB,oB,lB,uB,cB,dB=Oe(()=>{Di(),nB(),Ll(),qx(),La=()=>!!mr.wasm.proxy&&typeof document<"u",yu=!1,Nd=!1,Pd=!1,kh=new Map,Qo=(e,t)=>{let r=kh.get(e);r?r.push(t):kh.set(e,[t])},Zo=()=>{if(yu||!Nd||Pd||!qn)throw new Error("worker not ready")},qk=e=>{switch(e.data.type){case"init-wasm":yu=!1,e.data.err?(Pd=!0,Hv[1](e.data.err)):(Nd=!0,Hv[0]()),Ch&&(URL.revokeObjectURL(Ch),Ch=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=kh.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},iB=async()=>{if(!Nd){if(yu)throw new Error("multiple calls to 'initWasm()' detected.");if(Pd)throw new Error("previous call to 'initWasm()' failed.");if(yu=!0,La())return new Promise((e,t)=>{qn==null||qn.terminate(),r4().then(([r,n])=>{try{qn=n,qn.onerror=s=>t(s),qn.onmessage=qk,Hv=[e,t];let i={type:"init-wasm",in:mr};!i.in.wasm.wasmPaths&&(r||Pw)&&(i.in.wasm.wasmPaths={wasm:new URL("/FiberMapConnect/assets/ort-wasm-simd-threaded.jsep-6MnTkKum.wasm",import.meta.url).href}),qn.postMessage(i),Ch=r}catch(i){t(i)}},t)});try{await Wx(mr.wasm),await l1(mr),Nd=!0}catch(e){throw Pd=!0,e}finally{yu=!1}}},sB=async e=>{if(La())return Zo(),new Promise((t,r)=>{Qo("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:mr}};qn.postMessage(n)});await u1(mr,e)},aB=async e=>La()?(Zo(),new Promise((t,r)=>{Qo("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};qn.postMessage(n,[e.buffer])})):ng(e),oB=async(e,t)=>{if(La()){if(t!=null&&t.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Zo(),new Promise((r,n)=>{Qo("create",[r,n]);let i={type:"create",in:{model:e,options:{...t}}},s=[];e instanceof Uint8Array&&s.push(e.buffer),qn.postMessage(i,s)})}else return c1(e,t)},lB=async e=>{if(La())return Zo(),new Promise((t,r)=>{Qo("release",[t,r]);let n={type:"release",in:e};qn.postMessage(n)});d1(e)},uB=async(e,t,r,n,i,s)=>{if(La()){if(r.some(a=>a[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some(a=>a))throw new Error("pre-allocated output tensor is not supported for proxy.");return Zo(),new Promise((a,o)=>{Qo("run",[a,o]);let l=r,u={type:"run",in:{sessionId:e,inputIndices:t,inputs:l,outputIndices:n,options:s}};qn.postMessage(u,h1(l))})}else return f1(e,t,r,n,i,s)},cB=async e=>{if(La())return Zo(),new Promise((t,r)=>{Qo("end-profiling",[t,r]);let n={type:"end-profiling",in:e};qn.postMessage(n)});p1(e)}}),Gv,Wk,fB,oX=Oe(()=>{Di(),dB(),mt(),Vx(),a4(),Gv=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},Wk=e=>{switch(e[3]){case"cpu":return new Os(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!Hx(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:i}=e[2];return Os.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:i})}case"ml-tensor":{let t=e[0];if(!Gx(t))throw new Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:r,download:n,dispose:i}=e[2];return Os.fromMLTensor(r,{dataType:t,dims:e[1],download:n,dispose:i})}default:throw new Error(`invalid data location: ${e[3]}`)}},fB=class{async fetchModelAndCopyToWasmMemory(e){return aB(await Qx(e))}async loadModel(e,t){Ws();let r;typeof e=="string"?r=await this.fetchModelAndCopyToWasmMemory(e):r=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await oB(r,t),ds()}async dispose(){return lB(this.sessionId)}async run(e,t,r){Ws();let n=[],i=[];Object.entries(e).forEach(f=>{let p=f[0],w=f[1],x=this.inputNames.indexOf(p);if(x===-1)throw new Error(`invalid input '${p}'`);n.push(w),i.push(x)});let s=[],a=[];Object.entries(t).forEach(f=>{let p=f[0],w=f[1],x=this.outputNames.indexOf(p);if(x===-1)throw new Error(`invalid output '${p}'`);s.push(w),a.push(x)});let o=n.map((f,p)=>Gv(f,()=>`input "${this.inputNames[i[p]]}"`)),l=s.map((f,p)=>f?Gv(f,()=>`output "${this.outputNames[a[p]]}"`):null),u=await uB(this.sessionId,i,o,a,l,r),c={};for(let f=0;f<u.length;f++)c[this.outputNames[a[f]]]=s[f]??Wk(u[f]);return ds(),c}startProfiling(){}endProfiling(){cB(this.sessionId)}}}),pB={};Mc(pB,{OnnxruntimeWebAssemblyBackend:()=>Kw,initializeFlags:()=>Ww,wasmBackend:()=>hB});var Ww,Kw,hB,lX=Oe(()=>{Di(),dB(),oX(),Ww=()=>{(typeof mr.wasm.initTimeout!="number"||mr.wasm.initTimeout<0)&&(mr.wasm.initTimeout=0);let e=mr.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),mr.wasm.simd=!1),typeof mr.wasm.proxy!="boolean"&&(mr.wasm.proxy=!1),typeof mr.wasm.trace!="boolean"&&(mr.wasm.trace=!1),typeof mr.wasm.numThreads!="number"||!Number.isInteger(mr.wasm.numThreads)||mr.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)mr.wasm.numThreads=1;else{let t=typeof navigator>"u"?HZ("node:os").cpus().length:navigator.hardwareConcurrency;mr.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},Kw=class{async init(e){Ww(),await iB(),await sB(e)}async createInferenceSessionHandler(e,t){let r=new fB;return await r.loadModel(e,t),r}},hB=new Kw});Di();Di();Di();var uX="1.24.1";{let e=(lX(),Qf(pB)).wasmBackend;Ou("webgpu",e,5),Ou("webnn",e,5),Ou("cpu",e,10),Ou("wasm",e,10)}Object.defineProperty(mr.versions,"web",{value:uX,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */mr.wasm.numThreads=1;const mB="/FiberMapConnect/";mr.wasm.wasmPaths=mB;let Qv=null,Eh=null;async function cX(){return Qv||Eh||(Eh=(async()=>{try{const{default:e}=await pw(async()=>{const{default:n}=await import("./index-Cwy3kE90.js");return{default:n}},[]),t=`${mB}models`,r=await e.create({models:{detectionPath:`${t}/ch_PP-OCRv4_det_infer.onnx`,recognitionPath:`${t}/ch_PP-OCRv4_rec_infer.onnx`,dictionaryPath:`${t}/ppocr_keys_v1.txt`}});return Qv=r,r}catch(e){return console.warn("PaddleOCR init failed, will use Tesseract fallback:",e),null}})(),Eh)}async function dX(e){const t=await cX();if(!t)return null;const n=(await t.detect(e)).map(i=>({text:i.text,confidence:i.mean}));return{text:n.map(i=>i.text).join(`
`),lines:n}}function gB({open:e,onOpenChange:t,onTextExtracted:r}){const{toast:n}=_g(),[i,s]=P.useState(""),[a,o]=P.useState(""),[l,u]=P.useState(!1),[c,f]=P.useState(0),[p,w]=P.useState(!1),[x,v]=P.useState(""),[C,b]=P.useState(!1),[g,S]=P.useState(""),E=P.useRef(null),A=ue=>{var j;const X=(j=ue.target.files)==null?void 0:j[0];if(!X)return;const ie=new FileReader;ie.onloadend=()=>{s(ie.result),o("")},ie.readAsDataURL(X)},M=async()=>{try{const ue=await navigator.clipboard.read();for(const X of ue)for(const ie of X.types)if(ie.startsWith("image/")){const j=await X.getType(ie),le=new FileReader;le.onloadend=()=>{s(le.result),o(""),n({title:"Image pasted from clipboard"})},le.readAsDataURL(j);return}n({title:"No image found in clipboard",description:"Take a screenshot (Windows: Win+Shift+S, Mac: Cmd+Shift+4) and try again",variant:"destructive"})}catch{n({title:"Clipboard access failed",description:"Please upload an image file instead",variant:"destructive"})}},D=async ue=>{S("tesseract");const X=await VZ(ue);v(X),f(10);const ie=await kZ.createWorker("eng",1,{logger:le=>{le.status==="recognizing text"&&f(10+Math.round(le.progress*90))}}),{data:{text:j}}=await ie.recognize(X);return await ie.terminate(),j},I=async()=>{if(i){u(!0),f(0),o(""),S("");try{f(5);let ue=null;try{S("paddle"),f(10);const ie=await dX(i);ie&&ie.text.trim()&&(ue=ie.text,f(90))}catch(ie){console.warn("PaddleOCR failed, falling back to Tesseract:",ie)}ue||(ue=await D(i)),f(95);const X=OZ(ue);o(X),f(100),n({title:"Text extracted successfully",description:`Engine: ${g==="paddle"?"PaddleOCR":"Tesseract"}`})}catch{n({title:"Failed to process image",description:"Please try a clearer image",variant:"destructive"})}finally{u(!1),f(0)}}},U=()=>{navigator.clipboard.writeText(a),w(!0),n({title:"Text copied to clipboard"}),setTimeout(()=>w(!1),2e3)},Z=()=>{a.trim()&&(r(a),t(!1),s(""),o(""),v(""),b(!1),S(""),n({title:"Text added to Circuit IDs"}))};return y.jsx(gw,{open:e,onOpenChange:t,children:y.jsxs(Im,{className:"max-w-2xl max-h-[90vh] overflow-y-auto","data-testid":"dialog-ocr",children:[y.jsxs(Nm,{children:[y.jsx(Pm,{children:"Extract Circuit IDs from Image"}),y.jsx(Am,{children:"Upload an image or paste a screenshot to automatically extract text using OCR"})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:A,className:"hidden","data-testid":"input-ocr-file"}),y.jsxs(Ht,{variant:"outline",onClick:()=>{var ue;return(ue=E.current)==null?void 0:ue.click()},"data-testid":"button-upload-image",children:[y.jsx(oR,{className:"h-4 w-4 mr-2"}),"Upload"]}),y.jsxs(Ht,{variant:"outline",onClick:M,"data-testid":"button-paste-image",children:[y.jsx(Yq,{className:"h-4 w-4 mr-2"}),"Paste"]})]}),i&&y.jsxs("div",{className:"border rounded-md p-4 bg-muted",children:[y.jsxs("div",{className:"relative",children:[y.jsx("img",{src:C&&x?x:i,alt:C?"Preprocessed":"Original",className:"max-w-full max-h-64 mx-auto object-contain"}),x&&y.jsx(Ht,{variant:"secondary",size:"sm",className:"absolute top-2 right-2 opacity-80 hover:opacity-100",onClick:()=>b(!C),title:C?"Show original":"Show preprocessed",children:C?y.jsxs(y.Fragment,{children:[y.jsx(t8,{className:"h-3 w-3 mr-1"})," Original"]}):y.jsxs(y.Fragment,{children:[y.jsx(r8,{className:"h-3 w-3 mr-1"})," Enhanced"]})})]}),y.jsx(Ht,{onClick:I,disabled:l,className:"w-full mt-4","data-testid":"button-extract-text",children:l?"Processing...":"Extract Text"})]}),l&&y.jsxs("div",{className:"space-y-2",children:[y.jsx(Pz,{value:c,className:"w-full"}),y.jsxs("p",{className:"text-sm text-center text-muted-foreground",children:[g==="paddle"?"Processing with PaddleOCR...":g==="tesseract"?"Processing with Tesseract (fallback)...":"Initializing OCR..."," ",c,"%"]})]}),a&&y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("label",{className:"text-sm font-medium",children:"Extracted Text"}),y.jsx(Ht,{variant:"ghost",size:"sm",onClick:U,"data-testid":"button-copy-text",children:p?y.jsxs(y.Fragment,{children:[y.jsx(nR,{className:"h-4 w-4 mr-2"}),"Copied"]}):y.jsxs(y.Fragment,{children:[y.jsx(e8,{className:"h-4 w-4 mr-2"}),"Copy"]})})]}),y.jsx(Ox,{value:a,onChange:ue=>o(ue.target.value),rows:8,className:"font-mono text-sm",placeholder:"Extracted text will appear here...","data-testid":"textarea-extracted-text"}),y.jsx("p",{className:"text-xs text-muted-foreground",children:"You can edit the text above before using it"})]}),a&&y.jsxs("div",{className:"flex justify-end gap-2",children:[y.jsx(Ht,{variant:"outline",onClick:()=>{s(""),o(""),v(""),b(!1),S("")},"data-testid":"button-clear-ocr",children:"Clear"}),y.jsx(Ht,{onClick:Z,"data-testid":"button-use-text",children:"Use This Text"})]}),!i&&y.jsxs("div",{className:"text-sm text-muted-foreground space-y-3 border rounded-md p-4 bg-muted/50",children:[y.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded p-3",children:[y.jsx("p",{className:"font-semibold text-primary mb-2",children:"Recommended: Snip Part of Screen"}),y.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Windows:"})," Press ",y.jsx("kbd",{className:"px-2 py-1 bg-background border rounded text-xs",children:"Win+Shift+S"}),"  Drag to select region"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Mac:"})," Press ",y.jsx("kbd",{className:"px-2 py-1 bg-background border rounded text-xs",children:"Cmd+Shift+4"}),"  Drag to select region"]}),y.jsxs("li",{children:["Click ",y.jsx("strong",{children:'"Paste"'})," button above  Your snippet appears!"]})]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"font-medium",children:"Alternative:"}),y.jsx("ul",{className:"list-disc list-inside space-y-1 ml-2 text-sm",children:y.jsxs("li",{children:[y.jsx("strong",{children:"Upload:"})," Choose a saved image file from your computer"]})})]}),y.jsxs("div",{children:[y.jsx("p",{className:"font-medium",children:"Tips for best OCR results:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2 text-sm",children:[y.jsx("li",{children:"Uses PaddleOCR (PP-OCRv4) with Tesseract.js fallback"}),y.jsx("li",{children:"Use clear, high-contrast images"}),y.jsx("li",{children:"Ensure text is horizontal and legible"}),y.jsx("li",{children:"Works best with printed text (not handwriting)"})]})]})]})]})]})})}function fX({cable:e,onSubmit:t,onCancel:r,isLoading:n}){const[i,s]=P.useState(!1),a=wH({resolver:$H(R7),defaultValues:e?{name:e.name,fiberCount:e.fiberCount,type:e.type}:{name:"",fiberCount:24,type:"Feed",circuitIds:[]}}),o=l=>{l.circuitIds&&l.circuitIds.length>0&&(l.circuitIds=l.circuitIds.map(u=>Nw(u.trim()))),t(l)};return y.jsxs(j7,{...a,children:[y.jsxs("form",{onSubmit:a.handleSubmit(o),className:"space-y-6",children:[y.jsx(fh,{control:a.control,name:"name",render:({field:l})=>y.jsxs(Bd,{children:[y.jsx(Ud,{children:"Cable Name"}),y.jsx(Vd,{children:y.jsx(Sc,{placeholder:"e.g., Cable2, Feed1, Distribution-24",...l,"data-testid":"input-cable-name"})}),y.jsx(qd,{})]})}),y.jsx(fh,{control:a.control,name:"type",render:({field:l})=>y.jsxs(Bd,{children:[y.jsx(Ud,{children:"Cable Type"}),y.jsxs(cQ,{onValueChange:l.onChange,defaultValue:l.value,children:[y.jsx(Vd,{children:y.jsx(yz,{"data-testid":"select-cable-type",children:y.jsx(dQ,{placeholder:"Select cable type"})})}),y.jsx(bz,{children:NM.map(u=>y.jsx(xz,{value:u,"data-testid":`option-cable-type-${u}`,children:u},u))})]}),y.jsx(qd,{})]})}),y.jsx(fh,{control:a.control,name:"fiberCount",render:({field:l})=>y.jsxs(Bd,{children:[y.jsx(Ud,{children:"Fiber Count"}),y.jsx(Vd,{children:y.jsx(Sc,{type:"number",placeholder:"e.g., 24, 48, 72",...l,onChange:u=>l.onChange(parseInt(u.target.value)||0),"data-testid":"input-fiber-count"})}),y.jsx(qd,{})]})}),!e&&y.jsx(fh,{control:a.control,name:"circuitIds",render:({field:l})=>{var u;return y.jsxs(Bd,{children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx(Ud,{children:"Circuit IDs (Optional)"}),y.jsxs(Ht,{type:"button",variant:"ghost",size:"sm",onClick:()=>s(!0),title:"Extract text from image (OCR)","data-testid":"button-open-cable-ocr",children:[y.jsx(sR,{className:"h-4 w-4 mr-2"}),"Scan Image"]})]}),y.jsx(Vd,{children:y.jsx(Ox,{placeholder:`Enter circuit IDs, one per line
e.g.,
b,1-2 or b 1 2
n,15-16 or n 15 16
lg,33-36 or lg 33 36`,value:((u=l.value)==null?void 0:u.join(`
`))||"",onChange:c=>{const f=c.target.value.split(`
`);l.onChange(f)},"data-testid":"textarea-circuit-ids",rows:6,className:"font-mono text-sm resize-none"})}),y.jsx(DM,{className:"text-xs",children:"Use spaces or standard format (prefix,start-end). Fiber positions will be auto-calculated."}),y.jsx(qd,{})]})}}),y.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[y.jsx(Ht,{type:"button",variant:"outline",onClick:r,disabled:n,"data-testid":"button-cancel-cable",children:"Cancel"}),y.jsx(Ht,{type:"submit",disabled:n,"data-testid":"button-save-cable",children:n?"Saving...":e?"Update Cable":"Create Cable"})]})]}),y.jsx(gB,{open:i,onOpenChange:s,onTextExtracted:l=>{const c=(a.getValues("circuitIds")||[]).join(`
`),p=(c?`${c}
${l}`:l).split(`
`).filter(w=>w.trim());a.setValue("circuitIds",p)}})]})}const pX=kg("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function Kk({className:e,variant:t,...r}){return y.jsx("div",{className:ft(pX({variant:t}),e),...r})}var m1="Checkbox",[hX,WX]=Oi(m1),[mX,gX]=hX(m1),yB=P.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:i,defaultChecked:s,required:a,disabled:o,value:l="on",onCheckedChange:u,form:c,...f}=e,[p,w]=P.useState(null),x=or(t,E=>w(E)),v=P.useRef(!1),C=p?c||!!p.closest("form"):!0,[b=!1,g]=vo({prop:i,defaultProp:s,onChange:u}),S=P.useRef(b);return P.useEffect(()=>{const E=p==null?void 0:p.form;if(E){const A=()=>g(S.current);return E.addEventListener("reset",A),()=>E.removeEventListener("reset",A)}},[p,g]),y.jsxs(mX,{scope:r,state:b,disabled:o,children:[y.jsx(kt.button,{type:"button",role:"checkbox","aria-checked":mo(b)?"mixed":b,"aria-required":a,"data-state":bB(b),"data-disabled":o?"":void 0,disabled:o,value:l,...f,ref:x,onKeyDown:ht(e.onKeyDown,E=>{E.key==="Enter"&&E.preventDefault()}),onClick:ht(e.onClick,E=>{g(A=>mo(A)?!0:!A),C&&(v.current=E.isPropagationStopped(),v.current||E.stopPropagation())})}),C&&y.jsx(yX,{control:p,bubbles:!v.current,name:n,value:l,checked:b,required:a,disabled:o,form:c,style:{transform:"translateX(-100%)"},defaultChecked:mo(s)?!1:s})]})});yB.displayName=m1;var vB="CheckboxIndicator",wB=P.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...i}=e,s=gX(vB,r);return y.jsx(No,{present:n||mo(s.state)||s.state===!0,children:y.jsx(kt.span,{"data-state":bB(s.state),"data-disabled":s.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});wB.displayName=vB;var yX=e=>{const{control:t,checked:r,bubbles:n=!0,defaultChecked:i,...s}=e,a=P.useRef(null),o=Dx(r),l=lx(t);P.useEffect(()=>{const c=a.current,f=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(f,"checked").set;if(o!==r&&w){const x=new Event("click",{bubbles:n});c.indeterminate=mo(r),w.call(c,mo(r)?!1:r),c.dispatchEvent(x)}},[o,r,n]);const u=P.useRef(mo(r)?!1:r);return y.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??u.current,...s,tabIndex:-1,ref:a,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function mo(e){return e==="indeterminate"}function bB(e){return mo(e)?"indeterminate":e?"checked":"unchecked"}var xB=yB,vX=wB;const _B=P.forwardRef(({className:e,...t},r)=>y.jsx(xB,{ref:r,className:ft("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:y.jsx(vX,{className:ft("flex items-center justify-center text-current"),children:y.jsx(Af,{className:"h-4 w-4"})})}));_B.displayName=xB.displayName;const df=P.forwardRef(({className:e,...t},r)=>y.jsx("div",{className:"relative w-full overflow-auto",children:y.jsx("table",{ref:r,className:ft("w-full caption-bottom text-sm",e),...t})}));df.displayName="Table";const ff=P.forwardRef(({className:e,...t},r)=>y.jsx("thead",{ref:r,className:ft("[&_tr]:border-b",e),...t}));ff.displayName="TableHeader";const pf=P.forwardRef(({className:e,...t},r)=>y.jsx("tbody",{ref:r,className:ft("[&_tr:last-child]:border-0",e),...t}));pf.displayName="TableBody";const wX=P.forwardRef(({className:e,...t},r)=>y.jsx("tfoot",{ref:r,className:ft("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));wX.displayName="TableFooter";const er=P.forwardRef(({className:e,...t},r)=>y.jsx("tr",{ref:r,className:ft("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));er.displayName="TableRow";const It=P.forwardRef(({className:e,...t},r)=>y.jsx("th",{ref:r,className:ft("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));It.displayName="TableHead";const Xe=P.forwardRef(({className:e,...t},r)=>y.jsx("td",{ref:r,className:ft("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Xe.displayName="TableCell";const bX=P.forwardRef(({className:e,...t},r)=>y.jsx("caption",{ref:r,className:ft("mt-4 text-sm text-muted-foreground",e),...t}));bX.displayName="TableCaption";function xX({cable:e}){const{toast:t}=_g(),[r,n]=P.useState(""),[i,s]=P.useState(null),[a,o]=P.useState(""),[l,u]=P.useState(!1),{data:c=[],isLoading:f}=af({queryKey:["/api/circuits/cable",e.id]}),{data:p=[]}=af({queryKey:["/api/cables"]}),{data:w=[]}=af({queryKey:["/api/circuits"]}),x=ha({mutationFn:async j=>await As("POST","/api/circuits",j),onSuccess:async()=>{await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),n(""),t({title:"Circuit added successfully"})},onError:j=>{t({title:"Failed to add circuit",description:j.message||"Please check your input",variant:"destructive"})}}),v=ha({mutationFn:async j=>await As("DELETE",`/api/circuits/${j}`,void 0),onSuccess:async()=>{await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),t({title:"Circuit deleted successfully"})},onError:async j=>{var le,ne;(le=j==null?void 0:j.message)!=null&&le.includes("not found")||(ne=j==null?void 0:j.message)!=null&&ne.includes("404")?(await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),t({title:"Circuit removed from display"})):t({title:"Failed to delete circuit",variant:"destructive"})}}),C=ha({mutationFn:async({circuitId:j,feedCableId:le,feedFiberStart:ne,feedFiberEnd:ce})=>await As("PATCH",`/api/circuits/${j}/toggle-spliced`,{feedCableId:le,feedFiberStart:ne,feedFiberEnd:ce}),onSuccess:async()=>{await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]})},onError:async j=>{var le,ne;(le=j==null?void 0:j.message)!=null&&le.includes("not found")||(ne=j==null?void 0:j.message)!=null&&ne.includes("404")?(await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),t({title:"Circuit not found - display refreshed",variant:"destructive"})):t({title:"Failed to toggle splice status",description:j.message||"An error occurred",variant:"destructive"})}}),b=ha({mutationFn:async({id:j,circuitId:le})=>await As("PATCH",`/api/circuits/${j}/update-circuit-id`,{circuitId:le}),onSuccess:async()=>{await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),s(null),o(""),t({title:"Circuit ID updated successfully"})},onError:j=>{t({title:"Failed to update circuit ID",description:j.message||"Please check your input",variant:"destructive"})}}),g=ha({mutationFn:async({id:j,direction:le})=>await As("PATCH",`/api/circuits/${j}/move`,{direction:le}),onSuccess:async()=>{await vr.refetchQueries({queryKey:["/api/circuits/cable",e.id]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),t({title:"Circuit moved successfully"})},onError:()=>{t({title:"Failed to move circuit",variant:"destructive"})}}),S=(j,le)=>{if(e.type==="Distribution"&&le){const ne=j.circuitId.split(",");if(ne.length!==2){t({title:"Invalid circuit ID format",variant:"destructive"});return}const ce=ne[0].trim(),W=ne[1].trim().split("-");if(W.length!==2){t({title:"Invalid circuit ID range format",variant:"destructive"});return}const F=parseInt(W[0]),H=parseInt(W[1]),B=w.find(Ee=>{const We=p.find(rr=>rr.id===Ee.cableId);if((We==null?void 0:We.type)!=="Feed")return!1;const Fe=Ee.circuitId.split(",");if(Fe.length!==2||Fe[0].trim()!==ce)return!1;const Ve=Fe[1].trim().split("-");if(Ve.length!==2)return!1;const vt=parseInt(Ve[0]),gt=parseInt(Ve[1]);return F>=vt&&H<=gt});if(!B){t({title:"No matching Feed circuit found",description:`Could not find a Feed circuit with prefix "${ce}" that contains the range ${F}-${H}`,variant:"destructive"});return}const ee=p.find(Ee=>Ee.id===B.cableId),K=B.circuitId.split(",")[1].trim().split("-"),Ae=parseInt(K[0]);parseInt(K[1]);const Ze=F-Ae,be=H-Ae,ge=B.fiberStart+Ze,Te=B.fiberStart+be;C.mutate({circuitId:j.id,feedCableId:ee==null?void 0:ee.id,feedFiberStart:ge,feedFiberEnd:Te})}else C.mutate({circuitId:j.id})},E=j=>{s(j.id),o(j.circuitId)},A=()=>{s(null),o("")},M=(j,le)=>{const ne=j.split(",");if(ne.length!==2)return{valid:!1,error:'Invalid circuit ID format. Expected format: "prefix,start-end"'};const ce=ne[0].trim(),F=ne[1].trim().split("-");if(F.length!==2)return{valid:!1,error:'Invalid range format. Expected format: "start-end"'};const H=parseInt(F[0]),B=parseInt(F[1]);if(isNaN(H)||isNaN(B))return{valid:!1,error:"Range values must be numbers"};for(const ee of c){if(le&&ee.id===le)continue;const me=ee.circuitId.split(",");if(me.length!==2)continue;const K=me[0].trim(),Ze=me[1].trim().split("-");if(Ze.length!==2)continue;const be=parseInt(Ze[0]),ge=parseInt(Ze[1]);if(!(isNaN(be)||isNaN(ge))&&ce===K&&H<=ge&&B>=be)return{valid:!1,error:`Circuit ID "${j}" overlaps with existing circuit "${ee.circuitId}". Ranges cannot overlap for the same prefix.`}}return{valid:!0}},D=j=>{if(!a.trim()){t({title:"Circuit ID required",description:"Please enter a valid circuit ID",variant:"destructive"});return}const le=Nw(a.trim()),ne=M(le,j);if(!ne.valid){t({title:"Invalid Circuit ID",description:ne.error,variant:"destructive"});return}b.mutate({id:j,circuitId:le})},I=()=>{if(!r.trim()){t({title:"Missing circuit ID",description:"Please enter a circuit ID (e.g., lg,33-36)",variant:"destructive"});return}const j=Nw(r.trim()),le=M(j);if(!le.valid){t({title:"Invalid Circuit ID",description:le.error,variant:"destructive"});return}x.mutate({cableId:e.id,circuitId:j})},U=P.useMemo(()=>c.reduce((j,le)=>j+(le.fiberEnd-le.fiberStart+1),0),[c]),Z=P.useMemo(()=>U===e.fiberCount,[U,e.fiberCount]),ue=[{name:"blue",bg:"bg-blue-500",text:"text-white",colorClass:"text-blue-500"},{name:"orange",bg:"bg-orange-500",text:"text-white",colorClass:"text-orange-500"},{name:"green",bg:"bg-green-600",text:"text-white",colorClass:"text-green-600"},{name:"brown",bg:"bg-amber-700",text:"text-white",colorClass:"text-amber-700"},{name:"slate",bg:"bg-slate-500",text:"text-white",colorClass:"text-slate-500"},{name:"white",bg:"bg-white",text:"text-black",colorClass:"text-slate-700"},{name:"red",bg:"bg-red-600",text:"text-white",colorClass:"text-red-600"},{name:"black",bg:"bg-black",text:"text-white",colorClass:"text-slate-900"},{name:"yellow",bg:"bg-yellow-400",text:"text-black",colorClass:"text-yellow-500"},{name:"violet",bg:"bg-purple-600",text:"text-white",colorClass:"text-purple-600"},{name:"pink",bg:"bg-pink-500",text:"text-white",colorClass:"text-pink-500"},{name:"aqua",bg:"bg-cyan-400",text:"text-black",colorClass:"text-cyan-500"}],X=j=>j<1?(console.error(`Invalid fiber/ribbon number: ${j}`),ue[0]):ue[(j-1)%12],ie=(j,le,ne)=>{const ce=Math.ceil(j/ne),W=Math.ceil(le/ne),F=(j-1)%ne+1,H=(le-1)%ne+1,B=({num:me})=>{const K=X(me);return(me-1)%12===5?y.jsxs("span",{className:"inline-block px-2 py-0.5 rounded border-2 border-black bg-slate-300 text-white font-mono font-semibold text-xs",children:["R",me]}):y.jsxs("span",{className:`inline-block px-2 py-0.5 rounded border-2 ${K.colorClass} font-mono font-semibold text-xs`,style:{borderColor:"currentColor"},children:["R",me]})},ee=({num:me})=>{const K=X(me);return y.jsx("span",{className:`inline-block px-2 py-0.5 rounded border border-black ${K.bg} ${K.text} font-mono font-semibold text-xs`,children:me})};if(ce===W)return y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(B,{num:ce}),y.jsx("span",{children:":"}),y.jsx(ee,{num:F}),y.jsx("span",{children:"-"}),y.jsx(ee,{num:H})]});{const me=[],K=F!==1,Ae=H!==ne;if(!K&&!Ae)return ce===W-1?y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(B,{num:ce}),y.jsx("span",{children:"-"}),y.jsx(B,{num:W})]}):y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(B,{num:ce}),y.jsx("span",{children:"-"}),y.jsx(B,{num:W})]});K&&me.push(y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(B,{num:ce}),y.jsx("span",{children:":"}),y.jsx(ee,{num:F}),y.jsx("span",{children:"-"}),y.jsx(ee,{num:ne})]},`start-${ce}`));const Ze=K?ce+1:ce,be=Ae?W-1:W;if(Ze<=be)for(let ge=Ze;ge<=be;ge++)me.push(y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(B,{num:ge}),y.jsx("span",{children:":"}),y.jsx(ee,{num:1}),y.jsx("span",{children:"-"}),y.jsx(ee,{num:ne})]},`full-${ge}`));return Ae&&me.push(y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(B,{num:W}),y.jsx("span",{children:":"}),y.jsx(ee,{num:1}),y.jsx("span",{children:"-"}),y.jsx(ee,{num:H})]},`end-${W}`)),y.jsx("span",{className:"flex flex-col gap-1",children:me.map((ge,Te)=>y.jsx("span",{children:ge},Te))})}};return f?y.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading circuits..."}):y.jsxs(al,{"data-testid":"card-circuit-management",children:[y.jsxs(Pu,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-4",children:[y.jsx(Au,{className:"text-lg",children:"Circuit Details"}),y.jsxs("div",{className:"flex items-center gap-2",children:[Z?y.jsxs(Kk,{className:"gap-1 bg-green-600 hover:bg-green-700","data-testid":"badge-validation-pass",children:[y.jsx(nR,{className:"h-3 w-3"}),"Pass"]}):y.jsxs(Kk,{variant:"destructive",className:"gap-1","data-testid":"badge-validation-fail",children:[y.jsx(Jq,{className:"h-3 w-3"}),"Fail"]}),y.jsxs("span",{className:"text-sm text-muted-foreground","data-testid":"text-cable-size",children:["Total Fiber Count: ",U,"/",e.fiberCount]})]})]}),y.jsxs(ol,{className:"space-y-4",children:[y.jsxs("div",{className:"flex gap-2 items-end",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx(fa,{htmlFor:"circuitId",className:"text-xs",children:"Circuit ID"}),y.jsx(Sc,{id:"circuitId","data-testid":"input-circuit-id",value:r,onChange:j=>n(j.target.value),onKeyDown:j=>j.key==="Enter"&&I(),placeholder:"e.g., lg,33-36 or lg 33 36",className:"text-sm"})]}),y.jsx(Ht,{variant:"outline",size:"icon",onClick:()=>u(!0),title:"Extract text from image (OCR)","data-testid":"button-open-ocr",children:y.jsx(sR,{className:"h-4 w-4"})}),y.jsx(Ht,{size:"icon","data-testid":"button-add-circuit",onClick:I,disabled:x.isPending,children:y.jsx(iR,{className:"h-4 w-4"})})]}),c.length>0&&y.jsx("div",{className:"rounded-md border",children:y.jsxs(df,{children:[y.jsx(ff,{children:y.jsxs(er,{children:[e.type==="Distribution"&&y.jsx(It,{className:"w-[10%]",children:"Splice"}),y.jsx(It,{className:e.type==="Distribution"?"w-[30%]":"w-[35%]",children:"Circuit ID"}),y.jsx(It,{children:"Fiber Strands"}),y.jsx(It,{className:"w-[12%]",children:"Fiber Count"}),y.jsx(It,{className:"w-[15%] text-right",children:"Actions"})]})}),y.jsx(pf,{children:c.map((j,le)=>{const ne=ie(j.fiberStart,j.fiberEnd,e.ribbonSize),ce=i===j.id;return y.jsxs(er,{"data-testid":`row-circuit-${j.id}`,children:[e.type==="Distribution"&&y.jsx(Xe,{children:y.jsx(_B,{checked:j.isSpliced===1,onCheckedChange:W=>S(j,W),"data-testid":`checkbox-spliced-${j.id}`,disabled:ce})}),y.jsx(Xe,{className:"font-mono text-sm","data-testid":`text-circuit-id-${j.id}`,children:ce?y.jsx(Sc,{value:a,onChange:W=>o(W.target.value),onKeyDown:W=>{W.key==="Enter"&&D(j.id),W.key==="Escape"&&A()},className:"text-sm font-mono h-8","data-testid":`input-edit-circuit-${j.id}`,autoFocus:!0}):j.circuitId}),y.jsx(Xe,{className:"font-mono text-sm","data-testid":`text-fiber-range-${j.id}`,children:ne}),y.jsx(Xe,{className:"text-sm","data-testid":`text-fiber-count-${j.id}`,children:j.fiberEnd-j.fiberStart+1}),y.jsx(Xe,{className:"text-right",children:y.jsx("div",{className:"flex justify-end gap-1",children:ce?y.jsxs(y.Fragment,{children:[y.jsx(Ht,{size:"icon",variant:"ghost",onClick:()=>D(j.id),disabled:b.isPending,"data-testid":`button-save-circuit-${j.id}`,children:y.jsx(Af,{className:"h-4 w-4 text-green-600"})}),y.jsx(Ht,{size:"icon",variant:"ghost",onClick:A,"data-testid":`button-cancel-edit-${j.id}`,children:y.jsx(Rf,{className:"h-4 w-4 text-red-600"})})]}):y.jsxs(y.Fragment,{children:[y.jsx(Ht,{size:"icon",variant:"ghost",onClick:()=>E(j),"data-testid":`button-edit-circuit-${j.id}`,children:y.jsx(qh,{className:"h-4 w-4"})}),y.jsx(Ht,{size:"icon",variant:"ghost",onClick:()=>g.mutate({id:j.id,direction:"up"}),disabled:le===0||g.isPending,"data-testid":`button-move-up-${j.id}`,children:y.jsx(rR,{className:"h-4 w-4"})}),y.jsx(Ht,{size:"icon",variant:"ghost",onClick:()=>g.mutate({id:j.id,direction:"down"}),disabled:le===c.length-1||g.isPending,"data-testid":`button-move-down-${j.id}`,children:y.jsx(Jb,{className:"h-4 w-4"})}),y.jsx(Ht,{size:"icon",variant:"ghost","data-testid":`button-delete-circuit-${j.id}`,onClick:()=>v.mutate(j.id),disabled:v.isPending,children:y.jsx(aR,{className:"h-4 w-4"})})]})})})]},j.id)})})]})}),c.length===0&&y.jsx("div",{className:"text-center py-6 text-sm text-muted-foreground",children:"No circuits defined. Add a circuit to get started."})]}),y.jsx(gB,{open:l,onOpenChange:u,onTextExtracted:j=>{n(le=>le?`${le}
${j}`:j)}})]})}var g1="Switch",[_X,KX]=Oi(g1),[$X,SX]=_X(g1),$B=P.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:i,defaultChecked:s,required:a,disabled:o,value:l="on",onCheckedChange:u,form:c,...f}=e,[p,w]=P.useState(null),x=or(t,S=>w(S)),v=P.useRef(!1),C=p?c||!!p.closest("form"):!0,[b=!1,g]=vo({prop:i,defaultProp:s,onChange:u});return y.jsxs($X,{scope:r,checked:b,disabled:o,children:[y.jsx(kt.button,{type:"button",role:"switch","aria-checked":b,"aria-required":a,"data-state":kB(b),"data-disabled":o?"":void 0,disabled:o,value:l,...f,ref:x,onClick:ht(e.onClick,S=>{g(E=>!E),C&&(v.current=S.isPropagationStopped(),v.current||S.stopPropagation())})}),C&&y.jsx(CX,{control:p,bubbles:!v.current,name:n,value:l,checked:b,required:a,disabled:o,form:c,style:{transform:"translateX(-100%)"}})]})});$B.displayName=g1;var SB="SwitchThumb",CB=P.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,i=SX(SB,r);return y.jsx(kt.span,{"data-state":kB(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t})});CB.displayName=SB;var CX=e=>{const{control:t,checked:r,bubbles:n=!0,...i}=e,s=P.useRef(null),a=Dx(r),o=lx(t);return P.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(u,"checked").set;if(a!==r&&f){const p=new Event("click",{bubbles:n});f.call(l,r),l.dispatchEvent(p)}},[a,r,n]),y.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:s,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function kB(e){return e?"checked":"unchecked"}var EB=$B,kX=CB;const Yh=P.forwardRef(({className:e,...t},r)=>y.jsx(EB,{className:ft("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:y.jsx(kX,{className:ft("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Yh.displayName=EB.displayName;function EX(){const{toast:e}=_g(),[t,r]=P.useState(null),[n,i]=P.useState(!1),[s,a]=P.useState(null),[o,l]=P.useState(!1),[u,c]=P.useState(!1),[f,p]=P.useState("Feed"),[w,x]=P.useState(144),[v,C]=P.useState(!1),[b,g]=P.useState(!1),[S,E]=P.useState(""),[A,M]=P.useState(!0),{data:D=[],isLoading:I}=af({queryKey:["/api/cables"]}),{data:U=[],isLoading:Z}=af({queryKey:["/api/circuits"]}),ue=P.useMemo(()=>{const K=D.filter(Ze=>Ze.type==="Feed"),Ae=D.filter(Ze=>Ze.type==="Distribution");return[...K,...Ae]},[D]),X=ha({mutationFn:async K=>await As("POST","/api/cables",K),onSuccess:()=>{vr.invalidateQueries({queryKey:["/api/cables"]}),vr.invalidateQueries({queryKey:["/api/circuits"]}),i(!1),e({title:"Cable created successfully"})},onError:K=>{const Ae=(K==null?void 0:K.message)||"Failed to create cable";e({title:Ae,variant:"destructive"})}}),ie=ha({mutationFn:async({id:K,data:Ae})=>await As("PUT",`/api/cables/${K}`,Ae),onSuccess:()=>{vr.invalidateQueries({queryKey:["/api/cables"]}),vr.invalidateQueries({queryKey:["/api/circuits"]}),i(!1),a(null),e({title:"Cable updated successfully"})},onError:K=>{const Ae=(K==null?void 0:K.message)||"Failed to update cable";e({title:Ae,variant:"destructive"})}}),j=ha({mutationFn:async K=>await As("DELETE",`/api/cables/${K}`,void 0),onSuccess:()=>{vr.invalidateQueries({queryKey:["/api/cables"]}),vr.invalidateQueries({queryKey:["/api/circuits"]}),e({title:"Cable deleted successfully"})},onError:K=>{var Ae,Ze;(Ae=K==null?void 0:K.message)!=null&&Ae.includes("not found")||(Ze=K==null?void 0:K.message)!=null&&Ze.includes("404")?(vr.invalidateQueries({queryKey:["/api/cables"]}),vr.invalidateQueries({queryKey:["/api/circuits"]}),e({title:"Cable removed from display"})):e({title:"Failed to delete cable",variant:"destructive"})}}),le=ha({mutationFn:async()=>await As("DELETE","/api/reset",void 0),onSuccess:async()=>{await vr.refetchQueries({queryKey:["/api/cables"]}),await vr.refetchQueries({queryKey:["/api/circuits"]}),r(null),C(!1),e({title:"All data has been reset"})},onError:()=>{e({title:"Failed to reset data",variant:"destructive"})}}),ne=()=>{E(""),g(!0)},ce=async()=>{const Ae=JSON.stringify({cables:D,circuits:U},null,2),Ze=new Blob([Ae],{type:"application/json"}),be=URL.createObjectURL(Ze),ge=document.createElement("a");ge.href=be;const Te=S.trim()?`${S.trim()}.json`:`fiber-splice-project-${new Date().toISOString().replace(/[:.]/g,"-")}.json`;ge.download=Te,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(be),g(!1),E(""),e({title:"Project saved",description:`${D.length} cable(s) and ${U.length} circuit(s) saved to file`})},W=()=>{const K=document.createElement("input");K.type="file",K.accept="application/json",K.onchange=async Ae=>{var be;const Ze=(be=Ae.target.files)==null?void 0:be[0];if(Ze)try{const ge=await Ze.text(),Te=JSON.parse(ge);if(!Te.cables||!Te.circuits){e({title:"Invalid project file format",variant:"destructive"});return}await As("DELETE","/api/reset",void 0);const{storage:Ee}=await pw(async()=>{const{storage:Fe}=await Promise.resolve().then(()=>eq);return{storage:Fe}},void 0),{db:We}=await pw(async()=>{const{db:Fe}=await Promise.resolve().then(()=>J5);return{db:Fe}},void 0);await We.cables.bulkAdd(Te.cables),await We.circuits.bulkAdd(Te.circuits),vr.invalidateQueries({queryKey:["/api/cables"]}),vr.invalidateQueries({queryKey:["/api/circuits"]}),e({title:"Project loaded successfully",description:`${Te.cables.length} cable(s) and ${Te.circuits.length} circuit(s) restored`})}catch{e({title:"Failed to load project file",variant:"destructive"})}},K.click()},F=K=>{s?ie.mutate({id:s.id,data:K}):X.mutate(K)},H=P.useMemo(()=>U.filter(K=>{const Ae=D.find(Ze=>Ze.id===K.cableId);return K.isSpliced===1&&(Ae==null?void 0:Ae.type)==="Distribution"}),[U,D]),B=P.useMemo(()=>D.filter(K=>K.type==="Distribution"),[D]),ee=P.useMemo(()=>D.filter(K=>K.type==="Feed"),[D]),me=D.find(K=>K.id===t);return y.jsxs("div",{className:"min-h-screen bg-background",children:[y.jsx("header",{className:"border-b",children:y.jsx("div",{className:"container mx-auto px-6 py-4",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("div",{className:"flex items-center gap-3",children:y.jsx("h1",{className:"text-xl font-semibold",children:"Fiber Splice Manager"})}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs(Ht,{variant:"outline",size:"sm",onClick:W,"data-testid":"button-load",children:[y.jsx(oR,{className:"h-4 w-4 mr-2"}),"Load"]}),y.jsxs(Ht,{variant:"default",size:"sm",onClick:ne,"data-testid":"button-save",children:[y.jsx(p$,{className:"h-4 w-4 mr-2"}),"Save"]}),y.jsxs(Ht,{variant:"destructive",size:"sm",onClick:()=>C(!0),"data-testid":"button-reset",children:[y.jsx(i8,{className:"h-4 w-4 mr-2"}),"Reset"]})]})]})})}),y.jsx("main",{className:"container mx-auto px-6 py-6",children:y.jsxs(A9,{defaultValue:"input",className:"w-full",children:[y.jsxs(hO,{className:"mb-6","data-testid":"tabs-main",children:[y.jsxs(Md,{value:"input","data-testid":"tab-input-data",children:[y.jsx(f$,{className:"h-4 w-4 mr-2"}),"Home"]}),(()=>{const K=new Set;return H.forEach(Ae=>{var ge;const be=(ge=Ae.circuitId.split(",")[0])==null?void 0:ge.trim();be&&K.add(be)}),Array.from(K).sort().map(Ae=>y.jsxs(Md,{value:`prefix-splice-${Ae}`,"data-testid":`tab-prefix-splice-${Ae}`,children:[y.jsx(n8,{className:"h-4 w-4 mr-2"}),Ae," Splice"]},`prefix-${Ae}`))})(),B.map(K=>y.jsxs(Md,{value:`splice-${K.id}`,"data-testid":`tab-splice-${K.id}`,children:[y.jsx(h$,{className:"h-4 w-4 mr-2"}),K.name]},K.id)),ee.map(K=>y.jsxs(Md,{value:`feed-splice-${K.id}`,"data-testid":`tab-feed-splice-${K.id}`,children:[y.jsx(h$,{className:"h-4 w-4 mr-2"}),K.name]},`feed-${K.id}`))]}),y.jsx(zd,{value:"input",className:"space-y-6",children:y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I?y.jsx("div",{className:"text-muted-foreground",children:"Loading cables..."}):ue.length===0?y.jsx("div",{className:"text-muted-foreground","data-testid":"text-no-cables",children:"No cables yet. Add a cable to get started."}):ue.map(K=>{const be=U.filter(Te=>Te.cableId===K.id).reduce((Te,Ee)=>Te+(Ee.fiberEnd-Ee.fiberStart+1),0)===K.fiberCount,ge=K.type==="Feed"?"bg-green-100 dark:bg-green-950/50 hover:bg-green-200 dark:hover:bg-green-900/50":"bg-blue-100 dark:bg-blue-950/50 hover:bg-blue-200 dark:hover:bg-blue-900/50";return y.jsxs(Ht,{variant:t===K.id?"default":"outline",size:"sm",onClick:()=>r(K.id),className:`flex items-center gap-2 ${t!==K.id?ge:""}`,"data-testid":`button-cable-${K.id}`,children:[y.jsx(f$,{className:"h-4 w-4"}),y.jsx("span",{children:K.name}),y.jsxs("span",{className:"text-xs opacity-70",children:["(",K.fiberCount,")"]}),y.jsx("span",{className:`ml-1 text-xs px-1.5 py-0.5 rounded ${be?"bg-green-500/20 text-green-600 dark:text-green-400":"bg-red-500/20 text-red-600 dark:text-red-400"}`,children:be?"Pass":"Fail"})]},K.id)}),y.jsxs(Ht,{size:"sm",variant:"outline",onClick:()=>{a(null),i(!0)},"data-testid":"button-add-cable",className:"border-dashed",children:[y.jsx(iR,{className:"h-4 w-4 mr-1"}),"Add Cable"]})]}),y.jsx("div",{children:y.jsxs(al,{children:[y.jsxs(Pu,{className:"flex flex-row items-center justify-between gap-4",children:[y.jsx(Au,{children:me?`Cable: ${me.name}`:"Select a cable"}),me&&y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs(Ht,{variant:"outline",size:"sm",onClick:()=>{a(me),i(!0)},"data-testid":"button-edit-cable",children:[y.jsx(qh,{className:"h-4 w-4 mr-1"}),"Edit"]}),y.jsxs(Ht,{variant:"destructive",size:"sm",onClick:()=>{j.mutate(me.id),r(null)},"data-testid":"button-delete-cable",children:[y.jsx(aR,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]}),y.jsx(ol,{children:me?y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-muted-foreground",children:"Type:"}),o?y.jsxs(y.Fragment,{children:[y.jsxs("select",{value:f,onChange:K=>p(K.target.value),className:"ml-2 px-2 py-1 border rounded text-sm","data-testid":"select-edit-type",autoFocus:!0,children:[y.jsx("option",{value:"Feed",children:"Feed"}),y.jsx("option",{value:"Distribution",children:"Distribution"})]}),y.jsx(Ht,{variant:"ghost",size:"sm",className:"h-6",onClick:()=>{ie.mutate({id:me.id,data:{name:me.name,fiberCount:me.fiberCount,type:f}}),l(!1)},"data-testid":"button-save-type",children:y.jsx(Af,{className:"h-3 w-3"})}),y.jsx(Ht,{variant:"ghost",size:"sm",className:"h-6",onClick:()=>l(!1),"data-testid":"button-cancel-type",children:y.jsx(Rf,{className:"h-3 w-3"})})]}):y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"ml-2 font-medium",children:me.type}),y.jsx(Ht,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>{p(me.type),l(!0)},"data-testid":"button-edit-type",children:y.jsx(qh,{className:"h-3 w-3"})})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-muted-foreground",children:"Cable Size:"}),u?y.jsxs(y.Fragment,{children:[y.jsx("input",{type:"number",value:w,onChange:K=>x(parseInt(K.target.value)||0),className:"ml-2 w-20 px-2 py-1 border rounded text-sm font-mono","data-testid":"input-edit-size",autoFocus:!0,min:"12",step:"12"}),y.jsx(Ht,{variant:"ghost",size:"sm",className:"h-6",onClick:()=>{ie.mutate({id:me.id,data:{name:me.name,fiberCount:w,type:me.type}}),c(!1)},"data-testid":"button-save-size",children:y.jsx(Af,{className:"h-3 w-3"})}),y.jsx(Ht,{variant:"ghost",size:"sm",className:"h-6",onClick:()=>c(!1),"data-testid":"button-cancel-size",children:y.jsx(Rf,{className:"h-3 w-3"})})]}):y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"ml-2 font-mono font-medium",children:me.fiberCount}),y.jsx(Ht,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>{x(me.fiberCount),c(!0)},"data-testid":"button-edit-size",children:y.jsx(qh,{className:"h-3 w-3"})})]})]})]}),y.jsx(xX,{cable:me})]}):y.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Select a cable from the list to view details"})})]})})]})}),(()=>{const K={};H.forEach(He=>{var gt;const vt=((gt=He.circuitId.split(",")[0])==null?void 0:gt.trim())||"Unknown";K[vt]||(K[vt]=[]),K[vt].push(He)});const Ae=Object.keys(K).sort(),Ze=[{name:"blue",bg:"bg-blue-500",text:"text-white",colorClass:"text-blue-500"},{name:"orange",bg:"bg-orange-500",text:"text-white",colorClass:"text-orange-500"},{name:"green",bg:"bg-green-600",text:"text-white",colorClass:"text-green-600"},{name:"brown",bg:"bg-amber-700",text:"text-white",colorClass:"text-amber-700"},{name:"slate",bg:"bg-slate-500",text:"text-white",colorClass:"text-slate-500"},{name:"white",bg:"bg-white",text:"text-black",colorClass:"text-slate-700"},{name:"red",bg:"bg-red-600",text:"text-white",colorClass:"text-red-600"},{name:"black",bg:"bg-black",text:"text-white",colorClass:"text-slate-900"},{name:"yellow",bg:"bg-yellow-400",text:"text-black",colorClass:"text-yellow-500"},{name:"violet",bg:"bg-purple-600",text:"text-white",colorClass:"text-purple-600"},{name:"pink",bg:"bg-pink-500",text:"text-white",colorClass:"text-pink-500"},{name:"aqua",bg:"bg-cyan-400",text:"text-black",colorClass:"text-cyan-500"}],be=12,ge=He=>Math.ceil(He/be),Te=He=>(He-1)%be+1,Ee=He=>Ze[(He-1)%12],We=He=>Ze[(He-1)%12],Fe=He=>{var ot,rr;const Ve=He.split(",");if(Ve.length<2)return 0;const gt=(((ot=Ve[1])==null?void 0:ot.trim())||"").split("-");return parseInt(((rr=gt[0])==null?void 0:rr.trim())||"0")||0};return Ae.map(He=>{const Ve=[...K[He]].sort((gt,ot)=>Fe(gt.circuitId)-Fe(ot.circuitId)),vt=A?Ve.reduce((gt,ot)=>{const rr=ot.fiberEnd-ot.fiberStart+1;return gt+rr/12},0):Ve.reduce((gt,ot)=>gt+(ot.fiberEnd-ot.fiberStart+1),0);return y.jsx(zd,{value:`prefix-splice-${He}`,children:y.jsxs(al,{children:[y.jsx(Pu,{children:y.jsxs(Au,{children:[He," Splice"]})}),y.jsx(ol,{children:Ve.length===0?y.jsxs("div",{className:"text-center py-12 text-muted-foreground","data-testid":`text-no-prefix-splices-${He}`,children:["No circuits marked as spliced for ",He,"."]}):y.jsx("div",{className:"rounded-md border overflow-x-auto inline-block",children:y.jsxs(df,{className:"text-sm w-auto",children:[y.jsxs(ff,{children:[y.jsxs(er,{className:"bg-muted/50",children:[y.jsx(It,{rowSpan:3,className:"text-center font-semibold py-1 px-2 whitespace-nowrap align-middle",children:"#"}),y.jsx(It,{colSpan:A?2:3,rowSpan:2,className:"text-center font-semibold bg-green-100 dark:bg-green-950/50 py-1 px-2 align-middle",children:"Feed"}),y.jsx(It,{className:"text-center py-1 px-2",children:y.jsxs("div",{className:"flex items-center justify-center gap-1",children:[y.jsx(fa,{htmlFor:`view-toggle-prefix-${He}`,className:"text-xs text-muted-foreground",children:"Strands"}),y.jsx(Yh,{id:`view-toggle-prefix-${He}`,checked:A,onCheckedChange:M,"data-testid":`switch-view-mode-prefix-${He}`,className:"scale-75"}),y.jsx(fa,{htmlFor:`view-toggle-prefix-${He}`,className:"text-xs text-muted-foreground",children:"Ribbons"})]})}),y.jsx(It,{colSpan:A?2:3,rowSpan:2,className:"text-center font-semibold bg-blue-100 dark:bg-blue-950/50 py-1 px-2 align-middle",children:"Distribution"})]}),y.jsx(er,{className:"bg-muted/50",children:y.jsxs(It,{className:"text-center font-semibold py-1 px-2 whitespace-nowrap",children:["Splices : ",vt]})}),y.jsxs(er,{children:[y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Cable"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Ribbon"}),!A&&y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Strand"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Circuit"}),!A&&y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Strand"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Ribbon"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Cable"})]})]}),y.jsx(pf,{children:(()=>{let gt=0;return Ve.flatMap((ot,rr)=>{const Zt=D.find(De=>De.id===ot.cableId),cn=ot.feedCableId?D.find(De=>De.id===ot.feedCableId):void 0,Ut=rr%2===0?"bg-white dark:bg-background":"bg-gray-200 dark:bg-muted/50";if(!cn)return gt++,[y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ot.circuitId," - No feed cable selected."]})]},ot.id)];const G=ot.circuitId.split(","),ve=G[0]||"",Ne=(G[1]||"").split("-");if(Ne.length!==2||!Ne[0]||!Ne[1])return gt++,[y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ot.circuitId," - Invalid format."]})]},ot.id)];const ke=parseInt(Ne[0].trim()),Pe=parseInt(Ne[1].trim());if(isNaN(ke)||isNaN(Pe))return gt++,[y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ot.circuitId," - Invalid range."]})]},ot.id)];if(A){const De=[],tt=ot.fiberStart,pt=ot.fiberEnd,wt=ot.feedFiberStart||ot.fiberStart,nr=ot.feedFiberEnd||ot.fiberEnd;if(!tt||!pt||!wt||!nr)return gt++,[y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{colSpan:4,className:"text-center text-muted-foreground",children:["Circuit ",ot.circuitId," - Invalid fiber positions."]})]},ot.id)];let Wt=tt,lr=wt;for(;Wt<=pt;){const ir=ge(Wt),Ye=ge(lr),Vr=ir*be,jr=Math.min(Vr,pt),tn=Ye*be,Be=Math.min(tn,nr),wi=jr-Wt+1,ji=Be-lr+1,dn=Math.min(wi,ji),Jn=Wt-tt,Bn=ke+Jn,bi=Bn+dn-1,xi=Te(Wt),vn=Te(Wt+dn-1),Yt=Te(lr),Hs=Te(lr+dn-1),Gs=We(Ye),ur=We(ir);gt++,De.push(y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[cn.name,"-",cn.fiberCount]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${Gs.colorClass}`,children:["R",Ye,":",Yt,Yt!==Hs?`-${Hs}`:""]}),y.jsxs(Xe,{className:"text-center font-mono font-semibold py-1 px-2 whitespace-nowrap",children:[ve,",",Bn,"-",bi]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${ur.colorClass}`,children:["R",ir,":",xi,xi!==vn?`-${vn}`:""]}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[Zt==null?void 0:Zt.name,"-",Zt==null?void 0:Zt.fiberCount]})]},`${ot.id}-segment-${Wt}`)),Wt+=dn,lr+=dn}return De}else{const De=[];if(!ot.fiberStart||!ot.fiberEnd)return gt++,[y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{colSpan:6,className:"text-center text-muted-foreground",children:["Circuit ",ot.circuitId," - Invalid fiber positions."]})]},ot.id)];for(let tt=0;tt<ot.fiberEnd-ot.fiberStart+1;tt++){const pt=ot.fiberStart+tt,wt=(ot.feedFiberStart||ot.fiberStart)+tt,nr=ge(pt),Wt=Te(pt),lr=ge(wt),ir=Te(wt),Ye=ke+tt,Vr=Ee(ir),jr=Ee(Wt),tn=We(lr),Be=We(nr);gt++,De.push(y.jsxs(er,{className:Ut,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:gt}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[cn.name,"-",cn.fiberCount]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${tn.colorClass}`,children:["R",lr]}),y.jsx(Xe,{className:"text-center py-1 px-2",children:y.jsx("div",{className:`inline-block px-1.5 py-0.5 rounded border border-black ${Vr.bg} ${Vr.text} font-mono font-semibold text-xs`,children:ir})}),y.jsxs(Xe,{className:"text-center font-mono font-semibold py-1 px-2 whitespace-nowrap",children:[ve,",",Ye]}),y.jsx(Xe,{className:"text-center py-1 px-2",children:y.jsx("div",{className:`inline-block px-1.5 py-0.5 rounded border border-black ${jr.bg} ${jr.text} font-mono font-semibold text-xs`,children:Wt})}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${Be.colorClass}`,children:["R",nr]}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[Zt==null?void 0:Zt.name,"-",Zt==null?void 0:Zt.fiberCount]})]},`${ot.id}-fiber-${tt}`))}return De}})})()})]})})})]})},`prefix-${He}`)})})(),B.map(K=>{const Ae=H.filter(be=>be.cableId===K.id),Ze=A?Ae.reduce((be,ge)=>{const Te=ge.fiberEnd-ge.fiberStart+1;return be+Te/12},0):Ae.reduce((be,ge)=>be+(ge.fiberEnd-ge.fiberStart+1),0);return y.jsx(zd,{value:`splice-${K.id}`,children:y.jsxs(al,{children:[y.jsx(Pu,{children:y.jsxs(Au,{children:["Splice Mapping - ",K.name]})}),y.jsx(ol,{children:Z?y.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Loading circuits..."}):Ae.length===0?y.jsxs("div",{className:"text-center py-12 text-muted-foreground","data-testid":`text-no-spliced-circuits-${K.id}`,children:["No circuits marked as spliced yet for ",K.name,". Check circuits in the Home tab."]}):y.jsx("div",{className:"rounded-md border overflow-x-auto inline-block",children:y.jsxs(df,{className:"text-sm w-auto",children:[y.jsxs(ff,{children:[y.jsxs(er,{className:"bg-muted/50",children:[y.jsx(It,{rowSpan:3,className:"text-center font-semibold py-1 px-2 whitespace-nowrap align-middle",children:"#"}),y.jsx(It,{colSpan:A?2:3,rowSpan:2,className:"text-center font-semibold bg-green-100 dark:bg-green-950/50 py-1 px-2 align-middle",children:"Feed"}),y.jsx(It,{className:"text-center py-1 px-2",children:y.jsxs("div",{className:"flex items-center justify-center gap-1",children:[y.jsx(fa,{htmlFor:`view-toggle-${K.id}`,className:"text-xs text-muted-foreground",children:"Strands"}),y.jsx(Yh,{id:`view-toggle-${K.id}`,checked:A,onCheckedChange:M,"data-testid":`switch-view-mode-${K.id}`,className:"scale-75"}),y.jsx(fa,{htmlFor:`view-toggle-${K.id}`,className:"text-xs text-muted-foreground",children:"Ribbons"})]})}),y.jsx(It,{colSpan:A?2:3,rowSpan:2,className:"text-center font-semibold bg-blue-100 dark:bg-blue-950/50 py-1 px-2 align-middle",children:"Distribution"})]}),y.jsx(er,{className:"bg-muted/50",children:y.jsxs(It,{className:"text-center font-semibold py-1 px-2 whitespace-nowrap",children:["Splices : ",Ze]})}),y.jsxs(er,{children:[y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Cable"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Ribbon"}),!A&&y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Strand"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Circuit"}),!A&&y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Strand"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Ribbon"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Cable"})]})]}),y.jsx(pf,{children:(()=>{let be=0;return Ae.flatMap((ge,Te)=>{const Ee=D.find(Ne=>Ne.id===ge.cableId),We=ge.feedCableId?D.find(Ne=>Ne.id===ge.feedCableId):void 0,Fe=Te%2===0?"bg-white dark:bg-background":"bg-gray-200 dark:bg-muted/50";if(!We)return be++,[y.jsxs(er,{className:Fe,"data-testid":`row-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - No feed cable selected. Please re-check the circuit."]})]},ge.id)];const He=[{name:"blue",bg:"bg-blue-500",text:"text-white",colorClass:"text-blue-500"},{name:"orange",bg:"bg-orange-500",text:"text-white",colorClass:"text-orange-500"},{name:"green",bg:"bg-green-600",text:"text-white",colorClass:"text-green-600"},{name:"brown",bg:"bg-amber-700",text:"text-white",colorClass:"text-amber-700"},{name:"slate",bg:"bg-slate-500",text:"text-white",colorClass:"text-slate-500"},{name:"white",bg:"bg-white",text:"text-black",colorClass:"text-slate-700"},{name:"red",bg:"bg-red-600",text:"text-white",colorClass:"text-red-600"},{name:"black",bg:"bg-black",text:"text-white",colorClass:"text-slate-900"},{name:"yellow",bg:"bg-yellow-400",text:"text-black",colorClass:"text-yellow-500"},{name:"violet",bg:"bg-purple-600",text:"text-white",colorClass:"text-purple-600"},{name:"pink",bg:"bg-pink-500",text:"text-white",colorClass:"text-pink-500"},{name:"aqua",bg:"bg-cyan-400",text:"text-black",colorClass:"text-cyan-500"}],Ve=12,vt=Ne=>Math.ceil(Ne/Ve),gt=Ne=>(Ne-1)%Ve+1,ot=Ne=>He[(Ne-1)%12],rr=Ne=>He[(Ne-1)%12],Zt=ge.circuitId.split(","),cn=Zt[0]||"",G=(Zt[1]||"").split("-");if(G.length!==2||!G[0]||!G[1])return be++,[y.jsxs(er,{className:Fe,"data-testid":`row-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid circuit ID format."]})]},ge.id)];const ve=parseInt(G[0].trim()),_e=parseInt(G[1].trim());if(isNaN(ve)||isNaN(_e))return be++,[y.jsxs(er,{className:Fe,"data-testid":`row-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid circuit number range."]})]},ge.id)];if(A){const Ne=[],ke=ge.fiberStart,Pe=ge.fiberEnd,De=ge.feedFiberStart||ge.fiberStart,tt=ge.feedFiberEnd||ge.fiberEnd;if(!ke||!Pe||!De||!tt||isNaN(ke)||isNaN(Pe)||isNaN(De)||isNaN(tt))return be++,[y.jsxs(er,{className:Fe,"data-testid":`row-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:4,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid fiber positions."]})]},ge.id)];let pt=ke,wt=De;for(;pt<=Pe;){const nr=vt(pt),Wt=vt(wt),lr=nr*Ve,ir=Math.min(lr,Pe),Ye=Wt*Ve,Vr=Math.min(Ye,tt),jr=ir-pt+1,tn=Vr-wt+1,Be=Math.min(jr,tn),wi=pt-ke,ji=ve+wi,dn=ji+Be-1,Jn=gt(pt),Bn=gt(pt+Be-1),bi=gt(wt),xi=gt(wt+Be-1),vn=rr(Wt),Yt=rr(nr);be++,Ne.push(y.jsxs(er,{className:Fe,"data-testid":`row-ribbon-${ge.id}-${pt}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[We.name,"-",We.fiberCount]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${vn.colorClass}`,children:["R",Wt,":",bi,bi!==xi?`-${xi}`:""]}),y.jsxs(Xe,{className:"text-center font-mono font-semibold py-1 px-2 whitespace-nowrap",children:[cn,",",ji,"-",dn]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${Yt.colorClass}`,children:["R",nr,":",Jn,Jn!==Bn?`-${Bn}`:""]}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[Ee==null?void 0:Ee.name,"-",Ee==null?void 0:Ee.fiberCount]})]},`${ge.id}-segment-${pt}`)),pt+=Be,wt+=Be}return Ne}else{const Ne=[];if(!ge.fiberStart||!ge.fiberEnd||isNaN(ge.fiberStart)||isNaN(ge.fiberEnd))return be++,[y.jsxs(er,{className:Fe,"data-testid":`row-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid fiber positions."]})]},ge.id)];for(let ke=0;ke<ge.fiberEnd-ge.fiberStart+1;ke++){const Pe=ge.fiberStart+ke,De=(ge.feedFiberStart||ge.fiberStart)+ke,tt=vt(Pe),pt=gt(Pe),wt=vt(De),nr=gt(De),Wt=ve+ke,lr=ot(nr),ir=ot(pt),Ye=rr(wt),Vr=rr(tt);be++,Ne.push(y.jsxs(er,{className:Fe,"data-testid":`row-fiber-${ge.id}-${ke}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[We.name,"-",We.fiberCount]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${Ye.colorClass}`,children:["R",wt]}),y.jsx(Xe,{className:"text-center py-1 px-2",children:y.jsx("div",{className:`inline-block px-1.5 py-0.5 rounded border border-black ${lr.bg} ${lr.text} font-mono font-semibold text-xs`,children:nr})}),y.jsxs(Xe,{className:"text-center font-mono font-semibold py-1 px-2 whitespace-nowrap",children:[cn,",",Wt]}),y.jsx(Xe,{className:"text-center py-1 px-2",children:y.jsx("div",{className:`inline-block px-1.5 py-0.5 rounded border border-black ${ir.bg} ${ir.text} font-mono font-semibold text-xs`,children:pt})}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${Vr.colorClass}`,children:["R",tt]}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[Ee==null?void 0:Ee.name,"-",Ee==null?void 0:Ee.fiberCount]})]},`${ge.id}-fiber-${ke}`))}return Ne}})})()})]})})})]})},K.id)}),ee.map(K=>{const Ae=U.filter(be=>be.isSpliced===1&&be.feedCableId===K.id).sort((be,ge)=>(be.feedFiberStart||0)-(ge.feedFiberStart||0)),Ze=A?Ae.reduce((be,ge)=>{const Te=(ge.fiberEnd||0)-(ge.fiberStart||0)+1;return be+Te/12},0):Ae.reduce((be,ge)=>be+((ge.fiberEnd||0)-(ge.fiberStart||0)+1),0);return y.jsx(zd,{value:`feed-splice-${K.id}`,children:y.jsxs(al,{children:[y.jsx(Pu,{children:y.jsxs(Au,{children:["Splice Mapping - ",K.name]})}),y.jsx(ol,{children:Z?y.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Loading circuits..."}):Ae.length===0?y.jsxs("div",{className:"text-center py-12 text-muted-foreground","data-testid":`text-no-feed-spliced-circuits-${K.id}`,children:["No Distribution circuits spliced to ",K.name," yet. Check circuits in Distribution cables."]}):y.jsx("div",{className:"rounded-md border overflow-x-auto inline-block",children:y.jsxs(df,{className:"text-sm w-auto",children:[y.jsxs(ff,{children:[y.jsxs(er,{className:"bg-muted/50",children:[y.jsx(It,{rowSpan:3,className:"text-center font-semibold py-1 px-2 whitespace-nowrap align-middle",children:"#"}),y.jsx(It,{colSpan:A?2:3,rowSpan:2,className:"text-center font-semibold bg-green-100 dark:bg-green-950/50 py-1 px-2 align-middle",children:"Feed"}),y.jsx(It,{className:"text-center py-1 px-2",children:y.jsxs("div",{className:"flex items-center justify-center gap-1",children:[y.jsx(fa,{htmlFor:`view-toggle-feed-${K.id}`,className:"text-xs text-muted-foreground",children:"Strands"}),y.jsx(Yh,{id:`view-toggle-feed-${K.id}`,checked:A,onCheckedChange:M,"data-testid":`switch-view-mode-feed-${K.id}`,className:"scale-75"}),y.jsx(fa,{htmlFor:`view-toggle-feed-${K.id}`,className:"text-xs text-muted-foreground",children:"Ribbons"})]})}),y.jsx(It,{colSpan:A?2:3,rowSpan:2,className:"text-center font-semibold bg-blue-100 dark:bg-blue-950/50 py-1 px-2 align-middle",children:"Distribution"})]}),y.jsx(er,{className:"bg-muted/50",children:y.jsxs(It,{className:"text-center font-semibold py-1 px-2 whitespace-nowrap",children:["Splices : ",Ze]})}),y.jsxs(er,{children:[y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Cable"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Ribbon"}),!A&&y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Strand"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Circuit"}),!A&&y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Strand"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Ribbon"}),y.jsx(It,{className:"text-center py-1 px-2 whitespace-nowrap",children:"Cable"})]})]}),y.jsx(pf,{children:(()=>{let be=0;return Ae.flatMap((ge,Te)=>{const Ee=D.find(_e=>_e.id===ge.cableId),We=Te%2===0?"bg-white dark:bg-background":"bg-gray-200 dark:bg-muted/50",Fe=[{name:"blue",bg:"bg-blue-500",text:"text-white",colorClass:"text-blue-500"},{name:"orange",bg:"bg-orange-500",text:"text-white",colorClass:"text-orange-500"},{name:"green",bg:"bg-green-600",text:"text-white",colorClass:"text-green-600"},{name:"brown",bg:"bg-amber-700",text:"text-white",colorClass:"text-amber-700"},{name:"slate",bg:"bg-slate-500",text:"text-white",colorClass:"text-slate-500"},{name:"white",bg:"bg-white",text:"text-black",colorClass:"text-slate-700"},{name:"red",bg:"bg-red-600",text:"text-white",colorClass:"text-red-600"},{name:"black",bg:"bg-black",text:"text-white",colorClass:"text-slate-900"},{name:"yellow",bg:"bg-yellow-400",text:"text-black",colorClass:"text-yellow-500"},{name:"violet",bg:"bg-purple-600",text:"text-white",colorClass:"text-purple-600"},{name:"pink",bg:"bg-pink-500",text:"text-white",colorClass:"text-pink-500"},{name:"aqua",bg:"bg-cyan-400",text:"text-black",colorClass:"text-cyan-500"}],He=12,Ve=_e=>Math.ceil(_e/He),vt=_e=>(_e-1)%He+1,gt=_e=>Fe[(_e-1)%12],ot=_e=>Fe[(_e-1)%12],rr=ge.circuitId.split(","),Zt=rr[0]||"",Ut=(rr[1]||"").split("-");if(Ut.length!==2||!Ut[0]||!Ut[1])return be++,[y.jsxs(er,{className:We,"data-testid":`row-feed-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid circuit ID format."]})]},ge.id)];const G=parseInt(Ut[0].trim()),ve=parseInt(Ut[1].trim());if(isNaN(G)||isNaN(ve))return be++,[y.jsxs(er,{className:We,"data-testid":`row-feed-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:A?4:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid circuit number range."]})]},ge.id)];if(A){const _e=[],Ne=ge.fiberStart,ke=ge.fiberEnd,Pe=ge.feedFiberStart||ge.fiberStart,De=ge.feedFiberEnd||ge.fiberEnd;if(!Ne||!ke||!Pe||!De||isNaN(Ne)||isNaN(ke)||isNaN(Pe)||isNaN(De))return be++,[y.jsxs(er,{className:We,"data-testid":`row-feed-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:4,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid fiber positions."]})]},ge.id)];let tt=Ne,pt=Pe;for(;tt<=ke;){const wt=Ve(tt),nr=Ve(pt),Wt=wt*He,lr=Math.min(Wt,ke),ir=nr*He,Ye=Math.min(ir,De),Vr=lr-tt+1,jr=Ye-pt+1,tn=Math.min(Vr,jr),Be=tt-Ne,wi=G+Be,ji=wi+tn-1,dn=vt(tt),Jn=vt(tt+tn-1),Bn=vt(pt),bi=vt(pt+tn-1),xi=ot(nr),vn=ot(wt);be++,_e.push(y.jsxs(er,{className:We,"data-testid":`row-feed-ribbon-${ge.id}-${tt}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[K.name,"-",K.fiberCount]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${xi.colorClass}`,children:["R",nr,":",Bn,Bn!==bi?`-${bi}`:""]}),y.jsxs(Xe,{className:"text-center font-mono font-semibold py-1 px-2 whitespace-nowrap",children:[Zt,",",wi,"-",ji]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${vn.colorClass}`,children:["R",wt,":",dn,dn!==Jn?`-${Jn}`:""]}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[Ee==null?void 0:Ee.name,"-",Ee==null?void 0:Ee.fiberCount]})]},`${ge.id}-feed-segment-${tt}`)),tt+=tn,pt+=tn}return _e}else{const _e=[];if(!ge.fiberStart||!ge.fiberEnd||isNaN(ge.fiberStart)||isNaN(ge.fiberEnd))return be++,[y.jsxs(er,{className:We,"data-testid":`row-feed-spliced-circuit-${ge.id}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{colSpan:6,className:"text-center text-muted-foreground",children:["Circuit ",ge.circuitId," in ",Ee==null?void 0:Ee.name," - Invalid fiber positions."]})]},ge.id)];for(let Ne=0;Ne<ge.fiberEnd-ge.fiberStart+1;Ne++){const ke=ge.fiberStart+Ne,Pe=(ge.feedFiberStart||ge.fiberStart)+Ne,De=Ve(ke),tt=vt(ke),pt=Ve(Pe),wt=vt(Pe),nr=G+Ne,Wt=gt(wt),lr=gt(tt),ir=ot(pt),Ye=ot(De);be++,_e.push(y.jsxs(er,{className:We,"data-testid":`row-feed-fiber-${ge.id}-${Ne}`,children:[y.jsx(Xe,{className:"text-center font-mono py-1 px-2",children:be}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[K.name,"-",K.fiberCount]}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${ir.colorClass}`,children:["R",pt]}),y.jsx(Xe,{className:"text-center py-1 px-2",children:y.jsx("div",{className:`inline-block px-1.5 py-0.5 rounded border border-black ${Wt.bg} ${Wt.text} font-mono font-semibold text-xs`,children:wt})}),y.jsxs(Xe,{className:"text-center font-mono font-semibold py-1 px-2 whitespace-nowrap",children:[Zt,",",nr]}),y.jsx(Xe,{className:"text-center py-1 px-2",children:y.jsx("div",{className:`inline-block px-1.5 py-0.5 rounded border border-black ${lr.bg} ${lr.text} font-mono font-semibold text-xs`,children:tt})}),y.jsxs(Xe,{className:`text-center font-mono font-semibold py-1 px-2 whitespace-nowrap ${Ye.colorClass}`,children:["R",De]}),y.jsxs(Xe,{className:"text-center font-mono py-1 px-2 whitespace-nowrap",children:[Ee==null?void 0:Ee.name,"-",Ee==null?void 0:Ee.fiberCount]})]},`${ge.id}-feed-fiber-${Ne}`))}return _e}})})()})]})})})]})},`feed-${K.id}`)})]})}),y.jsx(gw,{open:n,onOpenChange:i,children:y.jsxs(Im,{"data-testid":"dialog-cable-form",children:[y.jsxs(Nm,{children:[y.jsx(Pm,{children:s?"Edit Cable":"Add New Cable"}),y.jsx(Am,{children:s?"Update cable details and circuit information":"Create a new cable with circuits for splicing"})]}),y.jsx(fX,{cable:s||void 0,onSubmit:F,onCancel:()=>{i(!1),a(null)},isLoading:X.isPending||ie.isPending})]})}),y.jsx(YK,{open:v,onOpenChange:C,children:y.jsxs(dD,{"data-testid":"dialog-reset-confirm",children:[y.jsxs(fD,{children:[y.jsx(hD,{children:"Reset All Data"}),y.jsx(mD,{children:"This will permanently delete all cables and circuits without saving. This action cannot be undone. Are you sure you want to continue?"})]}),y.jsxs(pD,{children:[y.jsx(yD,{"data-testid":"button-reset-cancel",children:"Cancel"}),y.jsx(gD,{onClick:()=>le.mutate(),"data-testid":"button-reset-confirm",className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Reset All Data"})]})]})}),y.jsx(gw,{open:b,onOpenChange:g,children:y.jsxs(Im,{"data-testid":"dialog-save-filename",children:[y.jsxs(Nm,{children:[y.jsx(Pm,{children:"Save Project"}),y.jsx(Am,{children:"Download your project as a JSON file to save your cables and circuits"})]}),y.jsx("div",{className:"space-y-4 py-4",children:y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"filename",className:"text-sm font-medium",children:"Project Name (optional)"}),y.jsx(Sc,{id:"filename",placeholder:"e.g., Main Street Splice",value:S,onChange:K=>E(K.target.value),onKeyDown:K=>{K.key==="Enter"&&ce()},"data-testid":"input-save-filename",autoFocus:!0}),y.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to use automatic timestamp"})]})}),y.jsxs("div",{className:"flex justify-end gap-2",children:[y.jsx(Ht,{variant:"outline",onClick:()=>{g(!1),E("")},"data-testid":"button-save-cancel",children:"Cancel"}),y.jsxs(Ht,{onClick:ce,"data-testid":"button-save-confirm",children:[y.jsx(p$,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]})}function TX(){return y.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:y.jsx(al,{className:"w-full max-w-md mx-4",children:y.jsxs(ol,{className:"pt-6",children:[y.jsxs("div",{className:"flex mb-4 gap-2",children:[y.jsx(Xq,{className:"h-8 w-8 text-red-500"}),y.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),y.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const IX="/FiberMapConnect";function NX(){return y.jsxs(w5,{children:[y.jsx(G_,{path:"/",component:EX}),y.jsx(G_,{component:TX})]})}function PX(){return y.jsx(F5,{client:vr,children:y.jsxs(f9,{children:[y.jsx(L8,{}),y.jsx(uA,{base:IX,children:y.jsx(NX,{})})]})})}function AX(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/FiberMapConnect/sw.js").then(t=>{console.log("SW registered:",t),t.addEventListener("updatefound",()=>{const r=t.installing;r&&r.addEventListener("statechange",()=>{r.state==="installed"&&navigator.serviceWorker.controller&&console.log("New version available! Please refresh.")})})}).catch(t=>{console.log("SW registration failed:",t)})})}AX();XP(document.getElementById("root")).render(y.jsx(PX,{}));export{Hw as a,R1 as c,OX as g,Zz as v};
